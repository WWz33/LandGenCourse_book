<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.3 Worked Example | Landscape Genetic Data Analysis with R</title>
  <meta name="description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics’. The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="5.3 Worked Example | Landscape Genetic Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics’. The output format is bookdown::gitbook." />
  <meta name="github-repo" content="hhwagner1/LandGenCourse_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.3 Worked Example | Landscape Genetic Data Analysis with R" />
  
  <meta name="twitter:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics’. The output format is bookdown::gitbook." />
  

<meta name="author" content="Editor: Helene Wagner (University of Toronto)" />


<meta name="date" content="2024-01-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tutorial_2.html"/>
<link rel="next" href="r-exercise-week-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.8/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Landscape Genetic Data Analysis with R</a></li>

<li class="divider"></li>
<li class="part"><span><b>Getting Started</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i><b>1.1</b> How to use this Book</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#book-structure"><i class="fa fa-check"></i>1. Book Structure</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#find-what-is-relevant-for-you"><i class="fa fa-check"></i>2. Find what is relevant for you</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#course-r-package-landgencourse"><i class="fa fa-check"></i>3. Course R package ‘LandGenCourse’</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="list-of-packages.html"><a href="list-of-packages.html"><i class="fa fa-check"></i><b>1.2</b> List of R Packages by Vignette</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="review-of-r-skills.html"><a href="review-of-r-skills.html"><i class="fa fa-check"></i><b>2</b> Review of R Skills</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>2.1</b> Basic R Programming</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#overview"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#data-types"><i class="fa fa-check"></i>2. Data Types</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#data-containers"><i class="fa fa-check"></i>3. Data Containers</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#programming"><i class="fa fa-check"></i>4. Programming</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-graphics.html"><a href="r-graphics.html"><i class="fa fa-check"></i><b>2.2</b> R Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#overview-1"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#univariate-plots"><i class="fa fa-check"></i>2. Univariate plots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#bivariate-plots"><i class="fa fa-check"></i>3. Bivariate plots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#advanced-plotting"><i class="fa fa-check"></i>4. Advanced plotting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>2.3</b> Further R resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="github-for-group-projects.html"><a href="github-for-group-projects.html"><i class="fa fa-check"></i><b>3</b> GitHub for Group Projects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>3.1</b> Why use GitHub?</a>
<ul>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#goals"><i class="fa fa-check"></i>1. Goals</a></li>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#version"><i class="fa fa-check"></i>2. Watch course video: Version Control 101</a></li>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#slides"><i class="fa fa-check"></i>3. Preview slides</a></li>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#next-steps"><i class="fa fa-check"></i>4. Next steps</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>3.2</b> Installation</a>
<ul>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#goals-1"><i class="fa fa-check"></i>1. Goals</a></li>
<li class="chapter" data-level="3.2.1" data-path="install.html"><a href="install.html#how-to-get-github-and-gitkraken-for-free"><i class="fa fa-check"></i><b>3.2.1</b> 2. How to get GitHub and GitKraken for free</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#happygit"><i class="fa fa-check"></i>3. Happy Git with R</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#gitvideos"><i class="fa fa-check"></i>4. Video tutorials: installation</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#join"><i class="fa fa-check"></i>5. Joining your group’s project on GitHub</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#repo"><i class="fa fa-check"></i>6. Setting up a group repo</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#next-steps-1"><i class="fa fa-check"></i>7. Next steps</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>3.3</b> Workflows</a>
<ul>
<li class="chapter" data-level="" data-path="workflow.html"><a href="workflow.html#goals-2"><i class="fa fa-check"></i>1. Goals</a></li>
<li class="chapter" data-level="" data-path="workflow.html"><a href="workflow.html#step-by-step-tutorials"><i class="fa fa-check"></i>2. Step-by-step tutorials</a></li>
<li class="chapter" data-level="" data-path="workflow.html"><a href="workflow.html#further-resources"><i class="fa fa-check"></i>3. Further resources</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Basic Topics</b></span></li>
<li class="chapter" data-level="4" data-path="Week1.html"><a href="Week1.html"><i class="fa fa-check"></i><b>4</b> Week 1: Importing Genetic Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="video_1.html"><a href="video_1.html"><i class="fa fa-check"></i><b>4.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_1.html"><a href="video_1.html#embedded-video"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_1.html"><a href="video_1.html#preview-slides"><i class="fa fa-check"></i>2. Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tutorial_1.html"><a href="tutorial_1.html"><i class="fa fa-check"></i><b>4.2</b> Interactive Tutorial 1</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_1.html"><a href="tutorial_1.html#list-of-r-commands-covered-this-week"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_1.html"><a href="tutorial_1.html#general-instructions"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="WE_1.html"><a href="WE_1.html"><i class="fa fa-check"></i><b>4.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#overview-of-worked-example"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#import-data-from-.csv-file"><i class="fa fa-check"></i>2. Import data from .csv file</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#create-genind-object"><i class="fa fa-check"></i>3. Create ‘genind’ Object</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#view-information-stored-in-genind-object"><i class="fa fa-check"></i>4. View information stored in ‘genind’ object</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#import-data-with-gstudio-package"><i class="fa fa-check"></i>5. Import data with ‘gstudio’ package</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#importing-snp-data"><i class="fa fa-check"></i>6. Importing SNP data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-1.html"><a href="r-exercise-week-1.html"><i class="fa fa-check"></i>R exercise Week 1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Week2.html"><a href="Week2.html"><i class="fa fa-check"></i><b>5</b> Week 2: Spatial Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="video_2.html"><a href="video_2.html"><i class="fa fa-check"></i><b>5.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_2.html"><a href="video_2.html#embedded-video-1"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_2.html"><a href="video_2.html#preview-slides-1"><i class="fa fa-check"></i>2. Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="tutorial_2.html"><a href="tutorial_2.html"><i class="fa fa-check"></i><b>5.2</b> Interactive Tutorial 2</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_2.html"><a href="tutorial_2.html#list-of-r-commands-covered-this-week-1"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_2.html"><a href="tutorial_2.html#general-instructions-1"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="WE_2.html"><a href="WE_2.html"><i class="fa fa-check"></i><b>5.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#overview-of-worked-example-1"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#import-site-data-from-.csv-file"><i class="fa fa-check"></i>2. Import site data from .csv file</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#display-raster-data-and-overlay-sampling-locations-extract-data"><i class="fa fa-check"></i>3. Display raster data and overlay sampling locations, extract data</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#calculate-landscape-metrics"><i class="fa fa-check"></i>4. Calculate landscape metrics</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#sample-landscape-metrics-within-buffer-around-sampling-locations"><i class="fa fa-check"></i>5. Sample landscape metrics within buffer around sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-2.html"><a href="r-exercise-week-2.html"><i class="fa fa-check"></i>R Exercise Week 2</a></li>
<li class="chapter" data-level="5.4" data-path="bonus_2a.html"><a href="bonus_2a.html"><i class="fa fa-check"></i><b>5.4</b> Bonus: ‘sf’ and ‘terra’</a>
<ul>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#overview-2"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#import-and-export-esri-shapefiles"><i class="fa fa-check"></i>2. Import and export ESRI shapefiles</a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#compatibility-with-sp-and-raster-objects"><i class="fa fa-check"></i>3. Compatibility with <code>sp</code> and <code>raster</code> objects</a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#plotting-spatial-data-with-tmap"><i class="fa fa-check"></i>4. Plotting spatial data with <code>tmap</code></a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#plot-a-categorical-map-with-predefined-color-scheme"><i class="fa fa-check"></i>5. Plot a categorical map with predefined color scheme</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Week3.html"><a href="Week3.html"><i class="fa fa-check"></i><b>6</b> Week 3: Genetic Diversity</a>
<ul>
<li class="chapter" data-level="6.1" data-path="video_3.html"><a href="video_3.html"><i class="fa fa-check"></i><b>6.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#embedded-video-2"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#video-part-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#video-part-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#preview-slides-2"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tutorial_3.html"><a href="tutorial_3.html"><i class="fa fa-check"></i><b>6.2</b> Interactive Tutorial 3</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_3.html"><a href="tutorial_3.html#list-of-r-commands-covered-this-week-2"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_3.html"><a href="tutorial_3.html#general-instructions-2"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="WE_3.html"><a href="WE_3.html"><i class="fa fa-check"></i><b>6.3</b> Worked Example</a></li>
<li class="chapter" data-level="6.4" data-path="r-exercise-week-3.html"><a href="r-exercise-week-3.html"><i class="fa fa-check"></i><b>6.4</b> R Exercise Week 3</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Week4.html"><a href="Week4.html"><i class="fa fa-check"></i><b>7</b> Week 4: Metapopulations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="video_4.html"><a href="video_4.html"><i class="fa fa-check"></i><b>7.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#embedded-video-3"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#video-part-1-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#video-part-2-1"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#preview-slides-3"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="tutorial_4.html"><a href="tutorial_4.html"><i class="fa fa-check"></i><b>7.2</b> Interactive Tutorial 4</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_4.html"><a href="tutorial_4.html#list-of-r-commands-covered-this-week-3"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_4.html"><a href="tutorial_4.html#general-instructions-3"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="WE_4.html"><a href="WE_4.html"><i class="fa fa-check"></i><b>7.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#overview-of-worked-example-3"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#spatial-distribution-of-genetic-structure"><i class="fa fa-check"></i>2. Spatial distribution of genetic structure</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#what-determines-genetic-differentiation-among-sites"><i class="fa fa-check"></i>3. What determines genetic differentiation among sites?</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#what-determines-genetic-diversity"><i class="fa fa-check"></i>4. What determines genetic diversity?</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#are-genetic-differentiation-and-diversity-related"><i class="fa fa-check"></i>5. Are genetic differentiation and diversity related?</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#effect-of-recent-extinction-events"><i class="fa fa-check"></i>6. Effect of recent extinction events</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-4.html"><a href="r-exercise-week-4.html"><i class="fa fa-check"></i>R Exercise Week 4</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Week5.html"><a href="Week5.html"><i class="fa fa-check"></i><b>8</b> Week 5: Spatial Statistics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="video_5.html"><a href="video_5.html"><i class="fa fa-check"></i><b>8.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_5.html"><a href="video_5.html#embedded-video-4"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_5.html"><a href="video_5.html#preview-slides-4"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tutorial_5.html"><a href="tutorial_5.html"><i class="fa fa-check"></i><b>8.2</b> Interactive Tutorial 5</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_5.html"><a href="tutorial_5.html#list-of-r-commands-covered-this-week-4"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_5.html"><a href="tutorial_5.html#general-instructions-4"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="WE_5.html"><a href="WE_5.html"><i class="fa fa-check"></i><b>8.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#overview-of-worked-example-4"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#data-import-and-manipulation"><i class="fa fa-check"></i>2. Data import and manipulation</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#calculate-genetic-distances"><i class="fa fa-check"></i>3. Calculate genetic distances</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#perform-a-mantel-test-to-test-for-ibd"><i class="fa fa-check"></i>4. Perform a Mantel test to test for IBD</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#create-mantel-correlogram-for-genetic-data"><i class="fa fa-check"></i>5. Create Mantel correlogram for genetic data</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#specify-spatial-weights-and-calculate-morans-i"><i class="fa fa-check"></i>6. Specify spatial weights and calculate Moran’s I</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-5.html"><a href="r-exercise-week-5.html"><i class="fa fa-check"></i>R Exercise Week 5</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Week6.html"><a href="Week6.html"><i class="fa fa-check"></i><b>9</b> Week 6: Quantitative Genetics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="video_6.html"><a href="video_6.html"><i class="fa fa-check"></i><b>9.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#embedded-video-5"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#video-part-1-2"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#video-part-2-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#preview-slides-5"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="tutorial_6.html"><a href="tutorial_6.html"><i class="fa fa-check"></i><b>9.2</b> Interactive Tutorial 6</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_6.html"><a href="tutorial_6.html#list-of-r-commands-covered-this-week-5"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_6.html"><a href="tutorial_6.html#general-instructions-5"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="WE_6.html"><a href="WE_6.html"><i class="fa fa-check"></i><b>9.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#overview-of-worked-example-5"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment"><i class="fa fa-check"></i>2. Estimate genetic and non-genetic variance components from a common garden experiment</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#estimate-trait-heritability"><i class="fa fa-check"></i>3. Estimate trait heritability</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#compare-q_st-to-f_st-measured-from-snp-data"><i class="fa fa-check"></i>4. Compare <span class="math inline">\(Q_{st}\)</span> to <span class="math inline">\(F_{st}\)</span> measured from SNP data</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#assess-correlation-between-trait-and-environment"><i class="fa fa-check"></i>5. Assess correlation between trait and environment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-6.html"><a href="r-exercise-week-6.html"><i class="fa fa-check"></i>R Exercise Week 6</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Week7.html"><a href="Week7.html"><i class="fa fa-check"></i><b>10</b> Week 7: Spatial Linear Models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="video_7.html"><a href="video_7.html"><i class="fa fa-check"></i><b>10.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#embedded-video-6"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#video-part-1-3"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#video-part-2-3"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#preview-slides-6"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tutorial_7.html"><a href="tutorial_7.html"><i class="fa fa-check"></i><b>10.2</b> Interactive Tutorial 7</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_7.html"><a href="tutorial_7.html#list-of-r-commands-covered-this-week-6"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_7.html"><a href="tutorial_7.html#general-instructions-6"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="WE_7.html"><a href="WE_7.html"><i class="fa fa-check"></i><b>10.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#overview-of-worked-example-6"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#explore-data-set"><i class="fa fa-check"></i>2. Explore data set</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#test-regression-residuals-for-spatial-autocorrelation"><i class="fa fa-check"></i>3. Test regression residuals for spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#fit-models-with-spatially-correlated-error-gls-with-package-nlme"><i class="fa fa-check"></i>4. Fit models with spatially correlated error (GLS) with package ‘nlme’</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#fit-spatial-simultaneous-autoregressive-error-models-sar"><i class="fa fa-check"></i>5. Fit spatial simultaneous autoregressive error models (SAR)</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#spatial-filtering-with-mem-using-package-spmoran"><i class="fa fa-check"></i>6. Spatial filtering with MEM using package ‘spmoran’</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#fit-spatially-varying-coefficients-model-with-package-spmoran"><i class="fa fa-check"></i>7. Fit spatially varying coefficients model with package ‘spmoran’</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#model-with-patchsize-and-ibr"><i class="fa fa-check"></i>Model with PatchSize and IBR</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#model-with-ibr-only"><i class="fa fa-check"></i>Model with IBR only</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#conclusions"><i class="fa fa-check"></i>8. Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-7.html"><a href="r-exercise-week-7.html"><i class="fa fa-check"></i>R Exercise Week 7</a></li>
<li class="chapter" data-level="10.4" data-path="bonus_7a.html"><a href="bonus_7a.html"><i class="fa fa-check"></i><b>10.4</b> Bonus: Si index</a>
<ul>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#overview-of-bonus-materials"><i class="fa fa-check"></i>1. Overview of Bonus Materials</a></li>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#import-ecological-distance-matrices"><i class="fa fa-check"></i>2. Import ecological distance matrices</a></li>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#optimize-the-scaling-parameter-alpha"><i class="fa fa-check"></i>3. Optimize the scaling parameter alpha</a></li>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#calculate-hanskis-index-si-with-source-patch-parameters"><i class="fa fa-check"></i>4. Calculate Hanski’s index Si with source patch parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Week8.html"><a href="Week8.html"><i class="fa fa-check"></i><b>11</b> Week 8: Simulation Experiments</a>
<ul>
<li class="chapter" data-level="11.1" data-path="video_8.html"><a href="video_8.html"><i class="fa fa-check"></i><b>11.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#embedded-video-7"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#video-part-1-4"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#video-part-2-4"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#preview-slides-7"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="tutorial_8.html"><a href="tutorial_8.html"><i class="fa fa-check"></i><b>11.2</b> Interactive Tutorial 8</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_8.html"><a href="tutorial_8.html#list-of-r-commands-covered-this-week-7"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_8.html"><a href="tutorial_8.html#general-instructions-7"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="WE_8.html"><a href="WE_8.html"><i class="fa fa-check"></i><b>11.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#overview-of-worked-example-7"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#initialize-a-landscape"><i class="fa fa-check"></i>2. Initialize a landscape</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#define-simulation-parameters"><i class="fa fa-check"></i>3. Define simulation parameters</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#run-simulations-and-analyze-results"><i class="fa fa-check"></i>4. Run simulations and analyze results</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#run-simulator-using-a-previously-defined-parameter-set"><i class="fa fa-check"></i>5. Run simulator using a previously defined parameter set</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-8.html"><a href="r-exercise-week-8.html"><i class="fa fa-check"></i>R Exercise Week 8</a></li>
<li class="chapter" data-level="11.4" data-path="bonus_8a.html"><a href="bonus_8a.html"><i class="fa fa-check"></i><b>11.4</b> Bonus: Efficient R</a></li>
</ul></li>
<li class="part"><span><b>Advanced Topics</b></span></li>
<li class="chapter" data-level="12" data-path="Week9.html"><a href="Week9.html"><i class="fa fa-check"></i><b>12</b> Week 9: Population Structure</a>
<ul>
<li class="chapter" data-level="12.1" data-path="WE_9.html"><a href="WE_9.html"><i class="fa fa-check"></i><b>12.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#overview-of-worked-example-8"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#simulated-data-2-island-model"><i class="fa fa-check"></i>2. Simulated data: 2-island model</a></li>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#simulated-data-2-island-model-with-admixture"><i class="fa fa-check"></i>3. Simulated data: 2-island model with admixture</a></li>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#empirical-data-threespine-sticklebacks"><i class="fa fa-check"></i>4. Empirical data: Threespine sticklebacks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Week10.html"><a href="Week10.html"><i class="fa fa-check"></i><b>13</b> Week 10: Landscape Resistance</a>
<ul>
<li class="chapter" data-level="13.1" data-path="WE_10.html"><a href="WE_10.html"><i class="fa fa-check"></i><b>13.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#overview-of-worked-example-9"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#explore-the-data-set"><i class="fa fa-check"></i>2. Explore the data set</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#setting-cost-values-and-calculating-conductance"><i class="fa fa-check"></i>3. Setting cost values and calculating conductance</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#convert-conductance-into-effective-distance"><i class="fa fa-check"></i>4. Convert conductance into effective distance</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#create-cost-distance-matrices"><i class="fa fa-check"></i>5. Create cost-distance matrices</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#how-does-changing-resolution-affect-these-metrics"><i class="fa fa-check"></i>6. How does changing resolution affect these metrics?</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#references"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="bonus-10a.html"><a href="bonus-10a.html"><i class="fa fa-check"></i><b>13.2</b> Bonus: ‘radish’ tutorial</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#overview-of-bonus-materials-1"><i class="fa fa-check"></i>1. Overview of Bonus Materials</a></li>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#import-data"><i class="fa fa-check"></i>2. Import data</a></li>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#basic-model-fitting"><i class="fa fa-check"></i>3. Basic model fitting</a></li>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#advanced-modeling-topics"><i class="fa fa-check"></i>4. Advanced modeling topics</a></li>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#summary"><i class="fa fa-check"></i>5. Summary</a></li>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#references-1"><i class="fa fa-check"></i>6. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="Week11.html"><a href="Week11.html"><i class="fa fa-check"></i><b>14</b> Week 11: Detecting Adaptation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="WE_11.html"><a href="WE_11.html"><i class="fa fa-check"></i><b>14.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#overview-of-worked-example-10"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#import-and-prepare-the-data"><i class="fa fa-check"></i>2. Import and prepare the data</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#latent-factor-mixed-models-lfmm-a-univariate-gea"><i class="fa fa-check"></i>3. Latent Factor Mixed Models (LFMM): a univariate GEA</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#redundancy-analysis-rda-a-multivariate-gea"><i class="fa fa-check"></i>4. Redundancy Analysis (RDA): a multivariate GEA</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#compare-lfmm-and-rda-candidates"><i class="fa fa-check"></i>5. Compare LFMM and RDA candidates</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#a-quick-note-on-controlling-for-population-structure-in-rda"><i class="fa fa-check"></i>6. A quick note on controlling for population structure in RDA</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#references-2"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="Week12.html"><a href="Week12.html"><i class="fa fa-check"></i><b>15</b> Week 12: Model Selection</a>
<ul>
<li class="chapter" data-level="15.1" data-path="WE_12.html"><a href="WE_12.html"><i class="fa fa-check"></i><b>15.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#overview-of-worked-example-11"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#fitting-candidate-models"><i class="fa fa-check"></i>2. Fitting candidate models</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#your-turn-to-test-additional-hypotheses"><i class="fa fa-check"></i>3. Your turn to test additional hypotheses!</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#nested-model-nmlpe-for-hierarchical-sampling-designs"><i class="fa fa-check"></i>4. Nested model (NMLPE) for hierarchical sampling designs</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#references-3"><i class="fa fa-check"></i>5. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="Week13.html"><a href="Week13.html"><i class="fa fa-check"></i><b>16</b> Week 13: Gravity Models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="WE_13.html"><a href="WE_13.html"><i class="fa fa-check"></i><b>16.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#overview-of-worked-example-12"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#setup"><i class="fa fa-check"></i>2. Setup</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#wetland-complex-data-preparation"><i class="fa fa-check"></i>3. Wetland complex data preparation</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#wetland-field-data-preparation"><i class="fa fa-check"></i>4. Wetland field-data preparation</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#saturated-graph"><i class="fa fa-check"></i>5. Saturated Graph</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#spatial-model-data-prepration"><i class="fa fa-check"></i>6. Spatial model data prepration</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#gravity-model"><i class="fa fa-check"></i>7. Gravity model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="Week14.html"><a href="Week14.html"><i class="fa fa-check"></i><b>17</b> Week 14: Contemporary Gene Flow</a>
<ul>
<li class="chapter" data-level="17.1" data-path="WE_14.html"><a href="WE_14.html"><i class="fa fa-check"></i><b>17.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#overview-3"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#import-genotypes"><i class="fa fa-check"></i>2. Import Genotypes</a></li>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#pollen-pool-genetic-structure"><i class="fa fa-check"></i>3. Pollen pool genetic structure</a></li>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#paternity-analysis"><i class="fa fa-check"></i>4. Paternity analysis</a></li>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#linking-paternity-to-ecological-variables"><i class="fa fa-check"></i>5. Linking paternity to ecological variables</a></li>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#references-4"><i class="fa fa-check"></i>6. References</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Landscape Genetic Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="WE_2" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Worked Example<a href="WE_2.html#WE_2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Helene Wagner and Max Hesselbarth</p>
<div id="overview-of-worked-example-1" class="section level3 unnumbered hasAnchor">
<h3>1. Overview of Worked Example<a href="WE_2.html#overview-of-worked-example-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-background-on-spatial-packages-in-r" class="section level4 hasAnchor" number="5.3.0.1">
<h4><span class="header-section-number">5.3.0.1</span> a. Background on spatial packages in R<a href="WE_2.html#a.-background-on-spatial-packages-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There has been a lot of development recently in R regarding object types for geospatial data. We are currently in a transition period, where some packages still expect the “old” object types (based e.g. on packages <code>raster</code> and <code>sp</code>), others expect the “new” object types (based e.g. on packages <code>terra</code> and <code>sf</code>), and some accept both. This vignette uses the newer packages <code>terra</code> and <code>sf</code>. The bonus vignette includes code for converting between <code>sf</code> and <code>sp</code>, and between <code>terra</code> and <code>raster</code>.</p>
<p>Further resources:</p>
<ul>
<li><p><strong>Intro GIS with R</strong>: to learn about GIS functionality using R, <a href="https://bookdown.org/michael_bcalles/gis-crash-course-in-r/data.html#vector-data" class="uri">https://bookdown.org/michael_bcalles/gis-crash-course-in-r/data.html#vector-data</a></p></li>
<li><p><strong>R Tutorial</strong>: For an introductory tutorial on spatial data analysis with R, which explains object types in more detail than this worked example, see: <a href="https://rpubs.com/jguelat/fdsfd" class="uri">https://rpubs.com/jguelat/fdsfd</a></p></li>
<li><p><strong>Advanced</strong>: For a thorough resource on spatial data analysis with R, see this excellent Gitbook: <a href="https://geocompr.robinlovelace.net/index.html" class="uri">https://geocompr.robinlovelace.net/index.html</a>.</p></li>
</ul>
</div>
<div id="b.-goals" class="section level4 unnumbered hasAnchor">
<h4>b. Goals<a href="WE_2.html#b.-goals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This worked example shows:</p>
<ul>
<li>How to import spatial coordinates and site attributes as spatially referenced data.<br />
</li>
<li>How to plot raster data in R and overlay sampling locations.</li>
<li>How to calculate landscape metrics.</li>
<li>How to extract landscape data at sampling locations and within a buffer around them.</li>
</ul>
<p>Try modifying the code to import your own data!</p>
</div>
<div id="c.-data-set" class="section level4 unnumbered hasAnchor">
<h4>c. Data set<a href="WE_2.html#c.-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This code builds on data and code from the <code>GeNetIt</code> package by Jeff Evans and Melanie Murphy. Landscape metrics will be calculated with the <code>landscapemetrics</code> package described in: Hesselbarth et al. (2019), Ecography 42: 1648-1657.</p>
<p>This code uses landscape data and spatial coordinates from 30 locations where Colombia spotted frogs (<em>Rana luteiventris</em>) were sampled for the full data set analyzed by Funk et al. (2005) and Murphy et al. (2010). Please see the separate introduction to the data set.</p>
<ul>
<li><code>ralu.site</code>: <code>sf</code> object with UTM coordinates (zone 11) and 17 site variables for 31 sites. The data are included in the ‘GeNetIt’ package, for meta data type: ?ralu.site</li>
</ul>
<p>We will extract values at sampling point locations and within a local neighborhood (buffer) from six raster maps (see Murphy et al. 2010 for definitions), which are included with the <code>GeNetIt</code> package as a SpatialPixelsDataFrame called ‘rasters’:</p>
<ul>
<li>cti: Compound Topographic Index (“wetness”)</li>
<li>err27: Elevation Relief Ratio</li>
<li>ffp: Frost Free Period</li>
<li>gsp: Growing Season Precipitation</li>
<li>hli: Heat Load Index</li>
<li>nlcd: USGS Landcover (categorical map)</li>
</ul>
</div>
<div id="d.-required-r-packages" class="section level4 unnumbered hasAnchor">
<h4>d. Required R packages<a href="WE_2.html#d.-required-r-packages" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Install some packages needed for this worked example.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="WE_2.html#cb347-1" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;GeNetIt&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;jeffreyevans/GeNetIt&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="WE_2.html#cb348-1" tabindex="-1"></a><span class="fu">library</span>(LandGenCourse)</span>
<span id="cb348-2"><a href="WE_2.html#cb348-2" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb348-3"><a href="WE_2.html#cb348-3" tabindex="-1"></a><span class="fu">library</span>(landscapemetrics)</span>
<span id="cb348-4"><a href="WE_2.html#cb348-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb348-5"><a href="WE_2.html#cb348-5" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb348-6"><a href="WE_2.html#cb348-6" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb348-7"><a href="WE_2.html#cb348-7" tabindex="-1"></a><span class="fu">library</span>(GeNetIt)</span>
<span id="cb348-8"><a href="WE_2.html#cb348-8" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb348-9"><a href="WE_2.html#cb348-9" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb348-10"><a href="WE_2.html#cb348-10" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span></code></pre></div>
</div>
</div>
<div id="import-site-data-from-.csv-file" class="section level3 unnumbered hasAnchor">
<h3>2. Import site data from .csv file<a href="WE_2.html#import-site-data-from-.csv-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-import-data-into-an-sf-object" class="section level4 unnumbered hasAnchor">
<h4>a. Import data into an <code>sf</code> object<a href="WE_2.html#a.-import-data-into-an-sf-object" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The site data are already in an <code>sf</code> object named <code>ralu.site</code> that comes with the package <code>GeNetIt</code>. Use <code>data(ralu.site)</code> to load it. This will create an object <code>ralu.site</code>.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="WE_2.html#cb349-1" tabindex="-1"></a><span class="fu">data</span>(ralu.site)</span>
<span id="cb349-2"><a href="WE_2.html#cb349-2" tabindex="-1"></a><span class="fu">class</span>(ralu.site)</span></code></pre></div>
<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;</code></pre>
<p>To demonstrate how to create an <code>sf</code> object from two data frames (one with the coordinates and one with the attribute data), we’ll extract these data frames from the <code>sf</code> object <code>ralu.site</code> and then recreate the <code>sf</code> object (we’ll call it <code>Sites</code>) from the two data frames.</p>
<p>We can extract the coordinates with the function <code>st_coordinates</code>:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="WE_2.html#cb351-1" tabindex="-1"></a>Coordinates <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(ralu.site)</span>
<span id="cb351-2"><a href="WE_2.html#cb351-2" tabindex="-1"></a><span class="fu">head</span>(Coordinates)</span></code></pre></div>
<pre><code>##             X       Y
## [1,] 688816.6 5003207
## [2,] 688494.4 4999093
## [3,] 687938.4 5000223
## [4,] 689732.8 5002522
## [5,] 690104.0 4999355
## [6,] 688742.5 4997481</code></pre>
<p><strong>Question</strong>: What are the variable names for the spatial coordinates?</p>
<p>Similarly, we can drop the geometry (spatial information) from the <code>sf</code> object to reduce it to a data frame:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="WE_2.html#cb353-1" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(ralu.site)</span>
<span id="cb353-2"><a href="WE_2.html#cb353-2" tabindex="-1"></a><span class="fu">class</span>(Data)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>Now we can create an <code>sf</code> object again. Here, we:</p>
<ul>
<li>combine the two data frames <code>Data</code> and <code>Coordinates</code> into a single data frame with function <code>data.frame</code>,</li>
<li>use the function <code>st_as_sf</code> from the <code>sf</code> package to convert this data frame to an <code>sf</code> object,</li>
<li>tell R that the variables with the coordinates are called “X” and “Y”.</li>
</ul>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="WE_2.html#cb355-1" tabindex="-1"></a>Sites <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Data, Coordinates)</span>
<span id="cb355-2"><a href="WE_2.html#cb355-2" tabindex="-1"></a>Sites.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(Sites, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>))</span>
<span id="cb355-3"><a href="WE_2.html#cb355-3" tabindex="-1"></a><span class="fu">head</span>(Sites.sf)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 17 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 687938.4 ymin: 4997481 xmax: 690104 ymax: 5003207
## CRS:           NA
##         SiteName        Drainage      Basin Substrate
## 1   AirplaneLake ShipIslandCreek Sheepeater      Silt
## 2 BachelorMeadow     WilsonCreek    Skyhigh      Silt
## 3 BarkingFoxLake  WaterfallCreek    Terrace      Silt
## 4   BirdbillLake      ClearCreek   Birdbill      Sand
## 5        BobLake     WilsonCreek     Harbor      Silt
## 6      CacheLake     WilsonCreek    Skyhigh      Silt
##                               NWI AREA_m2 PERI_m Depth_m  TDS FISH ACB   AUC
## 1                      Lacustrine 62582.2 1142.8   21.64  2.5    1   0 0.411
## 2 Riverine_Intermittent_Streambed   225.0   60.0    0.40  0.0    0   0 0.000
## 3                      Lacustrine 12000.0  435.0    5.00 13.8    1   0 0.300
## 4                      Lacustrine 12358.6  572.3    3.93  6.4    1   0 0.283
## 5                      Palustrine  4600.0  321.4    2.00 14.3    0   0 0.000
## 6                      Palustrine  2268.8  192.0    1.86 10.9    0   0 0.000
##   AUCV  AUCC   AUF AWOOD  AUFV                 geometry
## 1    0 0.411 0.063 0.063 0.464 POINT (688816.6 5003207)
## 2    0 0.000 1.000 0.000 0.000 POINT (688494.4 4999093)
## 3    0 0.300 0.700 0.000 0.000 POINT (687938.4 5000223)
## 4    0 0.283 0.717 0.000 0.000 POINT (689732.8 5002522)
## 5    0 0.000 0.500 0.000 0.500   POINT (690104 4999355)
## 6    0 0.000 0.556 0.093 0.352 POINT (688742.5 4997481)</code></pre>
<p><strong>Question</strong>: Where and how are the spatial coordinates shown in the <code>sf</code> object <code>Sites.sf</code>?</p>
<p>To illustrate importing spatial data from Excel, here we export the combined data frame as a csv file, import it again as a data frame, then convert it to an <code>sf</code> object. First we create a folder <code>output</code> if it does not yet exist.</p>
<p>Note: to run the code below, remove all the hashtags <code>#</code> at the beginning of the lines to un-comment them. This part assumes that you have writing permission on your computer. Alternatively, try setting up your R project folder on an external drive where you have writing permission.</p>
<p>The code below does the following:</p>
<ul>
<li>Line 1: Load package here that helps with file paths.</li>
<li>Line 2: Check if folder output exists, and if not, create it.</li>
<li>Line 3: Export the combined data frame as a .csv file.</li>
<li>Line 4: Re-imports the .csv file as a <code>data.frame</code> object <code>Sites</code>.</li>
<li>Line 5: Create <code>sf</code> object <code>Sites.sf</code> from df`.</li>
</ul>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="WE_2.html#cb357-1" tabindex="-1"></a><span class="co">#require(here)</span></span>
<span id="cb357-2"><a href="WE_2.html#cb357-2" tabindex="-1"></a><span class="co">#if(!dir.exists(here(&quot;output&quot;))) dir.create(here(&quot;output&quot;))</span></span>
<span id="cb357-3"><a href="WE_2.html#cb357-3" tabindex="-1"></a><span class="co">#write.csv(data.frame(Data, Coordinates), file=here(&quot;output/ralu.site.csv&quot;), quote=FALSE, row.names=FALSE)</span></span>
<span id="cb357-4"><a href="WE_2.html#cb357-4" tabindex="-1"></a><span class="co">#Sites &lt;- read.csv(here(&quot;output/ralu.site.csv&quot;), header=TRUE)</span></span>
<span id="cb357-5"><a href="WE_2.html#cb357-5" tabindex="-1"></a><span class="co">#Sites.sf &lt;- st_as_sf(df, coords=c(&quot;X&quot;, &quot;Y&quot;))</span></span></code></pre></div>
<p>The <code>sf</code> object <code>Sites.sf</code> contains 17 attribute variables and one variable <code>geometry</code> that contains the spatial information. Now R knows these are spatial data and knows how to handle them.</p>
</div>
<div id="b.-add-spatial-reference-data" class="section level4 unnumbered hasAnchor">
<h4>b. Add spatial reference data<a href="WE_2.html#b.-add-spatial-reference-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Before we can combine the sampling locations with other spatial datasets, such as raster data, we need to tell R where on Earth these locations are (georeferencing). This is done by specifying the “Coordinate Reference System” (CRS).</p>
<p>For a great explanation of projections, see:
<a href="https://michaelminn.net/tutorials/gis-projections/index.html" class="uri">https://michaelminn.net/tutorials/gis-projections/index.html</a></p>
<p>For more information on CRS, see: <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/OverviewCoordinateReferenceSystems.pdf" class="uri">https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/OverviewCoordinateReferenceSystems.pdf</a></p>
<p>We know that these coordinates are UTM zone 11 (Northern hemisphere) coordinates. We define it here by its EPSG code (32611). You can search for EPSG codes here: <a href="https://epsg.io/32611" class="uri">https://epsg.io/32611</a>.</p>
<p>Here we call the function and the package simultaneously (this is good practice, as it helps keep track of where the functions in your code come from).</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="WE_2.html#cb358-1" tabindex="-1"></a><span class="fu">st_crs</span>(Sites.sf) <span class="ot">&lt;-</span> <span class="dv">32611</span></span></code></pre></div>
<p><strong>Question:</strong> Print <code>Sites.sf</code> and check what CRS is listed in the header.</p>
<p><strong>Important</strong>: the code above, using function <code>st_crs</code>, only <strong>declares</strong> the existing projection, it does not change the coordinates to that projection!</p>
<p>However, the <code>ralu.site</code> dataset uses a slightly different definition of the projection (the difference is in the <code>datum</code> argument <code>WGS84</code> vs. <code>NAD83</code>). Hence it may be safer to simply copy the crs information from ralu.site to Sites.sf. Again, this does not change the projection but declares that Sites.sf has the same projection as ralu.site. R even prints a warning to remind us of this:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="WE_2.html#cb359-1" tabindex="-1"></a><span class="fu">st_crs</span>(Sites.sf) <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(ralu.site)</span></code></pre></div>
<pre><code>## Warning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for
## that</code></pre>
</div>
<div id="c.-change-projection" class="section level4 unnumbered hasAnchor">
<h4>c. Change projection<a href="WE_2.html#c.-change-projection" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In case we needed to <strong>transform</strong> the projection, e.g., from UTM zone 11 to longitude/latitude (EPSG code: 4326), we could create a new <code>sf</code> object <code>Sites.sf.longlat</code>. We use the function <code>st_transform</code> to change the projection from the projection of the old object <code>Sites.sf</code> to the “longlat” coordinate system, which we define by the argument <code>crs</code>.</p>
<p>With</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="WE_2.html#cb361-1" tabindex="-1"></a>Sites.sf.longlat <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Sites.sf, <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb361-2"><a href="WE_2.html#cb361-2" tabindex="-1"></a><span class="fu">head</span>(Sites.sf.longlat)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 17 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -114.61 ymin: 45.1056 xmax: -114.5828 ymax: 45.15708
## Geodetic CRS:  WGS 84
##         SiteName        Drainage      Basin Substrate
## 1   AirplaneLake ShipIslandCreek Sheepeater      Silt
## 2 BachelorMeadow     WilsonCreek    Skyhigh      Silt
## 3 BarkingFoxLake  WaterfallCreek    Terrace      Silt
## 4   BirdbillLake      ClearCreek   Birdbill      Sand
## 5        BobLake     WilsonCreek     Harbor      Silt
## 6      CacheLake     WilsonCreek    Skyhigh      Silt
##                               NWI AREA_m2 PERI_m Depth_m  TDS FISH ACB   AUC
## 1                      Lacustrine 62582.2 1142.8   21.64  2.5    1   0 0.411
## 2 Riverine_Intermittent_Streambed   225.0   60.0    0.40  0.0    0   0 0.000
## 3                      Lacustrine 12000.0  435.0    5.00 13.8    1   0 0.300
## 4                      Lacustrine 12358.6  572.3    3.93  6.4    1   0 0.283
## 5                      Palustrine  4600.0  321.4    2.00 14.3    0   0 0.000
## 6                      Palustrine  2268.8  192.0    1.86 10.9    0   0 0.000
##   AUCV  AUCC   AUF AWOOD  AUFV                   geometry
## 1    0 0.411 0.063 0.063 0.464 POINT (-114.5977 45.15708)
## 2    0 0.000 1.000 0.000 0.000 POINT (-114.6034 45.12016)
## 3    0 0.300 0.700 0.000 0.000   POINT (-114.61 45.13047)
## 4    0 0.283 0.717 0.000 0.000 POINT (-114.5864 45.15067)
## 5    0 0.000 0.500 0.000 0.500 POINT (-114.5828 45.12208)
## 6    0 0.000 0.556 0.093 0.352  POINT (-114.6008 45.1056)</code></pre>
<p><strong>Question</strong>: What has changed in the summary?</p>
</div>
<div id="d.-map-sampling-sites-on-world-map" class="section level4 unnumbered hasAnchor">
<h4>d. Map sampling sites on world map<a href="WE_2.html#d.-map-sampling-sites-on-world-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Where on earth is this? You could enter the coordinates from the “longlat” projection in Google maps. Note that Google expects the Latitude (Y coordinate) first, then the Longitude (X coordinate). In the variable <code>geometry</code>, longitude (e.g., -114.5977 for the first data point) is listed before latitude (45.15708 for the first data point). Thus, to locate the first site in Google maps, you will need to enter <code>45.15708, -114.5977</code>.</p>
<p>There is a much easier way to find out where on Earth the sampling points are located. And we don’t even need to change the coordinates to longitude/latitude - R will do this for us internally.</p>
<ul>
<li>We load the R package <code>tmap</code> (which stands for “thematic maps”)</li>
<li>With <code>tmap_mode("view")</code>, we indicate that we want to create an interactive map.</li>
<li>With <code>tm_shape(Sites.sf)</code> we select the data set (Sites.sf`) to be displayed. For now, we only plot the location, no attribute information.</li>
<li>With <code>tm_sf</code>, we specify how the points should be displayed (color, size).</li>
</ul>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="WE_2.html#cb363-1" tabindex="-1"></a><span class="fu">require</span>(tmap)</span>
<span id="cb363-2"><a href="WE_2.html#cb363-2" tabindex="-1"></a></span>
<span id="cb363-3"><a href="WE_2.html#cb363-3" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</span></code></pre></div>
<pre><code>## tmap mode set to interactive viewing</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="WE_2.html#cb365-1" tabindex="-1"></a><span class="fu">tm_shape</span>(Sites.sf) <span class="sc">+</span> <span class="fu">tm_sf</span>(<span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-cc1dae885f847ecc1fec" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-cc1dae885f847ecc1fec">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldGrayCanvas",null,"Esri.WorldGrayCanvas",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircles","args":[[45.15707850945083,45.12016062430876,45.1304727987641,45.15066982354276,45.12208200955106,45.10559714362714,45.0982893066227,45.11162597727552,45.16810160930147,45.09975785083597,45.11407808030845,45.15469735448928,45.15545452687273,45.1637644385459,45.09441390148887,45.1165823853642,45.15207319555835,45.09016340391857,45.08848338859229,45.15092837107155,45.08316146635691,45.08356480981284,45.16692667954503,45.08533324650074,45.16529181498381,45.11965875884201,45.15632923267202,45.13562787813084,45.12274430524,45.07529212294912,45.12860201067411],[-114.5977396540216,-114.6033865250272,-114.6100248049217,-114.5863531992181,-114.5828399817001,-114.6008430385362,-114.5983541778665,-114.6031733879995,-114.5964858515769,-114.5990662195857,-114.599181207082,-114.585563173993,-114.5835998180092,-114.5798359744075,-114.6100936916924,-114.6065382479126,-114.5715719888294,-114.6045327001424,-114.6158701947446,-114.6222594992278,-114.6185682698232,-114.622073588037,-114.5761415003057,-114.6122166396044,-114.6216736368122,-114.6076631577064,-114.5829370604914,-114.6082003751046,-114.5837103287136,-114.6117283040945,-114.5904058421169],[171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407,171.9993370863407],["AirplaneLake","BachelorMeadow","BarkingFoxLake","BirdbillLake","BobLake","CacheLake","DoeLake","EggWhiteLake","ElenasLake","FawnLake","FrogPondLake","GentianLake","GentianPonds","GoldenLake","GreggsLake","InandOutLake","MeadowLake","MooseLake","Mt.WilsonLake","NopezLake","ParagonLake","ParagonWetland","PotholeLake","RamshornLake","ShipIslandLake","SkyhighLake","StockingCapLake","Terrace1Lake","TobiasLake","WalkaboutLake","WelcomeLake"],"Sites.sf",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>AirplaneLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>AirplaneLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ShipIslandCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Sheepeater<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>62,582<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>1,143<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>21.64<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>2.5<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.411<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.411<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.063<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.063<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.464<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BachelorMeadow<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>BachelorMeadow<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Skyhigh<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Riverine_Intermittent_Streambed<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>225<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>60<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>0.40<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>1.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BarkingFoxLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>BarkingFoxLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WaterfallCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Terrace<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>12,000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>435<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>5.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>13.8<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.300<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.300<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.700<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BirdbillLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>BirdbillLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ClearCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Birdbill<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Sand<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>12,359<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>572<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>3.93<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>6.4<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.283<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.283<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.717<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BobLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>BobLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Harbor<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>4,600<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>321<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>2.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>14.3<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.500<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.500<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>CacheLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>CacheLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Skyhigh<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>2,269<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>192<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>1.86<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>10.9<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.556<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.093<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.352<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>DoeLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>DoeLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Skyhigh<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>13,035<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>463<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>6.03<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>10.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.415<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.171<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.585<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.341<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.073<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>EggWhiteLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>EggWhiteLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Skyhigh<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>4,544<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>292<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>3.30<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>2.4<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.047<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.047<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.686<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.209<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.058<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ElenasLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>ElenasLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ShipIslandCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Sheepeater<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Sand<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>FawnLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>FawnLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Skyhigh<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>3,866<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>238<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>1.98<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>3.6<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>1.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>FrogPondLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>FrogPondLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Skyhigh<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>2,094<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>171<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>3.07<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>9.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.500<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.500<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GentianLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>GentianLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ClearCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Birdbill<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Sand<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>26,276<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>1,046<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>3.57<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>3.3<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.597<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.597<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.260<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.143<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GentianPonds<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>GentianPonds<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ClearCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Birdbill<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>225<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>60<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>2.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>6.7<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>1.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GoldenLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>GoldenLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ClearCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Glacier<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>3,526<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>264<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>2.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.111<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.111<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.889<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GreggsLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>GreggsLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>TipTop<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Cobble<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>6,556<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>305<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>4.70<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.351<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.351<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.455<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.195<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>InandOutLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>InandOutLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Skyhigh<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Sand<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>13,043<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>438<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>8.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>5.2<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.279<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.403<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.682<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.287<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.031<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>MeadowLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>MeadowLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ClearCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Birdbill<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>12,000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>460<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>3.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>10.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.045<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.955<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>MooseLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>MooseLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>TipTop<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>3,445<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>220<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>2.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.067<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.067<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.437<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.042<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.454<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>Mt.WilsonLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>Mt.WilsonLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>TipTop<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>6,089<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>300<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>3.89<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>5.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.441<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.441<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.441<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.118<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>NopezLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>NopezLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ShipIslandCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Nopez<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>12,003<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>511<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>5.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.882<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.118<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ParagonLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>ParagonLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>TipTop<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>36,915<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>917<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>12.70<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.110<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.463<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.463<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.088<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.338<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ParagonWetland<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>ParagonWetland<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>TipTop<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Riverine_UpperPerennial_UnconsolidatedBottom<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>1,000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>120<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>0.25<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.500<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.500<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>PotholeLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>PotholeLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ClearCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Glacier<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>5,994<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>293<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>3.35<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.097<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.097<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.778<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.125<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>RamshornLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>RamshornLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>TipTop<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>38,913<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>922<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>16.97<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>5.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.135<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.099<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.766<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ShipIslandLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>ShipIslandLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ShipIslandCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Nopez<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Sand<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>353,898<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>4,313<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>22.86<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>5.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.036<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.405<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.012<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.417<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.357<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.071<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.119<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>SkyhighLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>SkyhighLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Skyhigh<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>39,087<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>764<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>24.30<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.630<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.630<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.151<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.151<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.068<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>StockingCapLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>StockingCapLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>ClearCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Birdbill<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Cobble<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>5,814<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>353<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>4.02<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>6.8<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.430<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.430<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.494<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.076<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>Terrace1Lake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>Terrace1Lake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WaterfallCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Terrace<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>16,601<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>520<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>6.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.396<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.396<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.604<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>TobiasLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>TobiasLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Harbor<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Palustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>0.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>WalkaboutLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>WalkaboutLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>TipTop<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Cobble<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>6,856<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>336<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>5.70<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>10.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.083<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.817<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.817<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.100<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:15px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>WelcomeLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>SiteName<\/nobr><\/td><td align=\"right\"><nobr>WelcomeLake<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Drainage<\/nobr><\/td><td align=\"right\"><nobr>WilsonCreek<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Basin<\/nobr><\/td><td align=\"right\"><nobr>Harbor<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Substrate<\/nobr><\/td><td align=\"right\"><nobr>Silt<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NWI<\/nobr><\/td><td align=\"right\"><nobr>Lacustrine<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AREA_m2<\/nobr><\/td><td align=\"right\"><nobr>17,159<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>PERI_m<\/nobr><\/td><td align=\"right\"><nobr>915<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Depth_m<\/nobr><\/td><td align=\"right\"><nobr>3.08<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TDS<\/nobr><\/td><td align=\"right\"><nobr>20.0<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>FISH<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ACB<\/nobr><\/td><td align=\"right\"><nobr>0.022<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUC<\/nobr><\/td><td align=\"right\"><nobr>0.034<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCV<\/nobr><\/td><td align=\"right\"><nobr>0.000<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUCC<\/nobr><\/td><td align=\"right\"><nobr>0.034<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUF<\/nobr><\/td><td align=\"right\"><nobr>0.820<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AWOOD<\/nobr><\/td><td align=\"right\"><nobr>0.067<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>AUFV<\/nobr><\/td><td align=\"right\"><nobr>0.056<\/nobr><\/td><\/tr><\/table><\/div>"],null,["AirplaneLake","BachelorMeadow","BarkingFoxLake","BirdbillLake","BobLake","CacheLake","DoeLake","EggWhiteLake","ElenasLake","FawnLake","FrogPondLake","GentianLake","GentianPonds","GoldenLake","GreggsLake","InandOutLake","MeadowLake","MooseLake","Mt.WilsonLake","NopezLake","ParagonLake","ParagonWetland","PotholeLake","RamshornLake","ShipIslandLake","SkyhighLake","StockingCapLake","Terrace1Lake","TobiasLake","WalkaboutLake","WelcomeLake"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addLayersControl","args":[["Esri.WorldGrayCanvas","OpenStreetMap","Esri.WorldTopoMap"],"Sites.sf",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[45.07529212294912,45.16810160930147],"lng":[-114.6222594992278,-114.5715719888294]},"fitBounds":[45.07529212294912,-114.6222594992278,45.16810160930147,-114.5715719888294,[]]},"evals":[],"jsHooks":[]}</script>
<p><strong>Question:</strong> Try changing the basemap by clicking on the Layers symbol and selecting a different map. Which map is most informative for these data? Zoom in and out to find out where on Earth the sampling points are located.</p>
<p>Note: see this week’s bonus materials to learn more about creating maps with <code>tmap</code>.</p>
</div>
</div>
<div id="display-raster-data-and-overlay-sampling-locations-extract-data" class="section level3 unnumbered hasAnchor">
<h3>3. Display raster data and overlay sampling locations, extract data<a href="WE_2.html#display-raster-data-and-overlay-sampling-locations-extract-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-display-raster-data" class="section level4 unnumbered hasAnchor">
<h4>a. Display raster data<a href="WE_2.html#a.-display-raster-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The raster data for this project are already available in the package <code>GeNetIt</code>. They are stored as a <code>SpatRaster</code> object from package <code>terra</code>.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="WE_2.html#cb366-1" tabindex="-1"></a>RasterMaps <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/covariates.tif&quot;</span>, <span class="at">package=</span><span class="st">&quot;GeNetIt&quot;</span>))</span>
<span id="cb366-2"><a href="WE_2.html#cb366-2" tabindex="-1"></a><span class="fu">class</span>(RasterMaps)</span></code></pre></div>
<pre><code>## [1] &quot;SpatRaster&quot;
## attr(,&quot;package&quot;)
## [1] &quot;terra&quot;</code></pre>
<p>Printing the name of the <code>SpatRaster</code> object displays a summary. A few explanations:</p>
<ul>
<li><strong>dimensions</strong>: number of rows (nrow), number of columns (ncol), number of layers (nlyr). So we see there are 6 layers (i.e., variables).</li>
<li><strong>resolution</strong>: cell size is 30 m both in x and y directions (typical for Landsat-derived remote sensing data)</li>
<li>extent: the bounding box that defines the spatial extent of the raster data.</li>
<li><strong>coord.ref</strong>: projected in UTM zone 11, with ‘datum’ (NAD83).</li>
<li><strong>source</strong>: the file from which the data were imported.</li>
<li><strong>names, min values, max values</strong>: summary of the layers (variables).</li>
</ul>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="WE_2.html#cb368-1" tabindex="-1"></a>RasterMaps</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## dimensions  : 426, 358, 6  (nrow, ncol, nlyr)
## resolution  : 30, 30  (x, y)
## extent      : 683282.5, 694022.5, 4992833, 5005613  (xmin, xmax, ymin, ymax)
## coord. ref. : NAD83 / UTM zone 11N (EPSG:26911) 
## source      : covariates.tif 
## names       :        cti,      err27, ffp,      gsp,  hli, nlcd 
## min values  :  0.8429851, 0.03906551,   0, 227.0000, 1014,   11 
## max values  : 23.7147598, 0.76376426,  51, 338.0697, 9263,   95</code></pre>
<p>Now we can use <code>plot</code>, which knows what to do with a raster <code>SpatRaster</code> object.</p>
<p>Note: layer <code>nlcd</code> is a categorical map of land cover types. See this week’s bonus materials for how to better display a categorical map in R.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="WE_2.html#cb370-1" tabindex="-1"></a><span class="fu">plot</span>(RasterMaps)</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-24-1.png" width="768" /></p>
<p>Some layers seem to show a similar pattern. It is easy to calculate the correlation between quantitative raster layers. Here, the last layer <code>ncld</code>, is in fact categorical (land cover type), and it’s correlation here is meaningless.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="WE_2.html#cb371-1" tabindex="-1"></a><span class="fu">layerCor</span>(RasterMaps, <span class="st">&quot;pearson&quot;</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">$</span>pearson</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p><strong>Questions</strong>:</p>
<ul>
<li>What does each value in this table represent?</li>
<li>Which layers are most strongly correlated?</li>
<li>What do these variables (layers) represent?</li>
<li>Is the correlation positive or negative?</li>
</ul>
</div>
<div id="b.-change-color-ramp-add-sampling-locations" class="section level4 unnumbered hasAnchor">
<h4>b. Change color ramp, add sampling locations<a href="WE_2.html#b.-change-color-ramp-add-sampling-locations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can specify a color ramp by setting the <code>col</code> argument. The default is <code>terrain.colors(255)</code>. Here we change it to <code>rainbow(9)</code>, a rainbow color palette with 9 color levels.</p>
<p>Note: To learn about options for the <code>plot</code> function for <code>SpatRaster</code> objects, access the help file by typing <code>?plot</code> and select <code>Make a map</code>.</p>
<p>We can add the sampling locations (if we plot only a single raster layer). Here we use <code>rev</code> to reverse the color ramp for plotting raster layer <code>ffp</code>, and add the sites as white circles with black outlines.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="WE_2.html#cb373-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb373-2"><a href="WE_2.html#cb373-2" tabindex="-1"></a><span class="fu">plot</span>(RasterMaps, <span class="st">&quot;ffp&quot;</span>, <span class="at">col=</span><span class="fu">rev</span>(<span class="fu">rainbow</span>(<span class="dv">9</span>)))</span>
<span id="cb373-3"><a href="WE_2.html#cb373-3" tabindex="-1"></a><span class="fu">points</span>(Sites.sf, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-26-1.png" width="427.2" /></p>
<p><strong>Question</strong>: Recall that ‘ffp’ stands for frost free period (in days). What do you think is the average length of the frost free period at theses sampling sites?</p>
</div>
<div id="c.-extract-raster-values-at-sampling-locations" class="section level4 unnumbered hasAnchor">
<h4>c. Extract raster values at sampling locations<a href="WE_2.html#c.-extract-raster-values-at-sampling-locations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The following code adds six variables to <code>Sites.sf</code>. However, it automatically changes the object type to a <code>SpatVector</code> object, which we’ll call <code>Sites.terra</code> to remind us of the object type. Technically we combine the columns of the existing data frame <code>Sites.sf</code> with the new columns in a new data frame with the same name.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="WE_2.html#cb374-1" tabindex="-1"></a>Sites.terra <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(RasterMaps, Sites.sf, <span class="at">bind=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>We can convert back to an <code>sf</code> object:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="WE_2.html#cb375-1" tabindex="-1"></a>Sites.sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(Sites.terra)</span>
<span id="cb375-2"><a href="WE_2.html#cb375-2" tabindex="-1"></a>Sites.sf</span></code></pre></div>
<pre><code>## Simple feature collection with 31 features and 23 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 686908.5 ymin: 4994089 xmax: 690890.1 ymax: 5004435
## Projected CRS: PROJCRS[&quot;unknown&quot;,
##     BASEGEOGCRS[&quot;unknown&quot;,
##         DATUM[&quot;North American Datum 1983&quot;,
##             ELLIPSOID[&quot;GRS 1980&quot;,6378137,298.257222101,
##                 LENGTHUNIT[&quot;metre&quot;,1]],
##             ID[&quot;EPSG&quot;,6269]],
##         PRIMEM[&quot;Greenwich&quot;,0,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8901]]],
##     CONVERSION[&quot;UTM zone 11N&quot;,
##         METHOD[&quot;Transverse Mercator&quot;,
##             ID[&quot;EPSG&quot;,9807]],
##         PARAMETER[&quot;Latitude of natural origin&quot;,0,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8801]],
##         PARAMETER[&quot;Longitude of natural origin&quot;,-117,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8802]],
##         PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,
##             SCALEUNIT[&quot;unity&quot;,1],
##             ID[&quot;EPSG&quot;,8805]],
##         PARAMETER[&quot;False easting&quot;,500000,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8806]],
##         PARAMETER[&quot;False northing&quot;,0,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8807]],
##         ID[&quot;EPSG&quot;,16011]],
##     CS[Cartesian,2],
##         AXIS[&quot;(E)&quot;,east,
##             ORDER[1],
##             LENGTHUNIT[&quot;metre&quot;,1,
##                 ID[&quot;EPSG&quot;,9001]]],
##         AXIS[&quot;(N)&quot;,north,
##             ORDER[2],
##             LENGTHUNIT[&quot;metre&quot;,1,
##                 ID[&quot;EPSG&quot;,9001]]]]
## First 10 features:
##          SiteName        Drainage      Basin Substrate
## 1    AirplaneLake ShipIslandCreek Sheepeater      Silt
## 2  BachelorMeadow     WilsonCreek    Skyhigh      Silt
## 3  BarkingFoxLake  WaterfallCreek    Terrace      Silt
## 4    BirdbillLake      ClearCreek   Birdbill      Sand
## 5         BobLake     WilsonCreek     Harbor      Silt
## 6       CacheLake     WilsonCreek    Skyhigh      Silt
## 7         DoeLake     WilsonCreek    Skyhigh      Silt
## 8    EggWhiteLake     WilsonCreek    Skyhigh      Silt
## 9      ElenasLake ShipIslandCreek Sheepeater      Sand
## 10       FawnLake     WilsonCreek    Skyhigh      Silt
##                                NWI AREA_m2 PERI_m Depth_m  TDS FISH ACB   AUC
## 1                       Lacustrine 62582.2 1142.8   21.64  2.5    1   0 0.411
## 2  Riverine_Intermittent_Streambed   225.0   60.0    0.40  0.0    0   0 0.000
## 3                       Lacustrine 12000.0  435.0    5.00 13.8    1   0 0.300
## 4                       Lacustrine 12358.6  572.3    3.93  6.4    1   0 0.283
## 5                       Palustrine  4600.0  321.4    2.00 14.3    0   0 0.000
## 6                       Palustrine  2268.8  192.0    1.86 10.9    0   0 0.000
## 7                       Lacustrine 13034.9  463.2    6.03 10.0    1   0 0.415
## 8                       Palustrine  4544.5  291.9    3.30  2.4    0   0 0.000
## 9                       Palustrine     0.0    0.0    0.00  0.0    0   0 0.000
## 10                      Palustrine  3865.9  237.7    1.98  3.6    0   0 0.000
##     AUCV  AUCC   AUF AWOOD  AUFV       cti     err27 ffp      gsp  hli nlcd
## 1  0.000 0.411 0.063 0.063 0.464  6.551698 0.2211860   8 286.0000 1438   42
## 2  0.000 0.000 1.000 0.000 0.000  7.257386 0.3399709   8 286.0000 1718   71
## 3  0.000 0.300 0.700 0.000 0.000  7.587409 0.2636720   9 283.0000 1308   42
## 4  0.000 0.283 0.717 0.000 0.000  4.864036 0.3027736   5 294.1377 1416   12
## 5  0.000 0.000 0.500 0.000 0.500 10.962278 0.5830295   6 290.0000 1685   42
## 6  0.000 0.000 0.556 0.093 0.352  7.817918 0.4895256  11 274.0000 1277   42
## 7  0.171 0.585 0.341 0.000 0.073  6.940942 0.1684043  11 273.0000 1306   42
## 8  0.047 0.047 0.686 0.209 0.058  6.560551 0.4499388  10 279.0000 1244   42
## 9  0.000 0.000 0.000 0.000 0.000  4.031181 0.3834549   2 308.0000 1169   71
## 10 0.000 0.000 1.000 0.000 0.000 10.988009 0.1625656  11 273.0000 1296   42
##                    geometry
## 1  POINT (688816.6 5003207)
## 2  POINT (688494.4 4999093)
## 3  POINT (687938.4 5000223)
## 4  POINT (689732.8 5002522)
## 5    POINT (690104 4999355)
## 6  POINT (688742.5 4997481)
## 7  POINT (688962.4 4996675)
## 8  POINT (688539.3 4998146)
## 9  POINT (688878.7 5004435)
## 10 POINT (688901.5 4996837)</code></pre>
<p>Let’s calculate the mean length of the frost free period for these sites:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="WE_2.html#cb377-1" tabindex="-1"></a><span class="fu">mean</span>(Sites.sf<span class="sc">$</span>ffp)</span></code></pre></div>
<pre><code>## [1] 8.0963</code></pre>
<p>What land cover type is assigned to the most sampling units? Let’s tabulate them.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="WE_2.html#cb379-1" tabindex="-1"></a><span class="fu">table</span>(Sites.sf<span class="sc">$</span>nlcd)</span></code></pre></div>
<pre><code>## 
## 11 12 42 52 71 90 
##  3  1 21  1  4  1</code></pre>
<p>Note: the land cover types are coded by numbers. Check here what the numbers mean: <a href="https://www.mrlc.gov/data/legends/national-land-cover-database-2016-nlcd2016-legend" class="uri">https://www.mrlc.gov/data/legends/national-land-cover-database-2016-nlcd2016-legend</a></p>
<p><strong>Question</strong>: A total of 21 sites are classified as <code>42</code>. What is this most frequent land cover type?</p>
</div>
</div>
<div id="calculate-landscape-metrics" class="section level3 unnumbered hasAnchor">
<h3>4. Calculate landscape metrics<a href="WE_2.html#calculate-landscape-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are going to use the package <a href="https://r-spatialecology.github.io/landscapemetrics/"><code>landscapemetrics</code></a>. It is an R package to calculate landscape metrics in a tidy workflow (for more information about tidy data see <a href="https://www.jstatsoft.org/article/view/v059i10/">here</a>). <code>landscapemetrics</code> is basically a reimplementation of <a href="https://www.umass.edu/landeco/research/fragstats/fragstats.html">‘FRAGSTATS’</a>, which allows an integration into larger workflows within the R environment. The core of the package are functions to calculate landscape metrics, but also several auxiliary functions exist.</p>
<p>To facilitate an integration into larger workflows, <code>landscapemetrics</code> is based on the <code>terra</code> and <code>stars</code> packages. It expects a raster with integers that represent land cover classes. To check if a raster is suitable for <code>landscapemetrics</code>, run the <code>check_landscape()</code> function first. The function checks the coordinate reference system (and mainly if units are in meters) and if the raster values are discrete classes. If the check fails, the calculation of metrics is still possible, however, especially metrics that are based on area and distances must be used with caution.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="WE_2.html#cb381-1" tabindex="-1"></a>landscapemetrics<span class="sc">::</span><span class="fu">check_landscape</span>(RasterMaps)</span></code></pre></div>
<pre><code>## Warning: Caution: Land-cover classes must be decoded as integer values.</code></pre>
<pre><code>## Warning: Caution: More than 30 land cover-classes - Please check if discrete
## land-cover classes are present.</code></pre>
<pre><code>## Warning: Caution: Land-cover classes must be decoded as integer values.</code></pre>
<pre><code>## Warning: Caution: More than 30 land cover-classes - Please check if discrete
## land-cover classes are present.</code></pre>
<pre><code>## Warning: Caution: Land-cover classes must be decoded as integer values.</code></pre>
<pre><code>## Warning: Caution: More than 30 land cover-classes - Please check if discrete
## land-cover classes are present.</code></pre>
<pre><code>## Warning: Caution: Land-cover classes must be decoded as integer values.</code></pre>
<pre><code>## Warning: Caution: More than 30 land cover-classes - Please check if discrete
## land-cover classes are present.

## Warning: Caution: More than 30 land cover-classes - Please check if discrete
## land-cover classes are present.</code></pre>
<pre><code>##   layer       crs units       class n_classes OK
## 1     1 projected     m non-integer    150973  ✖
## 2     2 projected     m non-integer    151161  ✖
## 3     3 projected     m non-integer     37266  ✖
## 4     4 projected     m non-integer     79335  ✖
## 5     5 projected     m     integer      4776 ❓
## 6     6 projected     m     integer         8  ✔</code></pre>
<p><strong>Question</strong>: Which raster layer(s) are suitable for calculating landscape metrics? Why are the others not suitable?</p>
<p>There are three different levels of landscape metrics. Firstly, metrics can be calculated for each single patch (a patch is defined as neighbouring cells of the same class). Secondly, metrics can be calculated for a certain class (i.e. all patches belonging to the same class) and lastly for the whole landscape. All these levels are implemented and easily accessible in <code>landscapemetrics</code>.</p>
<p>All functions to calculate metrics start with <code>lsm_</code> (for landscapemetrics). The second part of the name specifies the level (patch - <code>p</code>, class - <code>c</code> or landscape - <code>l</code>). Lastly, the final part of the function name is the abbreviation of the corresponding metric (e.g. <code>enn</code> for the Euclidean nearest-neighbor distance). To list all available metrics, you can use the <code>list_lsm()</code> function. The function also allows to show metrics filtered by level, type or metric name. For more information about the metrics, please see either the corresponding helpfile(s) or <a href="https://r-spatialecology.github.io/landscapemetrics/reference/index.html">https://r-spatialecology.github.io/landscapemetrics</a>.</p>
<p>List available diversity metrics:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="WE_2.html#cb391-1" tabindex="-1"></a>landscapemetrics<span class="sc">::</span><span class="fu">list_lsm</span>(<span class="at">level =</span> <span class="st">&quot;landscape&quot;</span>, <span class="at">type =</span> <span class="st">&quot;diversity metric&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 5
##   metric name                               type             level function_name
##   &lt;chr&gt;  &lt;chr&gt;                              &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt;        
## 1 msidi  modified simpson&#39;s diversity index diversity metric land… lsm_l_msidi  
## 2 msiei  modified simpson&#39;s evenness index  diversity metric land… lsm_l_msiei  
## 3 pr     patch richness                     diversity metric land… lsm_l_pr     
## 4 prd    patch richness density             diversity metric land… lsm_l_prd    
## 5 rpr    relative patch richness            diversity metric land… lsm_l_rpr    
## 6 shdi   shannon&#39;s diversity index          diversity metric land… lsm_l_shdi   
## 7 shei   shannon&#39;s evenness index           diversity metric land… lsm_l_shei   
## 8 sidi   simpson&#39;s diversity index          diversity metric land… lsm_l_sidi   
## 9 siei   simspon&#39;s evenness index           diversity metric land… lsm_l_siei</code></pre>
<p>List available area metrics:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="WE_2.html#cb393-1" tabindex="-1"></a>landscapemetrics<span class="sc">::</span><span class="fu">list_lsm</span>(<span class="at">metric =</span> <span class="st">&quot;area&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7 × 5
##   metric  name       type                 level     function_name
##   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;                &lt;chr&gt;     &lt;chr&gt;        
## 1 area    patch area area and edge metric patch     lsm_p_area   
## 2 area_cv patch area area and edge metric class     lsm_c_area_cv
## 3 area_mn patch area area and edge metric class     lsm_c_area_mn
## 4 area_sd patch area area and edge metric class     lsm_c_area_sd
## 5 area_cv patch area area and edge metric landscape lsm_l_area_cv
## 6 area_mn patch area area and edge metric landscape lsm_l_area_mn
## 7 area_sd patch area area and edge metric landscape lsm_l_area_sd</code></pre>
<p>List available aggregation metrics:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="WE_2.html#cb395-1" tabindex="-1"></a>landscapemetrics<span class="sc">::</span><span class="fu">list_lsm</span>(<span class="at">level =</span> <span class="fu">c</span>(<span class="st">&quot;class&quot;</span>, <span class="st">&quot;landscape&quot;</span>), <span class="at">type =</span> <span class="st">&quot;aggregation metric&quot;</span>, </span>
<span id="cb395-2"><a href="WE_2.html#cb395-2" tabindex="-1"></a>                           <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;lsm_c_ai&quot;       &quot;lsm_c_clumpy&quot;   &quot;lsm_c_cohesion&quot; &quot;lsm_c_division&quot;
##  [5] &quot;lsm_c_enn_cv&quot;   &quot;lsm_c_enn_mn&quot;   &quot;lsm_c_enn_sd&quot;   &quot;lsm_c_iji&quot;     
##  [9] &quot;lsm_c_lsi&quot;      &quot;lsm_c_mesh&quot;     &quot;lsm_c_nlsi&quot;     &quot;lsm_c_np&quot;      
## [13] &quot;lsm_c_pd&quot;       &quot;lsm_c_pladj&quot;    &quot;lsm_c_split&quot;    &quot;lsm_l_ai&quot;      
## [17] &quot;lsm_l_cohesion&quot; &quot;lsm_l_contag&quot;   &quot;lsm_l_division&quot; &quot;lsm_l_enn_cv&quot;  
## [21] &quot;lsm_l_enn_mn&quot;   &quot;lsm_l_enn_sd&quot;   &quot;lsm_l_iji&quot;      &quot;lsm_l_lsi&quot;     
## [25] &quot;lsm_l_mesh&quot;     &quot;lsm_l_np&quot;       &quot;lsm_l_pd&quot;       &quot;lsm_l_pladj&quot;   
## [29] &quot;lsm_l_split&quot;</code></pre>
<div id="a.-calculate-patch--class--and-landscape-level-landscape-metrics" class="section level4 unnumbered hasAnchor">
<h4>a. Calculate patch-, class- and landscape level landscape metrics<a href="WE_2.html#a.-calculate-patch--class--and-landscape-level-landscape-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Note: This section explains different ways of calculating a selection of landscape metrics from a raster map with ‘landscapemetrics’. If this seems too technical for a first go, you may jump to section 4b.</p>
<p>To calculate a single metric, just use the corresponding function. The result of all landscape metric functions is always an identically structured <code>tibble</code> (i.e. an advanced <code>data.frame</code>). The first coloumn is the layer id (only interesting for e.g. a <code>RasterStack</code>). The second coloumn specifies the level (‘patch’, ‘class’ or ‘landscape’). The third coloumn is the class ID (<code>NA</code> on landscape level) and the fourth coloumn is the patch ID (<code>NA</code> on class- and landscape level). Lastly, The fith coloumn is the abbreviation of the metric and finally the corresponding value in the last coloumn.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="WE_2.html#cb397-1" tabindex="-1"></a><span class="do">## c.lculate percentage of landscape of class</span></span>
<span id="cb397-2"><a href="WE_2.html#cb397-2" tabindex="-1"></a>percentage_class <span class="ot">&lt;-</span> <span class="fu">lsm_c_pland</span>(<span class="at">landscape =</span> RasterMaps<span class="sc">$</span>nlcd)</span>
<span id="cb397-3"><a href="WE_2.html#cb397-3" tabindex="-1"></a></span>
<span id="cb397-4"><a href="WE_2.html#cb397-4" tabindex="-1"></a>percentage_class</span></code></pre></div>
<pre><code>## # A tibble: 8 × 6
##   layer level class    id metric   value
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;
## 1     1 class    11    NA pland   0.948 
## 2     1 class    12    NA pland   0.441 
## 3     1 class    31    NA pland   0.394 
## 4     1 class    42    NA pland  59.1   
## 5     1 class    52    NA pland  11.0   
## 6     1 class    71    NA pland  28.1   
## 7     1 class    90    NA pland   0.0557
## 8     1 class    95    NA pland   0.0210</code></pre>
<p><strong>Questions</strong>:</p>
<ul>
<li>What percentage of the overall landscape (total map) is evergreen forest (class 42)?</li>
<li>What percentage of the landscape is classified as wetlands (classes 90 and 95)?</li>
</ul>
<p>Because the resulting <code>tibble</code> is type stable, you can easily row-bind (<code>rbind</code>) different metrics (even of different levels):</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="WE_2.html#cb399-1" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb399-2"><a href="WE_2.html#cb399-2" tabindex="-1"></a>  landscapemetrics<span class="sc">::</span><span class="fu">lsm_c_pladj</span>(RasterMaps<span class="sc">$</span>nlcd), </span>
<span id="cb399-3"><a href="WE_2.html#cb399-3" tabindex="-1"></a>  landscapemetrics<span class="sc">::</span><span class="fu">lsm_l_pr</span>(RasterMaps<span class="sc">$</span>nlcd),</span>
<span id="cb399-4"><a href="WE_2.html#cb399-4" tabindex="-1"></a>  landscapemetrics<span class="sc">::</span><span class="fu">lsm_l_shdi</span>(RasterMaps<span class="sc">$</span>nlcd)</span>
<span id="cb399-5"><a href="WE_2.html#cb399-5" tabindex="-1"></a>  )</span>
<span id="cb399-6"><a href="WE_2.html#cb399-6" tabindex="-1"></a></span>
<span id="cb399-7"><a href="WE_2.html#cb399-7" tabindex="-1"></a>metrics</span></code></pre></div>
<pre><code>## # A tibble: 10 × 6
##    layer level     class    id metric value
##    &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
##  1     1 class        11    NA pladj  77.9 
##  2     1 class        12    NA pladj  52.5 
##  3     1 class        31    NA pladj  48.8 
##  4     1 class        42    NA pladj  89.9 
##  5     1 class        52    NA pladj  58.6 
##  6     1 class        71    NA pladj  81.6 
##  7     1 class        90    NA pladj  41.8 
##  8     1 class        95    NA pladj  32.8 
##  9     1 landscape    NA    NA pr      8   
## 10     1 landscape    NA    NA shdi    1.01</code></pre>
<p>To calculate a larger set of landscape metrics, you can just use the wrapper <code>calculate_lsm()</code>. The arguments are similar to <code>list_lsm()</code>, e.g. you can specify the level or the type of metrics to calculate. Alternatively, you can also provide a vector with the function names of metrics to calculate to the <code>what</code> argument.</p>
<p>However, watch out, for large rasters and many metrics, this can be rather slow (set <code>progress = TRUE</code> to get an progress report on the console). Also, we suggest to not just calculate all available metrics, but rather think about which ones might be actually suitable for your research question.</p>
<p>Calculate all patch-level metrics using wrapper:</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="WE_2.html#cb401-1" tabindex="-1"></a>nlcd_patch <span class="ot">&lt;-</span> landscapemetrics<span class="sc">::</span><span class="fu">calculate_lsm</span>(<span class="at">landscape =</span> RasterMaps<span class="sc">$</span>nlcd,</span>
<span id="cb401-2"><a href="WE_2.html#cb401-2" tabindex="-1"></a>                                              <span class="at">level =</span> <span class="st">&quot;patch&quot;</span>)</span>
<span id="cb401-3"><a href="WE_2.html#cb401-3" tabindex="-1"></a>nlcd_patch</span></code></pre></div>
<pre><code>## # A tibble: 19,776 × 6
##    layer level class    id metric value
##    &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
##  1     1 patch    11     1 area    0.45
##  2     1 patch    11     2 area    0.45
##  3     1 patch    11     3 area   41.7 
##  4     1 patch    11     4 area    0.72
##  5     1 patch    11     5 area    6.12
##  6     1 patch    11     6 area    0.9 
##  7     1 patch    11     7 area    0.9 
##  8     1 patch    11     8 area    1.89
##  9     1 patch    11     9 area    0.09
## 10     1 patch    11    10 area    1.17
## # ℹ 19,766 more rows</code></pre>
<p>Show abbreviation of all calculated metrics:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="WE_2.html#cb403-1" tabindex="-1"></a><span class="fu">unique</span>(nlcd_patch<span class="sc">$</span>metric)</span></code></pre></div>
<pre><code>##  [1] &quot;area&quot;   &quot;cai&quot;    &quot;circle&quot; &quot;contig&quot; &quot;core&quot;   &quot;enn&quot;    &quot;frac&quot;   &quot;gyrate&quot;
##  [9] &quot;ncore&quot;  &quot;para&quot;   &quot;perim&quot;  &quot;shape&quot;</code></pre>
<p>Calculate all aggregation metrics on landscape level:</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="WE_2.html#cb405-1" tabindex="-1"></a>nlcd_landscape_aggr <span class="ot">&lt;-</span> landscapemetrics<span class="sc">::</span><span class="fu">calculate_lsm</span>(<span class="at">landscape =</span> RasterMaps<span class="sc">$</span>nlcd, </span>
<span id="cb405-2"><a href="WE_2.html#cb405-2" tabindex="-1"></a>                                                       <span class="at">level =</span> <span class="st">&quot;landscape&quot;</span>, </span>
<span id="cb405-3"><a href="WE_2.html#cb405-3" tabindex="-1"></a>                                                       <span class="at">type =</span> <span class="st">&quot;aggregation metric&quot;</span>)</span>
<span id="cb405-4"><a href="WE_2.html#cb405-4" tabindex="-1"></a>nlcd_landscape_aggr</span></code></pre></div>
<pre><code>## # A tibble: 14 × 6
##    layer level     class    id metric      value
##    &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1     1 landscape    NA    NA ai         84.1  
##  2     1 landscape    NA    NA cohesion   99.2  
##  3     1 landscape    NA    NA contag     62.7  
##  4     1 landscape    NA    NA division    0.804
##  5     1 landscape    NA    NA enn_cv    218.   
##  6     1 landscape    NA    NA enn_mn    129.   
##  7     1 landscape    NA    NA enn_sd    281.   
##  8     1 landscape    NA    NA iji        43.0  
##  9     1 landscape    NA    NA lsi        32.3  
## 10     1 landscape    NA    NA mesh     2694.   
## 11     1 landscape    NA    NA np       1648    
## 12     1 landscape    NA    NA pd         12.0  
## 13     1 landscape    NA    NA pladj      83.7  
## 14     1 landscape    NA    NA split       5.09</code></pre>
<p>Calculate specific metrics:</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="WE_2.html#cb407-1" tabindex="-1"></a>nlcd_subset <span class="ot">&lt;-</span> landscapemetrics<span class="sc">::</span><span class="fu">calculate_lsm</span>(<span class="at">landscape =</span> RasterMaps<span class="sc">$</span>nlcd, </span>
<span id="cb407-2"><a href="WE_2.html#cb407-2" tabindex="-1"></a>                                               <span class="at">what =</span> <span class="fu">c</span>(<span class="st">&quot;lsm_c_pladj&quot;</span>, </span>
<span id="cb407-3"><a href="WE_2.html#cb407-3" tabindex="-1"></a>                                                        <span class="st">&quot;lsm_l_pr&quot;</span>, </span>
<span id="cb407-4"><a href="WE_2.html#cb407-4" tabindex="-1"></a>                                                        <span class="st">&quot;lsm_l_shdi&quot;</span>))</span>
<span id="cb407-5"><a href="WE_2.html#cb407-5" tabindex="-1"></a>nlcd_subset</span></code></pre></div>
<pre><code>## # A tibble: 10 × 6
##    layer level     class    id metric value
##    &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
##  1     1 class        11    NA pladj  77.9 
##  2     1 class        12    NA pladj  52.5 
##  3     1 class        31    NA pladj  48.8 
##  4     1 class        42    NA pladj  89.9 
##  5     1 class        52    NA pladj  58.6 
##  6     1 class        71    NA pladj  81.6 
##  7     1 class        90    NA pladj  41.8 
##  8     1 class        95    NA pladj  32.8 
##  9     1 landscape    NA    NA pr      8   
## 10     1 landscape    NA    NA shdi    1.01</code></pre>
<p>The resulting <code>tibble</code> is easy to integrate into a workflow. For example, to get the ordered patch IDs of the 5% largest patches, the following code could be used.</p>
<p>The pipe operator %&gt;% from the <code>dplyr</code> package passes the resulting object automatically to the next function as first argument.</p>
<p>Note: the last step (pulling the id variable only) could be done by adding this to the pipe: <code>%&gt;% dplyr::pull(id)</code>. Due to some package inconsistencies, this sometimes created an error. Here we extract the id variable in a separate step as a work-around.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="WE_2.html#cb409-1" tabindex="-1"></a>id_largest <span class="ot">&lt;-</span> nlcd_patch <span class="sc">%&gt;%</span> <span class="co"># previously calculated patch metrics</span></span>
<span id="cb409-2"><a href="WE_2.html#cb409-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(metric <span class="sc">==</span> <span class="st">&quot;area&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># only patch area</span></span>
<span id="cb409-3"><a href="WE_2.html#cb409-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="sc">-</span>value) <span class="sc">%&gt;%</span> <span class="co"># order by decreasing size</span></span>
<span id="cb409-4"><a href="WE_2.html#cb409-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(value <span class="sc">&gt;</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.95</span>)) <span class="do">## g.t only patches larger than 95% quantile</span></span>
<span id="cb409-5"><a href="WE_2.html#cb409-5" tabindex="-1"></a></span>
<span id="cb409-6"><a href="WE_2.html#cb409-6" tabindex="-1"></a>id_largest <span class="ot">&lt;-</span> id_largest<span class="sc">$</span>id <span class="do">## g.t only patch id</span></span>
<span id="cb409-7"><a href="WE_2.html#cb409-7" tabindex="-1"></a>id_largest</span></code></pre></div>
<pre><code>##  [1]  206  166 1265 1459 1549 1558 1421  427 1434 1385  226    3  386 1205  589
## [16] 1441  426 1059 1206  324  433 1195  315 1225  712 1266 1377  389  753 1528
## [31]  894 1510  286  563  240 1411  478 1364  435 1336  812  640 1376 1523  786
## [46]  467  485 1559 1244  284 1537 1574  718  814  499  864  955 1015 1430  443
## [61]  393  930 1250  548  851  885 1481  928 1554   43  164  281 1608  716  514
## [76]  802 1614  729  977 1488   37  357 1353</code></pre>
<p>Because the metric names are only abbreviated, there is also a way to include the full name in the results. For the wrapper, just set <code>full_name = TRUE</code>. For the rowbinded <code>tibble</code>, you can use the provided <code>tibble</code> called <code>lsm_abbreviations_names</code> that comes with the package and use e.g. <code>dplyr::left_join()</code> to combine it with your results.</p>
<p>Add full metrics name to result:</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="WE_2.html#cb411-1" tabindex="-1"></a>nlcd_subset_full_a <span class="ot">&lt;-</span> landscapemetrics<span class="sc">::</span><span class="fu">calculate_lsm</span>(RasterMaps<span class="sc">$</span>nlcd, </span>
<span id="cb411-2"><a href="WE_2.html#cb411-2" tabindex="-1"></a>                                                      <span class="at">what =</span> <span class="fu">c</span>(<span class="st">&quot;lsm_c_pladj&quot;</span>, </span>
<span id="cb411-3"><a href="WE_2.html#cb411-3" tabindex="-1"></a>                                                               <span class="st">&quot;lsm_l_pr&quot;</span>, </span>
<span id="cb411-4"><a href="WE_2.html#cb411-4" tabindex="-1"></a>                                                               <span class="st">&quot;lsm_l_shdi&quot;</span>), </span>
<span id="cb411-5"><a href="WE_2.html#cb411-5" tabindex="-1"></a>                                                      <span class="at">full_name =</span> <span class="cn">TRUE</span>)</span>
<span id="cb411-6"><a href="WE_2.html#cb411-6" tabindex="-1"></a>nlcd_subset_full_a</span></code></pre></div>
<pre><code>## # A tibble: 10 × 9
##    layer level     class    id metric value name             type  function_name
##    &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt;        
##  1     1 class        11    NA pladj  77.9  percentage of l… aggr… lsm_c_pladj  
##  2     1 class        12    NA pladj  52.5  percentage of l… aggr… lsm_c_pladj  
##  3     1 class        31    NA pladj  48.8  percentage of l… aggr… lsm_c_pladj  
##  4     1 class        42    NA pladj  89.9  percentage of l… aggr… lsm_c_pladj  
##  5     1 class        52    NA pladj  58.6  percentage of l… aggr… lsm_c_pladj  
##  6     1 class        71    NA pladj  81.6  percentage of l… aggr… lsm_c_pladj  
##  7     1 class        90    NA pladj  41.8  percentage of l… aggr… lsm_c_pladj  
##  8     1 class        95    NA pladj  32.8  percentage of l… aggr… lsm_c_pladj  
##  9     1 landscape    NA    NA pr      8    patch richness   dive… lsm_l_pr     
## 10     1 landscape    NA    NA shdi    1.01 shannon&#39;s diver… dive… lsm_l_shdi</code></pre>
<p>Add full metrics name to results calculated previously using <code>left_join()</code>:</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="WE_2.html#cb413-1" tabindex="-1"></a>nlcd_subset_full_b <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="at">x =</span> nlcd_subset,</span>
<span id="cb413-2"><a href="WE_2.html#cb413-2" tabindex="-1"></a>                                       <span class="at">y =</span> lsm_abbreviations_names,</span>
<span id="cb413-3"><a href="WE_2.html#cb413-3" tabindex="-1"></a>                                       <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;metric&quot;</span>, <span class="st">&quot;level&quot;</span>))</span>
<span id="cb413-4"><a href="WE_2.html#cb413-4" tabindex="-1"></a></span>
<span id="cb413-5"><a href="WE_2.html#cb413-5" tabindex="-1"></a>nlcd_subset_full_b</span></code></pre></div>
<pre><code>## # A tibble: 10 × 9
##    layer level     class    id metric value name             type  function_name
##    &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt;        
##  1     1 class        11    NA pladj  77.9  percentage of l… aggr… lsm_c_pladj  
##  2     1 class        12    NA pladj  52.5  percentage of l… aggr… lsm_c_pladj  
##  3     1 class        31    NA pladj  48.8  percentage of l… aggr… lsm_c_pladj  
##  4     1 class        42    NA pladj  89.9  percentage of l… aggr… lsm_c_pladj  
##  5     1 class        52    NA pladj  58.6  percentage of l… aggr… lsm_c_pladj  
##  6     1 class        71    NA pladj  81.6  percentage of l… aggr… lsm_c_pladj  
##  7     1 class        90    NA pladj  41.8  percentage of l… aggr… lsm_c_pladj  
##  8     1 class        95    NA pladj  32.8  percentage of l… aggr… lsm_c_pladj  
##  9     1 landscape    NA    NA pr      8    patch richness   dive… lsm_l_pr     
## 10     1 landscape    NA    NA shdi    1.01 shannon&#39;s diver… dive… lsm_l_shdi</code></pre>
</div>
<div id="b.-calculate-patch-level-landscape-metrics-for-evergreen-forest" class="section level4 unnumbered hasAnchor">
<h4>b. Calculate patch-level landscape metrics for ‘Evergreen Forest’<a href="WE_2.html#b.-calculate-patch-level-landscape-metrics-for-evergreen-forest" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To only get the results for class 42 (evergreen forest), you can just <code>dplyr::filter()</code> the <code>tibble</code> (or use any other subset method you prefer).</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="WE_2.html#cb415-1" tabindex="-1"></a>forest_patch_metrics <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(nlcd_patch, class <span class="sc">==</span> <span class="dv">42</span>)</span>
<span id="cb415-2"><a href="WE_2.html#cb415-2" tabindex="-1"></a>forest_patch_metrics</span></code></pre></div>
<pre><code>## # A tibble: 2,664 × 6
##    layer level class    id metric   value
##    &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;
##  1     1 patch    42   164 area      8.1 
##  2     1 patch    42   165 area      0.18
##  3     1 patch    42   166 area   3180.  
##  4     1 patch    42   167 area      0.27
##  5     1 patch    42   168 area      3.51
##  6     1 patch    42   169 area      1.71
##  7     1 patch    42   170 area      0.18
##  8     1 patch    42   171 area      0.09
##  9     1 patch    42   172 area      0.09
## 10     1 patch    42   173 area      1.98
## # ℹ 2,654 more rows</code></pre>
<p>All functions make heavy use of connected components labeling to delineate patches (neighbouring cells of the same class). To get all patches of every class you can just use <code>get_patches()</code>. This returns a list of layers (one layer per input raster map, here only one) with a separate SpatRaster for each class within the layer.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="WE_2.html#cb417-1" tabindex="-1"></a><span class="do">## c.nnected components labeling of landscape</span></span>
<span id="cb417-2"><a href="WE_2.html#cb417-2" tabindex="-1"></a>cc_nlcd <span class="ot">&lt;-</span> landscapemetrics<span class="sc">::</span><span class="fu">get_patches</span>(RasterMaps<span class="sc">$</span>nlcd, <span class="at">directions =</span> <span class="dv">8</span>)</span>
<span id="cb417-3"><a href="WE_2.html#cb417-3" tabindex="-1"></a></span>
<span id="cb417-4"><a href="WE_2.html#cb417-4" tabindex="-1"></a><span class="co"># summarize the SpatRaster for class 42: </span></span>
<span id="cb417-5"><a href="WE_2.html#cb417-5" tabindex="-1"></a>cc_nlcd<span class="sc">$</span>layer_1<span class="sc">$</span>class_42</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## dimensions  : 426, 358, 1  (nrow, ncol, nlyr)
## resolution  : 30, 30  (x, y)
## extent      : 683282.5, 694022.5, 4992833, 5005613  (xmin, xmax, ymin, ymax)
## coord. ref. : NAD83 / UTM zone 11N (EPSG:26911) 
## source(s)   : memory
## name        : lyr.1 
## min value   :   164 
## max value   :   385</code></pre>
<p>To get only a certain class, just specify the <code>class</code> argument and the neighbourhood rule can be chosen between 8-neighbour rule or 4-neighbour rule with the argument <code>directions</code>.</p>
<p>Note: although we only process a single class, the resulting object still is a list with the same structure as above. Thus, we access the SpatRaster for class 42 the same way:</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="WE_2.html#cb419-1" tabindex="-1"></a>cc_forest <span class="ot">&lt;-</span> landscapemetrics<span class="sc">::</span><span class="fu">get_patches</span>(RasterMaps<span class="sc">$</span>nlcd, <span class="at">class =</span> <span class="dv">42</span>)</span>
<span id="cb419-2"><a href="WE_2.html#cb419-2" tabindex="-1"></a></span>
<span id="cb419-3"><a href="WE_2.html#cb419-3" tabindex="-1"></a>cc_forest<span class="sc">$</span>layer_1<span class="sc">$</span>class_42</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## dimensions  : 426, 358, 1  (nrow, ncol, nlyr)
## resolution  : 30, 30  (x, y)
## extent      : 683282.5, 694022.5, 4992833, 5005613  (xmin, xmax, ymin, ymax)
## coord. ref. : NAD83 / UTM zone 11N (EPSG:26911) 
## source(s)   : memory
## name        : lyr.1 
## min value   :   164 
## max value   :   385</code></pre>
<p>To plot the patches you can use the <code>show_patches()</code> function. Here we show patches of class 42 (forest) and class 52 (shrubland). Note that the color indicates patch ID!</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="WE_2.html#cb421-1" tabindex="-1"></a><span class="fu">show_patches</span>(<span class="at">landscape =</span> RasterMaps<span class="sc">$</span>nlcd, <span class="at">class =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">52</span>), <span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## $layer_1</code></pre>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>It is also possible to visualize only the core area of each patch using <code>show_cores()</code>. The core area is defined as all cells that are further away from the edge of each patch than a specified edge depth (e.g. 5 cells). Here we show core area with edge depth = 5 for class 42; try edge_depth = 1 for comparison:</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="WE_2.html#cb423-1" tabindex="-1"></a><span class="fu">show_cores</span>(<span class="at">landscape =</span> RasterMaps<span class="sc">$</span>nlcd, <span class="at">class =</span> <span class="fu">c</span>(<span class="dv">42</span>), <span class="at">edge_depth =</span> <span class="dv">5</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## $layer_1</code></pre>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Note: this may create a warning “no non-missing arguments to min; returning Inf” for each patch that does not have any core area. Here we suppressed the warnings for the chunk with the chunk option <code>warning=FALSE</code>.</p>
<p>Lastly, you can plot the map and fill each patch with the corresponding metric value, e.g. patch size, using <code>show_lsm()</code>. Notice that there are two very large patches in class 42:</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="WE_2.html#cb425-1" tabindex="-1"></a><span class="fu">show_lsm</span>(<span class="at">landscape =</span> RasterMaps<span class="sc">$</span>nlcd, <span class="at">class =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">52</span>), <span class="at">what =</span> <span class="st">&quot;lsm_p_area&quot;</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## $layer_1</code></pre>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
<div id="c.-extract-forest-patch-size-at-sampling-locations" class="section level4 unnumbered hasAnchor">
<h4>c. Extract forest patch size at sampling locations<a href="WE_2.html#c.-extract-forest-patch-size-at-sampling-locations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s add forest patch size to the <code>Sites.sf</code> data. To extract landscape metrics of the patch in which each sampling point is located, use <code>extract_lsm()</code>. Which metrics are extracted can be specified by the <code>what</code> argument (similar to <code>calculate_lsm()</code>). However, only patch-level metrics are available. Please be aware that the resulting <code>tibble</code> now has a new column, namely the ID of the sampling point (in the same order as the input points).</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="WE_2.html#cb427-1" tabindex="-1"></a><span class="do">## e.tract patch area of all classes:</span></span>
<span id="cb427-2"><a href="WE_2.html#cb427-2" tabindex="-1"></a>patch_size_sf <span class="ot">&lt;-</span> <span class="fu">extract_lsm</span>(<span class="at">landscape =</span> RasterMaps<span class="sc">$</span>nlcd, <span class="at">y =</span> Sites.sf, <span class="at">what =</span> <span class="st">&quot;lsm_p_area&quot;</span>)</span>
<span id="cb427-3"><a href="WE_2.html#cb427-3" tabindex="-1"></a></span>
<span id="cb427-4"><a href="WE_2.html#cb427-4" tabindex="-1"></a><span class="do">## b.cause we are only interested in the forest patch size, we set all area of class != 42 to 0:</span></span>
<span id="cb427-5"><a href="WE_2.html#cb427-5" tabindex="-1"></a>patch_size_sf_forest <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(patch_size_sf, </span>
<span id="cb427-6"><a href="WE_2.html#cb427-6" tabindex="-1"></a>                                      <span class="at">value =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(class <span class="sc">==</span> <span class="dv">42</span> <span class="sc">~</span> value, </span>
<span id="cb427-7"><a href="WE_2.html#cb427-7" tabindex="-1"></a>                                                               class <span class="sc">!=</span> <span class="dv">42</span> <span class="sc">~</span> <span class="dv">0</span>))</span>
<span id="cb427-8"><a href="WE_2.html#cb427-8" tabindex="-1"></a><span class="do">## a.d data to sf object:</span></span>
<span id="cb427-9"><a href="WE_2.html#cb427-9" tabindex="-1"></a>Sites.sf<span class="sc">$</span>ForestPatchSize <span class="ot">&lt;-</span> patch_size_sf_forest<span class="sc">$</span>value</span>
<span id="cb427-10"><a href="WE_2.html#cb427-10" tabindex="-1"></a>Sites.sf<span class="sc">$</span>ForestPatchSize</span></code></pre></div>
<pre><code>##  [1] 3179.88    0.00 3179.88    0.00    6.66 4539.33 4539.33 4539.33    0.00
## [10] 4539.33 4539.33   23.76   23.76    0.00    0.00 4539.33    0.00 4539.33
## [19]    3.60 3179.88    0.00 4539.33    3.87 4539.33    0.00    0.00   23.76
## [28] 3179.88    0.00 4539.33    0.09</code></pre>
</div>
<div id="d.-plot-a-bubble-map-of-forest-patch-size-at-sampling-locations" class="section level4 unnumbered hasAnchor">
<h4>d. Plot a bubble map of forest patch size at sampling locations<a href="WE_2.html#d.-plot-a-bubble-map-of-forest-patch-size-at-sampling-locations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="WE_2.html#cb429-1" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</span></code></pre></div>
<pre><code>## tmap mode set to interactive viewing</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="WE_2.html#cb431-1" tabindex="-1"></a><span class="fu">tm_shape</span>(Sites.sf) <span class="sc">+</span> <span class="fu">tm_bubbles</span>(<span class="at">col=</span><span class="st">&quot;ForestPatchSize&quot;</span>) </span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-3785741f2d10806c983e" style="width:427.2px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-3785741f2d10806c983e">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldGrayCanvas",null,"Esri.WorldGrayCanvas",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircles","args":[[45.15707850945083,45.12016062430876,45.1304727987641,45.15066982354276,45.12208200955106,45.10559714362714,45.0982893066227,45.11162597727552,45.16810160930147,45.09975785083597,45.11407808030845,45.15469735448928,45.15545452687273,45.1637644385459,45.09441390148887,45.1165823853642,45.15207319555835,45.09016340391857,45.08848338859229,45.15092837107155,45.08316146635691,45.08356480981284,45.16692667954503,45.08533324650074,45.16529181498381,45.11965875884201,45.15632923267202,45.13562787813084,45.12274430524,45.07529212294912,45.12860201067411],[-114.5977396540216,-114.6033865250272,-114.6100248049217,-114.5863531992181,-114.5828399817001,-114.6008430385362,-114.5983541778665,-114.6031733879995,-114.5964858515769,-114.5990662195857,-114.599181207082,-114.585563173993,-114.5835998180092,-114.5798359744075,-114.6100936916924,-114.6065382479126,-114.5715719888294,-114.6045327001424,-114.6158701947446,-114.6222594992278,-114.6185682698232,-114.622073588037,-114.5761415003057,-114.6122166396044,-114.6216736368122,-114.6076631577064,-114.5829370604914,-114.6082003751046,-114.5837103287136,-114.6117283040945,-114.5904058421169],[229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542,229.3324494484542],["AirplaneLake","BachelorMeadow","BarkingFoxLake","BirdbillLake","BobLake","CacheLake","DoeLake","EggWhiteLake","ElenasLake","FawnLake","FrogPondLake","GentianLake","GentianPonds","GoldenLake","GreggsLake","InandOutLake","MeadowLake","MooseLake","Mt.WilsonLake","NopezLake","ParagonLake","ParagonWetland","PotholeLake","RamshornLake","ShipIslandLake","SkyhighLake","StockingCapLake","Terrace1Lake","TobiasLake","WalkaboutLake","WelcomeLake"],"Sites.sf",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#EA6E13","#FFF8C4","#EA6E13","#FFF8C4","#FFF8C4","#B74202","#B74202","#B74202","#FFF8C4","#B74202","#B74202","#FFF8C4","#FFF8C4","#FFF8C4","#FFF8C4","#B74202","#FFF8C4","#B74202","#FFF8C4","#EA6E13","#FFF8C4","#B74202","#FFF8C4","#B74202","#FFF8C4","#FFF8C4","#FFF8C4","#EA6E13","#FFF8C4","#B74202","#FFF8C4"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>AirplaneLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>3,179.88<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BachelorMeadow<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BarkingFoxLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>3,179.88<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BirdbillLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BobLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>6.66<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>CacheLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>4,539.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>DoeLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>4,539.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>EggWhiteLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>4,539.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ElenasLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>FawnLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>4,539.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>FrogPondLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>4,539.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GentianLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>23.76<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GentianPonds<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>23.76<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GoldenLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GreggsLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>InandOutLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>4,539.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>MeadowLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>MooseLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>4,539.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>Mt.WilsonLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>3.60<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>NopezLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>3,179.88<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ParagonLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ParagonWetland<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>4,539.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>PotholeLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>3.87<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>RamshornLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>4,539.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ShipIslandLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>SkyhighLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>StockingCapLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>23.76<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>Terrace1Lake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>3,179.88<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>TobiasLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>WalkaboutLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>4,539.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>WelcomeLake<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ForestPatchSize<\/nobr><\/td><td align=\"right\"><nobr>0.09<\/nobr><\/td><\/tr><\/table><\/div>"],null,["AirplaneLake","BachelorMeadow","BarkingFoxLake","BirdbillLake","BobLake","CacheLake","DoeLake","EggWhiteLake","ElenasLake","FawnLake","FrogPondLake","GentianLake","GentianPonds","GoldenLake","GreggsLake","InandOutLake","MeadowLake","MooseLake","Mt.WilsonLake","NopezLake","ParagonLake","ParagonWetland","PotholeLake","RamshornLake","ShipIslandLake","SkyhighLake","StockingCapLake","Terrace1Lake","TobiasLake","WalkaboutLake","WelcomeLake"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addLegend","args":[{"colors":["#FFF8C4","#FEDE86","#FEAA38","#EA6E13","#B74202"],"labels":["0 to 1,000","1,000 to 2,000","2,000 to 3,000","3,000 to 4,000","4,000 to 5,000"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"ForestPatchSize","extra":null,"layerId":"legend401","className":"info legend Sites.sf","group":"Sites.sf"}]},{"method":"addLayersControl","args":[["Esri.WorldGrayCanvas","OpenStreetMap","Esri.WorldTopoMap"],"Sites.sf",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[45.07529212294912,45.16810160930147],"lng":[-114.6222594992278,-114.5715719888294]},"fitBounds":[45.07529212294912,-114.6222594992278,45.16810160930147,-114.5715719888294,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="sample-landscape-metrics-within-buffer-around-sampling-locations" class="section level3 unnumbered hasAnchor">
<h3>5. Sample landscape metrics within buffer around sampling locations<a href="WE_2.html#sample-landscape-metrics-within-buffer-around-sampling-locations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The package <code>landscapemetrics</code> has a built-in function <code>sample_lsm</code> to sample metrics in a buffer around sampling locations, which are provided with argument <code>y</code>. You can choose the <code>shape</code> of the buffer window (either a circle or a square) and, with the argument <code>what</code>, which metrics to sample (similar to <code>calculate_lsm()</code>).</p>
<p>The argument <code>size</code> specifies the buffer size in map units (e.g., meters): radius for circles, half of the side length for squares. Here, the value <code>size = 500</code> results in a square window of 1000 m x 1000 m centered at the sampling location.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="WE_2.html#cb432-1" tabindex="-1"></a>nlcd_sampled <span class="ot">&lt;-</span> landscapemetrics<span class="sc">::</span><span class="fu">sample_lsm</span>(<span class="at">landscape =</span> RasterMaps<span class="sc">$</span>nlcd, </span>
<span id="cb432-2"><a href="WE_2.html#cb432-2" tabindex="-1"></a>                                             <span class="at">what =</span> <span class="fu">c</span>(<span class="st">&quot;lsm_l_ta&quot;</span>, </span>
<span id="cb432-3"><a href="WE_2.html#cb432-3" tabindex="-1"></a>                                                      <span class="st">&quot;lsm_c_np&quot;</span>,</span>
<span id="cb432-4"><a href="WE_2.html#cb432-4" tabindex="-1"></a>                                                      <span class="st">&quot;lsm_c_pland&quot;</span>, </span>
<span id="cb432-5"><a href="WE_2.html#cb432-5" tabindex="-1"></a>                                                      <span class="st">&quot;lsm_c_ai&quot;</span>),</span>
<span id="cb432-6"><a href="WE_2.html#cb432-6" tabindex="-1"></a>                                             <span class="at">shape =</span> <span class="st">&quot;square&quot;</span>,</span>
<span id="cb432-7"><a href="WE_2.html#cb432-7" tabindex="-1"></a>                                             <span class="at">y =</span> Sites.sf, </span>
<span id="cb432-8"><a href="WE_2.html#cb432-8" tabindex="-1"></a>                                             <span class="at">size =</span> <span class="dv">500</span>)</span></code></pre></div>
<pre><code>## Warning: [crop] CRS do not match</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="WE_2.html#cb434-1" tabindex="-1"></a>nlcd_sampled</span></code></pre></div>
<pre><code>## # A tibble: 493 × 8
##    layer level class    id metric value plot_id percentage_inside
##    &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;int&gt;             &lt;dbl&gt;
##  1     1 class    11    NA ai      88.6       1              98.0
##  2     1 class    31    NA ai      NA         1              98.0
##  3     1 class    42    NA ai      93.3       1              98.0
##  4     1 class    52    NA ai      50         1              98.0
##  5     1 class    71    NA ai      65.9       1              98.0
##  6     1 class    11    NA np       2         1              98.0
##  7     1 class    31    NA np       1         1              98.0
##  8     1 class    42    NA np       2         1              98.0
##  9     1 class    52    NA np       4         1              98.0
## 10     1 class    71    NA np       8         1              98.0
## # ℹ 483 more rows</code></pre>
<p>The <code>tibble</code> now contains two additional columns. Firstly, the <code>plot_id</code> (in the same order as the input points) and secondly, the <code>percentage_inside</code>, i.e. what percentage of the buffer around the sampling location lies within the map. (In cases where the sampling location is on the edge of the landscape, the buffer around the sampling location could be only partly within the map). The value can also deviate from 100 % because the sampling locations are not necessarily in the cell center and the actually clipped cells lead to a slightly smaller or larger buffer area. A circular buffer shape increases this effect.</p>
<p>It is also possible to get the clippings of the buffer around sampling locations as a <code>RasterLayer</code>. For this, just set <code>return_raster = TRUE</code>.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="WE_2.html#cb436-1" tabindex="-1"></a><span class="co"># sample some metrics within buffer around sample location and returning sample</span></span>
<span id="cb436-2"><a href="WE_2.html#cb436-2" tabindex="-1"></a><span class="co"># plots as raster</span></span>
<span id="cb436-3"><a href="WE_2.html#cb436-3" tabindex="-1"></a></span>
<span id="cb436-4"><a href="WE_2.html#cb436-4" tabindex="-1"></a>nlcd_sampled_plots <span class="ot">&lt;-</span> landscapemetrics<span class="sc">::</span><span class="fu">sample_lsm</span>(<span class="at">landscape =</span> RasterMaps<span class="sc">$</span>nlcd, </span>
<span id="cb436-5"><a href="WE_2.html#cb436-5" tabindex="-1"></a>                                                   <span class="at">what =</span> <span class="fu">c</span>(<span class="st">&quot;lsm_l_ta&quot;</span>,</span>
<span id="cb436-6"><a href="WE_2.html#cb436-6" tabindex="-1"></a>                                                            <span class="st">&quot;lsm_c_np&quot;</span>,</span>
<span id="cb436-7"><a href="WE_2.html#cb436-7" tabindex="-1"></a>                                                            <span class="st">&quot;lsm_c_pland&quot;</span>,</span>
<span id="cb436-8"><a href="WE_2.html#cb436-8" tabindex="-1"></a>                                                            <span class="st">&quot;lsm_c_ai&quot;</span>),</span>
<span id="cb436-9"><a href="WE_2.html#cb436-9" tabindex="-1"></a>                                                   <span class="at">shape =</span> <span class="st">&quot;square&quot;</span>,</span>
<span id="cb436-10"><a href="WE_2.html#cb436-10" tabindex="-1"></a>                                                   <span class="at">y =</span> Sites.sf, </span>
<span id="cb436-11"><a href="WE_2.html#cb436-11" tabindex="-1"></a>                                                   <span class="at">size =</span> <span class="dv">500</span>, </span>
<span id="cb436-12"><a href="WE_2.html#cb436-12" tabindex="-1"></a>                                                   <span class="at">return_raster =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning: [crop] CRS do not match</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="WE_2.html#cb438-1" tabindex="-1"></a>nlcd_sampled_plots</span></code></pre></div>
<pre><code>## # A tibble: 493 × 9
##    layer level class    id metric value plot_id percentage_inside
##    &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;int&gt;             &lt;dbl&gt;
##  1     1 class    11    NA ai      88.6       1              98.0
##  2     1 class    31    NA ai      NA         1              98.0
##  3     1 class    42    NA ai      93.3       1              98.0
##  4     1 class    52    NA ai      50         1              98.0
##  5     1 class    71    NA ai      65.9       1              98.0
##  6     1 class    11    NA np       2         1              98.0
##  7     1 class    31    NA np       1         1              98.0
##  8     1 class    42    NA np       2         1              98.0
##  9     1 class    52    NA np       4         1              98.0
## 10     1 class    71    NA np       8         1              98.0
## # ℹ 483 more rows
## # ℹ 1 more variable: raster_sample_plots &lt;list&gt;</code></pre>
<p>The result will be a nested <code>tibble</code> containing the <code>plot_id</code>, the metrics and a <code>RasterLayer</code> with the clipped buffers (as a <code>list</code>). Attention: Because several metrics on class- and landscape-level the clipped buffers will be “repeated” several times.</p>
<p>Here we show results for the first four sampling locations. We use a for loop to avoid repeating code.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="WE_2.html#cb440-1" tabindex="-1"></a>unique_plots <span class="ot">&lt;-</span> <span class="fu">unique</span>(nlcd_sampled_plots<span class="sc">$</span>raster_sample_plots)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb440-2"><a href="WE_2.html#cb440-2" tabindex="-1"></a></span>
<span id="cb440-3"><a href="WE_2.html#cb440-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb440-4"><a href="WE_2.html#cb440-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb440-5"><a href="WE_2.html#cb440-5" tabindex="-1"></a>{</span>
<span id="cb440-6"><a href="WE_2.html#cb440-6" tabindex="-1"></a>  <span class="fu">plot</span>(unique_plots[[i]], <span class="at">type=</span><span class="st">&quot;classes&quot;</span>,</span>
<span id="cb440-7"><a href="WE_2.html#cb440-7" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(Sites.sf<span class="sc">$</span>SiteName[i]))</span>
<span id="cb440-8"><a href="WE_2.html#cb440-8" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-54-1.png" width="768" /></p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="WE_2.html#cb441-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>To use consistent colors for the land cover types, we need to tweak things a bit.</p>
<ul>
<li>Determine how many colors are needed (<code>nColor</code>): number of cover types in raster <code>nlcd</code>.</li>
<li>Define a set of <code>nColor</code> colors, using a categorical color ramp from package <code>RColorBrewer</code>: <code>Colors</code></li>
<li>For each clipped buffer, we use the function <code>is.element</code> to determine for each land cover type if it is present in the buffer. The vector Present is of type logical (TRUE/FALSE).</li>
<li>Then we specify the colors to be used as the subset of Colors for which Present is TRUE. (A shorter alternative would be: <code>col=Colors[Present]</code>).</li>
</ul>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="WE_2.html#cb442-1" tabindex="-1"></a>nColors <span class="ot">&lt;-</span> <span class="fu">nrow</span>(<span class="fu">unique</span>(RasterMaps<span class="sc">$</span>nlcd))</span>
<span id="cb442-2"><a href="WE_2.html#cb442-2" tabindex="-1"></a>Colors <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">n =</span> nColors, <span class="at">name =</span> <span class="st">&quot;Dark2&quot;</span>) </span>
<span id="cb442-3"><a href="WE_2.html#cb442-3" tabindex="-1"></a></span>
<span id="cb442-4"><a href="WE_2.html#cb442-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb442-5"><a href="WE_2.html#cb442-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb442-6"><a href="WE_2.html#cb442-6" tabindex="-1"></a>{</span>
<span id="cb442-7"><a href="WE_2.html#cb442-7" tabindex="-1"></a>  Present <span class="ot">&lt;-</span> <span class="fu">is.element</span>(<span class="fu">unique</span>(RasterMaps<span class="sc">$</span>nlcd)<span class="sc">$</span>nlcd, <span class="fu">unique</span>(unique_plots[[i]])<span class="sc">$</span>nlcd)</span>
<span id="cb442-8"><a href="WE_2.html#cb442-8" tabindex="-1"></a>  <span class="fu">plot</span>(unique_plots[[i]], <span class="at">type=</span><span class="st">&quot;classes&quot;</span>,</span>
<span id="cb442-9"><a href="WE_2.html#cb442-9" tabindex="-1"></a>       <span class="at">col=</span>Colors[Present<span class="sc">==</span><span class="cn">TRUE</span>],</span>
<span id="cb442-10"><a href="WE_2.html#cb442-10" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(Sites.sf<span class="sc">$</span>SiteName[i]))</span>
<span id="cb442-11"><a href="WE_2.html#cb442-11" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="02-Week02_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="WE_2.html#cb443-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<div id="b.-extract-landscape-metric-of-choice-for-a-single-cover-type-as-vector" class="section level4 unnumbered hasAnchor">
<h4>b. Extract landscape metric of choice for a single cover type (as vector)<a href="WE_2.html#b.-extract-landscape-metric-of-choice-for-a-single-cover-type-as-vector" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To extract a metrics you can just <code>dplyr::filter()</code> the resulting <code>tibble</code> and pull the <code>value</code> column.
Here we filter the results for class == 42 (forest) and metric <code>pland</code> (percentage of landscape) and pull the results as a vector:</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="WE_2.html#cb444-1" tabindex="-1"></a>percentage_forest_500_a <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(nlcd_sampled, </span>
<span id="cb444-2"><a href="WE_2.html#cb444-2" tabindex="-1"></a>                                                     class <span class="sc">==</span> <span class="dv">42</span>, </span>
<span id="cb444-3"><a href="WE_2.html#cb444-3" tabindex="-1"></a>                                                     metric <span class="sc">==</span> <span class="st">&quot;pland&quot;</span>), value)</span>
<span id="cb444-4"><a href="WE_2.html#cb444-4" tabindex="-1"></a>percentage_forest_500_a</span></code></pre></div>
<pre><code>##  [1] 77.50230 39.57759 38.01653 31.40138 40.40404 83.30450 69.16221 86.80927
##  [9] 10.19284 72.81910 92.19467 34.04635 34.84848 27.09447 31.37255 56.23886
## [17] 59.77961 58.73440 37.64922 60.12111 46.16756 32.32323 23.35640 50.44563
## [25] 66.93405 30.57851 33.70064 26.53811 45.18717 38.05704 62.47772</code></pre>
<p>As an alternative, here’s the same workflow again, but using a pipe:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="WE_2.html#cb446-1" tabindex="-1"></a>percentage_forest_500_b <span class="ot">&lt;-</span> nlcd_sampled <span class="sc">%&gt;%</span> </span>
<span id="cb446-2"><a href="WE_2.html#cb446-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(class <span class="sc">==</span> <span class="dv">42</span>, </span>
<span id="cb446-3"><a href="WE_2.html#cb446-3" tabindex="-1"></a>                metric <span class="sc">==</span> <span class="st">&quot;pland&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb446-4"><a href="WE_2.html#cb446-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(value)</span>
<span id="cb446-5"><a href="WE_2.html#cb446-5" tabindex="-1"></a>percentage_forest_500_b</span></code></pre></div>
<pre><code>##  [1] 77.50230 39.57759 38.01653 31.40138 40.40404 83.30450 69.16221 86.80927
##  [9] 10.19284 72.81910 92.19467 34.04635 34.84848 27.09447 31.37255 56.23886
## [17] 59.77961 58.73440 37.64922 60.12111 46.16756 32.32323 23.35640 50.44563
## [25] 66.93405 30.57851 33.70064 26.53811 45.18717 38.05704 62.47772</code></pre>
</div>
<div id="c.-extract-landscape-metric-of-choice-for-all-cover-types-as-data-frame" class="section level4 unnumbered hasAnchor">
<h4>c. Extract landscape metric of choice for all cover types (as data frame)<a href="WE_2.html#c.-extract-landscape-metric-of-choice-for-all-cover-types-as-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To extract the landscape metric ‘prop.landscape’ for all cover types as a <code>tibble</code>, just filter <code>dplyr::filter()</code> the <code>tibble</code> again, but only use the <code>metric</code> as filter.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="WE_2.html#cb448-1" tabindex="-1"></a><span class="do">## f.lter for percentage of landscape</span></span>
<span id="cb448-2"><a href="WE_2.html#cb448-2" tabindex="-1"></a>percentage_forest_500_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(nlcd_sampled,</span>
<span id="cb448-3"><a href="WE_2.html#cb448-3" tabindex="-1"></a>                                          metric <span class="sc">==</span> <span class="st">&quot;pland&quot;</span>)</span>
<span id="cb448-4"><a href="WE_2.html#cb448-4" tabindex="-1"></a></span>
<span id="cb448-5"><a href="WE_2.html#cb448-5" tabindex="-1"></a>percentage_forest_500_df</span></code></pre></div>
<pre><code>## # A tibble: 154 × 8
##    layer level class    id metric   value plot_id percentage_inside
##    &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;int&gt;             &lt;dbl&gt;
##  1     1 class    11    NA pland   7.25         1              98.0
##  2     1 class    31    NA pland   0.0918       1              98.0
##  3     1 class    42    NA pland  77.5          1              98.0
##  4     1 class    52    NA pland   1.93         1              98.0
##  5     1 class    71    NA pland  13.2          1              98.0
##  6     1 class    11    NA pland   3.49         2              98.0
##  7     1 class    12    NA pland   1.01         2              98.0
##  8     1 class    31    NA pland   0.735        2              98.0
##  9     1 class    42    NA pland  39.6          2              98.0
## 10     1 class    52    NA pland   5.33         2              98.0
## # ℹ 144 more rows</code></pre>
<p>The percent cover of all cover types should add up to ~ 100% (i.e., 1) for each site. We can check this with the function <code>dplyr::summarize()</code>. First, we need to group the data using the <code>plot_id</code>, then sum all percentages.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="WE_2.html#cb450-1" tabindex="-1"></a><span class="do">## g.oup by plot_id and sum all percentages</span></span>
<span id="cb450-2"><a href="WE_2.html#cb450-2" tabindex="-1"></a>pland_sum_a <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(dplyr<span class="sc">::</span><span class="fu">group_by</span>(percentage_forest_500_df, </span>
<span id="cb450-3"><a href="WE_2.html#cb450-3" tabindex="-1"></a>                                                <span class="at">by =</span> plot_id), </span>
<span id="cb450-4"><a href="WE_2.html#cb450-4" tabindex="-1"></a>                                <span class="at">sum_pland =</span> <span class="fu">sum</span>(value))</span>
<span id="cb450-5"><a href="WE_2.html#cb450-5" tabindex="-1"></a>pland_sum_a</span></code></pre></div>
<pre><code>## # A tibble: 31 × 2
##       by sum_pland
##    &lt;int&gt;     &lt;dbl&gt;
##  1     1       100
##  2     2       100
##  3     3       100
##  4     4       100
##  5     5       100
##  6     6       100
##  7     7       100
##  8     8       100
##  9     9       100
## 10    10       100
## # ℹ 21 more rows</code></pre>
<p>Same workflow, but using a pipe:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="WE_2.html#cb452-1" tabindex="-1"></a>pland_sum_b <span class="ot">&lt;-</span> percentage_forest_500_df <span class="sc">%&gt;%</span> </span>
<span id="cb452-2"><a href="WE_2.html#cb452-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(plot_id) <span class="sc">%&gt;%</span> </span>
<span id="cb452-3"><a href="WE_2.html#cb452-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum_pland =</span> <span class="fu">sum</span>(value))</span>
<span id="cb452-4"><a href="WE_2.html#cb452-4" tabindex="-1"></a>pland_sum_b</span></code></pre></div>
<pre><code>## # A tibble: 31 × 2
##    plot_id sum_pland
##      &lt;int&gt;     &lt;dbl&gt;
##  1       1       100
##  2       2       100
##  3       3       100
##  4       4       100
##  5       5       100
##  6       6       100
##  7       7       100
##  8       8       100
##  9       9       100
## 10      10       100
## # ℹ 21 more rows</code></pre>
</div>
<div id="d.-extract-all-landscape-metrics-for-a-single-cover-type-as-data-frame" class="section level4 unnumbered hasAnchor">
<h4>d. Extract all landscape metrics for a single cover type (as data frame)<a href="WE_2.html#d.-extract-all-landscape-metrics-for-a-single-cover-type-as-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Filter<code>dplyr::filter()</code> for <code>class == 42</code> and add the sites names as coloumn to the resulting <code>tibble</code>.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="WE_2.html#cb454-1" tabindex="-1"></a><span class="do">## f.lter for class == 42 (forest)</span></span>
<span id="cb454-2"><a href="WE_2.html#cb454-2" tabindex="-1"></a>forest_500_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(nlcd_sampled,</span>
<span id="cb454-3"><a href="WE_2.html#cb454-3" tabindex="-1"></a>                               class <span class="sc">==</span> <span class="dv">42</span>)</span>
<span id="cb454-4"><a href="WE_2.html#cb454-4" tabindex="-1"></a></span>
<span id="cb454-5"><a href="WE_2.html#cb454-5" tabindex="-1"></a><span class="do">## d.ta.frame with id and name of site</span></span>
<span id="cb454-6"><a href="WE_2.html#cb454-6" tabindex="-1"></a>SiteName_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Sites.sf<span class="sc">$</span>SiteName), <span class="at">site_name =</span> Sites.sf<span class="sc">$</span>SiteName)</span>
<span id="cb454-7"><a href="WE_2.html#cb454-7" tabindex="-1"></a></span>
<span id="cb454-8"><a href="WE_2.html#cb454-8" tabindex="-1"></a><span class="do">## a.d site_name to metrics using plot_id and id of sampling sites</span></span>
<span id="cb454-9"><a href="WE_2.html#cb454-9" tabindex="-1"></a>forest_500_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(forest_500_df, SiteName_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;plot_id&quot;</span> <span class="ot">=</span> <span class="st">&quot;id&quot;</span>))</span>
<span id="cb454-10"><a href="WE_2.html#cb454-10" tabindex="-1"></a></span>
<span id="cb454-11"><a href="WE_2.html#cb454-11" tabindex="-1"></a>forest_500_df</span></code></pre></div>
<pre><code>## # A tibble: 93 × 9
##    layer level class    id metric value plot_id percentage_inside site_name     
##    &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;int&gt;             &lt;dbl&gt; &lt;chr&gt;         
##  1     1 class    42    NA ai      93.3       1              98.0 AirplaneLake  
##  2     1 class    42    NA np       2         1              98.0 AirplaneLake  
##  3     1 class    42    NA pland   77.5       1              98.0 AirplaneLake  
##  4     1 class    42    NA ai      89.4       2              98.0 BachelorMeadow
##  5     1 class    42    NA np       7         2              98.0 BachelorMeadow
##  6     1 class    42    NA pland   39.6       2              98.0 BachelorMeadow
##  7     1 class    42    NA ai      79.4       3              98.0 BarkingFoxLake
##  8     1 class    42    NA np      10         3              98.0 BarkingFoxLake
##  9     1 class    42    NA pland   38.0       3              98.0 BarkingFoxLake
## 10     1 class    42    NA ai      81.2       4             104.  BirdbillLake  
## # ℹ 83 more rows</code></pre>
<p>Done!</p>
<p>Check out this week’s bonus material to see:</p>
<ul>
<li>More details on how to create static and interactive maps of an <code>sf</code> object with <code>tmap</code>.</li>
<li>How to import and export ESRI shapefiles.</li>
<li>How to plot a categorical raster map with a predefined color scheme, using <code>tmap</code> and <code>terra</code>. package).</li>
</ul>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tutorial_2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-exercise-week-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
