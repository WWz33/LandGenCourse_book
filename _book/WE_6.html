<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9.3 Worked Example | Landscape Genetic Data Analysis with R</title>
  <meta name="description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics’. The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="9.3 Worked Example | Landscape Genetic Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics’. The output format is bookdown::gitbook." />
  <meta name="github-repo" content="hhwagner1/LandGenCourse_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9.3 Worked Example | Landscape Genetic Data Analysis with R" />
  
  <meta name="twitter:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics’. The output format is bookdown::gitbook." />
  

<meta name="author" content="Editor: Helene Wagner (University of Toronto)" />


<meta name="date" content="2024-01-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tutorial_6.html"/>
<link rel="next" href="r-exercise-week-6.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.8/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Landscape Genetic Data Analysis with R</a></li>

<li class="divider"></li>
<li class="part"><span><b>Getting Started</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i><b>1.1</b> How to use this Book</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#book-structure"><i class="fa fa-check"></i>1. Book Structure</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#find-what-is-relevant-for-you"><i class="fa fa-check"></i>2. Find what is relevant for you</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#course-r-package-landgencourse"><i class="fa fa-check"></i>3. Course R package ‘LandGenCourse’</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="list-of-packages.html"><a href="list-of-packages.html"><i class="fa fa-check"></i><b>1.2</b> List of R Packages by Vignette</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="review-of-r-skills.html"><a href="review-of-r-skills.html"><i class="fa fa-check"></i><b>2</b> Review of R Skills</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>2.1</b> Basic R Programming</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#overview"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#data-types"><i class="fa fa-check"></i>2. Data Types</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#data-containers"><i class="fa fa-check"></i>3. Data Containers</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#programming"><i class="fa fa-check"></i>4. Programming</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-graphics.html"><a href="r-graphics.html"><i class="fa fa-check"></i><b>2.2</b> R Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#overview-1"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#univariate-plots"><i class="fa fa-check"></i>2. Univariate plots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#bivariate-plots"><i class="fa fa-check"></i>3. Bivariate plots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#advanced-plotting"><i class="fa fa-check"></i>4. Advanced plotting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>2.3</b> Further R resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="github-for-group-projects.html"><a href="github-for-group-projects.html"><i class="fa fa-check"></i><b>3</b> GitHub for Group Projects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>3.1</b> Why use GitHub?</a>
<ul>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#goals"><i class="fa fa-check"></i>1. Goals</a></li>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#version"><i class="fa fa-check"></i>2. Watch course video: Version Control 101</a></li>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#slides"><i class="fa fa-check"></i>3. Preview slides</a></li>
<li class="chapter" data-level="" data-path="github.html"><a href="github.html#next-steps"><i class="fa fa-check"></i>4. Next steps</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>3.2</b> Installation</a>
<ul>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#goals-1"><i class="fa fa-check"></i>1. Goals</a></li>
<li class="chapter" data-level="3.2.1" data-path="install.html"><a href="install.html#how-to-get-github-and-gitkraken-for-free"><i class="fa fa-check"></i><b>3.2.1</b> 2. How to get GitHub and GitKraken for free</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#happygit"><i class="fa fa-check"></i>3. Happy Git with R</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#gitvideos"><i class="fa fa-check"></i>4. Video tutorials: installation</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#join"><i class="fa fa-check"></i>5. Joining your group’s project on GitHub</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#repo"><i class="fa fa-check"></i>6. Setting up a group repo</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#next-steps-1"><i class="fa fa-check"></i>7. Next steps</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>3.3</b> Workflows</a>
<ul>
<li class="chapter" data-level="" data-path="workflow.html"><a href="workflow.html#goals-2"><i class="fa fa-check"></i>1. Goals</a></li>
<li class="chapter" data-level="" data-path="workflow.html"><a href="workflow.html#step-by-step-tutorials"><i class="fa fa-check"></i>2. Step-by-step tutorials</a></li>
<li class="chapter" data-level="" data-path="workflow.html"><a href="workflow.html#further-resources"><i class="fa fa-check"></i>3. Further resources</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Basic Topics</b></span></li>
<li class="chapter" data-level="4" data-path="Week1.html"><a href="Week1.html"><i class="fa fa-check"></i><b>4</b> Week 1: Importing Genetic Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="video_1.html"><a href="video_1.html"><i class="fa fa-check"></i><b>4.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_1.html"><a href="video_1.html#embedded-video"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_1.html"><a href="video_1.html#preview-slides"><i class="fa fa-check"></i>2. Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tutorial_1.html"><a href="tutorial_1.html"><i class="fa fa-check"></i><b>4.2</b> Interactive Tutorial 1</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_1.html"><a href="tutorial_1.html#list-of-r-commands-covered-this-week"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_1.html"><a href="tutorial_1.html#general-instructions"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="WE_1.html"><a href="WE_1.html"><i class="fa fa-check"></i><b>4.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#overview-of-worked-example"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#import-data-from-.csv-file"><i class="fa fa-check"></i>2. Import data from .csv file</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#create-genind-object"><i class="fa fa-check"></i>3. Create ‘genind’ Object</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#view-information-stored-in-genind-object"><i class="fa fa-check"></i>4. View information stored in ‘genind’ object</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#import-data-with-gstudio-package"><i class="fa fa-check"></i>5. Import data with ‘gstudio’ package</a></li>
<li class="chapter" data-level="" data-path="WE_1.html"><a href="WE_1.html#importing-snp-data"><i class="fa fa-check"></i>6. Importing SNP data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-1.html"><a href="r-exercise-week-1.html"><i class="fa fa-check"></i>R exercise Week 1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Week2.html"><a href="Week2.html"><i class="fa fa-check"></i><b>5</b> Week 2: Spatial Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="video_2.html"><a href="video_2.html"><i class="fa fa-check"></i><b>5.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_2.html"><a href="video_2.html#embedded-video-1"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_2.html"><a href="video_2.html#preview-slides-1"><i class="fa fa-check"></i>2. Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="tutorial_2.html"><a href="tutorial_2.html"><i class="fa fa-check"></i><b>5.2</b> Interactive Tutorial 2</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_2.html"><a href="tutorial_2.html#list-of-r-commands-covered-this-week-1"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_2.html"><a href="tutorial_2.html#general-instructions-1"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="WE_2.html"><a href="WE_2.html"><i class="fa fa-check"></i><b>5.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#overview-of-worked-example-1"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#import-site-data-from-.csv-file"><i class="fa fa-check"></i>2. Import site data from .csv file</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#display-raster-data-and-overlay-sampling-locations-extract-data"><i class="fa fa-check"></i>3. Display raster data and overlay sampling locations, extract data</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#calculate-landscape-metrics"><i class="fa fa-check"></i>4. Calculate landscape metrics</a></li>
<li class="chapter" data-level="" data-path="WE_2.html"><a href="WE_2.html#sample-landscape-metrics-within-buffer-around-sampling-locations"><i class="fa fa-check"></i>5. Sample landscape metrics within buffer around sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-2.html"><a href="r-exercise-week-2.html"><i class="fa fa-check"></i>R Exercise Week 2</a></li>
<li class="chapter" data-level="5.4" data-path="bonus_2a.html"><a href="bonus_2a.html"><i class="fa fa-check"></i><b>5.4</b> Bonus: ‘sf’ and ‘terra’</a>
<ul>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#overview-2"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#import-and-export-esri-shapefiles"><i class="fa fa-check"></i>2. Import and export ESRI shapefiles</a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#compatibility-with-sp-and-raster-objects"><i class="fa fa-check"></i>3. Compatibility with <code>sp</code> and <code>raster</code> objects</a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#plotting-spatial-data-with-tmap"><i class="fa fa-check"></i>4. Plotting spatial data with <code>tmap</code></a></li>
<li class="chapter" data-level="" data-path="bonus_2a.html"><a href="bonus_2a.html#plot-a-categorical-map-with-predefined-color-scheme"><i class="fa fa-check"></i>5. Plot a categorical map with predefined color scheme</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Week3.html"><a href="Week3.html"><i class="fa fa-check"></i><b>6</b> Week 3: Genetic Diversity</a>
<ul>
<li class="chapter" data-level="6.1" data-path="video_3.html"><a href="video_3.html"><i class="fa fa-check"></i><b>6.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#embedded-video-2"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#video-part-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#video-part-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_3.html"><a href="video_3.html#preview-slides-2"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tutorial_3.html"><a href="tutorial_3.html"><i class="fa fa-check"></i><b>6.2</b> Interactive Tutorial 3</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_3.html"><a href="tutorial_3.html#list-of-r-commands-covered-this-week-2"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_3.html"><a href="tutorial_3.html#general-instructions-2"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="WE_3.html"><a href="WE_3.html"><i class="fa fa-check"></i><b>6.3</b> Worked Example</a></li>
<li class="chapter" data-level="6.4" data-path="r-exercise-week-3.html"><a href="r-exercise-week-3.html"><i class="fa fa-check"></i><b>6.4</b> R Exercise Week 3</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Week4.html"><a href="Week4.html"><i class="fa fa-check"></i><b>7</b> Week 4: Metapopulations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="video_4.html"><a href="video_4.html"><i class="fa fa-check"></i><b>7.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#embedded-video-3"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#video-part-1-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#video-part-2-1"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_4.html"><a href="video_4.html#preview-slides-3"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="tutorial_4.html"><a href="tutorial_4.html"><i class="fa fa-check"></i><b>7.2</b> Interactive Tutorial 4</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_4.html"><a href="tutorial_4.html#list-of-r-commands-covered-this-week-3"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_4.html"><a href="tutorial_4.html#general-instructions-3"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="WE_4.html"><a href="WE_4.html"><i class="fa fa-check"></i><b>7.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#overview-of-worked-example-3"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#spatial-distribution-of-genetic-structure"><i class="fa fa-check"></i>2. Spatial distribution of genetic structure</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#what-determines-genetic-differentiation-among-sites"><i class="fa fa-check"></i>3. What determines genetic differentiation among sites?</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#what-determines-genetic-diversity"><i class="fa fa-check"></i>4. What determines genetic diversity?</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#are-genetic-differentiation-and-diversity-related"><i class="fa fa-check"></i>5. Are genetic differentiation and diversity related?</a></li>
<li class="chapter" data-level="" data-path="WE_4.html"><a href="WE_4.html#effect-of-recent-extinction-events"><i class="fa fa-check"></i>6. Effect of recent extinction events</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-4.html"><a href="r-exercise-week-4.html"><i class="fa fa-check"></i>R Exercise Week 4</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Week5.html"><a href="Week5.html"><i class="fa fa-check"></i><b>8</b> Week 5: Spatial Statistics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="video_5.html"><a href="video_5.html"><i class="fa fa-check"></i><b>8.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_5.html"><a href="video_5.html#embedded-video-4"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_5.html"><a href="video_5.html#preview-slides-4"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tutorial_5.html"><a href="tutorial_5.html"><i class="fa fa-check"></i><b>8.2</b> Interactive Tutorial 5</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_5.html"><a href="tutorial_5.html#list-of-r-commands-covered-this-week-4"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_5.html"><a href="tutorial_5.html#general-instructions-4"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="WE_5.html"><a href="WE_5.html"><i class="fa fa-check"></i><b>8.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#overview-of-worked-example-4"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#data-import-and-manipulation"><i class="fa fa-check"></i>2. Data import and manipulation</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#calculate-genetic-distances"><i class="fa fa-check"></i>3. Calculate genetic distances</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#perform-a-mantel-test-to-test-for-ibd"><i class="fa fa-check"></i>4. Perform a Mantel test to test for IBD</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#create-mantel-correlogram-for-genetic-data"><i class="fa fa-check"></i>5. Create Mantel correlogram for genetic data</a></li>
<li class="chapter" data-level="" data-path="WE_5.html"><a href="WE_5.html#specify-spatial-weights-and-calculate-morans-i"><i class="fa fa-check"></i>6. Specify spatial weights and calculate Moran’s I</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-5.html"><a href="r-exercise-week-5.html"><i class="fa fa-check"></i>R Exercise Week 5</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Week6.html"><a href="Week6.html"><i class="fa fa-check"></i><b>9</b> Week 6: Quantitative Genetics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="video_6.html"><a href="video_6.html"><i class="fa fa-check"></i><b>9.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#embedded-video-5"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#video-part-1-2"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#video-part-2-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_6.html"><a href="video_6.html#preview-slides-5"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="tutorial_6.html"><a href="tutorial_6.html"><i class="fa fa-check"></i><b>9.2</b> Interactive Tutorial 6</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_6.html"><a href="tutorial_6.html#list-of-r-commands-covered-this-week-5"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_6.html"><a href="tutorial_6.html#general-instructions-5"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="WE_6.html"><a href="WE_6.html"><i class="fa fa-check"></i><b>9.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#overview-of-worked-example-5"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment"><i class="fa fa-check"></i>2. Estimate genetic and non-genetic variance components from a common garden experiment</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#estimate-trait-heritability"><i class="fa fa-check"></i>3. Estimate trait heritability</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#compare-q_st-to-f_st-measured-from-snp-data"><i class="fa fa-check"></i>4. Compare <span class="math inline">\(Q_{st}\)</span> to <span class="math inline">\(F_{st}\)</span> measured from SNP data</a></li>
<li class="chapter" data-level="" data-path="WE_6.html"><a href="WE_6.html#assess-correlation-between-trait-and-environment"><i class="fa fa-check"></i>5. Assess correlation between trait and environment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-6.html"><a href="r-exercise-week-6.html"><i class="fa fa-check"></i>R Exercise Week 6</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Week7.html"><a href="Week7.html"><i class="fa fa-check"></i><b>10</b> Week 7: Spatial Linear Models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="video_7.html"><a href="video_7.html"><i class="fa fa-check"></i><b>10.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#embedded-video-6"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#video-part-1-3"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#video-part-2-3"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_7.html"><a href="video_7.html#preview-slides-6"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tutorial_7.html"><a href="tutorial_7.html"><i class="fa fa-check"></i><b>10.2</b> Interactive Tutorial 7</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_7.html"><a href="tutorial_7.html#list-of-r-commands-covered-this-week-6"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_7.html"><a href="tutorial_7.html#general-instructions-6"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="WE_7.html"><a href="WE_7.html"><i class="fa fa-check"></i><b>10.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#overview-of-worked-example-6"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#explore-data-set"><i class="fa fa-check"></i>2. Explore data set</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#test-regression-residuals-for-spatial-autocorrelation"><i class="fa fa-check"></i>3. Test regression residuals for spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#fit-models-with-spatially-correlated-error-gls-with-package-nlme"><i class="fa fa-check"></i>4. Fit models with spatially correlated error (GLS) with package ‘nlme’</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#fit-spatial-simultaneous-autoregressive-error-models-sar"><i class="fa fa-check"></i>5. Fit spatial simultaneous autoregressive error models (SAR)</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#spatial-filtering-with-mem-using-package-spmoran"><i class="fa fa-check"></i>6. Spatial filtering with MEM using package ‘spmoran’</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#fit-spatially-varying-coefficients-model-with-package-spmoran"><i class="fa fa-check"></i>7. Fit spatially varying coefficients model with package ‘spmoran’</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#model-with-patchsize-and-ibr"><i class="fa fa-check"></i>Model with PatchSize and IBR</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#model-with-ibr-only"><i class="fa fa-check"></i>Model with IBR only</a></li>
<li class="chapter" data-level="" data-path="WE_7.html"><a href="WE_7.html#conclusions"><i class="fa fa-check"></i>8. Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-7.html"><a href="r-exercise-week-7.html"><i class="fa fa-check"></i>R Exercise Week 7</a></li>
<li class="chapter" data-level="10.4" data-path="bonus_7a.html"><a href="bonus_7a.html"><i class="fa fa-check"></i><b>10.4</b> Bonus: Si index</a>
<ul>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#overview-of-bonus-materials"><i class="fa fa-check"></i>1. Overview of Bonus Materials</a></li>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#import-ecological-distance-matrices"><i class="fa fa-check"></i>2. Import ecological distance matrices</a></li>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#optimize-the-scaling-parameter-alpha"><i class="fa fa-check"></i>3. Optimize the scaling parameter alpha</a></li>
<li class="chapter" data-level="" data-path="bonus_7a.html"><a href="bonus_7a.html#calculate-hanskis-index-si-with-source-patch-parameters"><i class="fa fa-check"></i>4. Calculate Hanski’s index Si with source patch parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Week8.html"><a href="Week8.html"><i class="fa fa-check"></i><b>11</b> Week 8: Simulation Experiments</a>
<ul>
<li class="chapter" data-level="11.1" data-path="video_8.html"><a href="video_8.html"><i class="fa fa-check"></i><b>11.1</b> View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#embedded-video-7"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#video-part-1-4"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#video-part-2-4"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video_8.html"><a href="video_8.html#preview-slides-7"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="tutorial_8.html"><a href="tutorial_8.html"><i class="fa fa-check"></i><b>11.2</b> Interactive Tutorial 8</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial_8.html"><a href="tutorial_8.html#list-of-r-commands-covered-this-week-7"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial_8.html"><a href="tutorial_8.html#general-instructions-7"><i class="fa fa-check"></i>2. General Instructions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="WE_8.html"><a href="WE_8.html"><i class="fa fa-check"></i><b>11.3</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#overview-of-worked-example-7"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#initialize-a-landscape"><i class="fa fa-check"></i>2. Initialize a landscape</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#define-simulation-parameters"><i class="fa fa-check"></i>3. Define simulation parameters</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#run-simulations-and-analyze-results"><i class="fa fa-check"></i>4. Run simulations and analyze results</a></li>
<li class="chapter" data-level="" data-path="WE_8.html"><a href="WE_8.html#run-simulator-using-a-previously-defined-parameter-set"><i class="fa fa-check"></i>5. Run simulator using a previously defined parameter set</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-8.html"><a href="r-exercise-week-8.html"><i class="fa fa-check"></i>R Exercise Week 8</a></li>
<li class="chapter" data-level="11.4" data-path="bonus_8a.html"><a href="bonus_8a.html"><i class="fa fa-check"></i><b>11.4</b> Bonus: Efficient R</a></li>
</ul></li>
<li class="part"><span><b>Advanced Topics</b></span></li>
<li class="chapter" data-level="12" data-path="Week9.html"><a href="Week9.html"><i class="fa fa-check"></i><b>12</b> Week 9: Population Structure</a>
<ul>
<li class="chapter" data-level="12.1" data-path="WE_9.html"><a href="WE_9.html"><i class="fa fa-check"></i><b>12.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#overview-of-worked-example-8"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#simulated-data-2-island-model"><i class="fa fa-check"></i>2. Simulated data: 2-island model</a></li>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#simulated-data-2-island-model-with-admixture"><i class="fa fa-check"></i>3. Simulated data: 2-island model with admixture</a></li>
<li class="chapter" data-level="" data-path="WE_9.html"><a href="WE_9.html#empirical-data-threespine-sticklebacks"><i class="fa fa-check"></i>4. Empirical data: Threespine sticklebacks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Week10.html"><a href="Week10.html"><i class="fa fa-check"></i><b>13</b> Week 10: Landscape Resistance</a>
<ul>
<li class="chapter" data-level="13.1" data-path="WE_10.html"><a href="WE_10.html"><i class="fa fa-check"></i><b>13.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#overview-of-worked-example-9"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#explore-the-data-set"><i class="fa fa-check"></i>2. Explore the data set</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#setting-cost-values-and-calculating-conductance"><i class="fa fa-check"></i>3. Setting cost values and calculating conductance</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#convert-conductance-into-effective-distance"><i class="fa fa-check"></i>4. Convert conductance into effective distance</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#create-cost-distance-matrices"><i class="fa fa-check"></i>5. Create cost-distance matrices</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#how-does-changing-resolution-affect-these-metrics"><i class="fa fa-check"></i>6. How does changing resolution affect these metrics?</a></li>
<li class="chapter" data-level="" data-path="WE_10.html"><a href="WE_10.html#references"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="bonus-10a.html"><a href="bonus-10a.html"><i class="fa fa-check"></i><b>13.2</b> Bonus: ‘radish’ tutorial</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#overview-of-bonus-materials-1"><i class="fa fa-check"></i>1. Overview of Bonus Materials</a></li>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#import-data"><i class="fa fa-check"></i>2. Import data</a></li>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#basic-model-fitting"><i class="fa fa-check"></i>3. Basic model fitting</a></li>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#advanced-modeling-topics"><i class="fa fa-check"></i>4. Advanced modeling topics</a></li>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#summary"><i class="fa fa-check"></i>5. Summary</a></li>
<li class="chapter" data-level="" data-path="bonus-10a.html"><a href="bonus-10a.html#references-1"><i class="fa fa-check"></i>6. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="Week11.html"><a href="Week11.html"><i class="fa fa-check"></i><b>14</b> Week 11: Detecting Adaptation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="WE_11.html"><a href="WE_11.html"><i class="fa fa-check"></i><b>14.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#overview-of-worked-example-10"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#import-and-prepare-the-data"><i class="fa fa-check"></i>2. Import and prepare the data</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#latent-factor-mixed-models-lfmm-a-univariate-gea"><i class="fa fa-check"></i>3. Latent Factor Mixed Models (LFMM): a univariate GEA</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#redundancy-analysis-rda-a-multivariate-gea"><i class="fa fa-check"></i>4. Redundancy Analysis (RDA): a multivariate GEA</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#compare-lfmm-and-rda-candidates"><i class="fa fa-check"></i>5. Compare LFMM and RDA candidates</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#a-quick-note-on-controlling-for-population-structure-in-rda"><i class="fa fa-check"></i>6. A quick note on controlling for population structure in RDA</a></li>
<li class="chapter" data-level="" data-path="WE_11.html"><a href="WE_11.html#references-2"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="Week12.html"><a href="Week12.html"><i class="fa fa-check"></i><b>15</b> Week 12: Model Selection</a>
<ul>
<li class="chapter" data-level="15.1" data-path="WE_12.html"><a href="WE_12.html"><i class="fa fa-check"></i><b>15.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#overview-of-worked-example-11"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#fitting-candidate-models"><i class="fa fa-check"></i>2. Fitting candidate models</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#your-turn-to-test-additional-hypotheses"><i class="fa fa-check"></i>3. Your turn to test additional hypotheses!</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#nested-model-nmlpe-for-hierarchical-sampling-designs"><i class="fa fa-check"></i>4. Nested model (NMLPE) for hierarchical sampling designs</a></li>
<li class="chapter" data-level="" data-path="WE_12.html"><a href="WE_12.html#references-3"><i class="fa fa-check"></i>5. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="Week13.html"><a href="Week13.html"><i class="fa fa-check"></i><b>16</b> Week 13: Gravity Models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="WE_13.html"><a href="WE_13.html"><i class="fa fa-check"></i><b>16.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#overview-of-worked-example-12"><i class="fa fa-check"></i>1. Overview of Worked Example</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#setup"><i class="fa fa-check"></i>2. Setup</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#wetland-complex-data-preparation"><i class="fa fa-check"></i>3. Wetland complex data preparation</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#wetland-field-data-preparation"><i class="fa fa-check"></i>4. Wetland field-data preparation</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#saturated-graph"><i class="fa fa-check"></i>5. Saturated Graph</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#spatial-model-data-prepration"><i class="fa fa-check"></i>6. Spatial model data prepration</a></li>
<li class="chapter" data-level="" data-path="WE_13.html"><a href="WE_13.html#gravity-model"><i class="fa fa-check"></i>7. Gravity model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="Week14.html"><a href="Week14.html"><i class="fa fa-check"></i><b>17</b> Week 14: Contemporary Gene Flow</a>
<ul>
<li class="chapter" data-level="17.1" data-path="WE_14.html"><a href="WE_14.html"><i class="fa fa-check"></i><b>17.1</b> Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#overview-3"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#import-genotypes"><i class="fa fa-check"></i>2. Import Genotypes</a></li>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#pollen-pool-genetic-structure"><i class="fa fa-check"></i>3. Pollen pool genetic structure</a></li>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#paternity-analysis"><i class="fa fa-check"></i>4. Paternity analysis</a></li>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#linking-paternity-to-ecological-variables"><i class="fa fa-check"></i>5. Linking paternity to ecological variables</a></li>
<li class="chapter" data-level="" data-path="WE_14.html"><a href="WE_14.html#references-4"><i class="fa fa-check"></i>6. References</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Landscape Genetic Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="WE_6" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Worked Example<a href="WE_6.html#WE_6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Andrew Eckert, Katalin Csillery and Helene Wagner</p>
<div id="overview-of-worked-example-5" class="section level3 unnumbered hasAnchor">
<h3>1. Overview of Worked Example<a href="WE_6.html#overview-of-worked-example-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-goals-5" class="section level4 unnumbered hasAnchor">
<h4>a. Goals<a href="WE_6.html#a.-goals-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Justification</strong>: Natural selection acts on the heritable component of the total phenotypic variation. Traditionally, the heritable proportion of trait variation is estimated using information on the degree of relatedness between individuals. This approach (degree of relatedness) - extensively employed in breeding and evolutionary quantitative genetics – ignores the molecular underpinnings of traits. An alternative approach is scanning genomes using molecular markers to search for so-called outlier loci (see week 11), where selection invoked a change in allele frequencies that is detectable as unusual differentiation between populations in different environments. This approach (outlier loci) – advocated in population genetics - neglects information about the trait variation, but assumes that the markers are in or close to genes that code for adaptive traits. Genetic outliers often hard to interpret because generally we lack information what phenotype they affect and if this phenotype results in fitness differences between populations.</p>
<p><strong>Learning Objectives</strong>: This lab was constructed to give you experience in working with basic quantitative and population genetic analyses to test hypotheses about the presence of local adaptation. Similar to the genomic revolution, phenotyping is also undergoing a revolution thanks to developments e.g. in imagery that allow for a highly automated recording of traits; a task that has been extremely time consuming in the past. These developments will certainly advance the quantitative genetic approach in the future in evolutionary biology let alone breeding. By the end of the laboratory, you should be able to do the following:</p>
<ul>
<li>Construct, fit, and assess linear mixed effects models (LMMs) to estimate genetic values and variance components of a phenotypic trait measured in families, e.g. in a common garden experiments.</li>
<li>Use LMMs to estimate the heritability of a trait.</li>
<li>Test for the presence of unusual trait differentiation among populations relative to differentiation expected in the absence of adaptation</li>
<li>Assess if trait differentiation is correlated with differentiation in environmental variables to try identifying the selective component of the environment.</li>
</ul>
</div>
<div id="b.-data-set-4" class="section level4 unnumbered hasAnchor">
<h4>b. Data set<a href="WE_6.html#b.-data-set-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The data come from a study of western white pine (Pinus monticola Dougl. ex D. Don) sampled around the Lake Tahoe Basin of California and Nevada. These data consist of 157 trees sampled from 10 populations (n = 9 to 22 trees/population). Within each population, trees were sampled within three plots. For each plot, GPS coordinates were collected (i.e. each plot in each population has its own GPS coordinates) and used to generate a set of 7 environmental variables. From these trees, needle tissue was collected from which total DNA was extracted and genotyped for 164 single nucleotide polymorphisms (SNPs). Seeds were also collected and planted in a common garden. The seedlings (n = 5 to 35/tree) were measured for several phenotypic traits. The phenotypic trait we will be working with today is known as the carbon isotope ratio (<span class="math inline">\(δ^{13}C\)</span>). It is the ratio of two isotopes of carbon (<span class="math inline">\(^{13}C\)</span> and <span class="math inline">\(^{12}C\)</span>) relative to an experimental control, and it is strongly correlated with intrinsic water-use efficiency in plants. Plants need water to live, so it is not a stretch of the imagination to believe that this phenotypic trait has a link with plant fitness.</p>
<p>We will thus have the following data:</p>
<ul>
<li><strong>WWP_phenotype_data.txt</strong>: Phenotypic measurements for 5 seedlings per tree made in a common garden.</li>
<li><strong>WWP.ecogen</strong>: an <code>ecogen</code> object (package <code>EcoGenetics</code>) with SNP genotypes for all trees sampled in the field, and with environmental data collected from each plot within each population.</li>
</ul>
</div>
<div id="c.-required-r-packages-3" class="section level4 unnumbered hasAnchor">
<h4>c. Required R packages<a href="WE_6.html#c.-required-r-packages-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Install some packages needed for this worked example.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="WE_6.html#cb729-1" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;EcoGenetics&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb729-2"><a href="WE_6.html#cb729-2" tabindex="-1"></a>  remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;leandroroser/EcoGenetics-devel&quot;</span>)</span>
<span id="cb729-3"><a href="WE_6.html#cb729-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;QstFstComp&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;kjgilbert/QstFstComp&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="WE_6.html#cb730-1" tabindex="-1"></a><span class="fu">library</span>(LandGenCourse)</span>
<span id="cb730-2"><a href="WE_6.html#cb730-2" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb730-3"><a href="WE_6.html#cb730-3" tabindex="-1"></a><span class="co">#require(EcoGenetics)</span></span>
<span id="cb730-4"><a href="WE_6.html#cb730-4" tabindex="-1"></a><span class="fu">library</span>(methods)</span>
<span id="cb730-5"><a href="WE_6.html#cb730-5" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb730-6"><a href="WE_6.html#cb730-6" tabindex="-1"></a><span class="co">#require(lattice)</span></span>
<span id="cb730-7"><a href="WE_6.html#cb730-7" tabindex="-1"></a><span class="co">#require(MuMIn)</span></span>
<span id="cb730-8"><a href="WE_6.html#cb730-8" tabindex="-1"></a><span class="co">#require(predictmeans)</span></span>
<span id="cb730-9"><a href="WE_6.html#cb730-9" tabindex="-1"></a><span class="co">#require(nlme)</span></span>
<span id="cb730-10"><a href="WE_6.html#cb730-10" tabindex="-1"></a><span class="co">#require(QstFstComp)</span></span>
<span id="cb730-11"><a href="WE_6.html#cb730-11" tabindex="-1"></a><span class="co">#require(car)  </span></span></code></pre></div>
<p>Package <code>ggeffects</code> not automatically installed with <code>LandGenCourse</code>:</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="WE_6.html#cb731-1" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(ggeffects)) <span class="fu">install.packages</span>(<span class="st">&quot;ggeffects&quot;</span>, <span class="at">repos=</span><span class="st">&#39;http://cran.us.r-project.org&#39;</span>)</span></code></pre></div>
<p>Source two files with additional functions:</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="WE_6.html#cb732-1" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;supplemental_R_functions.R&quot;</span>, </span>
<span id="cb732-2"><a href="WE_6.html#cb732-2" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>))</span>
<span id="cb732-3"><a href="WE_6.html#cb732-3" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;panel.cor.r&quot;</span>, </span>
<span id="cb732-4"><a href="WE_6.html#cb732-4" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment" class="section level3 unnumbered hasAnchor">
<h3>2. Estimate genetic and non-genetic variance components from a common garden experiment<a href="WE_6.html#estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Motivation</strong>: A lot of genetics can be carried out without use of any molecular markers. Practitioners of empirical population genetics forget this quite often. A common garden allows us to create a standardized environment in which we minimize the influence of environment on the expression of a particular phenotypic trait. Phenotypic variation can be partitioned to genetic , environmental and residual components based on quantitative genetic theory. Further, we may also test for the presence of interaction between the genetic and environmental variation. The rationale of a common garden is to “standardize” the environment, thus phenotypic variation we observe is mainly due to genetic variation, even though environmental heterogeneity can never be completely eliminated and we still have to additionally control for it, e.g. using a block design (see below).</p>
<p><strong>Goals &amp; Background</strong>: The goal for this part of the laboratory is to construct, fit, and assess LMMs for <span class="math inline">\(δ^{13}C\)</span>. We will be using the data in the file named “WWP_phenotypic_data.txt”. These data are organized in a tab-delimited text file with seedlings grouped by maternal tree (i.e. its mother tree), plot, and population. Also included is an experimental treatment known as “block”. In a common garden, seedlings from the same maternal tree are randomized among blocks to avoid the influence of micro-environmental variation on expression of phenotypic traits.</p>
<div id="a.-import-phenytypic-data" class="section level4 unnumbered hasAnchor">
<h4>a. Import phenytypic data<a href="WE_6.html#a.-import-phenytypic-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="WE_6.html#cb733-1" tabindex="-1"></a>phen <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;WWP_phenotype_data.txt&quot;</span>, </span>
<span id="cb733-2"><a href="WE_6.html#cb733-2" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb733-3"><a href="WE_6.html#cb733-3" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">as_tibble</span>(phen)</span></code></pre></div>
<pre><code>## # A tibble: 779 × 5
##    population plot  family block  d13c
##    &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1 blk cyn    BC1       59     5 -30.2
##  2 blk cyn    BC1       59     2 -29.7
##  3 blk cyn    BC1       59     4 -29.6
##  4 blk cyn    BC1       59     3 -29.2
##  5 blk cyn    BC1       59     1 -29.0
##  6 blk cyn    BC1       60     4 -31.2
##  7 blk cyn    BC1       60     3 -30.7
##  8 blk cyn    BC1       60     1 -30.5
##  9 blk cyn    BC1       60     5 -30.1
## 10 blk cyn    BC1       60     2 -29.3
## # ℹ 769 more rows</code></pre>
<p>Check the variable types: <code>family</code> and <code>block</code> have been imported as type “integer”, and we need to convert them to “factor” first.</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="WE_6.html#cb735-1" tabindex="-1"></a>phen<span class="sc">$</span>family <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(phen<span class="sc">$</span>family)</span>
<span id="cb735-2"><a href="WE_6.html#cb735-2" tabindex="-1"></a>phen<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(phen<span class="sc">$</span>block)</span>
<span id="cb735-3"><a href="WE_6.html#cb735-3" tabindex="-1"></a><span class="fu">sapply</span>(phen, class)</span></code></pre></div>
<pre><code>##  population        plot      family       block        d13c 
## &quot;character&quot; &quot;character&quot;    &quot;factor&quot;    &quot;factor&quot;   &quot;numeric&quot;</code></pre>
</div>
<div id="b.-fit-linear-mixed-effects-models-lmm-to-trait-data-observed-on-families" class="section level4 unnumbered hasAnchor">
<h4>b. Fit linear mixed effects models (LMM) to trait data observed on families<a href="WE_6.html#b.-fit-linear-mixed-effects-models-lmm-to-trait-data-observed-on-families" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now,we are ready to fit a series of linear models. Here we will fit four models in total, though the last two are equivalent for our data:
- <strong>mod1</strong>: a model with only fixed effects (<code>intercept</code> and <code>block</code>),
- <strong>mod2</strong>: a LMM with the fixed effects and a random effect due to <code>family</code>, and
- <strong>mod3</strong>: a LMM where the random effect due to <code>family</code> is nested within <code>population</code>. We will thus be ignoring the variable <code>plot</code>.
- <strong>mod4</strong>: a LMM where the nesting of <code>family</code> within <code>population</code> is not explicitly specified, it is implied by the data. This model makes sense only if each family has a unique ID, so that there are no families from other populations that have the same ID.</p>
<p><strong>Disclaimer</strong>: <code>mod1</code> is not a valid model because it ignores the pseudo-replication that arises from the hierarchical sampling design. The goal of using random effects (for family, or family and plot), in the other models is to account for this.</p>
<p>Note: <code>d13c ~ 1 + block</code> is equivalent to <code>d13c ~ block</code> (see video, Part 1).</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="WE_6.html#cb737-1" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(d13c <span class="sc">~</span> block, <span class="at">data =</span> phen)</span>
<span id="cb737-2"><a href="WE_6.html#cb737-2" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(d13c <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>family) <span class="sc">+</span> block,<span class="at">data =</span> phen, <span class="at">REML =</span> <span class="cn">TRUE</span>)</span>
<span id="cb737-3"><a href="WE_6.html#cb737-3" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(d13c <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>population<span class="sc">/</span>family) <span class="sc">+</span> block, </span>
<span id="cb737-4"><a href="WE_6.html#cb737-4" tabindex="-1"></a>                   <span class="at">data =</span> phen, <span class="at">REML =</span> <span class="cn">TRUE</span>)</span>
<span id="cb737-5"><a href="WE_6.html#cb737-5" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(d13c <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>population) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>family) <span class="sc">+</span> block, </span>
<span id="cb737-6"><a href="WE_6.html#cb737-6" tabindex="-1"></a>                   <span class="at">data =</span> phen, <span class="at">REML =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Models <code>mod3</code> and <code>mod4</code> produce identical results, <strong>as long as each family has its own unique ID</strong>. In the following, we will use <code>mod4</code> as it simplifies interpretation (as commonly used in quantitative genetics).</p>
<p>Notice that we are using <code>REML=TRUE</code>, which stands for restricted maximum likelihood. This method is advised for quantitative genetic analysis, because it provides correct (statistically unbiased) estimates of the variance components. The other approach would be to set <code>REML=FALSE</code>, in which case the method used is ML or maximum likelihood. However, ML generally underestimates the residual variance, thus leading to inflated estimates of the family variance and thus the heritability. ML would be needed e.g. to test fixed effects.</p>
</div>
<div id="c.-compare-model-fit" class="section level4 unnumbered hasAnchor">
<h4>c. Compare model fit<a href="WE_6.html#c.-compare-model-fit" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now, let’s explore which model best fits our data. To do this we will use the Akaike Information Criterion (AIC). This statistic scores model fit while giving a penalty for the number of parameters in a model. The model with the lowest score is the preferred model. We will learn more about model selection with AIC (and related measures like AICc, BIC) in Week 12.</p>
<p>How do we ensure that the AIC values of the different models are comparable?</p>
<ul>
<li>For <code>mod1</code> that was fitted with function <code>lm'</code>, we use the function <code>AIC</code>.</li>
<li>For the other models that were fitted with <code>lmer</code>, we use <code>extractAIC</code>.</li>
</ul>
<p>For model comparison purposes, we have to use the ML fit, as AIC is not valid for REML (see video). The function <code>extractAIC</code> refits the models with ‘REML=FALSE’ to obtain AIC values that are comparable between models with different fixed effects (though this does not apply here because the fixed effects were the same), or between models fitted with functions <code>lm</code> and <code>lmer</code>. It returns two values, the first is the “equivalent degrees of freedom” of the fitted model, and the second is the “AIC” value. Here we only extract the second value.</p>
<p>Note: the function <code>extractAIC</code> does not allow to calculate AICc, which is the AIC with small sample correction (see Week 12).</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="WE_6.html#cb738-1" tabindex="-1"></a>aic_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">AIC</span>(mod1), <span class="fu">extractAIC</span>(mod2)[<span class="dv">2</span>], <span class="fu">extractAIC</span>(mod3)[<span class="dv">2</span>], </span>
<span id="cb738-2"><a href="WE_6.html#cb738-2" tabindex="-1"></a>              <span class="fu">extractAIC</span>(mod4)[<span class="dv">2</span>])</span>
<span id="cb738-3"><a href="WE_6.html#cb738-3" tabindex="-1"></a><span class="fu">names</span>(aic_vals) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mod1&quot;</span>,<span class="st">&quot;mod2&quot;</span>,<span class="st">&quot;mod3&quot;</span>, <span class="st">&quot;mod4&quot;</span>)</span>
<span id="cb738-4"><a href="WE_6.html#cb738-4" tabindex="-1"></a>aic_vals</span></code></pre></div>
<pre><code>##     mod1     mod2     mod3     mod4 
## 2120.987 2080.266 2051.207 2051.207</code></pre>
<p>Hence, model <code>mod3</code> (and its equivalent <code>mod4</code>) appears to be the best model. This suggests that there are important differences among populations, and among trees within populations.</p>
<p>We will learn more about model selection later in the course (Week 12).</p>
</div>
<div id="d.-check-model-validity" class="section level4 unnumbered hasAnchor">
<h4>d. Check model validity<a href="WE_6.html#d.-check-model-validity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Is the model <code>mod4</code> valid? Let’s check the residuals (see video!).</p>
<p>The function <code>residplot</code> from package <code>predictmeans</code> produces four diagnostic plots for a model fitted with <code>lmer</code>. The option <code>level</code> indicates which random factor should be plotted (here: 1 = family, 2 = population). This function uses the “conditional” residuals, which represent <code>observed - fitted(fixed) - fitted(random)</code>. The option <code>newwd=FALSE</code> specifies that no new window should be created for the plot - this setting is necessary for the knitted R notebook to actually show the figure.</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="WE_6.html#cb740-1" tabindex="-1"></a>predictmeans<span class="sc">::</span><span class="fu">residplot</span>(mod4, <span class="at">group=</span><span class="st">&quot;population&quot;</span>, <span class="at">level=</span><span class="dv">1</span>, <span class="at">newwd=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in checkDepPackageVersion(dep_pkg = &quot;TMB&quot;): Package version inconsistency detected.
## glmmTMB was built with TMB version 1.9.6
## Current TMB version is 1.9.10
## Please re-install glmmTMB from source or restore original &#39;TMB&#39; package (see &#39;?reinstalling&#39; for more information)</code></pre>
<p><img src="06-Week06_files/figure-html/unnamed-chunk-17-1.png" width="768" /></p>
<p>Hint: You may need to use the arrow symbols to scroll through the plots in the ‘Plot’ tab in RStudio.</p>
<p>The plots are:</p>
<ul>
<li>A normal probability plot of the random effect <code>family</code>: points should follow line.</li>
<li>A normal probability plot of (conditional) residuals: points should follow line.</li>
<li>A scatterplot of the (conditional) residuals against fitted values: the plot should not “thicken” (which would indicate differences in variances between groups such as blocks = heteroscedasticity). Due to the option <code>group = "population"</code>, residuals are colored by population.</li>
<li>A plot of fitted values against observed: the scatterplot shows the overall model fit, where points would fall on a line if the model explained 100% of the variation in the response (you can ignore the dashed line).</li>
</ul>
<p>In addition, we may want to look for outliers and influential points. For this, we create two additional plots. Here we use marginal residuals, which are calculated without accounting for random effects: <code>observed - fitted(fixed)</code>.</p>
<ul>
<li>A plot of marginal residuals against the fixed effect <code>block</code>: there should not be any large outliers.<br />
</li>
<li>A plot of Cook’s distances, where D &gt; 1 indicates influential points (more relevant when using quantitative predictors (covariates). Note: this may take a while to calculate.</li>
</ul>
<p>First we calculate the marginal residuals by predicting values with fixed effects only (<code>re.form=NA</code>) and subtract these fitted values from the observed values.</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="WE_6.html#cb742-1" tabindex="-1"></a>marginal.residuals <span class="ot">&lt;-</span> mod4<span class="sc">@</span>frame<span class="sc">$</span>d13c <span class="sc">-</span> <span class="fu">predict</span>(mod4, <span class="at">re.form=</span><span class="cn">NA</span>)</span>
<span id="cb742-2"><a href="WE_6.html#cb742-2" tabindex="-1"></a><span class="fu">plot</span>(mod4<span class="sc">@</span>frame<span class="sc">$</span>block, marginal.residuals)</span></code></pre></div>
<p><img src="06-Week06_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="WE_6.html#cb743-1" tabindex="-1"></a><span class="co">#predictmeans::CookD(mod4)</span></span>
<span id="cb743-2"><a href="WE_6.html#cb743-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(mod4))</span></code></pre></div>
<p><img src="06-Week06_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<p>The residual plots did not indicate any major problem. Hence we can proceed with interpreting the results.</p>
<p>Note: As an alternative, the R package <code>DHARMa</code> uses a simulation-based approach to provide residual diagnostics for hierachical (multi-level / mixed) regression models:
<a href="https://theoreticalecology.wordpress.com/2016/08/28/dharma-an-r-package-for-residual-diagnostics-of-glmms/" class="uri">https://theoreticalecology.wordpress.com/2016/08/28/dharma-an-r-package-for-residual-diagnostics-of-glmms/</a></p>
</div>
<div id="e.-estimate-variance-components" class="section level4 unnumbered hasAnchor">
<h4>e. Estimate variance components<a href="WE_6.html#e.-estimate-variance-components" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>How much of the variation in <span class="math inline">\(d^{13}C\)</span>’ is explained by the fixed and random effects? In models fitted with the function <code>lm</code>, we use the <span class="math inline">\(R^2\)</span> statistics to describe the total variance in the response explained by all the predictors in the model. In a mixed effects modeling context, there is no longer an obvious definition for <span class="math inline">\(R^2\)</span>. Two approximate <span class="math inline">\(R^2\)</span> statistics have been implemented in the function <code>r.squaredGLMM</code> from the package <code>MuMIn</code> (which stands for multi-model inference):</p>
<ul>
<li>R2m: marginal <span class="math inline">\(R^2\)</span>. This is the variance explained by fixed factors.</li>
<li>R2c: conditional <span class="math inline">\(R^2\)</span>. This is interpreted as the variance explained by both fixed and random factors, i.e., the entire model.</li>
</ul>
<p>In both statistics, the denominator is a sum of the fixed-effects variance, the random effect variance, and the residual variance.</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="WE_6.html#cb744-1" tabindex="-1"></a>MuMIn<span class="sc">::</span><span class="fu">r.squaredGLMM</span>(mod4)</span></code></pre></div>
<pre><code>## Warning: &#39;r.squaredGLMM&#39; now calculates a revised statistic. See the help page.</code></pre>
<pre><code>##             R2m       R2c
## [1,] 0.02466321 0.2297893</code></pre>
<p>The fixed effect <code>block</code> had a small effect of about 2.5%. The total model explained about 23%, most of which was due to the random effects.</p>
<p>How important are the random factors <code>population</code> and <code>family</code>? The summary for <code>mod4</code> lists the variance components under “Random effects”.</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="WE_6.html#cb747-1" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: d13c ~ 1 + (1 | population) + (1 | family) + block
##    Data: phen
## 
## REML criterion at convergence: 2050.4
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.5436 -0.7485  0.0151  0.6028  3.7867 
## 
## Random effects:
##  Groups     Name        Variance Std.Dev.
##  family     (Intercept) 0.08164  0.2857  
##  population (Intercept) 0.10859  0.3295  
##  Residual               0.71429  0.8452  
## Number of obs: 779, groups:  family, 157; population, 10
## 
## Fixed effects:
##              Estimate Std. Error  t value
## (Intercept) -30.62635    0.12666 -241.792
## block2       -0.13833    0.09667   -1.431
## block3       -0.35071    0.09520   -3.684
## block4       -0.10060    0.09538   -1.055
## block5       -0.39443    0.09651   -4.087
## 
## Correlation of Fixed Effects:
##        (Intr) block2 block3 block4
## block2 -0.374                     
## block3 -0.379  0.498              
## block4 -0.378  0.497  0.505       
## block5 -0.374  0.492  0.499  0.496</code></pre>
<p>Here we extract these variance components from the summary and divide by their sum.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="WE_6.html#cb749-1" tabindex="-1"></a>fam.var <span class="ot">&lt;-</span> nlme<span class="sc">::</span><span class="fu">VarCorr</span>(mod4)<span class="sc">$</span><span class="st">&quot;family&quot;</span>[<span class="dv">1</span>]</span>
<span id="cb749-2"><a href="WE_6.html#cb749-2" tabindex="-1"></a>pop.var <span class="ot">&lt;-</span> nlme<span class="sc">::</span><span class="fu">VarCorr</span>(mod4)<span class="sc">$</span><span class="st">&quot;population&quot;</span>[<span class="dv">1</span>]</span>
<span id="cb749-3"><a href="WE_6.html#cb749-3" tabindex="-1"></a>res.var <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod4)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb749-4"><a href="WE_6.html#cb749-4" tabindex="-1"></a></span>
<span id="cb749-5"><a href="WE_6.html#cb749-5" tabindex="-1"></a>Components <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(fam.var, pop.var, res.var)</span>
<span id="cb749-6"><a href="WE_6.html#cb749-6" tabindex="-1"></a>Components <span class="sc">/</span> <span class="fu">sum</span>(Components)</span></code></pre></div>
<pre><code>##      fam.var   pop.var   res.var
## 1 0.09026004 0.1200531 0.7896869</code></pre>
<p>Compared to Cohen’s (1988) effect sizes, population and family each had a medium-size effect (&gt; 9% variance explained) on d13c values.</p>
</div>
<div id="f.-significance-testing" class="section level4 unnumbered hasAnchor">
<h4>f. Significance testing<a href="WE_6.html#f.-significance-testing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In quantitative genetics, we are more interested in estimating variance components and the size of effects than in hypothesis testing. In other contexts, however, linear mixed models are often used to test fixed effects while accounting for the random effects. Let’s see how this works.</p>
<p>The confusing part is that we need to fit the model differently to test fixed and random effects (seee video). For testing the random effects, we can use model <code>mod4</code> that was fitted with <code>REML=TRUE</code>.</p>
<p>The simplest way to test the significance of a random effect is to calculate the model with and without it and use <code>anova()</code> to test whether the more complex model (listed first) explains significantly more than the simpler model. This implements a likelihood ratio test (LR). By default, when used for a model fitted with <code>lmer</code>, <code>anova</code> will refit the models with ML. Here we use the option <code>refit=FALSE</code> to prevent this.</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="WE_6.html#cb751-1" tabindex="-1"></a><span class="co">#mod.noPop &lt;- update(mod4, .~. -(1 | population))</span></span>
<span id="cb751-2"><a href="WE_6.html#cb751-2" tabindex="-1"></a>mod.noPop <span class="ot">&lt;-</span> <span class="fu">lmer</span>(d13c <span class="sc">~</span> <span class="dv">1</span>  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> family) <span class="sc">+</span> block, <span class="at">data=</span>phen, <span class="at">REML=</span><span class="cn">TRUE</span>)</span>
<span id="cb751-3"><a href="WE_6.html#cb751-3" tabindex="-1"></a>mod.noFam <span class="ot">&lt;-</span> <span class="fu">lmer</span>(d13c <span class="sc">~</span> <span class="dv">1</span>  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> population) <span class="sc">+</span> block, <span class="at">data=</span>phen, <span class="at">REML=</span><span class="cn">TRUE</span>)</span>
<span id="cb751-4"><a href="WE_6.html#cb751-4" tabindex="-1"></a><span class="fu">anova</span>(mod4, mod.noPop, <span class="at">refit=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Data: phen
## Models:
## mod.noPop: d13c ~ 1 + (1 | family) + block
## mod4: d13c ~ 1 + (1 | population) + (1 | family) + block
##           npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
## mod.noPop    7 2097.2 2129.8 -1041.6   2083.2                         
## mod4         8 2066.4 2103.7 -1025.2   2050.4 32.819  1  1.012e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="WE_6.html#cb753-1" tabindex="-1"></a><span class="fu">anova</span>(mod4, mod.noFam, <span class="at">refit=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Data: phen
## Models:
## mod.noFam: d13c ~ 1 + (1 | population) + block
## mod4: d13c ~ 1 + (1 | population) + (1 | family) + block
##           npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
## mod.noFam    7 2077.4 2110.0 -1031.7   2063.4                         
## mod4         8 2066.4 2103.7 -1025.2   2050.4 12.996  1  0.0003122 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We can do a similar test for the fixed effects (see video). Here we have only one effect. Note that we tell the function <code>anova</code> to refit the model with ML (i.e., <code>REML=FALSE</code>).</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="WE_6.html#cb755-1" tabindex="-1"></a>mod.noBlock <span class="ot">&lt;-</span> <span class="fu">lmer</span>(d13c <span class="sc">~</span> <span class="dv">1</span>  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> population) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> family), <span class="at">data=</span>phen, <span class="at">REML=</span><span class="cn">TRUE</span>)</span>
<span id="cb755-2"><a href="WE_6.html#cb755-2" tabindex="-1"></a>mod.noFam <span class="ot">&lt;-</span> <span class="fu">lmer</span>(d13c <span class="sc">~</span> <span class="dv">1</span>  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> population) <span class="sc">+</span> block, <span class="at">data=</span>phen, <span class="at">REML=</span><span class="cn">TRUE</span>)</span>
<span id="cb755-3"><a href="WE_6.html#cb755-3" tabindex="-1"></a><span class="fu">anova</span>(mod4, mod.noBlock, <span class="at">refit=</span><span class="cn">TRUE</span>, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: phen
## Models:
## mod.noBlock: d13c ~ 1 + (1 | population) + (1 | family)
## mod4: d13c ~ 1 + (1 | population) + (1 | family) + block
##             npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
## mod.noBlock    4 2067.7 2086.3 -1029.8   2059.7                         
## mod4           8 2051.2 2088.5 -1017.6   2035.2 24.454  4  6.475e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The output shows two lines of results, one for each model that was compared. The last column, with the p-value <code>Pr(&gt;Chisq)</code>, tells us that model <code>mod4</code>, with the fixed effect <code>block</code>, is statistically significantly better than the simpler model <code>mod.noBlock</code> without the fixed effect <code>block</code>. This means that the block effect is statistically significant at a significance level of alpha = 0.05 (p-value &lt; alpha).</p>
<p>We can also base our interpretation on the AIC: model <code>mod4</code> has a lower AIC value and is thus considered better than model <code>mod.noBlock</code>. (See Week 12 for an introduction to model selection).</p>
<p>If we have several fixed effects, it may be more convenient to use function <code>Anova</code> from the <code>car</code> package to perform a Wald chi-square test. However, the model must be fitted with ML. Choose between type II and type II sums of squares (see video).</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="WE_6.html#cb758-1" tabindex="-1"></a>mod4.ML <span class="ot">&lt;-</span> <span class="fu">lmer</span>(d13c <span class="sc">~</span> <span class="dv">1</span>  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> population) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> family) <span class="sc">+</span> block, </span>
<span id="cb758-2"><a href="WE_6.html#cb758-2" tabindex="-1"></a>                <span class="at">data=</span>phen, <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb758-3"><a href="WE_6.html#cb758-3" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mod4.ML, <span class="at">type=</span><span class="st">&quot;II&quot;</span>, <span class="at">test.statistic=</span><span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: d13c
##        Chisq Df Pr(&gt;Chisq)    
## block 24.905  4  5.257e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>This will return one line per fixed effect, each with a p-value (<code>Pr(&gt;Chisq)</code>). We see that the block effect is statistically significant at a significance level of alpha = 0.05 (p-value &lt; alpha).</p>
<p>This result suggests that in the common garden experiment, there were differences in d13c among the seeds that are associated with blocks, i.e., the blocks did not provide exactly the same growing conditions. That is why it is so important to repeat all treatments (here: families) within each block, rather than planting the seeds from one family in one block and the seeds from another family in a different block. Because the common garden experiment was properly designed, we can include the variable <code>block</code> in the model to test and account for this effect. We included it as a fixed effect, though if there were six or more blocks, we would include it as a random effect. Either way will work to account for differences between blocks.</p>
</div>
</div>
<div id="estimate-trait-heritability" class="section level3 unnumbered hasAnchor">
<h3>3. Estimate trait heritability<a href="WE_6.html#estimate-trait-heritability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Motivation</strong>: Now that we have learned how to estimate genetic values for <span class="math inline">\(δ^{13}C\)</span>, let’s learn how to estimate what fraction of the total variation in trait values is due to genetic effects. More precisely, we shall estimate the heritable proportion of the trait variation. Not all genetic effects are transmitted from one generation to the next, but the so-called additive genetic effects (see Week 6 lecture). Here we have data on half-siblings because seeds come from the same mother tree, but their father is most likely different because our species is wind pollinated. In such family structure, the estimation of the additive genetic variance is straightforward because these analyses provide key information about whether or not local adaptation should even be considered. Remember that local adaptation is about genetically determined phenotypes that vary across environments in responses to differing selective pressures. This step allows us to assess how genetic variation for a phenotypic trait is distributed across the landscape.</p>
<p><strong>Goals &amp; Background</strong>: The goal for this part of the laboratory is to estimate heritability, trait differentiation, and correlation with environment for trait values determined in Part 1. To do this, we will be using the output from the previous part of the laboratory and the environmental data contained in the file named <code>WWP_environmental_data.txt</code>. As with the phenotype file this is a tab-delimited text file.</p>
<div id="a.-estimate-heritability" class="section level4 unnumbered hasAnchor">
<h4>a. Estimate heritability<a href="WE_6.html#a.-estimate-heritability" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s start with estimating the heritability of <span class="math inline">\(δ^{13}C\)</span>. If you remember from your undergraduate evolution course, heritability refers generally to the proportion of phenotypic variance due to genetic variance. It comes in at least two different versions. The version we are interested in is narrow-sense heritability (<span class="math inline">\(h^2\)</span>), which is defined as the ratio of additive genetic variance to total phenotypic variance:</p>
<p><span class="math display">\[h^{2} = \frac{\sigma^{2}_{additive}}{\sigma^{2}_{total}}\]</span>
We need to extract the variance components from <code>mod4</code> for all model terms. We do this visually by printing mod3 to screen or using a set of functions applied to <code>mod4</code>. Here, we will do both.</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="WE_6.html#cb760-1" tabindex="-1"></a>mod4</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: d13c ~ 1 + (1 | population) + (1 | family) + block
##    Data: phen
## REML criterion at convergence: 2050.381
## Random effects:
##  Groups     Name        Std.Dev.
##  family     (Intercept) 0.2857  
##  population (Intercept) 0.3295  
##  Residual               0.8452  
## Number of obs: 779, groups:  family, 157; population, 10
## Fixed Effects:
## (Intercept)       block2       block3       block4       block5  
##    -30.6263      -0.1383      -0.3507      -0.1006      -0.3944</code></pre>
<p>Using the results from above, let’s calculate <span class="math inline">\(h^2\)</span>. If we assume that the seedlings from each maternal tree are half-siblings (i.e. same mom, but each with a different father) then <span class="math inline">\(σ^2_A = 4 σ^2_{family}\)</span> (so variance due to family). If the seedlings were all full-siblings, then the 4 would be replaced with 2. Let’s assume half-siblings. We can then do the following:</p>
<p>Copying the values visually from the output above (note that we need to square the standard deviations to get the variances):</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="WE_6.html#cb762-1" tabindex="-1"></a>add_var <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">*</span>(<span class="fl">0.2857</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb762-2"><a href="WE_6.html#cb762-2" tabindex="-1"></a>total_wp_var <span class="ot">&lt;-</span> (<span class="fl">0.2857</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="fl">0.3295</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="fl">0.8452</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb762-3"><a href="WE_6.html#cb762-3" tabindex="-1"></a>h2 <span class="ot">&lt;-</span> add_var<span class="sc">/</span>total_wp_var</span>
<span id="cb762-4"><a href="WE_6.html#cb762-4" tabindex="-1"></a>h2</span></code></pre></div>
<pre><code>## [1] 0.3609476</code></pre>
<p>And the same using the variance components from above:</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="WE_6.html#cb764-1" tabindex="-1"></a>one.over.relatedness <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fl">0.25</span></span>
<span id="cb764-2"><a href="WE_6.html#cb764-2" tabindex="-1"></a>h2 <span class="ot">&lt;-</span> (one.over.relatedness<span class="sc">*</span>Components<span class="sc">$</span>fam.var) <span class="sc">/</span> <span class="fu">sum</span>(Components)</span>
<span id="cb764-3"><a href="WE_6.html#cb764-3" tabindex="-1"></a>h2</span></code></pre></div>
<pre><code>## [1] 0.3610402</code></pre>
<p><strong>Question:</strong> Inspect your value of <span class="math inline">\(h^2\)</span>. What does it mean?</p>
<p>We have generated a point estimate for <span class="math inline">\(h^2\)</span>. It represents the average <span class="math inline">\(h^2\)</span> across populations after removing the genetic effects due to population differences. To take this further and also get a SE (so that you can construct a confidence interval), you could check out this R package:
<a href="https://bioconductor.org/packages/release/bioc/html/GeneticsPed.html" class="uri">https://bioconductor.org/packages/release/bioc/html/GeneticsPed.html</a></p>
</div>
<div id="b.-estimate-trait-differentiation" class="section level4 unnumbered hasAnchor">
<h4>b. Estimate trait differentiation<a href="WE_6.html#b.-estimate-trait-differentiation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Great, we have shown that within population genetic variation is statistically greater than zero. What about among population genetic variation? Let’s get to that right now. To measure among population genetic variation we will use a statistic known as <span class="math inline">\(Q_{ST}\)</span>. It is similar in concept to <span class="math inline">\(F_{ST}\)</span> from population genetics. To estimate <span class="math inline">\(Q_{ST}\)</span>, we will use our LMM output again. If we assume that all seedlings are again half-siblings, then:</p>
<p><span class="math display">\[Q_{ST} = \frac{\sigma^{2}_{population}}
{\sigma^{2}_{population}+8\sigma^{2}_{family}}\]</span></p>
<p>Again, we can do this by copying the values visually from the output:</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="WE_6.html#cb766-1" tabindex="-1"></a>num_qst <span class="ot">&lt;-</span> <span class="fl">0.3295</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb766-2"><a href="WE_6.html#cb766-2" tabindex="-1"></a>dem_qst <span class="ot">&lt;-</span> <span class="fl">0.3295</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">8</span><span class="sc">*</span>(<span class="fl">0.2857</span><span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb766-3"><a href="WE_6.html#cb766-3" tabindex="-1"></a>qst <span class="ot">&lt;-</span> num_qst<span class="sc">/</span>dem_qst</span>
<span id="cb766-4"><a href="WE_6.html#cb766-4" tabindex="-1"></a>qst</span></code></pre></div>
<pre><code>## [1] 0.1425618</code></pre>
<p>Or using the variance components from above:</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="WE_6.html#cb768-1" tabindex="-1"></a>num_qst <span class="ot">&lt;-</span> Components<span class="sc">$</span>prov.var</span>
<span id="cb768-2"><a href="WE_6.html#cb768-2" tabindex="-1"></a>dem_qst <span class="ot">&lt;-</span> Components<span class="sc">$</span>prov.var <span class="sc">+</span> (<span class="dv">8</span><span class="sc">*</span>Components<span class="sc">$</span>fam.var)</span>
<span id="cb768-3"><a href="WE_6.html#cb768-3" tabindex="-1"></a>qst <span class="ot">&lt;-</span> num_qst<span class="sc">/</span>dem_qst</span>
<span id="cb768-4"><a href="WE_6.html#cb768-4" tabindex="-1"></a>qst</span></code></pre></div>
<pre><code>## numeric(0)</code></pre>
<p><strong>Question:</strong> Inspect your ‘qst’ value:</p>
<ul>
<li>What does it mean?</li>
<li>Look at the quantities in the equation above, what is the denominator equal to? Is it the total phenotypic variance or the total genetic variance?</li>
</ul>
</div>
</div>
<div id="compare-q_st-to-f_st-measured-from-snp-data" class="section level3 unnumbered hasAnchor">
<h3>4. Compare <span class="math inline">\(Q_{st}\)</span> to <span class="math inline">\(F_{st}\)</span> measured from SNP data<a href="WE_6.html#compare-q_st-to-f_st-measured-from-snp-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you want to learn more about analyzing SNP data in R, here are some resources:</p>
<ul>
<li><strong>adegenet SNP tutorial</strong>: <a href="http://adegenet.r-forge.r-project.org/files/tutorial-genomics.pdf" class="uri">http://adegenet.r-forge.r-project.org/files/tutorial-genomics.pdf</a></li>
<li><strong>popgen.nescent.org</strong> (click on ‘Users’ tab): <a href="http://popgen.nescent.org/" class="uri">http://popgen.nescent.org/</a></li>
</ul>
<div id="a.-import-ecogen-object" class="section level4 unnumbered hasAnchor">
<h4>a. Import ‘ecogen’ object<a href="WE_6.html#a.-import-ecogen-object" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Load the data set ‘WWP.ecogen’.</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="WE_6.html#cb770-1" tabindex="-1"></a><span class="fu">data</span>(WWP.ecogen, <span class="at">package=</span><span class="st">&quot;LandGenCourse&quot;</span>)</span></code></pre></div>
<p>This ‘ecogen’ object has information in the following slots:</p>
<ul>
<li><strong>XY</strong>: data frame with spatial coordinates (here: longitude, latitude)</li>
<li><strong>P</strong>: data frame with phenotypic traits (here: intercept, family effects and population effects from mod4)</li>
<li><strong>G</strong>: data frame with genotypic data (here: 164 SNPs)</li>
<li><strong>A</strong>: generated automatically from G: matrix of allele counts (codominant markers only)</li>
<li><strong>E</strong>: data frame with environmental data (here: 7 bioclimatic site variables)</li>
<li><strong>S</strong>: data frame with structure (hierarchical sampling levels)</li>
</ul>
</div>
<div id="b.-compare-q_st-to-f_st" class="section level4 unnumbered hasAnchor">
<h4>b. Compare <span class="math inline">\(Q_{ST}\)</span> to <span class="math inline">\(F_{ST}\)</span><a href="WE_6.html#b.-compare-q_st-to-f_st" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>See ‘Week 6 Bonus Material’ for calculating Fst from the SNP data.</p>
<p>Here, we will use the <code>QstFstComp</code> package to formally test whether or not <span class="math inline">\(Q_{ST} &gt; F_{ST}\)</span> for <span class="math inline">\(δ^{13}C\)</span>. The function <code>QstFstComp</code> from the package with the same name calculates both <span class="math inline">\(Q_{ST}\)</span> and <span class="math inline">\(F_{ST}\)</span> itself, then tests whether they are different from each other.</p>
<p>Note: as this is a permutation test, if you run it several times, the results may change slightly from run to run.</p>
<p>First, however, we need to re-format the data to the format that <code>QstFstComp</code> expects. This is easy with the function <code>ecogen2hierfstat</code>.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="WE_6.html#cb771-1" tabindex="-1"></a>WWP.hierfstat <span class="ot">&lt;-</span> EcoGenetics<span class="sc">::</span><span class="fu">ecogen2hierfstat</span>(WWP.ecogen, <span class="at">pop=</span><span class="st">&#39;population&#39;</span>, </span>
<span id="cb771-2"><a href="WE_6.html#cb771-2" tabindex="-1"></a>                                  <span class="at">to_numeric=</span><span class="cn">TRUE</span>, <span class="at">nout=</span><span class="dv">1</span>)</span>
<span id="cb771-3"><a href="WE_6.html#cb771-3" tabindex="-1"></a>phen_mod <span class="ot">&lt;-</span> phen[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]</span>
<span id="cb771-4"><a href="WE_6.html#cb771-4" tabindex="-1"></a>QstFst_out <span class="ot">&lt;-</span> QstFstComp<span class="sc">::</span><span class="fu">QstFstComp</span>(<span class="at">fst.dat =</span> WWP.hierfstat, </span>
<span id="cb771-5"><a href="WE_6.html#cb771-5" tabindex="-1"></a>                                     <span class="at">qst.dat =</span> phen_mod, </span>
<span id="cb771-6"><a href="WE_6.html#cb771-6" tabindex="-1"></a>                                     <span class="at">numpops =</span> <span class="fu">nlevels</span>(WWP<span class="sc">@</span>S<span class="sc">$</span>population), </span>
<span id="cb771-7"><a href="WE_6.html#cb771-7" tabindex="-1"></a>                                     <span class="at">nsim =</span> <span class="dv">10000</span>, </span>
<span id="cb771-8"><a href="WE_6.html#cb771-8" tabindex="-1"></a>                                     <span class="at">breeding.design =</span> <span class="st">&quot;half.sib.dam&quot;</span>,</span>
<span id="cb771-9"><a href="WE_6.html#cb771-9" tabindex="-1"></a>                                     <span class="at">dam.offspring.relatedness =</span> <span class="fl">0.25</span>, </span>
<span id="cb771-10"><a href="WE_6.html#cb771-10" tabindex="-1"></a>                                     <span class="at">output =</span> <span class="st">&quot;concise_nowrite&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;No output file of Q minus F values written.&quot;</code></pre>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="WE_6.html#cb773-1" tabindex="-1"></a>QstFst_out</span></code></pre></div>
<pre><code>## [[1]]
##            Calculated Qst-Fst  Lower Bound crit. value.2.5% 
##                    0.11917632                   -0.02717074 
## Upper bound crit. value.97.5% 
##                    0.06354485 
## 
## [[2]]
## [1] &quot;Qst-Fst values output to file: /Users/helene/Desktop/R_Github_projects/LandGenCourse_book/vignettes/QminusFvalues_2024-01-25_05-16-23.802224.txt&quot;
## 
## [[3]]
## Lower one-tailed p value Upper one-tailed p value       Two-tailed p value 
##                   0.9923                   0.0077                   0.0154 
## 
## [[4]]
##        Estimated Fst  Lower Bound CI.2.5% Upper bound CI.97.5% 
##           0.01419871           0.01113645           0.01745797 
## 
## [[5]]
##        Estimated Qst  Lower Bound CI.2.5% Upper bound CI.97.5% 
##            0.1333750            0.0265540            0.3742151 
## 
## [[6]]
##                   Va  Lower bound CI.2.5% Upper bound CI.97.5% 
##            0.3180848            0.1087902            0.5487714</code></pre>
<p>The output contains the following elements:</p>
<ul>
<li><code>[[1]]</code>: The calculated difference between Qst and Fst, with 95% critical values of the distribution of the distribution under the null hypothesis of no difference.</li>
<li><code>[[2]]</code>: an output file name (though we suppressed the writing of this file with the option <code>output="consise_nowrite"</code>)</li>
<li><code>[[3]]</code>: p-values for a hypothesis test with H0: <span class="math inline">\(Q_{ST} = F_{ST}\)</span>, with three different alternatives (<code>less</code>, <code>greater</code>, <code>two.sided</code>)</li>
<li><code>[[4]]</code>: the Fst value estimated from the data with 95% confidence intervals.</li>
<li><code>[[5]]</code>: the Qst value estimated from the data with 95% confidence intervals.</li>
<li><code>[[6]]</code>: the additive genetic variance for the trait with 95% confidence intervals.</li>
</ul>
<p>Note: the values are somewhat different from what we calculated, most likely because the function <code>QstFstComp</code> did not account for the block effect.</p>
<p><strong>Questions:</strong> Inspect the first and third elements of the list <code>QstFst_out</code>:</p>
<ul>
<li>For the observed values, is <span class="math inline">\(Q_{ST} &gt; F_{ST}\)</span>?</li>
<li>Which alternative is most appropriate here?</li>
<li>Can the null hypothesis be rejected with alpha = 0.05?</li>
<li>What does this mean biologically?</li>
</ul>
</div>
</div>
<div id="assess-correlation-between-trait-and-environment" class="section level3 unnumbered hasAnchor">
<h3>5. Assess correlation between trait and environment<a href="WE_6.html#assess-correlation-between-trait-and-environment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Motivation</strong>: Similar to the fixed effects, estimates of the random effects can be also extracted from a mixed effects model and used in further analysis. Such estimates are called Best Linear Unbiased Predictions or BLUPs. They are technically predictions because when you fit a mixed effects model, initially only the mean and variance of the random effects are estimated. Then, the random effects or BLUPs for a given experimental unit (e.g., population or family) can be “predicted” from the estimated mean and variance (and the data).</p>
<p><strong>Goals and background</strong>: Here we will extract block, population and family effects from the model. Then we will correlate the plot-level bioclimatic data with the population effects to see if population differences in seedling d13C trait can be explained by the environment at the site where the mother tree stands. The underlying idea is to look if selection has made the population different.</p>
<div id="a.-describe-and-extract-effects" class="section level4 unnumbered hasAnchor">
<h4>a. Describe and extract effects<a href="WE_6.html#a.-describe-and-extract-effects" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Which blocks, populations or trees had higher mean d13c values than others? To answer this question, we extract and plot the fixed and random effects. We’ll start with the fixed effect for <code>block</code>.</p>
<p>The effects are not simply the mean of all seedlings from the same block, but the marginal effect of block`, i.e., estimates of the mean per block after accounting for all other effects (i.e., keeping population and family constant).</p>
<p>There are two ways to extract the block effects. The first is with function <code>fixef</code>. This treats the first level of <code>block</code> as a reference level and uses it to estimate the global intercept, then expresses the effect of the other blocks as deviations from the first block.</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="WE_6.html#cb775-1" tabindex="-1"></a>lme4<span class="sc">::</span><span class="fu">fixef</span>(mod4)</span></code></pre></div>
<pre><code>## (Intercept)      block2      block3      block4      block5 
## -30.6263478  -0.1383311  -0.3507053  -0.1006031  -0.3944314</code></pre>
<p>A more convenient way to extract the effects is with function <code>ggeffect</code> of the package <code>ggeffects</code>.</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="WE_6.html#cb777-1" tabindex="-1"></a>ggeffects<span class="sc">::</span><span class="fu">ggeffect</span>(mod4, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;block&quot;</span>))</span></code></pre></div>
<pre><code>## # Predicted values of d13c
## 
## block | Predicted |           95% CI
## ------------------------------------
## 1     |    -30.63 | [-30.87, -30.38]
## 2     |    -30.76 | [-31.01, -30.51]
## 3     |    -30.98 | [-31.23, -30.73]
## 4     |    -30.73 | [-30.98, -30.48]
## 5     |    -31.02 | [-31.27, -30.77]</code></pre>
<p>The table lists the predicted d13c value for each block (accounting for population and family) and a 95% confidence interval for each predicted value.</p>
<p>Now let’s plot the effects (mean with 95% confidence interval) for each random factor, accounting for all other factors. Again, these are not simply means of observed traits values but marginal effect, accounting for all other factors in the model.</p>
<p>Note: If the plots appear in the “Plot” tab in RStudio, use the arrows to scroll between plots.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="WE_6.html#cb779-1" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(mod4,<span class="at">condVar=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## $family</code></pre>
<p><img src="06-Week06_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<pre><code>## 
## $population</code></pre>
<p><img src="06-Week06_files/figure-html/unnamed-chunk-34-2.png" width="672" /></p>
<p>We can see that there are considerable differences between populations, where “blk cyn” has the highest, and “mt watson” the lowest mean.</p>
<p>We can extract the values with <code>ranef</code>. Again, they are deviations from the global intercept (block 1). We are now ready to correlate the population effect to the environmental data.</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="WE_6.html#cb782-1" tabindex="-1"></a>prov.eff <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">ranef</span>(mod4)<span class="sc">$</span>population</span>
<span id="cb782-2"><a href="WE_6.html#cb782-2" tabindex="-1"></a>fam.eff <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">ranef</span>(mod4)<span class="sc">$</span>family</span>
<span id="cb782-3"><a href="WE_6.html#cb782-3" tabindex="-1"></a>prov.eff</span></code></pre></div>
<pre><code>##              (Intercept)
## armstrong    -0.16372457
## blk cyn       0.56424812
## echo lk      -0.10480714
## flume         0.37270696
## hvn          -0.25055204
## incline lk    0.21873458
## jakes         0.03776884
## meiss mdw    -0.18557714
## montreal cyn -0.02673127
## mt watson    -0.46206634</code></pre>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="WE_6.html#cb784-1" tabindex="-1"></a><span class="fu">head</span>(fam.eff)</span></code></pre></div>
<pre><code>##     (Intercept)
## 59  0.269660618
## 60 -0.036688490
## 61 -0.007035082
## 63 -0.259031610
## 64  0.087029419
## 65 -0.168188771</code></pre>
</div>
<div id="b.-correlation-of-population-effect-with-environment" class="section level4 unnumbered hasAnchor">
<h4>b. Correlation of population effect with environment<a href="WE_6.html#b.-correlation-of-population-effect-with-environment" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have population effects estimated for 10 populations, and bioclimatic data for 30 plots (3 plots x 10 populations). If we used all 157 rows of the site data set, this would inflate our sample size. To avoid this, we first extract 30 unique rows (one per plot) from the site data <code>WWP.ecogen@E</code>. Then we use <code>match</code> to find for each plot the corresponding population. This returns the row number (<code>index</code>) and we use it to extract the corresponding population effect.</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="WE_6.html#cb786-1" tabindex="-1"></a>Plot.data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(<span class="fu">data.frame</span>(WWP.ecogen<span class="sc">@</span>E, </span>
<span id="cb786-2"><a href="WE_6.html#cb786-2" tabindex="-1"></a>                    <span class="at">population=</span>WWP.ecogen<span class="sc">@</span>S<span class="sc">$</span>population))</span>
<span id="cb786-3"><a href="WE_6.html#cb786-3" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">match</span>(Plot.data<span class="sc">$</span>population, <span class="fu">row.names</span>(prov.eff))</span>
<span id="cb786-4"><a href="WE_6.html#cb786-4" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">prov.eff=</span>prov.eff[index,<span class="dv">1</span>], Plot.data[,<span class="sc">-</span><span class="dv">8</span>])</span></code></pre></div>
<p>Now we estimate the correlation between the population effect and each bioclimatic variable. We summarize the results in a correlation matrix plot.</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="WE_6.html#cb787-1" tabindex="-1"></a><span class="fu">pairs</span>(dat2, <span class="at">lower.panel=</span>panel.smooth, <span class="at">upper.panel=</span>panel.cor,</span>
<span id="cb787-2"><a href="WE_6.html#cb787-2" tabindex="-1"></a>      <span class="at">diag.panel=</span>panel.hist)</span></code></pre></div>
<pre><code>## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter

## Warning in par(usr): argument 1 does not name a graphical parameter</code></pre>
<p><img src="06-Week06_files/figure-html/unnamed-chunk-37-1.png" width="720" /></p>
<p>How to read this plot:</p>
<ul>
<li>Each diagonal cell shows the name and histogram of one variable.</li>
<li>Each cell in the upper triangle shows the correlation coefficient r, and the p-value for the correlation, between the two variables that define the corresponding row and column. (A larger font indicates a stronger correlation, though this seems to be inconsistent).</li>
<li>Each cell in the lower triangle shows a scatterplot of the two variables that define the corresponding row and column. A smooth regression line is shown in red.</li>
</ul>
<p><strong>Questions:</strong></p>
<ul>
<li>Which site variables show the strongest correlation with the population effect?</li>
<li>Which site variables are significantly correlated with the population effect?</li>
<li>OVerall, does the population effect appear to be related to the environment?</li>
</ul>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tutorial_6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-exercise-week-6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
