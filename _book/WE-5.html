<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Worked Example | Landscape Genetic Data Analysis with R</title>
  <meta name="description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Worked Example | Landscape Genetic Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  <meta name="github-repo" content="hhwagner1/LandGenCourse_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Worked Example | Landscape Genetic Data Analysis with R" />
  
  <meta name="twitter:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  

<meta name="author" content="Editor: Helene Wagner (University of Toronto)" />


<meta name="date" content="2021-05-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tutorial-5.html"/>
<link rel="next" href="r-exercise-week-5.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.7/profvis.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Landscape Genetic Data Analysis with R</a></li>

<li class="divider"></li>
<li class="part"><span><b>Getting Started</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i>How to use this Book</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#book-structure"><i class="fa fa-check"></i>1. Book Structure</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#a-getting-started"><i class="fa fa-check"></i>a) Getting Started</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#b-basic-topics"><i class="fa fa-check"></i>b) Basic Topics</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#c-advanced-topics"><i class="fa fa-check"></i>c) Advanced Topics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#find-what-is-relevant-for-you"><i class="fa fa-check"></i>2. Find what is relevant for you</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#how-to-use"><i class="fa fa-check"></i>a) How to use the labs</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#b-check-contents"><i class="fa fa-check"></i>b) Check contents</a></li>
</ul></li>
<li><a href="how-to-use-this-book.html#course-r-package-landgencourse">3. Course R package <code>LandGenCourse</code></a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#a-how-to-install-or-update"><i class="fa fa-check"></i>a) How to install (or update)</a></li>
<li><a href="how-to-use-this-book.html#b-how-to-use-the-r-package-landgencourse">b) How to use the R package <code>LandGenCourse</code></a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#c-video-instructions-for-beginners"><i class="fa fa-check"></i>c) Video instructions for beginners</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="list-of-packages.html"><a href="list-of-packages.html"><i class="fa fa-check"></i>List of R Packages by Vignette</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="review-of-r-skills.html"><a href="review-of-r-skills.html"><i class="fa fa-check"></i>Review of R Skills</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i>Basic R Programming</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#overview"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#data-types"><i class="fa fa-check"></i>2. Data Types</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#numeric-data-types"><i class="fa fa-check"></i>2.1. Numeric Data Types</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#characters"><i class="fa fa-check"></i>2.2. Characters</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#factors"><i class="fa fa-check"></i>2.3. Factors</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#logical-types"><i class="fa fa-check"></i>2.4. Logical Types</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#data-containers"><i class="fa fa-check"></i>3. Data Containers</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#vectors"><i class="fa fa-check"></i>3.1. Vectors</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#matrices"><i class="fa fa-check"></i>3.2. Matrices</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#lists"><i class="fa fa-check"></i>3.3. Lists</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#data-frames"><i class="fa fa-check"></i>3.4. Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#programming"><i class="fa fa-check"></i>4. Programming</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#function-writing"><i class="fa fa-check"></i>4.1. Function Writing</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#variable-scope"><i class="fa fa-check"></i>4.2. Variable Scope</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#decision-making"><i class="fa fa-check"></i>4.3. Decision Making</a></li>
<li class="chapter" data-level="" data-path="basic-r.html"><a href="basic-r.html#flow-control"><i class="fa fa-check"></i>4.4. Flow Control</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html"><i class="fa fa-check"></i>R Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#overview-1"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#univariate-plots"><i class="fa fa-check"></i>2. Univariate plots</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#barplots-and-histograms"><i class="fa fa-check"></i>2.1. Barplots and histograms</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#plotting-parameters"><i class="fa fa-check"></i>2.2. Plotting Parameters</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#density-plots"><i class="fa fa-check"></i>2.3. Density Plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#bivariate-plots"><i class="fa fa-check"></i>3. Bivariate plots</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#overlaying-plots-by-grouping"><i class="fa fa-check"></i>3.1. Overlaying Plots by grouping</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#boxplots"><i class="fa fa-check"></i>3.2. Boxplots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#scatter-plots"><i class="fa fa-check"></i>3.3. Scatter Plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#advanced-plotting"><i class="fa fa-check"></i>4. Advanced plotting</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#multiple-plots"><i class="fa fa-check"></i>4.1. Multiple Plots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#color-palettes"><i class="fa fa-check"></i>4.2. Color Palettes</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#rcolorbrewer"><i class="fa fa-check"></i>4.3. RColorBrewer</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#saving-imagery"><i class="fa fa-check"></i>4.4. Saving Imagery</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#interactive-graphics"><i class="fa fa-check"></i>4.5. Interactive Graphics</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="further-r-resources.html"><a href="further-r-resources.html"><i class="fa fa-check"></i>Further R Resources</a></li>
<li class="part"><span><b>Basic Topics</b></span></li>
<li class="chapter" data-level="" data-path="Week1.html"><a href="Week1.html"><i class="fa fa-check"></i>Week 1: Importing Genetic Data</a>
<ul>
<li class="chapter" data-level="" data-path="video-1.html"><a href="video-1.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-1.html"><a href="video-1.html#embedded-video"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video-1.html"><a href="video-1.html#preview-slides"><i class="fa fa-check"></i>2. Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html"><i class="fa fa-check"></i>Interactive Tutorial 1</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#list-of-r-commands-covered-this-week"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#general-instructions"><i class="fa fa-check"></i>2. General Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#a-how-to-access-tutorials"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#b-how-to-complete-tutorial"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#c-how-to-submit-answers-participating-institutions-only"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#overview-of-worked-example"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-goals"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-data-set"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-required-r-libraries"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#import-data-from-.csv-file"><i class="fa fa-check"></i>2. Import data from .csv file</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-preparation"><i class="fa fa-check"></i>a. Preparation</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-excel-file"><i class="fa fa-check"></i>b. Excel file</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-import-with-function-read.csv"><i class="fa fa-check"></i>c. Import with function ‘read.csv’</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#d.-create-id-variable"><i class="fa fa-check"></i>d. Create ID variable</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#e.-export-with-function-write.csv"><i class="fa fa-check"></i>e. Export with function ‘write.csv’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#create-genind-object"><i class="fa fa-check"></i>3. Create ‘genind’ Object</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-read-the-helpfile"><i class="fa fa-check"></i>a. Read the helpfile</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-set-all-arguments-of-function-df2genind"><i class="fa fa-check"></i>b. Set all arguments of function ‘df2genind’</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-check-imported-data"><i class="fa fa-check"></i>c. Check imported data</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#d.-summarize-genind-object"><i class="fa fa-check"></i>d. Summarize ‘genind’ object</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#view-information-stored-in-genind-object"><i class="fa fa-check"></i>4. View information stored in ‘genind’ object</a>
<ul>
<li><a href="WE-1.html#a.-slot-tab">a. Slot <code>@tab</code></a></li>
<li><a href="WE-1.html#b.-slot-loc.n.all">b. Slot <code>@loc.n.all</code></a></li>
<li><a href="WE-1.html#c.-slot-loc.fac">c. Slot <code>@loc.fac</code></a></li>
<li><a href="WE-1.html#d.-slot-all.names">d. Slot <code>@all.names</code></a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#e.-further-slots"><i class="fa fa-check"></i>e. Further slots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#import-data-with-gstudio-package"><i class="fa fa-check"></i>5. Import data with ‘gstudio’ package</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-function-read_population"><i class="fa fa-check"></i>a. Function ‘read_population’</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-set-arguments"><i class="fa fa-check"></i>b. Set arguments</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-check-imported-data-1"><i class="fa fa-check"></i>c. Check imported data</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#d.-add-frogid"><i class="fa fa-check"></i>d. Add FrogID</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#e.-convert-to-genind-object"><i class="fa fa-check"></i>e. Convert to ‘genind’ object</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-1.html"><a href="r-exercise-week-1.html"><i class="fa fa-check"></i>R exercise Week 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week2.html"><a href="Week2.html"><i class="fa fa-check"></i>Week 2: Spatial Data</a>
<ul>
<li class="chapter" data-level="" data-path="video-2.html"><a href="video-2.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-2.html"><a href="video-2.html#embedded-video-1"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video-2.html"><a href="video-2.html#preview-slides-1"><i class="fa fa-check"></i>2. Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html"><i class="fa fa-check"></i>Interactive Tutorial 2</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#list-of-r-commands-covered-this-week-1"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#general-instructions-1"><i class="fa fa-check"></i>2. General Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#a-how-to-access-tutorials-1"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#b-how-to-complete-tutorial-1"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#c-how-to-submit-answers-participating-institutions-only-1"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#overview-of-worked-example-1"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-goals-1"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-data-set-1"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-required-r-libraries-1"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#import-site-data-from-.csv-file"><i class="fa fa-check"></i>2. Import site data from .csv file</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-import-data-into-spatialpointsdataframe"><i class="fa fa-check"></i>a. Import data into SpatialPointsDataFrame</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-add-spatial-reference-data"><i class="fa fa-check"></i>b. Add spatial reference data</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-change-projection"><i class="fa fa-check"></i>c. Change projection</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#d.-access-data-in-spatialpointsdataframe"><i class="fa fa-check"></i>d. Access data in ‘SpatialPointsDataFrame’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#display-raster-data-and-overlay-sampling-locations-extract-data"><i class="fa fa-check"></i>3. Display raster data and overlay sampling locations, extract data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-display-raster-data"><i class="fa fa-check"></i>a. Display raster data</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-change-color-ramp-add-sampling-locations"><i class="fa fa-check"></i>b. Change color ramp, add sampling locations</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-extract-raster-values-at-sampling-locations"><i class="fa fa-check"></i>c. Extract raster values at sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#calculate-landscape-metrics"><i class="fa fa-check"></i>4. Calculate landscape metrics</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-calculate-patch--class--and-landscape-level-landscape-metrics"><i class="fa fa-check"></i>a. Calculate patch-, class- and landscape level landscape metrics</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-calculate-patch-level-landscape-metrics-for-evergreen-forest"><i class="fa fa-check"></i>b. Calculate patch-level landscape metrics for ‘Evergreen Forest’</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-extract-forest-patch-size-at-samplig-locations"><i class="fa fa-check"></i>c. Extract forest patch size at samplig locations</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#d.-plot-a-bubble-map-of-forest-patch-size-at-sampling-locations"><i class="fa fa-check"></i>d. Plot a bubble map of forest patch size at sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#sample-landscape-metrics-within-buffer-around-sampling-locations"><i class="fa fa-check"></i>5. Sample landscape metrics within buffer around sampling locations</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-extract-landscape-metric-of-choice-for-a-single-cover-type-as-vector"><i class="fa fa-check"></i>b. Extract landscape metric of choice for a single cover type (as vector)</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-extract-landscape-metric-of-choice-for-all-cover-types-as-data-frame."><i class="fa fa-check"></i>c. Extract landscape metric of choice for all cover types (as data frame).</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#d.-extract-all-landscape-metrics-for-a-single-cover-type-as-data-frame"><i class="fa fa-check"></i>d. Extract all landscape metrics for a single cover type (as data frame)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-2.html"><a href="r-exercise-week-2.html"><i class="fa fa-check"></i>R Exercise Week 2</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html"><i class="fa fa-check"></i>Bonus Vignette</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#overview-2"><i class="fa fa-check"></i>1. Overview</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#a.-goals-2"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#b.-required-r-libraries"><i class="fa fa-check"></i>b. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#convert-spatialpointsdataframe-to-sf-object"><i class="fa fa-check"></i>2. Convert ‘SpatialPointsDataFrame’ to ‘sf’ object</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#plot-variables-first-10-in-data-set"><i class="fa fa-check"></i>3. Plot variables (first 10 in data set)</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#export-site-data-as-esri-shapefile"><i class="fa fa-check"></i>4. Export site data as ESRI shapefile</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#display-categorical-map-with-a-predefined-color-table"><i class="fa fa-check"></i>5. Display categorical map with a predefined color table</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week3.html"><a href="Week3.html"><i class="fa fa-check"></i>Week 3: Genetic Diversity</a>
<ul>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html#embedded-video-2"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html#video-part-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html#video-part-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html#preview-slides-2"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html"><i class="fa fa-check"></i>Interactive Tutorial 3</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#list-of-r-commands-covered-this-week-2"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#general-instructions-2"><i class="fa fa-check"></i>2. General Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#a-how-to-access-tutorials-2"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#b-how-to-complete-tutorial-2"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#c-how-to-submit-answers-participating-institutions-only-2"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#overview-of-worked-example-2"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#a.-goals-3"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#b.-data-set-2"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#c.-required-r-libraries-2"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#basic-checking-of-markers-and-populations"><i class="fa fa-check"></i>2. Basic checking of markers and populations</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#a.-re-create-genind-object"><i class="fa fa-check"></i>a. Re-create genind object</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#b.-check-that-markers-are-polymorphic"><i class="fa fa-check"></i>b. Check that markers are polymorphic</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#c.-check-for-deviations-from-hardy-weinberg-equilibrium-hwe"><i class="fa fa-check"></i>c. Check for deviations from Hardy-Weinberg equilibrium (HWE)</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#d.-check-for-linkage-disequilibrium-ld"><i class="fa fa-check"></i>d. Check for linkage disequilibrium (LD)</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#e.-check-for-null-alleles"><i class="fa fa-check"></i>e. Check for null alleles</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#f.-overall-interpretation"><i class="fa fa-check"></i>f. Overall interpretation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#assess-genetic-diversity"><i class="fa fa-check"></i>3. Assess genetic diversity</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#a.-rarefied-allelic-richness"><i class="fa fa-check"></i>a. Rarefied allelic richness</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#b.-observed-and-expected-heterozygosity"><i class="fa fa-check"></i>b. Observed and expected heterozygosity</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#c.-create-table-with-sitel-level-genetic-diversity-measures"><i class="fa fa-check"></i>c. Create table with sitel-level genetic diversity measures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#aggregate-genetic-data-at-population-level-allele-frequencies"><i class="fa fa-check"></i>4. Aggregate genetic data at population level (allele frequencies)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-3.html"><a href="r-exercise-week-3.html"><i class="fa fa-check"></i>R Exercise Week 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week4.html"><a href="Week4.html"><i class="fa fa-check"></i>Week 4: Metapopulations</a>
<ul>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html#embedded-video-3"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html#video-part-1-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html#video-part-2-1"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html#preview-slides-3"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html"><i class="fa fa-check"></i>Interactive Tutorial 4</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#list-of-r-commands-covered-this-week-3"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#general-instructions-3"><i class="fa fa-check"></i>2. General Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#a-how-to-access-tutorials-3"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#b-how-to-complete-tutorial-3"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#c-how-to-submit-answers-participating-institutions-only-3"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#overview-of-worked-example-3"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-goals-4"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-data-set-3"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#reference"><i class="fa fa-check"></i>Reference:</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#c.-required-r-libraries-3"><i class="fa fa-check"></i>c. Required R libraries</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#d.-import-data"><i class="fa fa-check"></i>d. Import data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#spatial-distribution-of-genetic-structure"><i class="fa fa-check"></i>2. Spatial distribution of genetic structure</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-creating-a-genind-object-with-the-hierarchical-data-set"><i class="fa fa-check"></i>a. Creating a ‘genind’ object with the hierarchical data set</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-hierarchical-amova"><i class="fa fa-check"></i>b. Hierarchical AMOVA</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#what-determines-genetic-differentiation-among-sites"><i class="fa fa-check"></i>3. What determines genetic differentiation among sites?</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-correlation-matrix"><i class="fa fa-check"></i>a. Correlation matrix</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-scatterplots"><i class="fa fa-check"></i>b. Scatterplots</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#c.-regression-model"><i class="fa fa-check"></i>c. Regression model</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#d.-which-populations-dont-fit-the-general-pattern"><i class="fa fa-check"></i>d. Which populations don’t fit the general pattern?</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#e.-regression-model-without-outliers"><i class="fa fa-check"></i>e. Regression model without outliers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#what-determines-genetic-diversity"><i class="fa fa-check"></i>4. What determines genetic diversity?</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-correlation-matrix-1"><i class="fa fa-check"></i>a. Correlation matrix</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-regression-models"><i class="fa fa-check"></i>b. Regression models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#are-genetic-differentiation-and-diversity-related"><i class="fa fa-check"></i>5. Are genetic differentiation and diversity related?</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#effect-of-recent-extinction-events"><i class="fa fa-check"></i>6. Effect of recent extinction events</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-effect-of-patch-extinction-event-temporal-data-set"><i class="fa fa-check"></i>a. Effect of patch extinction event (temporal data set)</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-power-analysis"><i class="fa fa-check"></i>b. Power analysis</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#c.-sample-size-calculation"><i class="fa fa-check"></i>c. Sample size calculation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-4.html"><a href="r-exercise-week-4.html"><i class="fa fa-check"></i>R Exercise Week 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week5.html"><a href="Week5.html"><i class="fa fa-check"></i>Week 5: Spatial Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="video-5.html"><a href="video-5.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-5.html"><a href="video-5.html#embedded-video-4"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video-5.html"><a href="video-5.html#preview-slides-4"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html"><i class="fa fa-check"></i>Interactive Tutorial 5</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#list-of-r-commands-covered-this-week-4"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#general-instructions-4"><i class="fa fa-check"></i>2. General Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#a-how-to-access-tutorials-4"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#b-how-to-complete-tutorial-4"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#c-how-to-submit-answers-participating-institutions-only-4"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#overview-of-worked-example-4"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-goals-5"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-data-set-4"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-required-r-packages"><i class="fa fa-check"></i>c. Required R packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#data-import-and-manipulation"><i class="fa fa-check"></i>2. Data import and manipulation</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-create-an-ecogen-object"><i class="fa fa-check"></i>a. Create an ecogen object</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-aggregate-to-ecopop"><i class="fa fa-check"></i>b. Aggregate to ecopop</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-add-site-level-data"><i class="fa fa-check"></i>b. Add site-level data</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-export-to-adegenet-and-gstudio"><i class="fa fa-check"></i>c. Export to adegenet and gstudio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#calculate-genetic-distances"><i class="fa fa-check"></i>3. Calculate genetic distances</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-genetic-distances-calculated-from-genind-object"><i class="fa fa-check"></i>a. Genetic distances calculated from genind object</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-more-distance-matrices-with-gstudio"><i class="fa fa-check"></i>b. More distance matrices with ‘gstudio’</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-assemble-distance-matrices"><i class="fa fa-check"></i>c. Assemble distance matrices</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#d.-export-genetic-distance-matrices"><i class="fa fa-check"></i>d. Export genetic distance matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#perform-a-mantel-test-to-test-for-ibd"><i class="fa fa-check"></i>4. Perform a Mantel test to test for IBD</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-visually-check-linearity"><i class="fa fa-check"></i>a. Visually check linearity</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-perform-mantel-test"><i class="fa fa-check"></i>b. Perform Mantel test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#create-mantel-correlogram-for-genetic-data"><i class="fa fa-check"></i>5. Create Mantel correlogram for genetic data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-create-a-first-mantel-correlogram"><i class="fa fa-check"></i>a. Create a first Mantel correlogram</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-vary-distance-class-definition"><i class="fa fa-check"></i>b. Vary distance class definition</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-alternative-measures-of-genetic-distances"><i class="fa fa-check"></i>c. Alternative measures of genetic distances</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#specify-spatial-weights-and-calculate-morans-i"><i class="fa fa-check"></i>6. Specify spatial weights and calculate Moran’s I</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-defining-spatial-neighbors"><i class="fa fa-check"></i>a. Defining spatial neighbors</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-defining-spatial-weights"><i class="fa fa-check"></i>b. Defining spatial weights</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-calculating-and-testing-morans-i"><i class="fa fa-check"></i>c. Calculating and testing Moran’s I</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-5.html"><a href="r-exercise-week-5.html"><i class="fa fa-check"></i>R Exercise Week 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week6.html"><a href="Week6.html"><i class="fa fa-check"></i>Week 6: Quantitative Genetics</a>
<ul>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html#embedded-video-5"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html#video-part-1-2"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html#video-part-2-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html#preview-slides-5"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html"><i class="fa fa-check"></i>Interactive Tutorial 6</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#list-of-r-commands-covered-this-week-5"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#general-instructions-5"><i class="fa fa-check"></i>2. General Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#a-how-to-access-tutorials-5"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#b-how-to-complete-tutorial-5"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#c-how-to-submit-answers-participating-institutions-only-5"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#overview-of-worked-example-5"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-goals-6"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-data-set-5"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#c.-required-r-packages-1"><i class="fa fa-check"></i>c. Required R packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment"><i class="fa fa-check"></i>2. Estimate genetic and non-genetic variance components from a common garden experiment</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-import-phenytypic-data"><i class="fa fa-check"></i>a. Import phenytypic data</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-fit-linear-mixed-effects-models-lmm-to-trait-data-observed-on-families"><i class="fa fa-check"></i>b. Fit linear mixed effects models (LMM) to trait data observed on families</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#c.-compare-model-fit"><i class="fa fa-check"></i>c. Compare model fit</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#d.-check-model-validity"><i class="fa fa-check"></i>d. Check model validity</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#e.-estimate-variance-components"><i class="fa fa-check"></i>e. Estimate variance components</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#f.-significance-testing"><i class="fa fa-check"></i>f. Significance testing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#estimate-trait-heritability"><i class="fa fa-check"></i>3. Estimate trait heritability</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-estimate-heritability"><i class="fa fa-check"></i>a. Estimate heritability</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-estimate-trait-differentiation"><i class="fa fa-check"></i>b. Estimate trait differentiation</a></li>
</ul></li>
<li><a href="WE-6.html#compare-q_st-to-f_st-measured-from-snp-data">4. Compare <span class="math inline">\(Q_{st}\)</span> to <span class="math inline">\(F_{st}\)</span> measured from SNP data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-import-ecogen-object"><i class="fa fa-check"></i>a. Import ‘ecogen’ object</a></li>
<li><a href="WE-6.html#b.-compare-q_st-to-f_st">b. Compare <span class="math inline">\(Q_{ST}\)</span> to <span class="math inline">\(F_{ST}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#assess-correlation-between-trait-and-environment"><i class="fa fa-check"></i>5. Assess correlation between trait and environment</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-describe-and-extract-effects"><i class="fa fa-check"></i>a. Describe and extract effects</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-correlation-of-population-effect-with-environment"><i class="fa fa-check"></i>b. Correlation of population effect with environment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-6.html"><a href="r-exercise-week-6.html"><i class="fa fa-check"></i>R Exercise Week 6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week7.html"><a href="Week7.html"><i class="fa fa-check"></i>Week 7: Spatial Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html#embedded-video-6"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html#video-part-1-3"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html#video-part-2-3"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html#preview-slides-6"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html"><i class="fa fa-check"></i>Interactive Tutorial 7</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#list-of-r-commands-covered-this-week-6"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#general-instructions-6"><i class="fa fa-check"></i>2. General Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#a-how-to-access-tutorials-6"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#b-how-to-complete-tutorial-6"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#c-how-to-submit-answers-participating-institutions-only-6"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#overview-of-worked-example-6"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-goals-7"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-data-set-6"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#c.-required-r-packages-2"><i class="fa fa-check"></i>c. Required R packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#explore-data-set"><i class="fa fa-check"></i>2. Explore data set</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-import-data"><i class="fa fa-check"></i>a. Import data</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-create-a-map"><i class="fa fa-check"></i>b. Create a map</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#c.-explore-correlations"><i class="fa fa-check"></i>c. Explore correlations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#test-regression-residuals-for-spatial-autocorrelation"><i class="fa fa-check"></i>3. Test regression residuals for spatial autocorrelation</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-fit-regression-models"><i class="fa fa-check"></i>a. Fit regression models</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-test-for-spatial-autocorrelation-morans-i"><i class="fa fa-check"></i>b. Test for spatial autocorrelation (Moran’s I):</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#fit-models-with-spatially-correlated-error-gls-with-package-nlme"><i class="fa fa-check"></i>4. Fit models with spatially correlated error (GLS) with package ‘nlme’</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-plot-empirical-variogram"><i class="fa fa-check"></i>a. Plot empirical variogram</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-fit-variogram-models"><i class="fa fa-check"></i>b. Fit variogram models</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#c.-select-best-fitting-model"><i class="fa fa-check"></i>c. Select best-fitting model</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#d.-plot-fitted-variogram-model"><i class="fa fa-check"></i>d. Plot fitted variogram model</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#e.-add-random-factor"><i class="fa fa-check"></i>e. Add random factor</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#fit-spatial-simultaneous-autoregressive-error-models-sar"><i class="fa fa-check"></i>5. Fit spatial simultaneous autoregressive error models (SAR)</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-fit-and-compare-alternative-sar-models"><i class="fa fa-check"></i>a. Fit and compare alternative SAR models</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-interpret-best-fitting-sar-model"><i class="fa fa-check"></i>b. Interpret best-fitting SAR model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#spatial-filtering-with-mem-using-package-spmoran"><i class="fa fa-check"></i>6. Spatial filtering with MEM using package ‘spmoran’</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-default-method"><i class="fa fa-check"></i>a. Default method</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-using-a-custom-connectivity-matrix"><i class="fa fa-check"></i>b. Using a custom connectivity matrix</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#c.-plot-spatial-eigenvectors"><i class="fa fa-check"></i>c. Plot spatial eigenvectors</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#d.-random-effect-model"><i class="fa fa-check"></i>d. Random effect model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#fit-spatially-varying-coefficients-model-with-package-spmoran"><i class="fa fa-check"></i>7. Fit spatially varying coefficients model with package ‘spmoran’</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#model-with-patchsize-and-ibr"><i class="fa fa-check"></i>Model with PatchSize and IBR</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#model-with-ibr-only"><i class="fa fa-check"></i>Model with IBR only</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#conclusions"><i class="fa fa-check"></i>8. Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-7.html"><a href="r-exercise-week-7.html"><i class="fa fa-check"></i>R Exercise Week 7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week8.html"><a href="Week8.html"><i class="fa fa-check"></i>Week 8: Simulation Experiments</a>
<ul>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html#embedded-video-7"><i class="fa fa-check"></i>1. Embedded Video</a></li>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html#video-part-1-4"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html#video-part-2-4"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html#preview-slides-7"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html"><i class="fa fa-check"></i>Interactive Tutorial 8</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#list-of-r-commands-covered-this-week-7"><i class="fa fa-check"></i>1. List of R commands covered this week</a></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#general-instructions-7"><i class="fa fa-check"></i>2. General Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#a-how-to-access-tutorials-7"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#b-how-to-complete-tutorial-7"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#c-how-to-submit-answers-participating-institutions-only-7"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#overview-of-worked-example-7"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-goals-8"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-data-set-7"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-required-r-libraries-4"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#initialize-a-landscape"><i class="fa fa-check"></i>2. Initialize a landscape</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-create-a-random-landscape"><i class="fa fa-check"></i>a. Create a random landscape</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-add-populations-to-the-landscape-using-minimal-distance"><i class="fa fa-check"></i>b. Add populations to the landscape (using minimal distance)</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-initialise-a-metapopulation"><i class="fa fa-check"></i>c. Initialise a metapopulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#define-simulation-parameters"><i class="fa fa-check"></i>3. Define simulation parameters</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-define-your-metapopulation"><i class="fa fa-check"></i>a. Define your metapopulation</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-initialise-your-population-on-the-landscape"><i class="fa fa-check"></i>b. Initialise your population on the landscape</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#run-simulations-and-analyze-results"><i class="fa fa-check"></i>4. Run simulations and analyze results</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-run-your-simulation-over-multiple-time-steps-years"><i class="fa fa-check"></i>a. Run your simulation over multiple time steps (years)</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-analyse-your-simulated-population-with-a-partial-mantel-test"><i class="fa fa-check"></i>b. Analyse your simulated population with a partial Mantel test</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-optional-analyze-your-simulated-populations-using-sunder"><i class="fa fa-check"></i>c. Optional: Analyze your simulated populations using ‘Sunder’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#run-simulator-using-a-previously-defined-parameter-set"><i class="fa fa-check"></i>5. Run simulator using a previously defined parameter set</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-specify-and-record-the-parameter-combinations"><i class="fa fa-check"></i>a. Specify and record the parameter combinations</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-run-the-simulator-over-every-parameter-combination."><i class="fa fa-check"></i>b. Run the simulator over every parameter combination.</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-save-your-complete-simulation-run-input-and-output"><i class="fa fa-check"></i>c. Save your complete simulation run (input and output)</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#d.-analyze-and-synthesize-results"><i class="fa fa-check"></i>d. Analyze and synthesize results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-8.html"><a href="r-exercise-week-8.html"><i class="fa fa-check"></i>R Exercise Week 8</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html"><i class="fa fa-check"></i>Bonus Vignette</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#overview-of-bonus-material"><i class="fa fa-check"></i>1. Overview of Bonus Material</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-goals-9"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-data-set-8"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#c.-required-r-libraries-5"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#navigating-the-file-system"><i class="fa fa-check"></i>2. Navigating the file system</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-where-am-i"><i class="fa fa-check"></i>a. Where am I?</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-accessing-a-system-file"><i class="fa fa-check"></i>b. Accessing a system file</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#c.-file-manipulation"><i class="fa fa-check"></i>c. File manipulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#benchmarking-file-import-and-export-options"><i class="fa fa-check"></i>3. Benchmarking file import and export options</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-benchmark-methods-for-importing-csv-files"><i class="fa fa-check"></i>a. Benchmark methods for importing csv files</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-check-handling-of-character-data"><i class="fa fa-check"></i>b. Check handling of character data</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#c.-binary-files"><i class="fa fa-check"></i>c. Binary files</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#d.-should-you-save-your-r-workspace"><i class="fa fa-check"></i>d. Should you save your R workspace?</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#e.-compile-your-functions"><i class="fa fa-check"></i>e. Compile your functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#profiling-your-code"><i class="fa fa-check"></i>4. Profiling your code</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-named-chunks"><i class="fa fa-check"></i>a. Named chunks</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-profiling-some-lines-of-code-with-profvis"><i class="fa fa-check"></i>b. Profiling some lines of code with ‘profvis’</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#c.-profiling-an-r-script-with-profvis"><i class="fa fa-check"></i>c. Profiling an R script with ‘profvis’</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#d.-converting-an-r-notebook-to-an-r-script"><i class="fa fa-check"></i>d. Converting an R Notebook to an R script</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#creating-and-executing-a-bash-r-script"><i class="fa fa-check"></i>5. Creating and executing a Bash R script</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-run-r-script-directly-in-the-terminal"><i class="fa fa-check"></i>a. Run R script directly in the Terminal</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-create-a-bash-r-script"><i class="fa fa-check"></i>b. Create a Bash R script</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#c.-executing-a-bash-r-script"><i class="fa fa-check"></i>c. Executing a Bash R script</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#d.-moving-to-a-node-or-cluster"><i class="fa fa-check"></i>d. Moving to a node or cluster?</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#e.-store-your-session-info-and-package-versions"><i class="fa fa-check"></i>e. Store your session info and package versions</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#f.-potential-windows-issues"><i class="fa fa-check"></i>f. Potential Windows issues</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#parallelizing-code"><i class="fa fa-check"></i>6. Parallelizing code</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-replace-lapply-by-mclapply-with-package-parallel"><i class="fa fa-check"></i>a. Replace ‘lapply’ by ‘mclapply’ with package ‘parallel’</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-replace-for-by-foreach-with-package-doparallel"><i class="fa fa-check"></i>b. Replace ‘for’ by ‘foreach’ with package ‘doParallel’</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Advanced Topics</b></span></li>
<li class="chapter" data-level="" data-path="Week9.html"><a href="Week9.html"><i class="fa fa-check"></i>Week 9: Population Structure</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#overview-of-worked-example-8"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#a.-goals-10"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#b.-data-sets"><i class="fa fa-check"></i>b. Data sets</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#c.-required-r-libraries-6"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#simulated-data-2-island-model"><i class="fa fa-check"></i>2. Simulated data: 2-island model</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#a.-import-data-1"><i class="fa fa-check"></i>a. Import data</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#b.-perform-principal-components-analysis-pca"><i class="fa fa-check"></i>b. Perform Principal Components Analysis (PCA)</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#c.-create-synthetic-spatial-coordinates-xy-and-map-them"><i class="fa fa-check"></i>c. Create synthetic spatial coordinates (X,Y) and map them</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#simulated-data-2-island-model-with-admixture"><i class="fa fa-check"></i>3. Simulated data: 2-island model with admixture</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#empirical-data-threespine-sticklebacks"><i class="fa fa-check"></i>4. Empirical data: Threespine sticklebacks</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#a.-import-the-data"><i class="fa fa-check"></i>a. Import the data:</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#b.-examine-population-structure-with-pca"><i class="fa fa-check"></i>b. Examine population structure with PCA</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#c.-clustering-with-snmf-similar-to-structure"><i class="fa fa-check"></i>c. Clustering with SNMF (similar to ‘STRUCTURE’)</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#d.-plot-ancestry-proportions"><i class="fa fa-check"></i>d. Plot ancestry proportions</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#e.-visualize-admixture-proportions-on-a-map"><i class="fa fa-check"></i>e. Visualize admixture proportions on a map</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week10.html"><a href="Week10.html"><i class="fa fa-check"></i>Week 10: Landscape Resistance</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#overview-of-worked-example-9"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-goals-11"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-data-set-9"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-required-r-libraries-7"><i class="fa fa-check"></i>c. Required R libraries</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#d.-import-rasters-gsp-err-cti-and-ffp."><i class="fa fa-check"></i>d. Import rasters (gsp, err, cti, and ffp).</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#e.-import-site-data-with-sampling-locations"><i class="fa fa-check"></i>e. Import site data with sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#explore-the-data-set"><i class="fa fa-check"></i>2. Explore the data set</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-plot-all-rasters"><i class="fa fa-check"></i>a. Plot all rasters</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-plot-spatial-points-over-ffp-raster"><i class="fa fa-check"></i>b. Plot spatial points over ffp raster</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#setting-cost-values-and-calculating-conductance"><i class="fa fa-check"></i>3. Setting cost values and calculating conductance</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-resistance-vs.-conductance-values"><i class="fa fa-check"></i>a. Resistance vs. conductance values</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-as-needed-get-all-rasters-at-the-same-scale"><i class="fa fa-check"></i>b. As needed: Get all rasters at the same scale</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-calculate-conductance-values"><i class="fa fa-check"></i>c. Calculate conductance values</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#d.-create-a-single-landscape-conductance-raster"><i class="fa fa-check"></i>d. Create a single landscape conductance raster</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#convert-conductance-into-effective-distance"><i class="fa fa-check"></i>4. Convert conductance into effective distance</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-create-a-transition-layer"><i class="fa fa-check"></i>a. Create a transition layer</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-visually-inspect-the-raster"><i class="fa fa-check"></i>b. Visually inspect the raster</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-correct-for-geometric-distortion"><i class="fa fa-check"></i>c. Correct for geometric distortion</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#d.-plot-shortest-paths-in-space"><i class="fa fa-check"></i>d. Plot shortest paths in space</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#create-cost-distance-matrices"><i class="fa fa-check"></i>5. Create cost-distance matrices</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-least-cost-distance"><i class="fa fa-check"></i>a. Least cost distance</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-cost-distance-matrix-based-on-random-paths-similar-to-circuitscape"><i class="fa fa-check"></i>b. Cost-distance matrix based on random paths (similar to Circuitscape)</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-compare-cost-distances"><i class="fa fa-check"></i>c. Compare cost distances</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#how-does-changing-resolution-affect-these-metrics"><i class="fa fa-check"></i>6. How does changing resolution affect these metrics?</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-create-loop"><i class="fa fa-check"></i>a. Create loop</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-plot-the-results"><i class="fa fa-check"></i>b. Plot the results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#references"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week11.html"><a href="Week11.html"><i class="fa fa-check"></i>Week 11: Detecting Adaptation</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#overview-of-worked-example-10"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-goals-12"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-data-set-10"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#c.-required-r-libraries-8"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#import-and-prepare-the-data"><i class="fa fa-check"></i>2. Import and prepare the data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-import-the-genetic-data"><i class="fa fa-check"></i>a. Import the genetic data</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-import-the-environmental-data"><i class="fa fa-check"></i>b. Import the environmental data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#latent-factor-mixed-models-lfmm-a-univariate-gea"><i class="fa fa-check"></i>3. Latent Factor Mixed Models (LFMM): a univariate GEA</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-determine-k"><i class="fa fa-check"></i>a. Determine K</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-run-lfmm"><i class="fa fa-check"></i>b. Run LFMM</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#c.-identify-lfmm-candidates-using-false-discovery-rate"><i class="fa fa-check"></i>c. Identify LFMM candidates using False Discovery Rate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#redundancy-analysis-rda-a-multivariate-gea"><i class="fa fa-check"></i>4. Redundancy Analysis (RDA): a multivariate GEA</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-run-rda"><i class="fa fa-check"></i>a. Run RDA</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-identify-rda-candidates"><i class="fa fa-check"></i>b. Identify RDA candidates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#compare-lfmm-and-rda-candidates"><i class="fa fa-check"></i>5. Compare LFMM and RDA candidates</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a-quick-note-on-controlling-for-population-structure-in-rda"><i class="fa fa-check"></i>6. A quick note on controlling for population structure in RDA</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#references-1"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week12.html"><a href="Week12.html"><i class="fa fa-check"></i>Week 12: Model Selection</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#overview-of-worked-example-11"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#a.-goals-and-background"><i class="fa fa-check"></i>a. Goals and Background</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#b.-data-set-11"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#c.-required-packages"><i class="fa fa-check"></i>c. Required packages</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#d.-import-data-1"><i class="fa fa-check"></i>d. Import data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#fitting-candidate-models"><i class="fa fa-check"></i>2. Fitting candidate models</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#a.-alternative-hypotheses"><i class="fa fa-check"></i>a. Alternative hypotheses</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#b.-prepare-for-model-fitting"><i class="fa fa-check"></i>b. Prepare for model fitting</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#c.-fit-all-five-models"><i class="fa fa-check"></i>c. Fit all five models</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#d.-compare-evidence-for-models"><i class="fa fa-check"></i>d. Compare evidence for models</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#e.-calculate-evidence-weights"><i class="fa fa-check"></i>e. Calculate evidence weights</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#f.-confidence-intervals-for-predictors"><i class="fa fa-check"></i>f. Confidence intervals for predictors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#your-turn-to-test-additional-hypotheses"><i class="fa fa-check"></i>3. Your turn to test additional hypotheses!</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#references-2"><i class="fa fa-check"></i>4. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week13.html"><a href="Week13.html"><i class="fa fa-check"></i>Week 13: Gravity Models</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#overview-of-worked-example-12"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-background"><i class="fa fa-check"></i>a. Background</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-data-set-12"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-required-r-libraries-9"><i class="fa fa-check"></i>c. Required R libraries</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#set-working-and-data-directories---needs-to-be-removed"><i class="fa fa-check"></i>Set working and data directories - NEEDS TO BE REMOVED</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#calculating-graph-metrics"><i class="fa fa-check"></i>2. Calculating graph metrics</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-read-in-make-a-spatial-object-and-plot-wetlands-wetlands.csv."><i class="fa fa-check"></i>a. Read in, make a spatial object and plot wetlands (Wetlands.csv).</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-create-a-graph-from-the-wetlands"><i class="fa fa-check"></i>b. Create a graph from the wetlands</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-create-adjacency-matrix"><i class="fa fa-check"></i>c. Create adjacency matrix</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#d.-calculate-graph-metrics"><i class="fa fa-check"></i>d. Calculate graph metrics</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#e.-add-graph-metrics-to-data.frame"><i class="fa fa-check"></i>e. Add graph metrics to data.frame</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#combine-frog-data-with-graph-metrics"><i class="fa fa-check"></i>3. Combine frog data with graph metrics</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-add-graph-node-data-to-frog-site-data"><i class="fa fa-check"></i>a. Add graph node data to frog site data</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-check-data-types"><i class="fa fa-check"></i>b. Check data types</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#merge-graph-with-genetic-distance-data"><i class="fa fa-check"></i>4. Merge graph with genetic distance data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-build-graph-from-occupied-sites"><i class="fa fa-check"></i>a. Build graph from occupied sites</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-merge-graph-with-genetic-distance"><i class="fa fa-check"></i>b. Merge graph with genetic distance</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-write-out-results-ascii-csv-and-lines-shapefile."><i class="fa fa-check"></i>c. Write out results (ASCII csv and lines shapefile).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#preparing-raster-based-covariates"><i class="fa fa-check"></i>5. Preparing raster-based covariates</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-import-raster-data-as-stack"><i class="fa fa-check"></i>a. Import raster data as stack</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-calculate-wetland-area-within-buffer"><i class="fa fa-check"></i>b. Calculate wetland area within buffer</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-create-raster-of-wetland-proportion"><i class="fa fa-check"></i>c. Create raster of wetland proportion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#extract-raster-stats-for-nodes-and-edges"><i class="fa fa-check"></i>6. Extract raster stats for nodes and edges</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-extract-at-site-variables-from-rasters"><i class="fa fa-check"></i>a. Extract at-site variables from rasters</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-add-covariates-to-graph-edges."><i class="fa fa-check"></i>b. Add covariates to graph edges.</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-calculating-stats-along-edges"><i class="fa fa-check"></i>c. Calculating stats along edges</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#d.-calculating-stats-for-categorical-variables"><i class="fa fa-check"></i>d. Calculating stats for categorical variables</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#e.-add-node-data-to-graph"><i class="fa fa-check"></i>e. Add node data to graph</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#gravity-models"><i class="fa fa-check"></i>7. Gravity Models</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-merge-distance-and-site-data"><i class="fa fa-check"></i>a. Merge distance and site data</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-define-a-set-of-models"><i class="fa fa-check"></i>b. Define a set of models</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-check-for-correlations"><i class="fa fa-check"></i>c. Check for correlations</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-write-out-resultss"><i class="fa fa-check"></i>c. Write out resultss</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#e.-compare-models"><i class="fa fa-check"></i>e. Compare models</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#f.-diagnostic-plots"><i class="fa fa-check"></i>f. Diagnostic plots</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#g.-fit-final-models"><i class="fa fa-check"></i>g. Fit final model(s)</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#h.-effect-size"><i class="fa fa-check"></i>h. Effect size</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week14.html"><a href="Week14.html"><i class="fa fa-check"></i>Week 14: Contemporary Gene Flow</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#overview-3"><i class="fa fa-check"></i>1. Overview</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-background-and-goals"><i class="fa fa-check"></i>a. Background and Goals</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-data-set-13"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#c.-required-packages-1"><i class="fa fa-check"></i>c. Required packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#import-genotypes"><i class="fa fa-check"></i>2. Import Genotypes</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-import-genotype-data"><i class="fa fa-check"></i>a. Import genotype data</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-plot-map-of-sampling-locations"><i class="fa fa-check"></i>b. Plot map of sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#pollen-pool-genetic-structure"><i class="fa fa-check"></i>3. Pollen pool genetic structure</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-subtract-maternal-contribution-to-offspring-genotype"><i class="fa fa-check"></i>a. Subtract maternal contribution to offspring genotype</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-twogener-analysis-amova-of-pollen-pool-data"><i class="fa fa-check"></i>b. ‘TwoGener’ analysis (AMOVA of pollen pool data)</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#c.-including-space-isolation-by-distance"><i class="fa fa-check"></i>c. Including space: Isolation by distance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#paternity-analysis"><i class="fa fa-check"></i>4. Paternity analysis</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-exclusion-probabilities"><i class="fa fa-check"></i>a. Exclusion probabilities</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-paternity-analysis"><i class="fa fa-check"></i>b. Paternity analysis</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#c.-visualize-reconstructed-pollen-flow-events-in-space"><i class="fa fa-check"></i>c. Visualize reconstructed pollen flow events in space</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#d.-visualize-dispersal-kernel"><i class="fa fa-check"></i>d. Visualize dispersal kernel</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#linking-paternity-to-ecological-variables"><i class="fa fa-check"></i>5. Linking paternity to ecological variables</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-explain-pollen-flow-within-populations"><i class="fa fa-check"></i>a. Explain pollen flow within populations</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-explain-pollen-flow-at-the-population-level"><i class="fa fa-check"></i>b. Explain pollen flow at the population level</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#references-3"><i class="fa fa-check"></i>6. References</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Landscape Genetic Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="WE_5" class="section level2">
<h2>Worked Example</h2>
<div id="overview-of-worked-example-4" class="section level3">
<h3>1. Overview of Worked Example</h3>
<div id="a.-goals-5" class="section level4">
<h4>a. Goals</h4>
<p>This worked example shows how to:</p>
<ul>
<li>Calculate genetic distance at population level.</li>
<li>Perform a Mantel test to test for IBD.</li>
<li>Create Mantel correlograms for the genetic data.</li>
<li>Calculate and test Moran’s I for population-level genetic diversity data.</li>
</ul>
</div>
<div id="b.-data-set-4" class="section level4">
<h4>b. Data set</h4>
<p>This is a larger version of the frog data set used in Weeks 1 - 3.</p>
<p>Here, we will analyze microsatellite data from Funk et al. (2005) and Murphy et al. (2010) for 418 individuals of Colombia spotted frogs (Rana luteiventris) from 30 populations, together with site-level spatial coordinates. Please see the introductory video on the DGS course website, R lab page.</p>
<ul>
<li><strong>ralu_loci_allpops.csv</strong>: Data frame with populations and genetic data (406 rows x 9 columns). Included as external file in package <code>LandGenCourse</code>.</li>
<li><strong>Frogs_diversity_allpops.csv</strong>: Table with genetic diversity variables similar to Week 3.</li>
<li><strong>ralu_coords_allpops.csv</strong>: Spatial coordinates (both in UTM and LongLat format), and basin.</li>
</ul>
</div>
<div id="c.-required-r-packages" class="section level4">
<h4>c. Required R packages</h4>
<p>Install some packages (not on CRAN) that are needed for this worked example.</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="WE-5.html#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;EcoGenetics&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb580-2"><a href="WE-5.html#cb580-2" aria-hidden="true" tabindex="-1"></a>  remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;leandroroser/EcoGenetics-devel&quot;</span>)</span>
<span id="cb580-3"><a href="WE-5.html#cb580-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;GeNetIt&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;jeffreyevans/GeNetIt&quot;</span>)</span>
<span id="cb580-4"><a href="WE-5.html#cb580-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;popgraph&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;dyerlab/popgraph&quot;</span>)</span>
<span id="cb580-5"><a href="WE-5.html#cb580-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;gstudio&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;dyerlab/gstudio&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="WE-5.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LandGenCourse)</span>
<span id="cb581-2"><a href="WE-5.html#cb581-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GeNetIt)</span>
<span id="cb581-3"><a href="WE-5.html#cb581-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb581-4"><a href="WE-5.html#cb581-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EcoGenetics)</span>
<span id="cb581-5"><a href="WE-5.html#cb581-5" aria-hidden="true" tabindex="-1"></a><span class="co">#require(adegenet)</span></span>
<span id="cb581-6"><a href="WE-5.html#cb581-6" aria-hidden="true" tabindex="-1"></a><span class="co">#require(tibble)</span></span>
<span id="cb581-7"><a href="WE-5.html#cb581-7" aria-hidden="true" tabindex="-1"></a><span class="co">#require(gstudio)</span></span>
<span id="cb581-8"><a href="WE-5.html#cb581-8" aria-hidden="true" tabindex="-1"></a><span class="co">#require(hierfstat)</span></span>
<span id="cb581-9"><a href="WE-5.html#cb581-9" aria-hidden="true" tabindex="-1"></a><span class="co">#require(PopGenReport)</span></span>
<span id="cb581-10"><a href="WE-5.html#cb581-10" aria-hidden="true" tabindex="-1"></a><span class="co">#require(mmod)</span></span>
<span id="cb581-11"><a href="WE-5.html#cb581-11" aria-hidden="true" tabindex="-1"></a><span class="co">#require(spdep)</span></span></code></pre></div>
</div>
</div>
<div id="data-import-and-manipulation" class="section level3">
<h3>2. Data import and manipulation</h3>
<div id="a.-create-an-ecogen-object" class="section level4">
<h4>a. Create an ecogen object</h4>
<p>Import the site data that we used before in Week 2.</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="WE-5.html#cb582-1" aria-hidden="true" tabindex="-1"></a>Frogs.coords <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;ralu_coords_allpops.csv&quot;</span>, </span>
<span id="cb582-2"><a href="WE-5.html#cb582-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>))</span></code></pre></div>
<p>In Week 3, we calculated population-level genetic data as a table <code>Frogs.diversity</code>. Here we import a table with the same diversity measures for all 29 sites from a system file in <code>LandGenCourse</code>.</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="WE-5.html#cb583-1" aria-hidden="true" tabindex="-1"></a>Frogs.diversity <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Frogs_diversity_allpops.csv&quot;</span>, </span>
<span id="cb583-2"><a href="WE-5.html#cb583-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>))</span></code></pre></div>
<p>Import the genetic data for 29 sites:</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="WE-5.html#cb584-1" aria-hidden="true" tabindex="-1"></a>Frogs.loci <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;ralu_loci_allpops.csv&quot;</span>, </span>
<span id="cb584-2"><a href="WE-5.html#cb584-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>))</span></code></pre></div>
<p>We start building an <code>ecogen</code> object by assigning the genetic data to the <code>G</code> slot, and the structure (i.e., hierarchical sampling information, here site names) to the <code>S</code> slot. For the genetic data, we need to specify the type of data and coding.</p>
<p>Note the tweak using <code>data.frame</code> when specifying <code>data.frame(ralu.loci[,1:2])</code>. This is necessary to import the multiple columns correctly and with their original names.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="WE-5.html#cb585-1" aria-hidden="true" tabindex="-1"></a>Frogs.ecogen <span class="ot">&lt;-</span> <span class="fu">ecogen</span>(<span class="at">G =</span> Frogs.loci[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)], <span class="at">ploidy =</span> <span class="dv">2</span>, </span>
<span id="cb585-2"><a href="WE-5.html#cb585-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&quot;codominant&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;:&quot;</span>,</span>
<span id="cb585-3"><a href="WE-5.html#cb585-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">S =</span> <span class="fu">data.frame</span>(Frogs.loci[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]))</span>
<span id="cb585-4"><a href="WE-5.html#cb585-4" aria-hidden="true" tabindex="-1"></a>Frogs.ecogen</span></code></pre></div>
<pre><code>## 
##                    || ECOGEN CLASS OBJECT ||
## ----------------------------------------------------------------------------
##  Access to slots: &lt;ecoslot.&gt; + &lt;name of the slot&gt; + &lt;(name of the object)&gt; 
##  See: help(&quot;EcoGenetics accessors&quot;)
## ----------------------------------------------------------------------------
## 
##  | slot XY:    | --&gt; 0 x 0          coordinates
##  | slot P:     | --&gt; 0 x 0          phenotypic variables
##  | slot G:     | --&gt; 413 x 8        loci         &gt;&gt; ploidy: 2 || codominant
##  | slot A:     | --&gt; 413 x 43       alleles
##  | slot E:     | --&gt; 0 x 0          environmental variables
##  | slot S:     | --&gt; 413 x 2        structures   &gt;&gt; 2 structures found
##  | slot C:     | --&gt; 0 x 0          variables
##  | slot OUT:   | --&gt; 0              results
## ----------------------------------------------------------------------------</code></pre>
<p>The summary confirms that we now have data in the <code>S</code> and <code>G</code> slots. In addition, EcoGenetics created a table of absolute frequencies (i.e. counts) of alleles for each individual in slot <code>A</code>.</p>
</div>
<div id="b.-aggregate-to-ecopop" class="section level4">
<h4>b. Aggregate to ecopop</h4>
<p>Most of our analysis for this lab will be at the population level. The function <code>ecogen2ecopop</code> aggregates from individual to population-level data.</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="WE-5.html#cb587-1" aria-hidden="true" tabindex="-1"></a>Frogs.ecopop <span class="ot">&lt;-</span> <span class="fu">ecogen2ecopop</span>(Frogs.ecogen, <span class="at">hier =</span> <span class="st">&quot;SiteName&quot;</span>)</span>
<span id="cb587-2"><a href="WE-5.html#cb587-2" aria-hidden="true" tabindex="-1"></a>Frogs.ecopop</span></code></pre></div>
<pre><code>## 
##                    &lt;&lt; ECOPOP CLASS OBJECT &gt;&gt;
## ****************************************************************************
##  Access to slots: &lt;ecoslot.&gt; + &lt;name of the slot&gt; + &lt;(name of the object)&gt; 
##  See: help(&quot;EcoGenetics accessors&quot;)
## ****************************************************************************
## 
##  # slot XY:    # =&gt;  0 x 0          coordinates
##  # slot P:     # =&gt;  0 x 0          phenotypic variables
##  # slot AF:    # =&gt;  30 x 43        loci         &gt;&gt; ploidy: 2 || codominant
##  # slot E:     # =&gt;  0 x 0          environmental variables
##  # slot S:     # =&gt;  30 x 1         population found
##  # slot C:     # =&gt;  0 x 0          variables
## ****************************************************************************</code></pre>
<p>Instead of 413 individuals, we now have data for 30 populations. Slot <code>AF</code> contains the population-level absolute frequencies (counts) of alleles.</p>
</div>
<div id="b.-add-site-level-data" class="section level4">
<h4>b. Add site-level data</h4>
<p>Before importing the genetic diversity, spatial coordinates and site data into the <code>ecopop</code> object, we need to match the rows and extract the data for the sampled populations.</p>
<p>Unfortunately, the datasets use different versions of the site name, both were include in the file <code>ralu_loci_allpops.csv</code> and thus in the <code>S</code> slot of <code>Frogs.ecogen</code>.</p>
<ul>
<li>Here, we use <code>group_by</code> and <code>summarize</code> to get the unique set of site names in both versions. We save it as a data frame Subset.</li>
<li>Then we join the genetic diversity data. Because the two data frames share a common variable, we dont’ need to specify the argument <code>by</code>. R will confirm what ID variable it used to join.</li>
</ul>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="WE-5.html#cb589-1" aria-hidden="true" tabindex="-1"></a>Subset <span class="ot">&lt;-</span> <span class="fu">ecoslot.S</span>(Frogs.ecogen) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(SiteName, Pop) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;SiteName&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="WE-5.html#cb591-1" aria-hidden="true" tabindex="-1"></a>Subset <span class="ot">&lt;-</span> <span class="fu">left_join</span>(Subset, Frogs.diversity)</span></code></pre></div>
<pre><code>## Joining, by = &quot;Pop&quot;</code></pre>
<p>R tells us that it used the shared ID variable <code>Pop</code> to join the data.</p>
<p>Now we can join the site data. Note: with <code>as.data.frame</code>, we combine the <code>@data</code> and <code>@coords</code> slots of the SpatialPointsDataFrame <code>ralu.site</code> to a single data frame.</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="WE-5.html#cb593-1" aria-hidden="true" tabindex="-1"></a>Subset <span class="ot">&lt;-</span> <span class="fu">left_join</span>(Subset, <span class="fu">as.data.frame</span>(Frogs.coords))</span></code></pre></div>
<pre><code>## Joining, by = &quot;SiteName&quot;</code></pre>
<p>This time, R used the shared ID variable <code>SiteName</code> to join the data.</p>
<p>Now we have all site-level data in the data frame <code>Subset</code> that has the same row names as <code>Frogs.ecopop</code>. We check the names of the variables to decide which ones to put where. Then we assign them to their respective slots (<span class="citation">(<a href="#ref-C" role="doc-biblioref"><strong>C?</strong></a>)</span> for the custom data, here genetic diversity, <code>@E</code> for the environmental data, and <code>@XY</code> for the coordinates).</p>
<p>The argument pop specifies the matching ID variable in the <code>@S</code> slot. When we aggregated from <code>Frogs.ecogen</code> to <code>Frogs.ecopop</code>, unfortunately EcoGenetics renamed the variable <code>SiteName</code> to <code>pop</code>. The argument <code>pop_levels</code> identifies the corresponding ID variable in <code>Subset</code>.</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="WE-5.html#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Subset)</span></code></pre></div>
<pre><code>##  [1] &quot;SiteName&quot;  &quot;Pop&quot;       &quot;n&quot;         &quot;Hobs&quot;      &quot;Hexp&quot;      &quot;Ar&quot;       
##  [7] &quot;UTM83_E&quot;   &quot;UTM83_N&quot;   &quot;Longitude&quot; &quot;Latitude&quot;  &quot;Basin&quot;</code></pre>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="WE-5.html#cb597-1" aria-hidden="true" tabindex="-1"></a>Frogs.ecopop <span class="ot">&lt;-</span> EcoGenetics<span class="sc">::</span><span class="fu">eco.fill_ecogen_with_df</span>(Frogs.ecopop,</span>
<span id="cb597-2"><a href="WE-5.html#cb597-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">pop =</span><span class="st">&quot;pop&quot;</span>, <span class="at">pop_levels =</span> Subset<span class="sc">$</span>SiteName, </span>
<span id="cb597-3"><a href="WE-5.html#cb597-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">C =</span> Subset[,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>],</span>
<span id="cb597-4"><a href="WE-5.html#cb597-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">XY =</span> Subset[,<span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb597-5"><a href="WE-5.html#cb597-5" aria-hidden="true" tabindex="-1"></a>Frogs.ecopop</span></code></pre></div>
<pre><code>## 
##                    &lt;&lt; ECOPOP CLASS OBJECT &gt;&gt;
## ****************************************************************************
##  Access to slots: &lt;ecoslot.&gt; + &lt;name of the slot&gt; + &lt;(name of the object)&gt; 
##  See: help(&quot;EcoGenetics accessors&quot;)
## ****************************************************************************
## 
##  # slot XY:    # =&gt;  30 x 4         coordinates
##  # slot P:     # =&gt;  0 x 0          phenotypic variables
##  # slot AF:    # =&gt;  30 x 43        loci         &gt;&gt; ploidy: 2 || codominant
##  # slot E:     # =&gt;  0 x 0          environmental variables
##  # slot S:     # =&gt;  30 x 1         population found
##  # slot C:     # =&gt;  30 x 4         variables
## ****************************************************************************</code></pre>
</div>
<div id="c.-export-to-adegenet-and-gstudio" class="section level4">
<h4>c. Export to adegenet and gstudio</h4>
<p>‘EcoGenetics’ provides convenient functions for converting genetic data to and from other packages.</p>
<p>Import into ‘genind’ object (package ‘adegenet’): there is a dedicated function, but we need to separately declare the variable that represents the populations and write it into the <code>@pop</code> slot of the ‘genind’ object.</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="WE-5.html#cb599-1" aria-hidden="true" tabindex="-1"></a>Frogs.genind <span class="ot">&lt;-</span> EcoGenetics<span class="sc">::</span><span class="fu">ecogen2genind</span>(Frogs.ecogen)</span></code></pre></div>
<pre><code>## Loading required package: adegenet</code></pre>
<pre><code>## Loading required package: ade4</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;spdep&#39;:
##   method   from
##   plot.mst ape</code></pre>
<pre><code>## 
##    /// adegenet 2.1.3 is loaded ////////////
## 
##    &gt; overview: &#39;?adegenet&#39;
##    &gt; tutorials/doc/questions: &#39;adegenetWeb()&#39; 
##    &gt; bug reports/feature requests: adegenetIssues()</code></pre>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="WE-5.html#cb604-1" aria-hidden="true" tabindex="-1"></a>Frogs.genind<span class="sc">@</span>pop <span class="ot">&lt;-</span> <span class="fu">ecoslot.S</span>(Frogs.ecogen)<span class="sc">$</span>SiteName</span></code></pre></div>
<p>For calculating population-level genetic distances, we aggregate the individual-level data to a <code>genpop</code> object with population-level allele frequencies.</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="WE-5.html#cb605-1" aria-hidden="true" tabindex="-1"></a>Frogs.genpop <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">genind2genpop</span>(Frogs.genind)</span></code></pre></div>
<pre><code>## 
##  Converting data from a genind to a genpop object... 
## 
## ...done.</code></pre>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="WE-5.html#cb607-1" aria-hidden="true" tabindex="-1"></a>Frogs.genpop</span></code></pre></div>
<pre><code>## /// GENPOP OBJECT /////////
## 
##  // 30 populations; 8 loci; 43 alleles; size: 18.2 Kb
## 
##  // Basic content
##    @tab:  30 x 43 matrix of allele counts
##    @loc.n.all: number of alleles per locus (range: 3-9)
##    @loc.fac: locus factor for the 43 columns of @tab
##    @all.names: list of allele names for each locus
##    @ploidy: ploidy of each individual  (range: 2-2)
##    @type:  codom
##    @call: adegenet::genind2genpop(x = Frogs.genind)
## 
##  // Optional content
##    - empty -</code></pre>
<p>Note: Alternatively, we could directly import the <code>ecopop</code> object into a <code>genpop</code> object (<code>adegenet</code>) with <code>EcoGenetics::ecopop2genpop(Frogs.ecopop)</code>. However, this can create warnings later on when calculating genetic distances.</p>
<p>The object ‘Frogs.genpop’ has 30 rows, each representing a population.</p>
<p>We will also use some functions from the package <code>gstudio</code>, hence we import the individual-level genetic data into <code>gstudio</code>. This should be easy with the function <code>EcoGenetics::ecogen2gstudio</code>. However, there seems to be an issue. The following chunk contains code adapted from within the <code>ecogen2gstudio</code> function, tweaked to work for our data. (You can view the original function with: <code>findMethods(ecogen2gstudio)</code>.)</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="WE-5.html#cb609-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Frogs.gstudio &lt;- EcoGenetics::ecogen2gstudio(Frogs.ecogen, type=&quot;codominant&quot;)</span></span>
<span id="cb609-2"><a href="WE-5.html#cb609-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-3"><a href="WE-5.html#cb609-3" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">eco.convert</span>(Frogs.ecogen<span class="sc">@</span>G, <span class="st">&quot;matrix&quot;</span>, <span class="at">sep.in =</span> <span class="st">&quot;:&quot;</span>, <span class="at">sep.out =</span> <span class="st">&quot;:&quot;</span>)</span>
<span id="cb609-4"><a href="WE-5.html#cb609-4" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dat, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb609-5"><a href="WE-5.html#cb609-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(dat)) {</span>
<span id="cb609-6"><a href="WE-5.html#cb609-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">class</span>(dat[, i]) <span class="ot">&lt;-</span> <span class="st">&quot;locus&quot;</span></span>
<span id="cb609-7"><a href="WE-5.html#cb609-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb609-8"><a href="WE-5.html#cb609-8" aria-hidden="true" tabindex="-1"></a>  dat[<span class="fu">is.na</span>(dat)] <span class="ot">&lt;-</span> gstudio<span class="sc">::</span><span class="fu">locus</span>(<span class="cn">NA</span>)</span>
<span id="cb609-9"><a href="WE-5.html#cb609-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(Frogs.ecogen<span class="sc">@</span>G)</span>
<span id="cb609-10"><a href="WE-5.html#cb609-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-11"><a href="WE-5.html#cb609-11" aria-hidden="true" tabindex="-1"></a>Frogs.gstudio <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">ecoslot.S</span>(Frogs.ecogen), dat)</span>
<span id="cb609-12"><a href="WE-5.html#cb609-12" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">as_tibble</span>(Frogs.gstudio)        </span></code></pre></div>
<pre><code>## # A tibble: 413 x 10
##    SiteName    Pop     A       B       C      D      E      F      G      H     
##    &lt;fct&gt;       &lt;fct&gt;   &lt;locus&gt; &lt;locus&gt; &lt;locu&gt; &lt;locu&gt; &lt;locu&gt; &lt;locu&gt; &lt;locu&gt; &lt;locu&gt;
##  1 AirplaneLa~ Airpla~ 1:1     1:1     1:1    1:1    1:2    1:1    1:1    4:5   
##  2 AirplaneLa~ Airpla~ 2:2     1:1            1:1    1:1           2:2          
##  3 AirplaneLa~ Airpla~ 1:1     1:1     1:1    1:1    3:3    1:1    1:1    3:3   
##  4 AirplaneLa~ Airpla~ 1:1     1:1            2:2    1:2                        
##  5 AirplaneLa~ Airpla~ 1:2     1:3     1:1    1:1    1:2    1:1    1:2    4:5   
##  6 AirplaneLa~ Airpla~ 1:2     1:1     1:1    1:3    1:1    1:1    1:2    4:5   
##  7 AirplaneLa~ Airpla~ 2:2     1:3     1:1    1:1    3:3    1:1    1:1    2:3   
##  8 AirplaneLa~ Airpla~ 2:2     1:3     1:1    1:1    3:3    1:1    1:1    2:3   
##  9 AirplaneLa~ Airpla~ 1:3     1:1     1:1    1:1    1:7    1:1    1:1    3:5   
## 10 AirplaneLa~ Airpla~ 2:2     1:3     1:1    1:1    3:7    1:1    1:1    3:3   
## # ... with 403 more rows</code></pre>
</div>
</div>
<div id="calculate-genetic-distances" class="section level3">
<h3>3. Calculate genetic distances</h3>
<p>Here, we’ll calculate a number of different measures of genetic distance, using functions from several packages. Adding the package name to each distance matrix name helps keeping track of methods used. Normally you would not calculate all of them for your own data, and some are redundant, as we will see.</p>
<p>Note: Some functions provide an option <code>linearized = TRUE</code> to linearize distances <code>d</code> by calculating <code>d/(1-d)</code>. This should result in more linear relationships when plotted or correlated against geographic distance.Here we don’t linearize, we can do so later manually.</p>
<div id="a.-genetic-distances-calculated-from-genind-object" class="section level4">
<h4>a. Genetic distances calculated from genind object</h4>
<p>Pairwise Fst with package <code>hierfstat</code>:</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="WE-5.html#cb611-1" aria-hidden="true" tabindex="-1"></a>GD.pop.PairwiseFst.hierfstat <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(hierfstat<span class="sc">::</span><span class="fu">pairwise.neifst</span>(hierfstat<span class="sc">::</span><span class="fu">genind2hierfstat</span>(Frogs.genind)))</span></code></pre></div>
<p>Proportion of shared alleles with package ‘PopGenReport’:</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="WE-5.html#cb612-1" aria-hidden="true" tabindex="-1"></a>GD.pop.propShared <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">pairwise.propShared</span>(Frogs.genind)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;pegas&#39;:
##   method      from
##   print.amova ade4</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;genetics&#39;:
##   method      from   
##   print.locus gstudio
##   [.haplotype pegas</code></pre>
<p>Several distance matrices with package ‘adegenet’:</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="WE-5.html#cb616-1" aria-hidden="true" tabindex="-1"></a>GD.pop.Nei <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">dist.genpop</span>(Frogs.genpop, <span class="at">method=</span><span class="dv">1</span>)   </span>
<span id="cb616-2"><a href="WE-5.html#cb616-2" aria-hidden="true" tabindex="-1"></a>GD.pop.Edwards <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">dist.genpop</span>(Frogs.genpop, <span class="at">method=</span><span class="dv">2</span>)</span>
<span id="cb616-3"><a href="WE-5.html#cb616-3" aria-hidden="true" tabindex="-1"></a>GD.pop.Reynolds <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">dist.genpop</span>(Frogs.genpop, <span class="at">method=</span><span class="dv">3</span>)  </span>
<span id="cb616-4"><a href="WE-5.html#cb616-4" aria-hidden="true" tabindex="-1"></a>GD.pop.Rogers <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">dist.genpop</span>(Frogs.genpop, <span class="at">method=</span><span class="dv">4</span>)  </span>
<span id="cb616-5"><a href="WE-5.html#cb616-5" aria-hidden="true" tabindex="-1"></a>GD.pop.Provesti <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">dist.genpop</span>(Frogs.genpop, <span class="at">method=</span><span class="dv">5</span>)</span></code></pre></div>
<p>Additional distance matrices with package ‘mmod’:</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="WE-5.html#cb617-1" aria-hidden="true" tabindex="-1"></a>GD.pop.Joost <span class="ot">&lt;-</span> mmod<span class="sc">::</span><span class="fu">pairwise_D</span>(Frogs.genind, <span class="at">linearized =</span> <span class="cn">FALSE</span>)</span>
<span id="cb617-2"><a href="WE-5.html#cb617-2" aria-hidden="true" tabindex="-1"></a>GD.pop.Hedrick <span class="ot">&lt;-</span> mmod<span class="sc">::</span><span class="fu">pairwise_Gst_Hedrick</span>(Frogs.genind, <span class="at">linearized =</span> <span class="cn">FALSE</span>)</span>
<span id="cb617-3"><a href="WE-5.html#cb617-3" aria-hidden="true" tabindex="-1"></a>GD.pop.NeiGst <span class="ot">&lt;-</span> mmod<span class="sc">::</span><span class="fu">pairwise_Gst_Nei</span>(Frogs.genind, <span class="at">linearized =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="b.-more-distance-matrices-with-gstudio" class="section level4">
<h4>b. More distance matrices with ‘gstudio’</h4>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="WE-5.html#cb618-1" aria-hidden="true" tabindex="-1"></a>GD.pop.Euclidean.gstudio <span class="ot">&lt;-</span>gstudio<span class="sc">::</span><span class="fu">genetic_distance</span>(Frogs.gstudio, <span class="at">mode =</span> <span class="st">&quot;Euclidean&quot;</span>, <span class="at">stratum=</span><span class="st">&quot;SiteName&quot;</span>)</span></code></pre></div>
<pre><code>## Multilous estimates of Euclidean distance are assumed to be additive.</code></pre>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="WE-5.html#cb620-1" aria-hidden="true" tabindex="-1"></a>GD.pop.cGD.gstudio <span class="ot">&lt;-</span>gstudio<span class="sc">::</span><span class="fu">genetic_distance</span>(Frogs.gstudio, <span class="at">mode =</span> <span class="st">&quot;cGD&quot;</span>, <span class="at">stratum=</span><span class="st">&quot;SiteName&quot;</span>)</span>
<span id="cb620-2"><a href="WE-5.html#cb620-2" aria-hidden="true" tabindex="-1"></a>GD.pop.Nei.gstudio <span class="ot">&lt;-</span>gstudio<span class="sc">::</span><span class="fu">genetic_distance</span>(Frogs.gstudio, <span class="at">mode =</span> <span class="st">&quot;Nei&quot;</span>, <span class="at">stratum=</span><span class="st">&quot;SiteName&quot;</span>)</span>
<span id="cb620-3"><a href="WE-5.html#cb620-3" aria-hidden="true" tabindex="-1"></a>GD.pop.Dps.gstudio <span class="ot">&lt;-</span>gstudio<span class="sc">::</span><span class="fu">genetic_distance</span>(Frogs.gstudio, <span class="at">mode =</span> <span class="st">&quot;Dps&quot;</span>, <span class="at">stratum=</span><span class="st">&quot;SiteName&quot;</span>)</span></code></pre></div>
<pre><code>## Bray distance will be assumed to be entirely additive across loci.</code></pre>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="WE-5.html#cb622-1" aria-hidden="true" tabindex="-1"></a>GD.pop.Jaccard.gstudio <span class="ot">&lt;-</span>gstudio<span class="sc">::</span><span class="fu">genetic_distance</span>(Frogs.gstudio, <span class="at">mode =</span> <span class="st">&quot;Jaccard&quot;</span>, <span class="at">stratum=</span><span class="st">&quot;SiteName&quot;</span>)</span></code></pre></div>
<pre><code>## Jaccard distance will be assumed to be entirely additive across loci.</code></pre>
</div>
<div id="c.-assemble-distance-matrices" class="section level4">
<h4>c. Assemble distance matrices</h4>
<p>We’ll store the population-level genetic distances in a list ‘GD.pop.’</p>
<p>Note: a few measures return similarities (scaled between 0 and 1) instead of distances. For instance, ‘proporition of shared alleles’ is 1 if the alleles are identical, and zero of no alleles are shared. We convert these values to distances by subtracting them from 1.</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="WE-5.html#cb624-1" aria-hidden="true" tabindex="-1"></a>GD.pop <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">pairwiseFst.hierfstat =</span> GD.pop.PairwiseFst.hierfstat,</span>
<span id="cb624-2"><a href="WE-5.html#cb624-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">propShared.PopGenReport =</span> <span class="dv">1</span> <span class="sc">-</span> GD.pop.propShared,</span>
<span id="cb624-3"><a href="WE-5.html#cb624-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Nei.adegenet =</span> GD.pop.Nei,</span>
<span id="cb624-4"><a href="WE-5.html#cb624-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">Edwards.adegenet =</span> GD.pop.Edwards,</span>
<span id="cb624-5"><a href="WE-5.html#cb624-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">Reynolds.adegenet =</span> GD.pop.Reynolds,</span>
<span id="cb624-6"><a href="WE-5.html#cb624-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">Rogers.adegenet =</span> GD.pop.Rogers,</span>
<span id="cb624-7"><a href="WE-5.html#cb624-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">Provesti.adegenet =</span> GD.pop.Provesti,</span>
<span id="cb624-8"><a href="WE-5.html#cb624-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">Joost.mmod =</span> GD.pop.Joost,</span>
<span id="cb624-9"><a href="WE-5.html#cb624-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">Hedrick.mmod =</span> GD.pop.Hedrick,</span>
<span id="cb624-10"><a href="WE-5.html#cb624-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">Nei.mmod =</span> GD.pop.NeiGst,</span>
<span id="cb624-11"><a href="WE-5.html#cb624-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">Euclidean.gstudio =</span> <span class="fu">as.dist</span>(GD.pop.Euclidean.gstudio),</span>
<span id="cb624-12"><a href="WE-5.html#cb624-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">cGD.gstudio =</span> <span class="fu">as.dist</span>(GD.pop.cGD.gstudio),</span>
<span id="cb624-13"><a href="WE-5.html#cb624-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">Nei.gstudio =</span> <span class="fu">as.dist</span>(GD.pop.Nei.gstudio),</span>
<span id="cb624-14"><a href="WE-5.html#cb624-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">Dps.gstudio =</span> <span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> GD.pop.Dps.gstudio),</span>
<span id="cb624-15"><a href="WE-5.html#cb624-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">Jaccard.gstudio =</span> <span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> GD.pop.Jaccard.gstudio))</span>
<span id="cb624-16"><a href="WE-5.html#cb624-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(<span class="fu">sapply</span>(GD.pop, <span class="cf">function</span>(ls) <span class="fu">as.vector</span>(ls))),<span class="dv">2</span>)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>##                         pairwiseFst.hierfstat propShared.PopGenReport
## pairwiseFst.hierfstat                    1.00                    0.79
## propShared.PopGenReport                  0.79                    1.00
## Nei.adegenet                             0.85                    0.96
## Edwards.adegenet                         0.83                    0.93
## Reynolds.adegenet                        0.97                    0.82
## Rogers.adegenet                          0.83                    0.99
## Provesti.adegenet                        0.79                    1.00
## Joost.mmod                               0.90                    0.95
## Hedrick.mmod                             0.98                    0.88
## Nei.mmod                                 1.00                    0.77
## Euclidean.gstudio                        0.93                    0.95
## cGD.gstudio                              0.50                    0.62
## Nei.gstudio                              0.85                    0.96
## Dps.gstudio                              0.71                    0.90
## Jaccard.gstudio                          0.71                    0.90</code></pre>
<p>Consider the correlations printed above (only the first two columns of the correlation matrix are shown).</p>
<ul>
<li>Correlations are high in general, except for conditional genetic distance (cGD) (see Week 13).</li>
<li>There are some duplicate measures (with correlation = 1).</li>
</ul>
<p>Note: the following functions calculate distance matrices at the individual level:</p>
<ul>
<li>PopGenReport::gd.smouse()</li>
<li>adegenet::propShared()</li>
<li>gstudio::genetic_distance(mode = “AMOVA”)</li>
</ul>
</div>
<div id="d.-export-genetic-distance-matrices" class="section level4">
<h4>d. Export genetic distance matrices</h4>
<p>Optional: You can use <code>save</code> to save an R object to your file system, and <code>load</code> to read it in again. Note: the default setting is that <code>save</code> will overwrite existing files with the same name.</p>
<p>The code is commented out with <code>#</code>. To run it, remove the <code>#</code>. The first part creates a folder <code>output</code> in your project folder if it does not yet exist. The function <code>save</code> writes the list <code>GD.pop</code> into a file “GD.pop.RData,” and the function <code>load</code> imports it again.</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="WE-5.html#cb626-1" aria-hidden="true" tabindex="-1"></a><span class="co">#require(here)</span></span>
<span id="cb626-2"><a href="WE-5.html#cb626-2" aria-hidden="true" tabindex="-1"></a><span class="co">#if(!dir.exists(paste0(here::here(),&quot;/output&quot;))) dir.create(paste0(here::here(),&quot;/output&quot;))</span></span>
<span id="cb626-3"><a href="WE-5.html#cb626-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-4"><a href="WE-5.html#cb626-4" aria-hidden="true" tabindex="-1"></a><span class="co">#save(GD.pop, file = paste0(here::here(),&quot;/output/GD.pop.RData&quot;))</span></span>
<span id="cb626-5"><a href="WE-5.html#cb626-5" aria-hidden="true" tabindex="-1"></a><span class="co">#load(paste0(here::here(),&quot;/output/GD.pop.RData&quot;))</span></span></code></pre></div>
</div>
</div>
<div id="perform-a-mantel-test-to-test-for-ibd" class="section level3">
<h3>4. Perform a Mantel test to test for IBD</h3>
<p>First, we calculate geographic (Euclidean) distances <code>Dgeo</code> with the <code>dist</code> function, using the spatial coordinates that we imported from ralu.site. These are UTM coordinates and thus metric.</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="WE-5.html#cb627-1" aria-hidden="true" tabindex="-1"></a>Dgeo <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">dist</span>(<span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]))</span></code></pre></div>
<div id="a.-visually-check-linearity" class="section level4">
<h4>a. Visually check linearity</h4>
<p>Before we quantify the linear relationship between genetic and geographic distances, let’s check visually whether the relationship is indeed linear. To start, we will define genetic distance <code>Dgen</code> based on proportion of shared alleles.</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="WE-5.html#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb628-2"><a href="WE-5.html#cb628-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb628-3"><a href="WE-5.html#cb628-3" aria-hidden="true" tabindex="-1"></a>Dgen <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(GD.pop<span class="sc">$</span>propShared.PopGenReport)</span>
<span id="cb628-4"><a href="WE-5.html#cb628-4" aria-hidden="true" tabindex="-1"></a>dens <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">kde2d</span>(Dgeo, Dgen, <span class="at">n=</span><span class="dv">300</span>)</span>
<span id="cb628-5"><a href="WE-5.html#cb628-5" aria-hidden="true" tabindex="-1"></a>myPal <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;white&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;gold&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;red&quot;</span>))</span>
<span id="cb628-6"><a href="WE-5.html#cb628-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Dgeo, Dgen, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="fl">0.5</span>,  </span>
<span id="cb628-7"><a href="WE-5.html#cb628-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Geographic Distance&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Genetic Distance&quot;</span>)</span>
<span id="cb628-8"><a href="WE-5.html#cb628-8" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(dens, <span class="at">col=</span><span class="fu">transp</span>(<span class="fu">myPal</span>(<span class="dv">300</span>), <span class="fl">0.7</span>), <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb628-9"><a href="WE-5.html#cb628-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(Dgen <span class="sc">~</span> Dgeo))</span>
<span id="cb628-10"><a href="WE-5.html#cb628-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">loess.smooth</span>(Dgeo, Dgen), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="05-Week05_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>There is clearly an increase of genetic distance with geographic distance. However, the red line, which is a smoothed local mean, indicates that the relationship is not linear.</p>
<p>Let’s take the natural logarithm of geographic distance:</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="WE-5.html#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb629-2"><a href="WE-5.html#cb629-2" aria-hidden="true" tabindex="-1"></a>dens <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">kde2d</span>(<span class="fu">log</span>(Dgeo), Dgen, <span class="at">n=</span><span class="dv">300</span>)</span>
<span id="cb629-3"><a href="WE-5.html#cb629-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(Dgeo), Dgen, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="fl">0.5</span>,  </span>
<span id="cb629-4"><a href="WE-5.html#cb629-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Geographic Distance&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Genetic Distance&quot;</span>)</span>
<span id="cb629-5"><a href="WE-5.html#cb629-5" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(dens, <span class="at">col=</span><span class="fu">transp</span>(<span class="fu">myPal</span>(<span class="dv">300</span>), <span class="fl">0.7</span>), <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb629-6"><a href="WE-5.html#cb629-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(Dgen <span class="sc">~</span> <span class="fu">log</span>(Dgeo)))</span>
<span id="cb629-7"><a href="WE-5.html#cb629-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">loess.smooth</span>(<span class="fu">log</span>(Dgeo), Dgen), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="05-Week05_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p><strong>Questions:</strong></p>
<ul>
<li>Is the relationship between Dgen and Dgeo more linear than before the transformation?</li>
<li>What happened to the spread of points along the x axis (geographic distance)?</li>
<li>What do the units of the x-axis represent, after the transformation?</li>
</ul>
</div>
<div id="b.-perform-mantel-test" class="section level4">
<h4>b. Perform Mantel test</h4>
<p>Next, we perform a Mantel test with the function <code>mantel</code> from the <code>vegan</code> package.</p>
<p>We define Dgen and Dgeo anew, as we need them in ‘dist’ format this time, not as vectors.</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="WE-5.html#cb630-1" aria-hidden="true" tabindex="-1"></a>Dgen <span class="ot">&lt;-</span> GD.pop<span class="sc">$</span>propShared.PopGenReport</span>
<span id="cb630-2"><a href="WE-5.html#cb630-2" aria-hidden="true" tabindex="-1"></a>Dgeo <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb630-3"><a href="WE-5.html#cb630-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb630-4"><a href="WE-5.html#cb630-4" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> vegan<span class="sc">::</span><span class="fu">mantel</span>(Dgen,Dgeo, <span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb630-5"><a href="WE-5.html#cb630-5" aria-hidden="true" tabindex="-1"></a>IBD</span></code></pre></div>
<pre><code>## 
## Mantel statistic based on Pearson&#39;s product-moment correlation 
## 
## Call:
## vegan::mantel(xdis = Dgen, ydis = Dgeo, method = &quot;pearson&quot;) 
## 
## Mantel statistic r: 0.6211 
##       Significance: 0.001 
## 
## Upper quantiles of permutations (null model):
##    90%    95%  97.5%    99% 
## 0.0795 0.1120 0.1378 0.1651 
## Permutation: free
## Number of permutations: 999</code></pre>
<p>What happens if we take the log of geographic distance, which we saw above helps linearize the relationship for these data?</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="WE-5.html#cb632-1" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> vegan<span class="sc">::</span><span class="fu">mantel</span>(Dgen,<span class="fu">log</span>(Dgeo), <span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb632-2"><a href="WE-5.html#cb632-2" aria-hidden="true" tabindex="-1"></a>IBD</span></code></pre></div>
<pre><code>## 
## Mantel statistic based on Pearson&#39;s product-moment correlation 
## 
## Call:
## vegan::mantel(xdis = Dgen, ydis = log(Dgeo), method = &quot;pearson&quot;) 
## 
## Mantel statistic r: 0.6839 
##       Significance: 0.001 
## 
## Upper quantiles of permutations (null model):
##    90%    95%  97.5%    99% 
## 0.0654 0.0903 0.1105 0.1342 
## Permutation: free
## Number of permutations: 999</code></pre>
<p>The statistical significance (p-value) didn’t really change, but the strength of the Mantel correlation increased from r = 0.62 to r = 0.68.</p>
<p>Instead of transforming variables, we could use Spearman rank correlation to quantify the strength of the association. Rank correlations can be used to quantify and test the strength of curvilinear relationships.</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="WE-5.html#cb634-1" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> vegan<span class="sc">::</span><span class="fu">mantel</span>(Dgen,Dgeo, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb634-2"><a href="WE-5.html#cb634-2" aria-hidden="true" tabindex="-1"></a>IBD</span></code></pre></div>
<pre><code>## 
## Mantel statistic based on Spearman&#39;s rank correlation rho 
## 
## Call:
## vegan::mantel(xdis = Dgen, ydis = Dgeo, method = &quot;spearman&quot;) 
## 
## Mantel statistic r: 0.6512 
##       Significance: 0.001 
## 
## Upper quantiles of permutations (null model):
##   90%   95% 97.5%   99% 
## 0.075 0.103 0.134 0.158 
## Permutation: free
## Number of permutations: 999</code></pre>
<p>For this measure of genetic diversity, the Mantel correlation was significant, quite strong, and the relationship not linear, hence the transformed data or the rank correlation performed better. What about the other measures?</p>
<p>Here we use <code>lapply</code> to apply the function <code>mantel</code> to each genetic distance matrix in <code>GD.pop</code>. Then we use <code>sapply</code> to extract two values for each distance matrix: <code>statistic</code> is the Mantel r statistic (here: Pearson linear correlation), and <code>signif</code> is the p-value. We can find these names with the function <code>attributes</code> (see above).</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="WE-5.html#cb636-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(IBD)</span></code></pre></div>
<pre><code>## $names
## [1] &quot;call&quot;         &quot;method&quot;       &quot;statistic&quot;    &quot;signif&quot;       &quot;perm&quot;        
## [6] &quot;permutations&quot; &quot;control&quot;     
## 
## $class
## [1] &quot;mantel&quot;</code></pre>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="WE-5.html#cb638-1" aria-hidden="true" tabindex="-1"></a>Mantel.test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(GD.pop, <span class="cf">function</span>(x) vegan<span class="sc">::</span><span class="fu">mantel</span>(x,Dgeo, <span class="at">method=</span><span class="st">&quot;pearson&quot;</span>))</span>
<span id="cb638-2"><a href="WE-5.html#cb638-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Mantel.r =</span> <span class="fu">sapply</span>(Mantel.test, <span class="cf">function</span>(x) x<span class="sc">$</span>statistic),</span>
<span id="cb638-3"><a href="WE-5.html#cb638-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.value =</span> <span class="fu">sapply</span>(Mantel.test, <span class="cf">function</span>(x) x<span class="sc">$</span>signif))</span></code></pre></div>
<pre><code>##                          Mantel.r p.value
## pairwiseFst.hierfstat   0.6238025   0.001
## propShared.PopGenReport 0.6211335   0.001
## Nei.adegenet            0.6316224   0.001
## Edwards.adegenet        0.6639963   0.001
## Reynolds.adegenet       0.6162305   0.001
## Rogers.adegenet         0.6188092   0.001
## Provesti.adegenet       0.6211335   0.001
## Joost.mmod              0.6556870   0.001
## Hedrick.mmod            0.6520614   0.001
## Nei.mmod                0.6147866   0.001
## Euclidean.gstudio       0.6591863   0.001
## cGD.gstudio             0.5667087   0.001
## Nei.gstudio             0.6317948   0.001
## Dps.gstudio             0.5371591   0.001
## Jaccard.gstudio         0.5357096   0.001</code></pre>
<p>The nature of the result did not depend on the measure of genetic diversity used. Let’s repeat the analysis with log(Dgeo).</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="WE-5.html#cb640-1" aria-hidden="true" tabindex="-1"></a>Mantel.test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(GD.pop, <span class="cf">function</span>(x) ade4<span class="sc">::</span><span class="fu">mantel.randtest</span>(x,<span class="fu">log</span>(Dgeo)))</span>
<span id="cb640-2"><a href="WE-5.html#cb640-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Mantel.r =</span> <span class="fu">sapply</span>(Mantel.test, <span class="cf">function</span>(x) x<span class="sc">$</span>obs),</span>
<span id="cb640-3"><a href="WE-5.html#cb640-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.value =</span> <span class="fu">sapply</span>(Mantel.test, <span class="cf">function</span>(x) x<span class="sc">$</span>pvalue))</span></code></pre></div>
<pre><code>##                          Mantel.r p.value
## pairwiseFst.hierfstat   0.6218519   0.001
## propShared.PopGenReport 0.6839092   0.001
## Nei.adegenet            0.6547320   0.001
## Edwards.adegenet        0.7122499   0.001
## Reynolds.adegenet       0.6437788   0.001
## Rogers.adegenet         0.6718605   0.001
## Provesti.adegenet       0.6839092   0.001
## Joost.mmod              0.6748485   0.001
## Hedrick.mmod            0.6673508   0.001
## Nei.mmod                0.6034555   0.001
## Euclidean.gstudio       0.6967457   0.001
## cGD.gstudio             0.6008983   0.001
## Nei.gstudio             0.6548413   0.001
## Dps.gstudio             0.5911350   0.001
## Jaccard.gstudio         0.5880305   0.001</code></pre>
<p><strong>Questions:</strong>
- Did the transformation lead to higher Mantel correlations for all measures of genetic distance used here?
- Why was it higher?</p>
</div>
</div>
<div id="create-mantel-correlogram-for-genetic-data" class="section level3">
<h3>5. Create Mantel correlogram for genetic data</h3>
<p>Let’s look at the relationship between genetic distance and geographic distance in a different way, with a Mantel correlogram. Note that this method does not make the assumption of linearity.</p>
<div id="a.-create-a-first-mantel-correlogram" class="section level4">
<h4>a. Create a first Mantel correlogram</h4>
<p>Here, we’ll create a population-level Mantel correlogram with the proportion of shared alleles.</p>
<p>Note: The function <code>eco.cormantel</code> has an option <code>latlon=TRUE</code> that takes care of the distance calculation from lat-lon coordinates. To use this option, the coordinates must be in a matrix or data frame with the longitude in the first column and the latitude in the second. Here, we can set we can set <code>latlon=FALSE</code> because the spatial coordinates are in UTM projection.</p>
<p>The biological hypothesis of isolation-by-distance postulates that genetic distance increases with geographic distance. Hence it makes sense to use a one-sided alternative. Somewhat counter-intutitively, we use ‘alternative=“less”’ to test for positive spatial autocorrelation.</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="WE-5.html#cb642-1" aria-hidden="true" tabindex="-1"></a>corm <span class="ot">&lt;-</span> EcoGenetics<span class="sc">::</span><span class="fu">eco.cormantel</span>(<span class="at">M =</span> GD.pop<span class="sc">$</span>propShared.PopGenReport, </span>
<span id="cb642-2"><a href="WE-5.html#cb642-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">XY =</span> <span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],  <span class="at">nsim =</span> <span class="dv">199</span>, <span class="at">latlon=</span><span class="cn">FALSE</span>, </span>
<span id="cb642-3"><a href="WE-5.html#cb642-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">alternative=</span><span class="st">&quot;less&quot;</span>, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
 interval 0 / 10 completed
 interval 1 / 10 completed
 interval 2 / 10 completed
 interval 3 / 10 completed
 interval 4 / 10 completed
 interval 5 / 10 completed
 interval 6 / 10 completed
 interval 7 / 10 completed
 interval 8 / 10 completed
 interval 9 / 10 completed
 interval 10 / 10 completed</code></pre>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="WE-5.html#cb644-1" aria-hidden="true" tabindex="-1"></a>corm</span></code></pre></div>
<pre><code>## 
##  ############################ 
##    Mantel statistic 
##  ############################ 
## 
##  &gt; Correlation coefficient used --&gt;  Pearson 
##   &gt; Number of simulations --&gt;  199 
##   &gt; Random test --&gt;  permutation 
##   &gt; P-adjust method --&gt;  holm -sequential: TRUE 
## 
##   &gt;  ecoslot.OUT(x): results --&gt;  
## 
## [[1]]
##                           d.mean     obs     exp p.val cardinal
## d= 0 - 1055.243          697.776  0.4815 -0.0076 0.005       45
## d= 1055.243 - 2110.485  1583.490  0.2708  0.0015 0.010       67
## d= 2110.485 - 3165.728  2622.371  0.2043  0.0015 0.015       64
## d= 3165.728 - 4220.97   3710.591 -0.1302 -0.0024 0.995       64
## d= 4220.97 - 5276.213   4716.029 -0.1719  0.0007 1.000       54
## d= 5276.213 - 6331.455  5824.450 -0.2021 -0.0054 1.000       46
## d= 6331.455 - 7386.698  6856.457 -0.1496 -0.0053 1.000       27
## d= 7386.698 - 8441.941  7883.679 -0.2297 -0.0013 1.000       33
## d= 8441.941 - 9497.183  8882.536 -0.1909  0.0007 1.000       25
## d= 9497.183 - 10552.426 9847.000 -0.0807  0.0073 1.000        9
## 
## 
##  Results table(s) in ecoslot.OUT(x) 
## --------------------------------------------------------------------------
##  Access to slots: &lt;ecoslot.&gt; + &lt;name of the slot&gt; + &lt;(name of the object)&gt; 
##  See: help(&quot;EcoGenetics accessors&quot;)</code></pre>
<p>The table shows:</p>
<ul>
<li>Breaks of distance lag ‘d’: here in meters (default for lag definition: Sturges rule)</li>
<li>Mean distance ‘d.mean’: mean distance of pairs in each lag.</li>
<li>obs: observed value of the statistic</li>
<li>Expected value ‘exp’: expected if there is no autocorrelation.</li>
<li>P-value ‘p.val’: default uses a two-sided permutation test with sequential Holm-Bonferroni adjustement of p-values.</li>
<li>Number of pairs ‘cardinal’: number of unique pairs per lag.</li>
</ul>
<p>The result <code>corm</code> is an object of class <code>eco.correlog</code> (package: EcoGenetics). A safe way to access thet table is <code>ecoslot.OUT(corm)</code>.</p>
<p>Let’s plot the correlogram:</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="WE-5.html#cb646-1" aria-hidden="true" tabindex="-1"></a>EcoGenetics<span class="sc">::</span><span class="fu">eco.plotCorrelog</span>(corm)</span></code></pre></div>
<p>You can hover over individual points of the correlogram to see the test statistic and mean distance.</p>
</div>
<div id="b.-vary-distance-class-definition" class="section level4">
<h4>b. Vary distance class definition</h4>
<p>Under IBD, at least the first distance lag should show positive spatial autocorrelation. Here, it is the first two classes, as indicated by the red symbols.</p>
<p>To what degree does this result depend on the following:</p>
<ul>
<li>The distance lag definition?</li>
<li>The measure of genetic distance?</li>
<li>Non-linear relationship between genetic and geographic distances?</li>
</ul>
<p>There are several options of the <code>eco.cormantel</code> function to modify the definition of distance classes:</p>
<ul>
<li><code>int</code>: distance interval in the units of XY</li>
<li><code>smin</code>: minimum class distance in the units of XY</li>
<li><code>smax</code>: maximum class distance in the units of XY</li>
<li><code>nclass</code>: number of classes</li>
<li><code>seqvec</code>: vector with breaks in the unites of XY</li>
<li><code>size</code>: number of individuals per class</li>
<li><code>bin</code>: rule for constructing intervals if no other parameters provided (default: Sturge’s rule)</li>
</ul>
<p>The easiest ones to modify are either <code>nclass</code> or <code>size</code>. Here we use <code>size</code> to specify that there should be at least 50 or 100 pairs in each distance class. (Note: for a reliable analysis, this should be 100 or more).</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="WE-5.html#cb647-1" aria-hidden="true" tabindex="-1"></a>corm<span class="fl">.50</span> <span class="ot">&lt;-</span> EcoGenetics<span class="sc">::</span><span class="fu">eco.cormantel</span>(<span class="at">M =</span> GD.pop<span class="sc">$</span>propShared.PopGenReport, </span>
<span id="cb647-2"><a href="WE-5.html#cb647-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">XY =</span> <span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],  <span class="at">nsim =</span> <span class="dv">199</span>, <span class="at">latlon=</span><span class="cn">FALSE</span>,</span>
<span id="cb647-3"><a href="WE-5.html#cb647-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">alternative=</span><span class="st">&quot;less&quot;</span>, <span class="at">size=</span><span class="dv">50</span>)</span></code></pre></div>
<pre><code>## 
 interval 0 / 8 completed
 interval 1 / 8 completed
 interval 2 / 8 completed
 interval 3 / 8 completed
 interval 4 / 8 completed
 interval 5 / 8 completed
 interval 6 / 8 completed
 interval 7 / 8 completed
 interval 8 / 8 completed</code></pre>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="WE-5.html#cb649-1" aria-hidden="true" tabindex="-1"></a>EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.OUT</span>(corm<span class="fl">.50</span>)</span></code></pre></div>
<pre><code>## [[1]]
##                          d.mean     obs     exp p.val cardinal
## d= 0 - 1152.337         739.966  0.4872  0.0022 0.005       50
## d= 1152.337 - 1821.843 1536.052  0.2256  0.0036 0.010       50
## d= 1821.843 - 2769.341 2286.134  0.2307  0.0060 0.015       50
## d= 2769.341 - 3526.318 3169.188  0.0411  0.0076 0.265       50
## d= 3526.318 - 4408.262 3992.072 -0.1714  0.0012 1.000       50
## d= 4408.262 - 5339.102 4863.176 -0.1579  0.0055 1.000       50
## d= 5339.102 - 6668.986 6011.873 -0.2404 -0.0001 1.000       50
## d= 6668.986 - 8434.883 7615.126 -0.2429 -0.0042 1.000       50</code></pre>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="WE-5.html#cb651-1" aria-hidden="true" tabindex="-1"></a>corm<span class="fl">.100</span> <span class="ot">&lt;-</span> EcoGenetics<span class="sc">::</span><span class="fu">eco.cormantel</span>(<span class="at">M =</span> GD.pop<span class="sc">$</span>propShared.PopGenReport, </span>
<span id="cb651-2"><a href="WE-5.html#cb651-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">XY =</span> <span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],  <span class="at">nsim =</span> <span class="dv">199</span>, <span class="at">latlon=</span><span class="cn">FALSE</span>,</span>
<span id="cb651-3"><a href="WE-5.html#cb651-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">alternative=</span><span class="st">&quot;less&quot;</span>, <span class="at">size=</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## 
 interval 0 / 4 completed
 interval 1 / 4 completed
 interval 2 / 4 completed
 interval 3 / 4 completed
 interval 4 / 4 completed</code></pre>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="WE-5.html#cb653-1" aria-hidden="true" tabindex="-1"></a>EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.OUT</span>(corm<span class="fl">.100</span>)</span></code></pre></div>
<pre><code>## [[1]]
##                          d.mean     obs     exp p.val cardinal
## d= 0 - 1821.843        1138.009  0.5403 -0.0042 0.005      100
## d= 1821.843 - 3526.318 2727.661  0.2060 -0.0015 0.010      100
## d= 3526.318 - 5339.102 4427.624 -0.2496  0.0063 1.000      100
## d= 5339.102 - 8434.883 6813.499 -0.3664 -0.0084 1.000      100</code></pre>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="WE-5.html#cb655-1" aria-hidden="true" tabindex="-1"></a>EcoGenetics<span class="sc">::</span><span class="fu">eco.plotCorrelog</span>(corm<span class="fl">.50</span>)</span>
<span id="cb655-2"><a href="WE-5.html#cb655-2" aria-hidden="true" tabindex="-1"></a>EcoGenetics<span class="sc">::</span><span class="fu">eco.plotCorrelog</span>(corm<span class="fl">.100</span>)</span></code></pre></div>
<p>Let’s compare the observed Mantel r statistic, p-value, number of pairs in the first distance class and their mean distance, as well as the definition of the first lag interval. We can get all of this by extracting the first line from each object.</p>
<p>The lag intervals are stored only in the row names, and we need to extract those separately and add them as a colum.</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="WE-5.html#cb656-1" aria-hidden="true" tabindex="-1"></a>Lag1.def <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rbind</span>(<span class="at">Sturge =</span> EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.OUT</span>(corm)[[<span class="dv">1</span>]][<span class="dv">1</span>,],</span>
<span id="cb656-2"><a href="WE-5.html#cb656-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">size.50 =</span> EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.OUT</span>(corm<span class="fl">.50</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>,],</span>
<span id="cb656-3"><a href="WE-5.html#cb656-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">size.100 =</span> EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.OUT</span>(corm<span class="fl">.100</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>,]))</span>
<span id="cb656-4"><a href="WE-5.html#cb656-4" aria-hidden="true" tabindex="-1"></a>Lag1.def<span class="sc">$</span>bin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">row.names</span>(EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.OUT</span>(corm)[[<span class="dv">1</span>]])[<span class="dv">1</span>],</span>
<span id="cb656-5"><a href="WE-5.html#cb656-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">row.names</span>(EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.OUT</span>(corm<span class="fl">.50</span>)[[<span class="dv">1</span>]])[<span class="dv">1</span>],</span>
<span id="cb656-6"><a href="WE-5.html#cb656-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">row.names</span>(EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.OUT</span>(corm<span class="fl">.100</span>)[[<span class="dv">1</span>]])[<span class="dv">1</span>])</span>
<span id="cb656-7"><a href="WE-5.html#cb656-7" aria-hidden="true" tabindex="-1"></a>Lag1.def</span></code></pre></div>
<pre><code>##            d.mean    obs     exp p.val cardinal             bin
## Sturge    697.776 0.4815 -0.0076 0.005       45 d= 0 - 1055.243
## size.50   739.966 0.4872  0.0022 0.005       50 d= 0 - 1152.337
## size.100 1138.009 0.5403 -0.0042 0.005      100 d= 0 - 1821.843</code></pre>
<ul>
<li>All three distance class definitions (Sturge’s rule, size = 50, size = 100) resulted in statistically significant p-values.</li>
<li>The Mantel correlation in the first distance lag was strongest for size.100.</li>
<li>For the first distance class, Sturge’s rule resulted in 45 pairs and a mean distance similar to size.50 (for this specific dataset).</li>
</ul>
<p>Overall, Sturge’s rule to define distance classes seems to be a good compromise. What is the trade-off, i.e., what happens if distance lags are defined too narrowly or too widely?</p>
<p>It can be really helpful to plot the distribution of distances among the pairs and compare it to the distance intervals:</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="WE-5.html#cb658-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb658-2"><a href="WE-5.html#cb658-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb658-3"><a href="WE-5.html#cb658-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Dgeo, <span class="at">nclass=</span><span class="dv">50</span>, <span class="at">main=</span><span class="st">&quot;Sturge&#39;s rule&quot;</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb658-4"><a href="WE-5.html#cb658-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.BREAKS</span>(corm))){</span>
<span id="cb658-5"><a href="WE-5.html#cb658-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">rep</span>(EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.BREAKS</span>(corm)[i], <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)}</span>
<span id="cb658-6"><a href="WE-5.html#cb658-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb658-7"><a href="WE-5.html#cb658-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Dgeo, <span class="at">nclass=</span><span class="dv">50</span>, <span class="at">main =</span> <span class="st">&quot;50 pairs per lag&quot;</span>, <span class="at">axes=</span>F)</span>
<span id="cb658-8"><a href="WE-5.html#cb658-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.BREAKS</span>(corm<span class="fl">.50</span>))){</span>
<span id="cb658-9"><a href="WE-5.html#cb658-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">rep</span>(EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.BREAKS</span>(corm<span class="fl">.50</span>)[i], <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)}</span>
<span id="cb658-10"><a href="WE-5.html#cb658-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb658-11"><a href="WE-5.html#cb658-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Dgeo, <span class="at">nclass=</span><span class="dv">50</span>, <span class="at">main =</span> <span class="st">&quot;100 pairs per lag&quot;</span>, <span class="at">axes=</span>F)</span>
<span id="cb658-12"><a href="WE-5.html#cb658-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.BREAKS</span>(corm<span class="fl">.100</span>))){</span>
<span id="cb658-13"><a href="WE-5.html#cb658-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">rep</span>(EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.BREAKS</span>(corm<span class="fl">.100</span>)[i], <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)}</span></code></pre></div>
<p><img src="05-Week05_files/figure-html/unnamed-chunk-37-1.png" width="768" /></p>
<p><strong>Question:</strong> Compare what happens at larger distances. Do you think Sturge’s rule does a good job for these as well?</p>
<p>Unlike a Mantel test, where all pairs are considered, in geostatistics we typically interpret only values for distances up to a certain threshold, e.g. half the maximum distance, for two reasons:</p>
<ul>
<li>There are few pairs in of these bins, making estimates highly variable.</li>
<li>Not all pairs contribute (equally) to the largest distance classes (those in the center of the study area are not involved in very large distances).</li>
</ul>
</div>
<div id="c.-alternative-measures-of-genetic-distances" class="section level4">
<h4>c. Alternative measures of genetic distances</h4>
<p>Which measure of genetic distance would provide the strongest Mantel correlation in the first distance class for this data set?</p>
<p>Here we will cycle through all genetic distance matrices in <code>GD.pop</code> and calculate a Mantel correlogram with Sturge’s rule (not linearized, method=“pearson”). This may take a while.</p>
<p>Note: the code that calculates <code>corm.GD.pop</code> is included here twice, first commented out, then with the option <code>include=FALSE</code>. This avoids printing out a lot of unnecessary output while still showing the (commented out) code in the .html version of the file.</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="WE-5.html#cb659-1" aria-hidden="true" tabindex="-1"></a><span class="co">#corm.GD.pop &lt;- lapply(GD.pop, function(x) EcoGenetics::eco.cormantel(M = x, </span></span>
<span id="cb659-2"><a href="WE-5.html#cb659-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                      XY = ecoslot.XY(Frogs.ecopop)[,1:2],  nsim = 199, latlon=FALSE,</span></span>
<span id="cb659-3"><a href="WE-5.html#cb659-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                      alternative=&quot;less&quot;))</span></span></code></pre></div>
<p>Next, we extract for each genetic distance matrix the observed value of the Mantel correlation for the first distance class and its p-value.</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="WE-5.html#cb660-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">sapply</span>(corm.GD.pop, <span class="cf">function</span>(x) EcoGenetics<span class="sc">::</span><span class="fu">ecoslot.OUT</span>(x)[[<span class="dv">1</span>]][<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]))</span></code></pre></div>
<pre><code>##                            obs p.val
## pairwiseFst.hierfstat   0.3908 0.005
## propShared.PopGenReport 0.4815 0.005
## Nei.adegenet            0.4175 0.005
## Edwards.adegenet        0.4782 0.005
## Reynolds.adegenet       0.4337 0.005
## Rogers.adegenet         0.4704 0.005
## Provesti.adegenet       0.4815 0.005
## Joost.mmod              0.4331 0.005
## Hedrick.mmod            0.4331 0.005
## Nei.mmod                0.3698 0.005
## Euclidean.gstudio       0.4721 0.005
## cGD.gstudio             0.3647 0.005
## Nei.gstudio             0.4175 0.005
## Dps.gstudio             0.4074 0.005
## Jaccard.gstudio         0.4031 0.005</code></pre>
<p>Compare the p-values: for this dataset, all genetic distance measures resulted in significant spatial autocorrelation (indicating IBD).</p>
<p>Let’s plot the Mantel correlogram for <code>Nei.adegenet</code>. Statistically significant lags are shown in a different color than non-significant ones.</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="WE-5.html#cb662-1" aria-hidden="true" tabindex="-1"></a>EcoGenetics<span class="sc">::</span><span class="fu">eco.plotCorrelog</span>(corm.GD.pop<span class="sc">$</span>Nei.adegenet)</span></code></pre></div>
<p><strong>Questions:</strong></p>
<ul>
<li>Starting with the first distance class, how many consecutive distance classes showed significant spatial autocorrelation?</li>
<li>At what distance (range), roughly, did the positive autocorrelation disappear?</li>
</ul>
</div>
</div>
<div id="specify-spatial-weights-and-calculate-morans-i" class="section level3">
<h3>6. Specify spatial weights and calculate Moran’s I</h3>
<p>In this part, we’ll quantify and test Moran’s I for the genetic diversity data as calculated in Week 3 lab.</p>
<p>Note: Above, we used a distance lag approach from geostatistics, here we use spatial neighbours and weights (neighbor topology). Either approach could be used with either type of data.</p>
<p>For a detailed tutorial on defining spatial neighbors and weights, see: <a href="https://cran.r-project.org/web/packages/adespatial/vignettes/tutorial.html#irregular-samplings" class="uri">https://cran.r-project.org/web/packages/adespatial/vignettes/tutorial.html#irregular-samplings</a></p>
<div id="a.-defining-spatial-neighbors" class="section level4">
<h4>a. Defining spatial neighbors</h4>
<p>The function <code>chooseCN</code> (package: <code>adegenet</code>) provides an interface for choosing a connection network, i.e., for defining spatial neighbors. The underlying functions are defined in package <code>spdep</code> (for defining spatial dependences). It can return the following graph types:</p>
<ul>
<li>Delaunay triangulation (type 1)</li>
<li>Gabriel graph (type 2)</li>
<li>Relative neighbours (type 3)</li>
<li>Minimum spanning tree (type 4)</li>
<li>Neighbourhood by distance (type 5)</li>
<li>K nearests neighbours (type 6)</li>
<li>Inverse distances (type 7)</li>
</ul>
<p>Here we use types 1 - 6 to define neighbors in different ways. Then we plot each graph in geographic space. Lines indicate pairs of sites classified as neighbors.</p>
<p>Note: this function expects metric spatial coordinates (e.g., UTM).</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="WE-5.html#cb663-1" aria-hidden="true" tabindex="-1"></a>nb.del <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">chooseCN</span>(<span class="at">xy =</span> <span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb663-2"><a href="WE-5.html#cb663-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">result.type =</span> <span class="st">&quot;nb&quot;</span>, <span class="at">plot.nb =</span> <span class="cn">FALSE</span>, <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb663-3"><a href="WE-5.html#cb663-3" aria-hidden="true" tabindex="-1"></a>nb.gab <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">chooseCN</span>(<span class="at">xy =</span> <span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb663-4"><a href="WE-5.html#cb663-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">result.type =</span> <span class="st">&quot;nb&quot;</span>, <span class="at">plot.nb =</span> <span class="cn">FALSE</span>, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb663-5"><a href="WE-5.html#cb663-5" aria-hidden="true" tabindex="-1"></a>nb.rel <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">chooseCN</span>(<span class="at">xy =</span> <span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb663-6"><a href="WE-5.html#cb663-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">result.type =</span> <span class="st">&quot;nb&quot;</span>, <span class="at">plot.nb =</span> <span class="cn">FALSE</span>, <span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb663-7"><a href="WE-5.html#cb663-7" aria-hidden="true" tabindex="-1"></a>nb.mst <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">chooseCN</span>(<span class="at">xy =</span> <span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb663-8"><a href="WE-5.html#cb663-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">result.type =</span> <span class="st">&quot;nb&quot;</span>, <span class="at">plot.nb =</span> <span class="cn">FALSE</span>, <span class="at">type =</span> <span class="dv">4</span>)</span>
<span id="cb663-9"><a href="WE-5.html#cb663-9" aria-hidden="true" tabindex="-1"></a>nb.nbd <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">chooseCN</span>(<span class="at">xy =</span> <span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb663-10"><a href="WE-5.html#cb663-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">result.type =</span> <span class="st">&quot;nb&quot;</span>, <span class="at">plot.nb =</span> <span class="cn">FALSE</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">d1=</span><span class="dv">100</span>, <span class="at">d2=</span><span class="dv">15000</span>)</span>
<span id="cb663-11"><a href="WE-5.html#cb663-11" aria-hidden="true" tabindex="-1"></a>nb<span class="fl">.4</span>nn <span class="ot">&lt;-</span> adegenet<span class="sc">::</span><span class="fu">chooseCN</span>(<span class="at">xy =</span> <span class="fu">ecoslot.XY</span>(Frogs.ecopop)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb663-12"><a href="WE-5.html#cb663-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">result.type =</span> <span class="st">&quot;nb&quot;</span>, <span class="at">plot.nb =</span> <span class="cn">FALSE</span>, <span class="at">type =</span> <span class="dv">6</span>, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb663-13"><a href="WE-5.html#cb663-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb663-14"><a href="WE-5.html#cb663-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mai=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>, <span class="fl">0.1</span>))</span>
<span id="cb663-15"><a href="WE-5.html#cb663-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb.del, <span class="at">coords=</span><span class="fu">ecoslot.XY</span>(Frogs.ecopop)); <span class="fu">title</span>(<span class="at">main=</span><span class="st">&quot;Delaunay&quot;</span>)</span>
<span id="cb663-16"><a href="WE-5.html#cb663-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb.gab, <span class="at">coords=</span><span class="fu">ecoslot.XY</span>(Frogs.ecopop)); <span class="fu">title</span>(<span class="at">main=</span><span class="st">&quot;Gabriel&quot;</span>)</span>
<span id="cb663-17"><a href="WE-5.html#cb663-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb.rel, <span class="at">coords=</span><span class="fu">ecoslot.XY</span>(Frogs.ecopop)); <span class="fu">title</span>(<span class="at">main=</span> <span class="st">&quot;Rel. neighbors&quot;</span>)</span>
<span id="cb663-18"><a href="WE-5.html#cb663-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb.mst, <span class="at">coords=</span><span class="fu">ecoslot.XY</span>(Frogs.ecopop)); <span class="fu">title</span>(<span class="at">main=</span> <span class="st">&quot;Min spanning tree&quot;</span>)</span>
<span id="cb663-19"><a href="WE-5.html#cb663-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb.nbd, <span class="at">coords=</span><span class="fu">ecoslot.XY</span>(Frogs.ecopop)); <span class="fu">title</span>(<span class="at">main =</span> <span class="st">&quot;Neighbor distance&quot;</span>)</span>
<span id="cb663-20"><a href="WE-5.html#cb663-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb<span class="fl">.4</span>nn, <span class="at">coords=</span><span class="fu">ecoslot.XY</span>(Frogs.ecopop)); <span class="fu">title</span>(<span class="at">main =</span> <span class="st">&quot;4 nearest neighbors&quot;</span>)</span>
<span id="cb663-21"><a href="WE-5.html#cb663-21" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="05-Week05_files/figure-html/unnamed-chunk-42-1.png" width="768" /></p>
<p>For spatial statistics, spatial neighbors are used to calculate a local mean. We want each site to have multiple neighbors, but they should be nearby only. Gabriel graph (type = 2) is often a good option, and we’ll use it for the rest of this worked example.</p>
</div>
<div id="b.-defining-spatial-weights" class="section level4">
<h4>b. Defining spatial weights</h4>
<p>By default, <code>chooseCN</code> returns row-standardized weights, so that for each site, the weights of its neighbors sum to 1. This means that a local mean can be calculated as a weighted mean of the other sites (non-neighboring sites have a weight of 0).</p>
<p>With the function <code>nb2mat</code> we can convert the neighbor object to a matrix of spatial weights. Let’s look at the first five lines and columns:</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="WE-5.html#cb664-1" aria-hidden="true" tabindex="-1"></a>spdep<span class="sc">::</span><span class="fu">nb2mat</span>(nb.gab)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##   [,1]      [,2]      [,3]      [,4] [,5]
## 1    0 0.0000000 0.0000000 0.0000000    0
## 2    0 0.0000000 0.1666667 0.1666667    0
## 3    0 0.2500000 0.0000000 0.0000000    0
## 4    0 0.3333333 0.0000000 0.0000000    0
## 5    0 0.0000000 0.0000000 0.0000000    0</code></pre>
<p>Each row contains the weights for the neighbors of one site. We see that the third site is a neighbor of the second site and vice versa. However, the weights are not the same. It seems that site 2 has six neighbors, so each has a weight of 0.167, whereas site 3 has four neighbors, each with a weight of 0.25.</p>
</div>
<div id="c.-calculating-and-testing-morans-i" class="section level4">
<h4>c. Calculating and testing Moran’s I</h4>
<p>Let’s see whether rarefied allelic richness, Ar, shows spatial autocorrelation among these sites.</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="WE-5.html#cb666-1" aria-hidden="true" tabindex="-1"></a>spdep<span class="sc">::</span><span class="fu">moran.test</span>(<span class="fu">ecoslot.C</span>(Frogs.ecopop)<span class="sc">$</span>Ar, spdep<span class="sc">::</span><span class="fu">nb2listw</span>(nb.gab),</span>
<span id="cb666-2"><a href="WE-5.html#cb666-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  ecoslot.C(Frogs.ecopop)$Ar  
## weights: spdep::nb2listw(nb.gab)    
## 
## Moran I statistic standard deviate = 4.648, p-value = 1.676e-06
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##        0.60990344       -0.03448276        0.01921995</code></pre>
<p>The test statistic is 0.61, and the p-value for a one-sided alternative “greater” (i.e., positive spatial autocorrelation) is <em>p</em> &lt; 0.0001. Thus, Ar showed strong and statistially significant spatial autocorrelation.</p>
<p>Let’s do this for all genetic diversity variables and extract the value of the Moran I statistics (for first neighbors) and its p-value.</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="WE-5.html#cb668-1" aria-hidden="true" tabindex="-1"></a>Frogs.moran <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">ecoslot.C</span>(Frogs.ecopop), </span>
<span id="cb668-2"><a href="WE-5.html#cb668-2" aria-hidden="true" tabindex="-1"></a>                       <span class="cf">function</span>(x) spdep<span class="sc">::</span><span class="fu">moran.test</span>(x,</span>
<span id="cb668-3"><a href="WE-5.html#cb668-3" aria-hidden="true" tabindex="-1"></a>                       spdep<span class="sc">::</span><span class="fu">nb2listw</span>(nb.gab), <span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>))</span>
<span id="cb668-4"><a href="WE-5.html#cb668-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="at">obs =</span> <span class="fu">sapply</span>(Frogs.moran, <span class="cf">function</span>(x) <span class="fu">as.vector</span>(x<span class="sc">$</span>estimate[<span class="dv">1</span>])),  </span>
<span id="cb668-5"><a href="WE-5.html#cb668-5" aria-hidden="true" tabindex="-1"></a><span class="at">p.value =</span> <span class="fu">sapply</span>(Frogs.moran, <span class="cf">function</span>(x) x<span class="sc">$</span>p.value)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##         obs p.value
## n    -0.109   0.606
## Hobs  0.507   0.000
## Hexp  0.551   0.000
## Ar    0.610   0.000</code></pre>
<p><strong>Questions:</strong></p>
<ul>
<li>Which measure of genetic diversity showed the strongest autocorrelation?</li>
<li>Sample size n had a negative value of Moran’s I (obs). What does this mean?</li>
<li>Did all four variables show statistically significant spatial autocorrelation?</li>
</ul>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tutorial-5.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-exercise-week-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
