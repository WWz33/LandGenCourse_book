<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16.1 Worked Example | Landscape Genetic Data Analysis with R</title>
  <meta name="description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="16.1 Worked Example | Landscape Genetic Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  <meta name="github-repo" content="hhwagner1/LandGenCourse_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16.1 Worked Example | Landscape Genetic Data Analysis with R" />
  
  <meta name="twitter:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  

<meta name="author" content="Editor: Helene Wagner (University of Toronto)" />


<meta name="date" content="2022-04-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Week13.html"/>
<link rel="next" href="Week14.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.7/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Landscape Genetic Data Analysis with R</a></li>

<li class="divider"></li>
<li class="part"><span><b>Getting Started<span></span></b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i><b>1.1</b> How to use this Book<span></span></a>
<ul>
<li><a href="how-to-use-this-book.html#book-structure">1. Book Structure<span></span></a></li>
<li><a href="how-to-use-this-book.html#find-what-is-relevant-for-you">2. Find what is relevant for you<span></span></a></li>
<li><a href="how-to-use-this-book.html#course-r-package-landgencourse">3. Course R package ‘LandGenCourse’<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="list-of-packages.html"><a href="list-of-packages.html"><i class="fa fa-check"></i><b>1.2</b> List of R Packages by Vignette<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="review-of-r-skills.html"><a href="review-of-r-skills.html"><i class="fa fa-check"></i><b>2</b> Review of R Skills<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>2.1</b> Basic R Programming<span></span></a>
<ul>
<li><a href="basic-r.html#overview">1. Overview<span></span></a></li>
<li><a href="basic-r.html#data-types">2. Data Types<span></span></a></li>
<li><a href="basic-r.html#data-containers">3. Data Containers<span></span></a></li>
<li><a href="basic-r.html#programming">4. Programming<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-graphics.html"><a href="r-graphics.html"><i class="fa fa-check"></i><b>2.2</b> R Graphics<span></span></a>
<ul>
<li><a href="r-graphics.html#overview-1">1. Overview<span></span></a></li>
<li><a href="r-graphics.html#univariate-plots">2. Univariate plots<span></span></a></li>
<li><a href="r-graphics.html#bivariate-plots">3. Bivariate plots<span></span></a></li>
<li><a href="r-graphics.html#advanced-plotting">4. Advanced plotting<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>2.3</b> Further R resources<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="github-for-group-projects.html"><a href="github-for-group-projects.html"><i class="fa fa-check"></i><b>3</b> GitHub for Group Projects<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>3.1</b> Why use GitHub?<span></span></a>
<ul>
<li><a href="github.html#goals">1. Goals<span></span></a></li>
<li><a href="github.html#version">2. Watch course video: Version Control 101<span></span></a></li>
<li><a href="github.html#slides">3. Preview slides<span></span></a></li>
<li><a href="github.html#next-steps">4. Next steps<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>3.2</b> Installation<span></span></a>
<ul>
<li><a href="install.html#goals-1">1. Goals<span></span></a></li>
<li class="chapter" data-level="3.2.1" data-path="install.html"><a href="install.html#how-to-get-github-and-gitkraken-for-free"><i class="fa fa-check"></i><b>3.2.1</b> 2. How to get GitHub and GitKraken for free<span></span></a></li>
<li><a href="install.html#happygit">3. Happy Git with R<span></span></a></li>
<li><a href="install.html#gitvideos">4. Video tutorials: installation<span></span></a></li>
<li><a href="install.html#join">5. Joining your group’s project on GitHub<span></span></a></li>
<li><a href="install.html#repo">6. Setting up a group repo<span></span></a></li>
<li><a href="install.html#next-steps-1">7. Next steps<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>3.3</b> Workflows<span></span></a>
<ul>
<li><a href="workflow.html#goals-2">1. Goals<span></span></a></li>
<li><a href="workflow.html#step-by-step-tutorials">2. Step-by-step tutorials<span></span></a></li>
<li><a href="workflow.html#further-resources">3. Further resources<span></span></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Basic Topics<span></span></b></span></li>
<li class="chapter" data-level="4" data-path="Week1.html"><a href="Week1.html"><i class="fa fa-check"></i><b>4</b> Week 1: Importing Genetic Data<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="video_1.html"><a href="video_1.html"><i class="fa fa-check"></i><b>4.1</b> View Course Video<span></span></a>
<ul>
<li><a href="video_1.html#embedded-video">1. Embedded Video<span></span></a></li>
<li><a href="video_1.html#preview-slides">2. Preview Slides<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tutorial_1.html"><a href="tutorial_1.html"><i class="fa fa-check"></i><b>4.2</b> Interactive Tutorial 1<span></span></a>
<ul>
<li><a href="tutorial_1.html#list-of-r-commands-covered-this-week">1. List of R commands covered this week<span></span></a></li>
<li><a href="tutorial_1.html#general-instructions">2. General Instructions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="WE_1.html"><a href="WE_1.html"><i class="fa fa-check"></i><b>4.3</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_1.html#overview-of-worked-example">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_1.html#import-data-from-.csv-file">2. Import data from .csv file<span></span></a></li>
<li><a href="WE_1.html#create-genind-object">3. Create ‘genind’ Object<span></span></a></li>
<li><a href="WE_1.html#view-information-stored-in-genind-object">4. View information stored in ‘genind’ object<span></span></a></li>
<li><a href="WE_1.html#import-data-with-gstudio-package">5. Import data with ‘gstudio’ package<span></span></a></li>
<li><a href="WE_1.html#importing-snp-data">6. Importing SNP data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="r-exercise-week-1.html"><a href="r-exercise-week-1.html"><i class="fa fa-check"></i><b>4.4</b> R exercise Week 1<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Week2.html"><a href="Week2.html"><i class="fa fa-check"></i><b>5</b> Week 2: Spatial Data<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="video_2.html"><a href="video_2.html"><i class="fa fa-check"></i><b>5.1</b> View Course Video<span></span></a>
<ul>
<li><a href="video_2.html#embedded-video-1">1. Embedded Video<span></span></a></li>
<li><a href="video_2.html#preview-slides-1">2. Preview Slides<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="tutorial_2.html"><a href="tutorial_2.html"><i class="fa fa-check"></i><b>5.2</b> Interactive Tutorial 2<span></span></a>
<ul>
<li><a href="tutorial_2.html#list-of-r-commands-covered-this-week-1">1. List of R commands covered this week<span></span></a></li>
<li><a href="tutorial_2.html#general-instructions-1">2. General Instructions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="WE_2.html"><a href="WE_2.html"><i class="fa fa-check"></i><b>5.3</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_2.html#overview-of-worked-example-1">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_2.html#import-site-data-from-.csv-file">2. Import site data from .csv file<span></span></a></li>
<li><a href="WE_2.html#display-raster-data-and-overlay-sampling-locations-extract-data">3. Display raster data and overlay sampling locations, extract data<span></span></a></li>
<li><a href="WE_2.html#calculate-landscape-metrics">4. Calculate landscape metrics<span></span></a></li>
<li><a href="WE_2.html#sample-landscape-metrics-within-buffer-around-sampling-locations">5. Sample landscape metrics within buffer around sampling locations<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="r-exercise-week-2.html"><a href="r-exercise-week-2.html"><i class="fa fa-check"></i><b>5.4</b> R Exercise Week 2<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="bonus_2a.html"><a href="bonus_2a.html"><i class="fa fa-check"></i><b>5.5</b> Bonus: ‘sf’ and ‘terra’<span></span></a>
<ul>
<li><a href="bonus_2a.html#overview-2">1. Overview<span></span></a></li>
<li><a href="bonus_2a.html#convert-spatialpointsdataframe-to-sf-object">2. Convert ‘SpatialPointsDataFrame’ to ‘sf’ object<span></span></a></li>
<li><a href="bonus_2a.html#plot-variables-first-10-in-data-set">3. Plot variables (first 10 in data set)<span></span></a></li>
<li><a href="bonus_2a.html#export-site-data-as-esri-shapefile">4. Export site data as ESRI shapefile<span></span></a></li>
<li><a href="bonus_2a.html#use-terra-and-tmap-to-display-categorical-map-with-color-scheme">5. Use ‘terra’ and ‘tmap’ to display categorical map with color scheme<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Week3.html"><a href="Week3.html"><i class="fa fa-check"></i><b>6</b> Week 3: Genetic Diversity<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="video_3.html"><a href="video_3.html"><i class="fa fa-check"></i><b>6.1</b> View Course Video<span></span></a>
<ul>
<li><a href="video_3.html#embedded-video-2">1. Embedded Video<span></span></a></li>
<li><a href="video_3.html#video-part-1">Video, Part 1<span></span></a></li>
<li><a href="video_3.html#video-part-2">Video, Part 2<span></span></a></li>
<li><a href="video_3.html#preview-slides-2">Preview Slides<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tutorial_3.html"><a href="tutorial_3.html"><i class="fa fa-check"></i><b>6.2</b> Interactive Tutorial 3<span></span></a>
<ul>
<li><a href="tutorial_3.html#list-of-r-commands-covered-this-week-2">1. List of R commands covered this week<span></span></a></li>
<li><a href="tutorial_3.html#general-instructions-2">2. General Instructions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="WE_3.html"><a href="WE_3.html"><i class="fa fa-check"></i><b>6.3</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_3.html#overview-of-worked-example-2">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_3.html#basic-checking-of-markers-and-populations">2. Basic checking of markers and populations<span></span></a></li>
<li><a href="WE_3.html#assess-genetic-diversity">3. Assess genetic diversity<span></span></a></li>
<li><a href="WE_3.html#aggregate-genetic-data-at-population-level-allele-frequencies">4. Aggregate genetic data at population level (allele frequencies)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="r-exercise-week-3.html"><a href="r-exercise-week-3.html"><i class="fa fa-check"></i><b>6.4</b> R Exercise Week 3<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Week4.html"><a href="Week4.html"><i class="fa fa-check"></i><b>7</b> Week 4: Metapopulations<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="video_4.html"><a href="video_4.html"><i class="fa fa-check"></i><b>7.1</b> View Course Video<span></span></a>
<ul>
<li><a href="video_4.html#embedded-video-3">1. Embedded Video<span></span></a></li>
<li><a href="video_4.html#video-part-1-1">Video, Part 1<span></span></a></li>
<li><a href="video_4.html#video-part-2-1">Video, Part 2<span></span></a></li>
<li><a href="video_4.html#preview-slides-3">Preview Slides<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="tutorial_4.html"><a href="tutorial_4.html"><i class="fa fa-check"></i><b>7.2</b> Interactive Tutorial 4<span></span></a>
<ul>
<li><a href="tutorial_4.html#list-of-r-commands-covered-this-week-3">1. List of R commands covered this week<span></span></a></li>
<li><a href="tutorial_4.html#general-instructions-3">2. General Instructions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="WE_4.html"><a href="WE_4.html"><i class="fa fa-check"></i><b>7.3</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_4.html#overview-of-worked-example-3">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_4.html#spatial-distribution-of-genetic-structure">2. Spatial distribution of genetic structure<span></span></a></li>
<li><a href="WE_4.html#what-determines-genetic-differentiation-among-sites">3. What determines genetic differentiation among sites?<span></span></a></li>
<li><a href="WE_4.html#what-determines-genetic-diversity">4. What determines genetic diversity?<span></span></a></li>
<li><a href="WE_4.html#are-genetic-differentiation-and-diversity-related">5. Are genetic differentiation and diversity related?<span></span></a></li>
<li><a href="WE_4.html#effect-of-recent-extinction-events">6. Effect of recent extinction events<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="r-exercise-week-4.html"><a href="r-exercise-week-4.html"><i class="fa fa-check"></i><b>7.4</b> R Exercise Week 4<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Week5.html"><a href="Week5.html"><i class="fa fa-check"></i><b>8</b> Week 5: Spatial Statistics<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="video_5.html"><a href="video_5.html"><i class="fa fa-check"></i><b>8.1</b> View Course Video<span></span></a>
<ul>
<li><a href="video_5.html#embedded-video-4">1. Embedded Video<span></span></a></li>
<li><a href="video_5.html#preview-slides-4">Preview Slides<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tutorial_5.html"><a href="tutorial_5.html"><i class="fa fa-check"></i><b>8.2</b> Interactive Tutorial 5<span></span></a>
<ul>
<li><a href="tutorial_5.html#list-of-r-commands-covered-this-week-4">1. List of R commands covered this week<span></span></a></li>
<li><a href="tutorial_5.html#general-instructions-4">2. General Instructions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="WE_5.html"><a href="WE_5.html"><i class="fa fa-check"></i><b>8.3</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_5.html#overview-of-worked-example-4">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_5.html#data-import-and-manipulation">2. Data import and manipulation<span></span></a></li>
<li><a href="WE_5.html#calculate-genetic-distances">3. Calculate genetic distances<span></span></a></li>
<li><a href="WE_5.html#perform-a-mantel-test-to-test-for-ibd">4. Perform a Mantel test to test for IBD<span></span></a></li>
<li><a href="WE_5.html#create-mantel-correlogram-for-genetic-data">5. Create Mantel correlogram for genetic data<span></span></a></li>
<li><a href="WE_5.html#specify-spatial-weights-and-calculate-morans-i">6. Specify spatial weights and calculate Moran’s I<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="r-exercise-week-5.html"><a href="r-exercise-week-5.html"><i class="fa fa-check"></i><b>8.4</b> R Exercise Week 5<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Week6.html"><a href="Week6.html"><i class="fa fa-check"></i><b>9</b> Week 6: Quantitative Genetics<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="video_6.html"><a href="video_6.html"><i class="fa fa-check"></i><b>9.1</b> View Course Video<span></span></a>
<ul>
<li><a href="video_6.html#embedded-video-5">1. Embedded Video<span></span></a></li>
<li><a href="video_6.html#video-part-1-2">Video, Part 1<span></span></a></li>
<li><a href="video_6.html#video-part-2-2">Video, Part 2<span></span></a></li>
<li><a href="video_6.html#preview-slides-5">Preview Slides<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="tutorial_6.html"><a href="tutorial_6.html"><i class="fa fa-check"></i><b>9.2</b> Interactive Tutorial 6<span></span></a>
<ul>
<li><a href="tutorial_6.html#list-of-r-commands-covered-this-week-5">1. List of R commands covered this week<span></span></a></li>
<li><a href="tutorial_6.html#general-instructions-5">2. General Instructions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="WE_6.html"><a href="WE_6.html"><i class="fa fa-check"></i><b>9.3</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_6.html#overview-of-worked-example-5">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_6.html#estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment">2. Estimate genetic and non-genetic variance components from a common garden experiment<span></span></a></li>
<li><a href="WE_6.html#estimate-trait-heritability">3. Estimate trait heritability<span></span></a></li>
<li><a href="WE_6.html#compare-q_st-to-f_st-measured-from-snp-data">4. Compare <span class="math inline">\(Q_{st}\)</span> to <span class="math inline">\(F_{st}\)</span> measured from SNP data<span></span></a></li>
<li><a href="WE_6.html#assess-correlation-between-trait-and-environment">5. Assess correlation between trait and environment<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="r-exercise-week-6.html"><a href="r-exercise-week-6.html"><i class="fa fa-check"></i><b>9.4</b> R Exercise Week 6<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Week7.html"><a href="Week7.html"><i class="fa fa-check"></i><b>10</b> Week 7: Spatial Linear Models<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="video_7.html"><a href="video_7.html"><i class="fa fa-check"></i><b>10.1</b> View Course Video<span></span></a>
<ul>
<li><a href="video_7.html#embedded-video-6">1. Embedded Video<span></span></a></li>
<li><a href="video_7.html#video-part-1-3">Video, Part 1<span></span></a></li>
<li><a href="video_7.html#video-part-2-3">Video, Part 2<span></span></a></li>
<li><a href="video_7.html#preview-slides-6">Preview Slides<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tutorial_7.html"><a href="tutorial_7.html"><i class="fa fa-check"></i><b>10.2</b> Interactive Tutorial 7<span></span></a>
<ul>
<li><a href="tutorial_7.html#list-of-r-commands-covered-this-week-6">1. List of R commands covered this week<span></span></a></li>
<li><a href="tutorial_7.html#general-instructions-6">2. General Instructions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="WE_7.html"><a href="WE_7.html"><i class="fa fa-check"></i><b>10.3</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_7.html#overview-of-worked-example-6">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_7.html#explore-data-set">2. Explore data set<span></span></a></li>
<li><a href="WE_7.html#test-regression-residuals-for-spatial-autocorrelation">3. Test regression residuals for spatial autocorrelation<span></span></a></li>
<li><a href="WE_7.html#fit-models-with-spatially-correlated-error-gls-with-package-nlme">4. Fit models with spatially correlated error (GLS) with package ‘nlme’<span></span></a></li>
<li><a href="WE_7.html#fit-spatial-simultaneous-autoregressive-error-models-sar">5. Fit spatial simultaneous autoregressive error models (SAR)<span></span></a></li>
<li><a href="WE_7.html#spatial-filtering-with-mem-using-package-spmoran">6. Spatial filtering with MEM using package ‘spmoran’<span></span></a></li>
<li><a href="WE_7.html#fit-spatially-varying-coefficients-model-with-package-spmoran">7. Fit spatially varying coefficients model with package ‘spmoran’<span></span></a></li>
<li><a href="WE_7.html#model-with-patchsize-and-ibr">Model with PatchSize and IBR<span></span></a></li>
<li><a href="WE_7.html#model-with-ibr-only">Model with IBR only<span></span></a></li>
<li><a href="WE_7.html#conclusions">8. Conclusions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="r-exercise-week-7.html"><a href="r-exercise-week-7.html"><i class="fa fa-check"></i><b>10.4</b> R Exercise Week 7<span></span></a></li>
<li class="chapter" data-level="10.5" data-path="bonus_7a.html"><a href="bonus_7a.html"><i class="fa fa-check"></i><b>10.5</b> Bonus: Si index<span></span></a>
<ul>
<li><a href="bonus_7a.html#overview-of-bonus-materials">1. Overview of Bonus Materials<span></span></a></li>
<li><a href="bonus_7a.html#import-ecological-distance-matrices">2. Import ecological distance matrices<span></span></a></li>
<li><a href="bonus_7a.html#optimize-the-scaling-parameter-alpha">3. Optimize the scaling parameter alpha<span></span></a></li>
<li><a href="bonus_7a.html#calculate-hanskis-index-si-with-source-patch-parameters">4. Calculate Hanski’s index Si with source patch parameters<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Week8.html"><a href="Week8.html"><i class="fa fa-check"></i><b>11</b> Week 8: Simulation Experiments<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="video_8.html"><a href="video_8.html"><i class="fa fa-check"></i><b>11.1</b> View Course Video<span></span></a>
<ul>
<li><a href="video_8.html#embedded-video-7">1. Embedded Video<span></span></a></li>
<li><a href="video_8.html#video-part-1-4">Video, Part 1<span></span></a></li>
<li><a href="video_8.html#video-part-2-4">Video, Part 2<span></span></a></li>
<li><a href="video_8.html#preview-slides-7">Preview Slides<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="tutorial_8.html"><a href="tutorial_8.html"><i class="fa fa-check"></i><b>11.2</b> Interactive Tutorial 8<span></span></a>
<ul>
<li><a href="tutorial_8.html#list-of-r-commands-covered-this-week-7">1. List of R commands covered this week<span></span></a></li>
<li><a href="tutorial_8.html#general-instructions-7">2. General Instructions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="WE_8.html"><a href="WE_8.html"><i class="fa fa-check"></i><b>11.3</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_8.html#overview-of-worked-example-7">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_8.html#initialize-a-landscape">2. Initialize a landscape<span></span></a></li>
<li><a href="WE_8.html#define-simulation-parameters">3. Define simulation parameters<span></span></a></li>
<li><a href="WE_8.html#run-simulations-and-analyze-results">4. Run simulations and analyze results<span></span></a></li>
<li><a href="WE_8.html#run-simulator-using-a-previously-defined-parameter-set">5. Run simulator using a previously defined parameter set<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="r-exercise-week-8.html"><a href="r-exercise-week-8.html"><i class="fa fa-check"></i><b>11.4</b> R Exercise Week 8<span></span></a></li>
<li class="chapter" data-level="11.5" data-path="bonus_8a.html"><a href="bonus_8a.html"><i class="fa fa-check"></i><b>11.5</b> Bonus: Efficient R<span></span></a>
<ul>
<li><a href="bonus_8a.html#overview-of-bonus-material">1. Overview of Bonus Material<span></span></a></li>
<li><a href="bonus_8a.html#navigating-the-file-system">2. Navigating the file system<span></span></a></li>
<li><a href="bonus_8a.html#benchmarking-file-import-and-export-options">3. Benchmarking file import and export options<span></span></a></li>
<li><a href="bonus_8a.html#profiling-your-code">4. Profiling your code<span></span></a></li>
<li><a href="bonus_8a.html#creating-and-executing-a-bash-r-script">5. Creating and executing a Bash R script<span></span></a></li>
<li><a href="bonus_8a.html#parallelizing-code">6. Parallelizing code<span></span></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Advanced Topics<span></span></b></span></li>
<li class="chapter" data-level="12" data-path="Week9.html"><a href="Week9.html"><i class="fa fa-check"></i><b>12</b> Week 9: Population Structure<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="WE_9.html"><a href="WE_9.html"><i class="fa fa-check"></i><b>12.1</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_9.html#overview-of-worked-example-8">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_9.html#simulated-data-2-island-model">2. Simulated data: 2-island model<span></span></a></li>
<li><a href="WE_9.html#simulated-data-2-island-model-with-admixture">3. Simulated data: 2-island model with admixture<span></span></a></li>
<li><a href="WE_9.html#empirical-data-threespine-sticklebacks">4. Empirical data: Threespine sticklebacks<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Week10.html"><a href="Week10.html"><i class="fa fa-check"></i><b>13</b> Week 10: Landscape Resistance<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="WE_10.html"><a href="WE_10.html"><i class="fa fa-check"></i><b>13.1</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_10.html#overview-of-worked-example-9">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_10.html#explore-the-data-set">2. Explore the data set<span></span></a></li>
<li><a href="WE_10.html#setting-cost-values-and-calculating-conductance">3. Setting cost values and calculating conductance<span></span></a></li>
<li><a href="WE_10.html#convert-conductance-into-effective-distance">4. Convert conductance into effective distance<span></span></a></li>
<li><a href="WE_10.html#create-cost-distance-matrices">5. Create cost-distance matrices<span></span></a></li>
<li><a href="WE_10.html#how-does-changing-resolution-affect-these-metrics">6. How does changing resolution affect these metrics?<span></span></a></li>
<li><a href="WE_10.html#references">7. References<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="bonus-10a.html"><a href="bonus-10a.html"><i class="fa fa-check"></i><b>13.2</b> Bonus: ‘radish’ tutorial<span></span></a>
<ul>
<li><a href="bonus-10a.html#overview-of-bonus-materials-1">1. Overview of Bonus Materials<span></span></a></li>
<li><a href="bonus-10a.html#import-data">2. Import data<span></span></a></li>
<li><a href="bonus-10a.html#basic-model-fitting">3. Basic model fitting<span></span></a></li>
<li><a href="bonus-10a.html#advanced-modeling-topics">4. Advanced modeling topics<span></span></a></li>
<li><a href="bonus-10a.html#summary">5. Summary<span></span></a></li>
<li><a href="bonus-10a.html#references-1">6. References<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="Week11.html"><a href="Week11.html"><i class="fa fa-check"></i><b>14</b> Week 11: Detecting Adaptation<span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="WE_11.html"><a href="WE_11.html"><i class="fa fa-check"></i><b>14.1</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_11.html#overview-of-worked-example-10">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_11.html#import-and-prepare-the-data">2. Import and prepare the data<span></span></a></li>
<li><a href="WE_11.html#latent-factor-mixed-models-lfmm-a-univariate-gea">3. Latent Factor Mixed Models (LFMM): a univariate GEA<span></span></a></li>
<li><a href="WE_11.html#redundancy-analysis-rda-a-multivariate-gea">4. Redundancy Analysis (RDA): a multivariate GEA<span></span></a></li>
<li><a href="WE_11.html#compare-lfmm-and-rda-candidates">5. Compare LFMM and RDA candidates<span></span></a></li>
<li><a href="WE_11.html#a-quick-note-on-controlling-for-population-structure-in-rda">6. A quick note on controlling for population structure in RDA<span></span></a></li>
<li><a href="WE_11.html#references-2">7. References<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="Week12.html"><a href="Week12.html"><i class="fa fa-check"></i><b>15</b> Week 12: Model Selection<span></span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="WE_12.html"><a href="WE_12.html"><i class="fa fa-check"></i><b>15.1</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_12.html#overview-of-worked-example-11">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_12.html#fitting-candidate-models">2. Fitting candidate models<span></span></a></li>
<li><a href="WE_12.html#your-turn-to-test-additional-hypotheses">3. Your turn to test additional hypotheses!<span></span></a></li>
<li><a href="WE_12.html#nested-model-nmlpe-for-hierarchical-sampling-designs">4. Nested model (NMLPE) for hierarchical sampling designs<span></span></a></li>
<li><a href="WE_12.html#references-3">5. References<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="Week13.html"><a href="Week13.html"><i class="fa fa-check"></i><b>16</b> Week 13: Gravity Models<span></span></a>
<ul>
<li class="chapter" data-level="16.1" data-path="WE_13.html"><a href="WE_13.html"><i class="fa fa-check"></i><b>16.1</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_13.html#overview-of-worked-example-12">1. Overview of Worked Example<span></span></a></li>
<li><a href="WE_13.html#setup">2. Setup<span></span></a></li>
<li><a href="WE_13.html#wetland-complex-data-preparation">3. Wetland complex data preparation<span></span></a></li>
<li><a href="WE_13.html#wetland-field-data-preparation">4. Wetland field-data preparation<span></span></a></li>
<li><a href="WE_13.html#saturated-graph">5. Saturated Graph<span></span></a></li>
<li><a href="WE_13.html#spatial-model-data-prepration">6. Spatial model data prepration<span></span></a></li>
<li><a href="WE_13.html#gravity-model">7. Gravity model<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="Week14.html"><a href="Week14.html"><i class="fa fa-check"></i><b>17</b> Week 14: Contemporary Gene Flow<span></span></a>
<ul>
<li class="chapter" data-level="17.1" data-path="WE_14.html"><a href="WE_14.html"><i class="fa fa-check"></i><b>17.1</b> Worked Example<span></span></a>
<ul>
<li><a href="WE_14.html#overview-3">1. Overview<span></span></a></li>
<li><a href="WE_14.html#import-genotypes">2. Import Genotypes<span></span></a></li>
<li><a href="WE_14.html#pollen-pool-genetic-structure">3. Pollen pool genetic structure<span></span></a></li>
<li><a href="WE_14.html#paternity-analysis">4. Paternity analysis<span></span></a></li>
<li><a href="WE_14.html#linking-paternity-to-ecological-variables">5. Linking paternity to ecological variables<span></span></a></li>
<li><a href="WE_14.html#references-4">6. References<span></span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Landscape Genetic Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="WE_13" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Worked Example<a href="WE_13.html#WE_13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Melanie A. Murphy &amp; Jeffrey S. Evans</p>
<div id="overview-of-worked-example-12" class="section level3 unnumbered hasAnchor">
<h3>1. Overview of Worked Example<a href="WE_13.html#overview-of-worked-example-12" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-background" class="section level4 unnumbered hasAnchor">
<h4>a. Background<a href="WE_13.html#a.-background" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are many ways graphs can be implemented to understand population structure and relate that structure to landscape characteristics (see Dyer and Nason 2004). In this exercise, we will calculate various graph metrics and apply graphs to fit a gravity model.</p>
<p>Gravity models are a type of inferential model that exploit graph characteristics. Gravity models include both at-site and between-site landscape data. They are a type of graph consisting of nodes and edges. These nodes and edges represent landscape characteristics associated with these graph elements.</p>
</div>
<div id="b.-data-set-12" class="section level4 unnumbered hasAnchor">
<h4>b. Data set<a href="WE_13.html#b.-data-set-12" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this exercise, you will use the gravity model framework to build an empirical model of gene flow for the Columbia spotted frog dataset in central Idaho that you have used for several other exercises (Murphy et al. 2010).</p>
</div>
</div>
<div id="setup" class="section level3 unnumbered hasAnchor">
<h3>2. Setup<a href="WE_13.html#setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="add-required-packages" class="section level4 unnumbered hasAnchor">
<h4>Add required packages<a href="WE_13.html#add-required-packages" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This code checks of all required packages are installed, and if so, loads them. If any are missing, it will return a message that identifies the packages that need to be installed. If that happens, install the packages and run the code again.</p>
<p>The package then checks if your version of the <code>GeNetIt</code> package is up-to-date (at least 0.1-5), and if not, installs the latest version.</p>
<div class="sourceCode" id="cb1289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1289-1"><a href="WE_13.html#cb1289-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;raster&quot;</span>, <span class="st">&quot;rgdal&quot;</span>, <span class="st">&quot;igraph&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;GeNetIt&quot;</span>, <span class="st">&quot;spatialEco&quot;</span>, <span class="st">&quot;leaflet&quot;</span>,</span>
<span id="cb1289-2"><a href="WE_13.html#cb1289-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;sf&quot;</span>, <span class="st">&quot;terra&quot;</span>, <span class="st">&quot;sfnetworks&quot;</span>, <span class="st">&quot;spdep&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;tmap&quot;</span>, <span class="st">&quot;devtools&quot;</span>) </span>
<span id="cb1289-3"><a href="WE_13.html#cb1289-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(<span class="sc">!</span><span class="fu">unlist</span>(<span class="fu">lapply</span>(p, requireNamespace, <span class="at">quietly=</span><span class="cn">TRUE</span>)))) { </span>
<span id="cb1289-4"><a href="WE_13.html#cb1289-4" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">=</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">unlist</span>(<span class="fu">lapply</span>(p, requireNamespace, <span class="at">quietly=</span><span class="cn">TRUE</span>)))</span>
<span id="cb1289-5"><a href="WE_13.html#cb1289-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">suppressMessages</span>(<span class="fu">invisible</span>(<span class="fu">lapply</span>(p[<span class="sc">-</span>m], require,    </span>
<span id="cb1289-6"><a href="WE_13.html#cb1289-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">character.only=</span><span class="cn">TRUE</span>)))</span>
<span id="cb1289-7"><a href="WE_13.html#cb1289-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Missing library, please install &quot;</span>, <span class="fu">paste</span>(p[m], <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>))</span>
<span id="cb1289-8"><a href="WE_13.html#cb1289-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1289-9"><a href="WE_13.html#cb1289-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">packageVersion</span>(<span class="st">&quot;GeNetIt&quot;</span>) <span class="sc">&lt;</span> <span class="st">&quot;0.1-5&quot;</span>) {</span>
<span id="cb1289-10"><a href="WE_13.html#cb1289-10" aria-hidden="true" tabindex="-1"></a>      remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;jeffreyevans/GeNetIt&quot;</span>)</span>
<span id="cb1289-11"><a href="WE_13.html#cb1289-11" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb1289-12"><a href="WE_13.html#cb1289-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">invisible</span>(<span class="fu">lapply</span>(p, require, <span class="at">character.only=</span><span class="cn">TRUE</span>)))</span>
<span id="cb1289-13"><a href="WE_13.html#cb1289-13" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="prepare-work-environment" class="section level4 unnumbered hasAnchor">
<h4>Prepare work environment<a href="WE_13.html#prepare-work-environment" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1290-1"><a href="WE_13.html#cb1290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the path to your project folder</span></span>
<span id="cb1290-2"><a href="WE_13.html#cb1290-2" aria-hidden="true" tabindex="-1"></a>Path <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>()</span>
<span id="cb1290-3"><a href="WE_13.html#cb1290-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1290-4"><a href="WE_13.html#cb1290-4" aria-hidden="true" tabindex="-1"></a><span class="do">## i.dicates UTM 11 NAD83 projection</span></span>
<span id="cb1290-5"><a href="WE_13.html#cb1290-5" aria-hidden="true" tabindex="-1"></a>prj <span class="ot">=</span> <span class="dv">32611</span> </span>
<span id="cb1290-6"><a href="WE_13.html#cb1290-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1290-7"><a href="WE_13.html#cb1290-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Some needed functions</span></span>
<span id="cb1290-8"><a href="WE_13.html#cb1290-8" aria-hidden="true" tabindex="-1"></a>back.transform <span class="ot">&lt;-</span> <span class="cf">function</span>(y) <span class="fu">exp</span>(y <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> stats<span class="sc">::</span><span class="fu">var</span>(y))</span>
<span id="cb1290-9"><a href="WE_13.html#cb1290-9" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">=</span> <span class="cf">function</span>(p, o){ <span class="fu">sqrt</span>(<span class="fu">mean</span>((p <span class="sc">-</span> o)<span class="sc">^</span><span class="dv">2</span>)) }</span></code></pre></div>
</div>
<div id="download-data" class="section level4 unnumbered hasAnchor">
<h4>Download data<a href="WE_13.html#download-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This may take a moment as the file is large (148.7 MB).</p>
<div class="sourceCode" id="cb1291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1291-1"><a href="WE_13.html#cb1291-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">file.path</span>(Path, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;Wetlands.csv&quot;</span>)))</span>
<span id="cb1291-2"><a href="WE_13.html#cb1291-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1291-3"><a href="WE_13.html#cb1291-3" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">=</span> <span class="st">&quot;https://spatialr.s3.us-west-2.amazonaws.com/Gravity/data.zip&quot;</span></span>
<span id="cb1291-4"><a href="WE_13.html#cb1291-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(d, <span class="at">destfile=</span><span class="fu">file.path</span>(Path, <span class="st">&quot;data.zip&quot;</span>), <span class="at">mode=</span><span class="st">&quot;wb&quot;</span>)</span>
<span id="cb1291-5"><a href="WE_13.html#cb1291-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unzip</span>(<span class="fu">file.path</span>(Path, <span class="st">&quot;data.zip&quot;</span>))</span>
<span id="cb1291-6"><a href="WE_13.html#cb1291-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.remove</span>(<span class="fu">file.path</span>(Path, <span class="st">&quot;data.zip&quot;</span>))</span>
<span id="cb1291-7"><a href="WE_13.html#cb1291-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="wetland-complex-data-preparation" class="section level3 unnumbered hasAnchor">
<h3>3. Wetland complex data preparation<a href="WE_13.html#wetland-complex-data-preparation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this sections, we will read in all wetland locations in the study area and calculate a few graph-based metrics to assign to wetland sites that data was collected at. This allows us to put our samples into the context of the larger wetland system thus, accounting for proximity and juxtaposition.</p>
<div id="a.-read-in-wetlands-data" class="section level4 unnumbered hasAnchor">
<h4>a. Read in wetlands data<a href="WE_13.html#a.-read-in-wetlands-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Read file “Wetlands.csv.”</p>
<div class="sourceCode" id="cb1292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1292-1"><a href="WE_13.html#cb1292-1" aria-hidden="true" tabindex="-1"></a>wetlands <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(Path, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;Wetlands.csv&quot;</span>), </span>
<span id="cb1292-2"><a href="WE_13.html#cb1292-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1292-3"><a href="WE_13.html#cb1292-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wetlands)</span></code></pre></div>
<pre><code>##   ID      X       Y RALU          SiteName
## 1  1 688835 5002939    y      AirplaneLake
## 2  2 687460 4994400    n  AlpineInletCreek
## 3  3 687507 4994314    n AlpineInletMeadow
## 4  4 687637 4994117    n        AlpineLake
## 5  5 688850 4997750    n   AxeHandleMeadow
## 6  6 688500 4998900    y    BachelorMeadow</code></pre>
<p>Make it a spatial object.</p>
<div class="sourceCode" id="cb1294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1294-1"><a href="WE_13.html#cb1294-1" aria-hidden="true" tabindex="-1"></a>wetlands <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(wetlands, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>), </span>
<span id="cb1294-2"><a href="WE_13.html#cb1294-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">crs =</span> <span class="dv">32611</span>, <span class="at">agr =</span> <span class="st">&quot;constant&quot;</span>) </span>
<span id="cb1294-3"><a href="WE_13.html#cb1294-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wetlands)</span></code></pre></div>
<pre><code>## Classes &#39;sf&#39; and &#39;data.frame&#39;:   121 obs. of  4 variables:
##  $ ID      : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ RALU    : chr  &quot;y&quot; &quot;n&quot; &quot;n&quot; &quot;n&quot; ...
##  $ SiteName: chr  &quot;AirplaneLake&quot; &quot;AlpineInletCreek&quot; &quot;AlpineInletMeadow&quot; &quot;AlpineLake&quot; ...
##  $ geometry:sfc_POINT of length 121; first list element:  &#39;XY&#39; num  688835 5002939
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: 1 1 1
##   ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;ID&quot; &quot;RALU&quot; &quot;SiteName&quot;</code></pre>
</div>
<div id="b.-create-wetlands-graph" class="section level4 unnumbered hasAnchor">
<h4>b. Create wetlands graph<a href="WE_13.html#b.-create-wetlands-graph" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Create Gabriel graph from the wetlands to represent a “realization” of connectivity and spatial arrangement.</p>
<p>Derive Gabriel graph</p>
<div class="sourceCode" id="cb1296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1296-1"><a href="WE_13.html#cb1296-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">graph2nb</span>(<span class="fu">gabrielneigh</span>(<span class="fu">st_coordinates</span>(wetlands)),<span class="at">sym=</span><span class="cn">TRUE</span>)</span>
<span id="cb1296-2"><a href="WE_13.html#cb1296-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1296-3"><a href="WE_13.html#cb1296-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gg, <span class="at">coords=</span><span class="fu">st_coordinates</span>(wetlands))</span></code></pre></div>
<p><img src="13-Week13_files/figure-html/gabriel-1.png" width="672" /></p>
<p><strong>Questions</strong>:</p>
<ul>
<li>This graph may or may not be the best representation of wetland connectivity. What other types of graphs could you build?</li>
<li>What wetlands are connected to each other based on the graph?</li>
</ul>
</div>
<div id="c.-graph-metrics" class="section level4 unnumbered hasAnchor">
<h4>c. Graph metrics<a href="WE_13.html#c.-graph-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To calculate graph metrics, we need to do a few steps:</p>
<p>Coerce to sf line object (will be used to create igraph object)</p>
<div class="sourceCode" id="cb1297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1297-1"><a href="WE_13.html#cb1297-1" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">nb2lines</span>(gg, <span class="at">coords =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(wetlands), </span>
<span id="cb1297-2"><a href="WE_13.html#cb1297-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">proj4string =</span> prj, <span class="at">as_sf=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Coerce to a <code>sfnetwork</code>, which is an <code>igraph</code> object:</p>
<div class="sourceCode" id="cb1298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1298-1"><a href="WE_13.html#cb1298-1" aria-hidden="true" tabindex="-1"></a>wg <span class="ot">&lt;-</span> <span class="fu">as_sfnetwork</span>(gg, <span class="at">edges=</span>gg, <span class="at">nodes=</span>wetlands, <span class="at">directed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1298-2"><a href="WE_13.html#cb1298-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">node_key =</span> <span class="st">&quot;SiteName&quot;</span>, <span class="at">length_as_weight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1298-3"><a href="WE_13.html#cb1298-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">edges_as_lines =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Calculate weights</p>
<div class="sourceCode" id="cb1299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1299-1"><a href="WE_13.html#cb1299-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> wg <span class="sc">%&gt;%</span> <span class="fu">activate</span>(<span class="st">&quot;edges&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(weight) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb1299-2"><a href="WE_13.html#cb1299-2" aria-hidden="true" tabindex="-1"></a>w[w <span class="sc">&lt;=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb1299-3"><a href="WE_13.html#cb1299-3" aria-hidden="true" tabindex="-1"></a>w <span class="ot">=</span> w <span class="sc">/</span> <span class="fu">sum</span>(w)</span></code></pre></div>
<p>Calculate graph metrics of betweenness and closeness with weights and degree. We’ll add these as attributes (columns) to the wetlands <code>sf</code> object.</p>
<ul>
<li><strong>degree</strong> - the number of connections a node has</li>
<li><strong>betweenness</strong> - the number of shortest paths going through a node</li>
<li><strong>closensess</strong> - the average of the shortest path length from the node to every other node in the network</li>
</ul>
<div class="sourceCode" id="cb1300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1300-1"><a href="WE_13.html#cb1300-1" aria-hidden="true" tabindex="-1"></a>wetlands<span class="sc">$</span>betweenness <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(wg, <span class="at">directed=</span><span class="cn">FALSE</span>, <span class="at">weights=</span>w)</span>
<span id="cb1300-2"><a href="WE_13.html#cb1300-2" aria-hidden="true" tabindex="-1"></a>wetlands<span class="sc">$</span>degree <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(wg)</span>
<span id="cb1300-3"><a href="WE_13.html#cb1300-3" aria-hidden="true" tabindex="-1"></a>wetlands<span class="sc">$</span>closeness <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">closeness</span>(wg, <span class="at">weights=</span>w)</span>
<span id="cb1300-4"><a href="WE_13.html#cb1300-4" aria-hidden="true" tabindex="-1"></a>wetlands</span></code></pre></div>
<pre><code>## Simple feature collection with 121 features and 6 fields
## Attribute-geometry relationship: 3 constant, 0 aggregate, 0 identity, 3 NA&#39;s
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 686244 ymin: 4993077 xmax: 695699 ymax: 5004317
## Projected CRS: WGS 84 / UTM zone 11N
## First 10 features:
##    ID RALU          SiteName               geometry betweenness degree
## 1   1    y      AirplaneLake POINT (688835 5002939)         288      8
## 2   2    n  AlpineInletCreek POINT (687460 4994400)         443      6
## 3   3    n AlpineInletMeadow POINT (687507 4994314)         332      4
## 4   4    n        AlpineLake POINT (687637 4994117)         220      6
## 5   5    n   AxeHandleMeadow POINT (688850 4997750)        1690      6
## 6   6    y    BachelorMeadow POINT (688500 4998900)         195      4
## 7   7    y    BarkingFoxLake POINT (687944 5000006)        1323      6
## 8   8    n BarkingFoxWetland POINT (687872 5000041)        1291     10
## 9   9    n          BartPond POINT (687150 4995850)           0      6
## 10 10    n      BigClearLake POINT (690888 5004126)           0      4
##    closeness
## 1  0.3538381
## 2  0.3407043
## 3  0.3352415
## 4  0.3226762
## 5  0.5426490
## 6  0.5334932
## 7  0.5094841
## 8  0.5066511
## 9  0.3783181
## 10 0.2706522</code></pre>
</div>
<div id="d.-plot-graph-metric" class="section level4 unnumbered hasAnchor">
<h4>d. Plot graph metric<a href="WE_13.html#d.-plot-graph-metric" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Plot results using the graph edges and wetlands points with the attributes “betweenness,” “closeness” and “degree.”</p>
<p>Plot betweenness</p>
<div class="sourceCode" id="cb1302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1302-1"><a href="WE_13.html#cb1302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(gg), <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb1302-2"><a href="WE_13.html#cb1302-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(wetlands[<span class="st">&quot;betweenness&quot;</span>], <span class="at">pch=</span><span class="dv">19</span>,  </span>
<span id="cb1302-3"><a href="WE_13.html#cb1302-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb1302-4"><a href="WE_13.html#cb1302-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">box</span>()</span>
<span id="cb1302-5"><a href="WE_13.html#cb1302-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">title</span>(<span class="st">&quot;Wetlands Gabriel graph betweenness&quot;</span>)</span></code></pre></div>
<p><img src="13-Week13_files/figure-html/plot_btwn-1.png" width="672" /></p>
<p>Plot closeness</p>
<div class="sourceCode" id="cb1303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1303-1"><a href="WE_13.html#cb1303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(gg), <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb1303-2"><a href="WE_13.html#cb1303-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wetlands[<span class="st">&quot;closeness&quot;</span>], <span class="at">pch=</span><span class="dv">19</span>,  </span>
<span id="cb1303-3"><a href="WE_13.html#cb1303-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb1303-4"><a href="WE_13.html#cb1303-4" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb1303-5"><a href="WE_13.html#cb1303-5" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Wetlands Gabriel graph closeness&quot;</span>)</span></code></pre></div>
<p><img src="13-Week13_files/figure-html/plot_clsn-1.png" width="672" /></p>
<p>Plot degree</p>
<div class="sourceCode" id="cb1304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1304-1"><a href="WE_13.html#cb1304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(gg), <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb1304-2"><a href="WE_13.html#cb1304-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wetlands[<span class="st">&quot;degree&quot;</span>], <span class="at">pch=</span><span class="dv">19</span>,  </span>
<span id="cb1304-3"><a href="WE_13.html#cb1304-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb1304-4"><a href="WE_13.html#cb1304-4" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb1304-5"><a href="WE_13.html#cb1304-5" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Wetlands Gabriel graph degree&quot;</span>)</span></code></pre></div>
<p><img src="13-Week13_files/figure-html/plot_dgr-1.png" width="672" /></p>
<p><strong>Questions:</strong> Consider the three figures above and how the graph was constructed.</p>
<ul>
<li>In what way(s) is the resulting graph potentially ecologically meaningful?</li>
<li>How might it not be ecologically or biologically meaningful?</li>
</ul>
</div>
</div>
<div id="wetland-field-data-preparation" class="section level3 unnumbered hasAnchor">
<h3>4. Wetland field-data preparation<a href="WE_13.html#wetland-field-data-preparation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section we will read the field data and add the node metrics we just calculated.</p>
<p>Using <code>RALU_Site.csv</code>, we read in the data, add the node data (betweenness and degree), create a spatial object that includes the node data.</p>
<p>Read in site data</p>
<div class="sourceCode" id="cb1305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1305-1"><a href="WE_13.html#cb1305-1" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(Path, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;RALU_Site.csv&quot;</span>), </span>
<span id="cb1305-2"><a href="WE_13.html#cb1305-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1305-3"><a href="WE_13.html#cb1305-3" aria-hidden="true" tabindex="-1"></a>sites<span class="sc">$</span>SiteID <span class="ot">&lt;-</span> <span class="fu">as.character</span>(sites<span class="sc">$</span>SiteID)</span></code></pre></div>
<p>Add the node data.</p>
<p>Note: using names is dangerous as, small changes in names can result in non-matches. In this case, the ID fields are not consistent (data were collected at different times for different purposes originally). However, names are standardized in a drop-down list of a database. So they are a matching field. My recommendation to you all is to do to this type of operation on a numeric field.</p>
<div class="sourceCode" id="cb1306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1306-1"><a href="WE_13.html#cb1306-1" aria-hidden="true" tabindex="-1"></a>nodestats <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(wetlands[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>)])</span>
<span id="cb1306-2"><a href="WE_13.html#cb1306-2" aria-hidden="true" tabindex="-1"></a>  nodestats <span class="ot">&lt;-</span> nodestats[<span class="fu">which</span>(nodestats<span class="sc">$</span>SiteName <span class="sc">%in%</span> sites<span class="sc">$</span>SiteName),] </span>
<span id="cb1306-3"><a href="WE_13.html#cb1306-3" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">merge</span>(nodestats, sites, <span class="at">by=</span><span class="st">&quot;SiteName&quot;</span>)</span></code></pre></div>
<p>Convert data frame to <code>sf</code> object.</p>
<div class="sourceCode" id="cb1307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1307-1"><a href="WE_13.html#cb1307-1" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(sites, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>), </span>
<span id="cb1307-2"><a href="WE_13.html#cb1307-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">crs =</span> prj, <span class="at">agr =</span> <span class="st">&quot;constant&quot;</span>) </span>
<span id="cb1307-3"><a href="WE_13.html#cb1307-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sites)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 14 fields
## Attribute-geometry relationship: 14 constant, 0 aggregate, 0 identity
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 687944 ymin: 4996458 xmax: 690127 ymax: 5002939
## Projected CRS: WGS 84 / UTM zone 11N
##         SiteName betweenness degree closeness SiteID     Elev Length    Area
## 1   AirplaneLake         288      8 0.3538381     27 2564.381    390 62582.2
## 2 BachelorMeadow         195      4 0.5334932     15 2591.781      0   225.0
## 3 BarkingFoxLake        1323      6 0.5094841     19 2545.275    160 12000.0
## 4        BobLake         116      4 0.4652124     16 2649.125    143  4600.0
## 5      CacheLake         673      4 0.5189996     10 2475.829     75  2268.8
## 6        DoeLake         758      6 0.4710215      8 2463.006    170 13034.9
##    Perim Depth  pH Dforest Drock Dshrub               geometry
## 1 1142.8 21.64 6.5   0.398 0.051   0.00 POINT (688835 5002939)
## 2   60.0  0.40 6.1   0.000 0.000   0.20 POINT (688500 4998900)
## 3  435.0  5.00 6.5   0.400 0.250   0.05 POINT (687944 5000006)
## 4  321.4  2.00 7.0   0.550 0.000   0.05 POINT (690127 4999150)
## 5  192.0  1.86 6.5   0.508 0.000   0.00 POINT (688777 4997264)
## 6  463.2  6.03 7.6   0.254 0.000   0.00 POINT (688968 4996458)</code></pre>
<p><strong>Question</strong>:</p>
<ul>
<li>What are the fields here? What data are included in <code>sites</code>?</li>
</ul>
</div>
<div id="saturated-graph" class="section level3 unnumbered hasAnchor">
<h3>5. Saturated Graph<a href="WE_13.html#saturated-graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-create-graph-from-site-locations" class="section level4 unnumbered hasAnchor">
<h4>a. Create graph from site locations<a href="WE_13.html#a.-create-graph-from-site-locations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To assess connectivity using a gravity model, we need to build a graph from the occupied frog sites create a graph. This could be any type of graph, but I generally use saturated (essentially a full genetic distance matrix) or pruned by some maximum distance.</p>
<div class="sourceCode" id="cb1309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1309-1"><a href="WE_13.html#cb1309-1" aria-hidden="true" tabindex="-1"></a>dist.graph <span class="ot">&lt;-</span> <span class="fu">knn.graph</span>(sites, <span class="at">row.names =</span> sites<span class="sc">$</span>SiteName)</span>
<span id="cb1309-2"><a href="WE_13.html#cb1309-2" aria-hidden="true" tabindex="-1"></a>dist.graph <span class="ot">&lt;-</span> <span class="fu">merge</span>(dist.graph, <span class="fu">st_drop_geometry</span>(sites), </span>
<span id="cb1309-3"><a href="WE_13.html#cb1309-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">by.y=</span><span class="st">&quot;SiteName&quot;</span>, <span class="at">by.x=</span><span class="st">&quot;from_ID&quot;</span>)</span>
<span id="cb1309-4"><a href="WE_13.html#cb1309-4" aria-hidden="true" tabindex="-1"></a>dist.graph <span class="ot">&lt;-</span> dist.graph[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">19</span>)] <span class="do">## d.op extra columns</span></span></code></pre></div>
<p>Note: Can create a distance-constrained graph with max.dist arg (not run)</p>
<div class="sourceCode" id="cb1310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1310-1"><a href="WE_13.html#cb1310-1" aria-hidden="true" tabindex="-1"></a><span class="do">## d.st.graph &lt;- knn.graph(sites, row.names = sites$SiteName, max.dist=5000)</span></span></code></pre></div>
</div>
<div id="b.-merge-the-graph-with-genetic-distance" class="section level4 unnumbered hasAnchor">
<h4>b. Merge the graph with genetic distance<a href="WE_13.html#b.-merge-the-graph-with-genetic-distance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Read in the genetic distance data and make a matrix, gdist, then unfold data</p>
<div class="sourceCode" id="cb1311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1311-1"><a href="WE_13.html#cb1311-1" aria-hidden="true" tabindex="-1"></a>gdist <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(Path, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;RALU_Dps.csv&quot;</span>), <span class="at">header=</span><span class="cn">TRUE</span>) </span>
<span id="cb1311-2"><a href="WE_13.html#cb1311-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(gdist) <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">names</span>(gdist))</span>
<span id="cb1311-3"><a href="WE_13.html#cb1311-3" aria-hidden="true" tabindex="-1"></a>gdist <span class="ot">&lt;-</span> <span class="fu">dmatrix.df</span>(<span class="fu">as.matrix</span>(gdist)) </span>
<span id="cb1311-4"><a href="WE_13.html#cb1311-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gdist) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FROM&quot;</span>, <span class="st">&quot;TO&quot;</span>, <span class="st">&quot;GDIST&quot;</span>) <span class="co">#unfold the file</span></span>
<span id="cb1311-5"><a href="WE_13.html#cb1311-5" aria-hidden="true" tabindex="-1"></a>gdist <span class="ot">&lt;-</span> gdist[<span class="sc">!</span>gdist<span class="sc">$</span>FROM <span class="sc">==</span> gdist<span class="sc">$</span>TO ,]</span>
<span id="cb1311-6"><a href="WE_13.html#cb1311-6" aria-hidden="true" tabindex="-1"></a>gdist[,<span class="dv">1</span>] <span class="ot">&lt;-</span><span class="fu">sub</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;&quot;</span>, gdist[,<span class="dv">1</span>])</span>
<span id="cb1311-7"><a href="WE_13.html#cb1311-7" aria-hidden="true" tabindex="-1"></a>gdist[,<span class="dv">2</span>] <span class="ot">&lt;-</span><span class="fu">sub</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;&quot;</span>, gdist[,<span class="dv">2</span>])</span>
<span id="cb1311-8"><a href="WE_13.html#cb1311-8" aria-hidden="true" tabindex="-1"></a>gdist <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">from.to=</span><span class="fu">paste</span>(gdist[,<span class="dv">1</span>], gdist[,<span class="dv">2</span>], <span class="at">sep=</span><span class="st">&quot;.&quot;</span>), gdist)</span></code></pre></div>
<p>Transform genetic distance to genetic flow (1-distance)</p>
<div class="sourceCode" id="cb1312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1312-1"><a href="WE_13.html#cb1312-1" aria-hidden="true" tabindex="-1"></a>gdist<span class="sc">$</span>GDIST <span class="ot">&lt;-</span> <span class="fu">flow</span>(gdist<span class="sc">$</span>GDIST)</span></code></pre></div>
<p>Merge graph with genetic distances, based on from node - to node combination</p>
<div class="sourceCode" id="cb1313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1313-1"><a href="WE_13.html#cb1313-1" aria-hidden="true" tabindex="-1"></a>dist.graph<span class="sc">$</span>from.to <span class="ot">&lt;-</span> <span class="fu">paste</span>(dist.graph<span class="sc">$</span>i, dist.graph<span class="sc">$</span>j, <span class="at">sep=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb1313-2"><a href="WE_13.html#cb1313-2" aria-hidden="true" tabindex="-1"></a>dist.graph <span class="ot">&lt;-</span> <span class="fu">merge</span>(dist.graph, gdist, <span class="at">by =</span> <span class="st">&quot;from.to&quot;</span>)</span></code></pre></div>
<p><strong>Question</strong>:</p>
<ul>
<li>What is in the resulting object?</li>
</ul>
</div>
</div>
<div id="spatial-model-data-prepration" class="section level3 unnumbered hasAnchor">
<h3>6. Spatial model data prepration<a href="WE_13.html#spatial-model-data-prepration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-read-raster-data-using-terra" class="section level4 unnumbered hasAnchor">
<h4>a. Read raster data using ‘terra’<a href="WE_13.html#a.-read-raster-data-using-terra" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1314-1"><a href="WE_13.html#cb1314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="fu">file.path</span>(Path,<span class="st">&quot;data&quot;</span>), <span class="st">&quot;tif$&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;cti.tif&quot;     &quot;dd5.tif&quot;     &quot;ffp.tif&quot;     &quot;gsp.tif&quot;     &quot;hli.tif&quot;    
## [6] &quot;nlcd.tif&quot;    &quot;pratio.tif&quot;  &quot;rough27.tif&quot; &quot;srr.tif&quot;</code></pre>
<div class="sourceCode" id="cb1316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1316-1"><a href="WE_13.html#cb1316-1" aria-hidden="true" tabindex="-1"></a>xvars <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">list.files</span>(<span class="fu">file.path</span>(Path, <span class="st">&quot;data&quot;</span>), <span class="st">&quot;tif$&quot;</span>, </span>
<span id="cb1316-2"><a href="WE_13.html#cb1316-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">full.names =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
</div>
<div id="b.-reclassify-wetlands" class="section level4 unnumbered hasAnchor">
<h4>b. Reclassify wetlands<a href="WE_13.html#b.-reclassify-wetlands" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>NLCD is land cover data. The wetland classes are 11 and 90-95 (for this system and vintage NLCD data)</p>
<div class="sourceCode" id="cb1317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1317-1"><a href="WE_13.html#cb1317-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">10.8</span>, <span class="dv">0</span>,<span class="fl">10.9</span>,<span class="fl">12.1</span>,<span class="dv">1</span>,<span class="fl">12.9</span>,<span class="fl">89.5</span>,<span class="dv">0</span>, <span class="fl">89.1</span>,<span class="fl">95.1</span>,<span class="dv">1</span>,<span class="fl">95.9</span>,<span class="dv">100</span>,<span class="dv">0</span> )</span>
<span id="cb1317-2"><a href="WE_13.html#cb1317-2" aria-hidden="true" tabindex="-1"></a>  reclass <span class="ot">&lt;-</span> <span class="fu">matrix</span>(m, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb1317-3"><a href="WE_13.html#cb1317-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1317-4"><a href="WE_13.html#cb1317-4" aria-hidden="true" tabindex="-1"></a>wetlnd <span class="ot">&lt;-</span> <span class="fu">classify</span>(xvars[[<span class="st">&quot;nlcd&quot;</span>]], reclass)</span>
<span id="cb1317-5"><a href="WE_13.html#cb1317-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(wetlnd) <span class="ot">&lt;-</span> <span class="st">&quot;wetlnd&quot;</span></span>
<span id="cb1317-6"><a href="WE_13.html#cb1317-6" aria-hidden="true" tabindex="-1"></a>    xvars <span class="ot">&lt;-</span> <span class="fu">c</span>(xvars, wetlnd)</span></code></pre></div>
</div>
<div id="c.-calculate-the-proportion-of-the-landscape-around-sites" class="section level4 unnumbered hasAnchor">
<h4>c. Calculate the proportion of the landscape around sites<a href="WE_13.html#c.-calculate-the-proportion-of-the-landscape-around-sites" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Assign proportion of landcover that is wetland to sites as pwetland. You could create a binary raster for any cover type of interest and calculate this parameter.</p>
<p><strong>Question</strong>:</p>
<ul>
<li>You want to know if areas of dense wetlands produce more frogs. What buffer distance will you use?</li>
</ul>
<p>Create function to extract the proportion of wetland.</p>
<div class="sourceCode" id="cb1318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1318-1"><a href="WE_13.html#cb1318-1" aria-hidden="true" tabindex="-1"></a><span class="do">## method 1 (can result in Inf if all zero)</span></span>
<span id="cb1318-2"><a href="WE_13.html#cb1318-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  prop.land &lt;- function(x) {</span></span>
<span id="cb1318-3"><a href="WE_13.html#cb1318-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   length(x[x==1]) / length(x)  </span></span>
<span id="cb1318-4"><a href="WE_13.html#cb1318-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb1318-5"><a href="WE_13.html#cb1318-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1318-6"><a href="WE_13.html#cb1318-6" aria-hidden="true" tabindex="-1"></a><span class="do">## method 2 (no divide by zero error)</span></span>
<span id="cb1318-7"><a href="WE_13.html#cb1318-7" aria-hidden="true" tabindex="-1"></a>prop.land <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1318-8"><a href="WE_13.html#cb1318-8" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(<span class="fu">factor</span>(x, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))))[<span class="dv">2</span>]</span>
<span id="cb1318-9"><a href="WE_13.html#cb1318-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Apply the function to extract the proportion of wetland within a buffer (here: 300 m).</p>
<div class="sourceCode" id="cb1319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1319-1"><a href="WE_13.html#cb1319-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(sites, <span class="dv">300</span>)</span>
<span id="cb1319-2"><a href="WE_13.html#cb1319-2" aria-hidden="true" tabindex="-1"></a>pwetland <span class="ot">&lt;-</span> <span class="fu">extract</span>(wetlnd, <span class="fu">vect</span>(b))</span>
<span id="cb1319-3"><a href="WE_13.html#cb1319-3" aria-hidden="true" tabindex="-1"></a>pwetland <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pwetland[,<span class="dv">2</span>], pwetland[,<span class="dv">1</span>], prop.land)</span></code></pre></div>
<p>Add the proportion of wetland back to the dataframe.</p>
<div class="sourceCode" id="cb1320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1320-1"><a href="WE_13.html#cb1320-1" aria-hidden="true" tabindex="-1"></a>sites<span class="sc">$</span>pwetland <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pwetland)</span>
<span id="cb1320-2"><a href="WE_13.html#cb1320-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sites<span class="sc">$</span>pwetland)</span></code></pre></div>
<pre><code>## [1] 0.196036801 0.015929204 0.050991501 0.000000000 0.004247788 0.107916223</code></pre>
<p><strong>Challenge</strong>:</p>
<ul>
<li>What happens if you change this radius?</li>
<li>What radius do you think makes the most sense ecologically?</li>
</ul>
<p>Alternatively, you can use the <code>landscapemetrics</code> package (see Week 2) to calculate a broader set of landscape metrics. Here is an example for calculating <code>pland</code>.</p>
<p>Note: as per help file, the argument <code>y</code> of the function <code>sample_lsm</code> can accept an <code>sf</code> points object (e.g., <code>sites</code>). This returned an error though, hence we first convert <code>sites</code> to an <code>sp</code> object, using the function <code>as_Spatial</code>.</p>
<div class="sourceCode" id="cb1322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1322-1"><a href="WE_13.html#cb1322-1" aria-hidden="true" tabindex="-1"></a>sites.sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(sites)</span>
<span id="cb1322-2"><a href="WE_13.html#cb1322-2" aria-hidden="true" tabindex="-1"></a>nlcd_sampled <span class="ot">&lt;-</span> landscapemetrics<span class="sc">::</span><span class="fu">sample_lsm</span>(<span class="at">landscape =</span> xvars[[<span class="st">&quot;wetlnd&quot;</span>]], </span>
<span id="cb1322-3"><a href="WE_13.html#cb1322-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">what =</span> <span class="st">&quot;lsm_c_pland&quot;</span>,</span>
<span id="cb1322-4"><a href="WE_13.html#cb1322-4" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">shape =</span> <span class="st">&quot;circle&quot;</span>,</span>
<span id="cb1322-5"><a href="WE_13.html#cb1322-5" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">y =</span> sites.sp, </span>
<span id="cb1322-6"><a href="WE_13.html#cb1322-6" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">size =</span> <span class="dv">300</span>, </span>
<span id="cb1322-7"><a href="WE_13.html#cb1322-7" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">return_raster =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1322-8"><a href="WE_13.html#cb1322-8" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">plot_id=</span>sites.sp<span class="sc">@</span>data<span class="sc">$</span>SiteID)</span>
<span id="cb1322-9"><a href="WE_13.html#cb1322-9" aria-hidden="true" tabindex="-1"></a>pwetland <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(nlcd_sampled, class <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb1322-10"><a href="WE_13.html#cb1322-10" aria-hidden="true" tabindex="-1"></a>                                        metric <span class="sc">==</span> <span class="st">&quot;pland&quot;</span>), plot_id, value)  </span>
<span id="cb1322-11"><a href="WE_13.html#cb1322-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pwetland) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;SiteID&quot;</span>, <span class="st">&quot;pwetland&quot;</span>)</span>
<span id="cb1322-12"><a href="WE_13.html#cb1322-12" aria-hidden="true" tabindex="-1"></a>pwetland<span class="sc">$</span>pwetland <span class="ot">&lt;-</span> pwetland<span class="sc">$</span>pwetland<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb1322-13"><a href="WE_13.html#cb1322-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1322-14"><a href="WE_13.html#cb1322-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pwetland)</span></code></pre></div>
<p>Note: these values are sorted by <code>SiteID</code> and are not in the same order as the <code>sf</code> object <code>sites</code>, that’s why the first six values may not be the same.</p>
</div>
<div id="d.-add-values-of-rasters-to-sample-sites" class="section level4 unnumbered hasAnchor">
<h4>d. Add values of rasters to sample sites<a href="WE_13.html#d.-add-values-of-rasters-to-sample-sites" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This adds potential “at site” variables, keep as sf POINT class object. We are removing raster 6 as knowing the cover class from NLCD that intersects the same points is not very useful information.</p>
<div class="sourceCode" id="cb1323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1323-1"><a href="WE_13.html#cb1323-1" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">extract</span>(xvars[[<span class="sc">-</span><span class="dv">6</span>]], <span class="fu">vect</span>(sites))</span>
<span id="cb1323-2"><a href="WE_13.html#cb1323-2" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="fu">data.frame</span>(<span class="fu">as.data.frame</span>(sites), stats), </span>
<span id="cb1323-3"><a href="WE_13.html#cb1323-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">geometry=</span>sites<span class="sc">$</span>geometry)</span></code></pre></div>
</div>
<div id="e.-add-raster-covariates-to-graph-edges-lines" class="section level4 unnumbered hasAnchor">
<h4>e. Add raster covariates to graph edges (lines)<a href="WE_13.html#e.-add-raster-covariates-to-graph-edges-lines" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Remove <code>nlcd</code> and <code>wetlnd</code> rasters before calculating statistics, as calculating statistics on categorical data is nonsensical.</p>
<p>Calculating stats - this will take a while!</p>
<div class="sourceCode" id="cb1324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1324-1"><a href="WE_13.html#cb1324-1" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">names</span>(xvars) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;nlcd&quot;</span>,<span class="st">&quot;wetlnd&quot;</span>))</span>
<span id="cb1324-2"><a href="WE_13.html#cb1324-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(</span>
<span id="cb1324-3"><a href="WE_13.html#cb1324-3" aria-hidden="true" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">graph.statistics</span>(dist.graph, <span class="at">r =</span> xvars[[<span class="sc">-</span>idx]], </span>
<span id="cb1324-4"><a href="WE_13.html#cb1324-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">buffer=</span> <span class="cn">NULL</span>, <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">&quot;min&quot;</span>,         </span>
<span id="cb1324-5"><a href="WE_13.html#cb1324-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;mean&quot;</span>,<span class="st">&quot;max&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;median&quot;</span>)))</span></code></pre></div>
<p>Add statistics to graph.</p>
<div class="sourceCode" id="cb1325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1325-1"><a href="WE_13.html#cb1325-1" aria-hidden="true" tabindex="-1"></a>dist.graph <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="fu">data.frame</span>(<span class="fu">as.data.frame</span>(dist.graph), stats), </span>
<span id="cb1325-2"><a href="WE_13.html#cb1325-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">geometry=</span>dist.graph<span class="sc">$</span>geometry)</span></code></pre></div>
</div>
<div id="f.-what-about-categorical-variables" class="section level4 unnumbered hasAnchor">
<h4>f. What about categorical variables?<a href="WE_13.html#f.-what-about-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Statistical moments (mean, variance, etc.) are nonsensical for categorical variables. Here we create a function for returning the percent wetland between sites. Then we use it to calculate an additional statistic and add the result to the graph.</p>
<p><strong>Question</strong>:</p>
<ul>
<li>Are there other categorical variables that you think may be ecologically important?</li>
</ul>
<p>Function to calculate percent wetland between pairs of sites:</p>
<div class="sourceCode" id="cb1326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1326-1"><a href="WE_13.html#cb1326-1" aria-hidden="true" tabindex="-1"></a>wet.pct <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1326-2"><a href="WE_13.html#cb1326-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> x <span class="sc">==</span> <span class="dv">12</span> <span class="sc">|</span> x <span class="sc">==</span> <span class="dv">90</span> <span class="sc">|</span> x <span class="sc">==</span> <span class="dv">95</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1326-3"><a href="WE_13.html#cb1326-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prop.table</span>(<span class="fu">table</span>(<span class="fu">factor</span>(x, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))))[<span class="dv">2</span>] </span>
<span id="cb1326-4"><a href="WE_13.html#cb1326-4" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
<p>Calculate statistic and add it to graph.</p>
<div class="sourceCode" id="cb1327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1327-1"><a href="WE_13.html#cb1327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(</span>
<span id="cb1327-2"><a href="WE_13.html#cb1327-2" aria-hidden="true" tabindex="-1"></a>  wetstats <span class="ot">&lt;-</span> <span class="fu">graph.statistics</span>(dist.graph, <span class="at">r=</span>xvars[[<span class="st">&quot;nlcd&quot;</span>]], </span>
<span id="cb1327-3"><a href="WE_13.html#cb1327-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">buffer=</span> <span class="cn">NULL</span>, <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">&quot;wet.pct&quot;</span>)) )</span>
<span id="cb1327-4"><a href="WE_13.html#cb1327-4" aria-hidden="true" tabindex="-1"></a>dist.graph<span class="sc">$</span>wet.pct.nlcd <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(wetstats[,<span class="dv">1</span>]) </span></code></pre></div>
</div>
<div id="g.-evaluate-node-and-edge-correlations" class="section level4 unnumbered hasAnchor">
<h4>g. Evaluate node and edge correlations<a href="WE_13.html#g.-evaluate-node-and-edge-correlations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We need to evaluate correlations in the data to avoid overdispersion in our models (remember lab from Week 12, where we calculated the variance inflation factor, VIF).</p>
<p>Note, we are not going to actually remove the correlated variables but, just go through a few methods of evaluating them. The code to remove colinear variables is commented out for reference. We do have to log transform the data as to evaluate the actual model structure.</p>
<p>Create data frame with the node variables to be evaluated.</p>
<div class="sourceCode" id="cb1328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1328-1"><a href="WE_13.html#cb1328-1" aria-hidden="true" tabindex="-1"></a>node.var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;degree&quot;</span>, <span class="st">&quot;betweenness&quot;</span>, <span class="st">&quot;Elev&quot;</span>, <span class="st">&quot;Length&quot;</span>, <span class="st">&quot;Area&quot;</span>, <span class="st">&quot;Perim&quot;</span>, </span>
<span id="cb1328-2"><a href="WE_13.html#cb1328-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;Depth&quot;</span>, <span class="st">&quot;pH&quot;</span>,<span class="st">&quot;Dforest&quot;</span>,<span class="st">&quot;Drock&quot;</span>, <span class="st">&quot;Dshrub&quot;</span>, <span class="st">&quot;pwetland&quot;</span>, <span class="st">&quot;cti&quot;</span>,</span>
<span id="cb1328-3"><a href="WE_13.html#cb1328-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;dd5&quot;</span>, <span class="st">&quot;ffp&quot;</span>,<span class="st">&quot;gsp&quot;</span>,<span class="st">&quot;pratio&quot;</span>,<span class="st">&quot;hli&quot;</span>,<span class="st">&quot;rough27&quot;</span>,<span class="st">&quot;srr&quot;</span>)</span>
<span id="cb1328-4"><a href="WE_13.html#cb1328-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(sites)[,node.var]</span></code></pre></div>
<p>Log-transform values, set log of negative values or zero (where log is not defined) to 0.00001.</p>
<div class="sourceCode" id="cb1329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1329-1"><a href="WE_13.html#cb1329-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(s)) </span>
<span id="cb1329-2"><a href="WE_13.html#cb1329-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1329-3"><a href="WE_13.html#cb1329-3" aria-hidden="true" tabindex="-1"></a>  s[,i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(s[,i] <span class="sc">&lt;=</span> <span class="dv">0</span>, <span class="fl">0.00001</span>, <span class="fu">log</span>(s[,i]))</span>
<span id="cb1329-4"><a href="WE_13.html#cb1329-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Site correlations:</p>
<div class="sourceCode" id="cb1330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1330-1"><a href="WE_13.html#cb1330-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fl">0.8</span> <span class="co"># Set upper limit of for collinearity</span></span>
<span id="cb1330-2"><a href="WE_13.html#cb1330-2" aria-hidden="true" tabindex="-1"></a>site.cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(s, <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb1330-3"><a href="WE_13.html#cb1330-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>, </span>
<span id="cb1330-4"><a href="WE_13.html#cb1330-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb1330-5"><a href="WE_13.html#cb1330-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(site.cor) <span class="ot">&lt;-</span> <span class="dv">0</span>                 </span>
<span id="cb1330-6"><a href="WE_13.html#cb1330-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1330-7"><a href="WE_13.html#cb1330-7" aria-hidden="true" tabindex="-1"></a>cor.idx <span class="ot">&lt;-</span> <span class="fu">which</span>(site.cor <span class="sc">&gt;</span> p <span class="sc">|</span> site.cor <span class="sc">&lt;</span> <span class="sc">-</span>p, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1330-8"><a href="WE_13.html#cb1330-8" aria-hidden="true" tabindex="-1"></a>cor.names <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb1330-9"><a href="WE_13.html#cb1330-9" aria-hidden="true" tabindex="-1"></a>cor.p <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb1330-10"><a href="WE_13.html#cb1330-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1330-11"><a href="WE_13.html#cb1330-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cor.idx)) </span>
<span id="cb1330-12"><a href="WE_13.html#cb1330-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1330-13"><a href="WE_13.html#cb1330-13" aria-hidden="true" tabindex="-1"></a>     cor.p[i] <span class="ot">&lt;-</span> site.cor[cor.idx[i,][<span class="dv">1</span>], cor.idx[i,][<span class="dv">2</span>]]</span>
<span id="cb1330-14"><a href="WE_13.html#cb1330-14" aria-hidden="true" tabindex="-1"></a>  cor.names [i] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">rownames</span>(site.cor)[cor.idx[i,][<span class="dv">1</span>]],</span>
<span id="cb1330-15"><a href="WE_13.html#cb1330-15" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">colnames</span>(site.cor)[cor.idx[i,][<span class="dv">2</span>]], <span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb1330-16"><a href="WE_13.html#cb1330-16" aria-hidden="true" tabindex="-1"></a>}   </span>
<span id="cb1330-17"><a href="WE_13.html#cb1330-17" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">parm=</span>cor.names, <span class="at">p=</span>cor.p)</span></code></pre></div>
<pre><code>##            parm          p
## 1      dd5_Elev -0.8924399
## 2      ffp_Elev -0.8873475
## 3      gsp_Elev  0.8728832
## 4   pratio_Elev -0.8659980
## 5   Area_Length  0.8715535
## 6  Perim_Length  0.8392532
## 7   Length_Area  0.8715535
## 8    Perim_Area  0.9912114
## 9  Length_Perim  0.8392532
## 10   Area_Perim  0.9912114
## 11     Elev_dd5 -0.8924399
## 12      ffp_dd5  0.9787231
## 13      gsp_dd5 -0.9843433
## 14   pratio_dd5  0.8965794
## 15     Elev_ffp -0.8873475
## 16      dd5_ffp  0.9787231
## 17      gsp_ffp -0.9705124
## 18   pratio_ffp  0.8553544
## 19     Elev_gsp  0.8728832
## 20      dd5_gsp -0.9843433
## 21      ffp_gsp -0.9705124
## 22   pratio_gsp -0.8820946
## 23  Elev_pratio -0.8659980
## 24   dd5_pratio  0.8965794
## 25   ffp_pratio  0.8553544
## 26   gsp_pratio -0.8820946</code></pre>
<p>This returns a list of pairwise correlations that are than the threshold p. Instead of doing this manually, we can use the function collinear to check this. It will make a suggestions which variable to drop.</p>
<div class="sourceCode" id="cb1332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1332-1"><a href="WE_13.html#cb1332-1" aria-hidden="true" tabindex="-1"></a>node.cor <span class="ot">&lt;-</span> spatialEco<span class="sc">::</span><span class="fu">collinear</span>(s, <span class="at">p=</span>p)</span></code></pre></div>
<pre><code>## Collinearity between Area and Perim correlation = 0.9912</code></pre>
<pre><code>##   Correlation means: 0.407 vs 0.272</code></pre>
<pre><code>##    recommend dropping Area</code></pre>
<pre><code>## Collinearity between Area and Length correlation = 0.8716</code></pre>
<pre><code>##   Correlation means: 0.407 vs 0.274</code></pre>
<pre><code>##    recommend dropping Area</code></pre>
<pre><code>## Collinearity between Perim and Length correlation = 0.8393</code></pre>
<pre><code>##   Correlation means: 0.402 vs 0.274</code></pre>
<pre><code>##    recommend dropping Perim</code></pre>
<pre><code>## Collinearity between Elev and dd5 correlation = 0.8924</code></pre>
<pre><code>##   Correlation means: 0.384 vs 0.273</code></pre>
<pre><code>##    recommend dropping Elev</code></pre>
<pre><code>## Collinearity between Elev and ffp correlation = 0.8873</code></pre>
<pre><code>##   Correlation means: 0.384 vs 0.274</code></pre>
<pre><code>##    recommend dropping Elev</code></pre>
<pre><code>## Collinearity between Elev and gsp correlation = 0.8729</code></pre>
<pre><code>##   Correlation means: 0.384 vs 0.274</code></pre>
<pre><code>##    recommend dropping Elev</code></pre>
<pre><code>## Collinearity between Elev and pratio correlation = 0.866</code></pre>
<pre><code>##   Correlation means: 0.384 vs 0.275</code></pre>
<pre><code>##    recommend dropping Elev</code></pre>
<pre><code>## Collinearity between dd5 and ffp correlation = 0.9787</code></pre>
<pre><code>##   Correlation means: 0.38 vs 0.274</code></pre>
<pre><code>##    recommend dropping dd5</code></pre>
<pre><code>## Collinearity between dd5 and gsp correlation = 0.9843</code></pre>
<pre><code>##   Correlation means: 0.38 vs 0.274</code></pre>
<pre><code>##    recommend dropping dd5</code></pre>
<pre><code>## Collinearity between dd5 and pratio correlation = 0.8966</code></pre>
<pre><code>##   Correlation means: 0.38 vs 0.275</code></pre>
<pre><code>##    recommend dropping dd5</code></pre>
<pre><code>## Collinearity between ffp and gsp correlation = 0.9705</code></pre>
<pre><code>##   Correlation means: 0.363 vs 0.274</code></pre>
<pre><code>##    recommend dropping ffp</code></pre>
<pre><code>## Collinearity between ffp and pratio correlation = 0.8554</code></pre>
<pre><code>##   Correlation means: 0.363 vs 0.275</code></pre>
<pre><code>##    recommend dropping ffp</code></pre>
<pre><code>## Collinearity between gsp and pratio correlation = 0.8821</code></pre>
<pre><code>##   Correlation means: 0.357 vs 0.275</code></pre>
<pre><code>##    recommend dropping gsp</code></pre>
<p>It also returns a vector of correlated variables:</p>
<div class="sourceCode" id="cb1372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1372-1"><a href="WE_13.html#cb1372-1" aria-hidden="true" tabindex="-1"></a>node.cor</span></code></pre></div>
<pre><code>## [1] &quot;Elev&quot;  &quot;Area&quot;  &quot;Perim&quot; &quot;dd5&quot;   &quot;ffp&quot;   &quot;gsp&quot;</code></pre>
</div>
<div id="h.-add-node-data" class="section level4 unnumbered hasAnchor">
<h4>h. Add node data<a href="WE_13.html#h.-add-node-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Build and add node (at-site) level data to graph, then merge edge (distance graph) and edge (between-site) data.</p>
<div class="sourceCode" id="cb1374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1374-1"><a href="WE_13.html#cb1374-1" aria-hidden="true" tabindex="-1"></a>node.var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;degree&quot;</span>, <span class="st">&quot;betweenness&quot;</span>, <span class="st">&quot;Elev&quot;</span>, <span class="st">&quot;Length&quot;</span>, <span class="st">&quot;Area&quot;</span>, <span class="st">&quot;Perim&quot;</span>, </span>
<span id="cb1374-2"><a href="WE_13.html#cb1374-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;Depth&quot;</span>, <span class="st">&quot;pH&quot;</span>,<span class="st">&quot;Dforest&quot;</span>,<span class="st">&quot;Drock&quot;</span>, <span class="st">&quot;Dshrub&quot;</span>, <span class="st">&quot;pwetland&quot;</span>, <span class="st">&quot;cti&quot;</span>,</span>
<span id="cb1374-3"><a href="WE_13.html#cb1374-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;dd5&quot;</span>, <span class="st">&quot;ffp&quot;</span>,<span class="st">&quot;gsp&quot;</span>,<span class="st">&quot;pratio&quot;</span>,<span class="st">&quot;hli&quot;</span>,<span class="st">&quot;rough27&quot;</span>,<span class="st">&quot;srr&quot;</span>)  </span>
<span id="cb1374-4"><a href="WE_13.html#cb1374-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1374-5"><a href="WE_13.html#cb1374-5" aria-hidden="true" tabindex="-1"></a>node <span class="ot">&lt;-</span> <span class="fu">build.node.data</span>(<span class="fu">st_drop_geometry</span>(sites), <span class="at">group.ids =</span> <span class="st">&quot;SiteID&quot;</span>, </span>
<span id="cb1374-6"><a href="WE_13.html#cb1374-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">from.parms =</span> node.var)</span></code></pre></div>
<p>Merge node and edges for model data.frame</p>
<div class="sourceCode" id="cb1375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1375-1"><a href="WE_13.html#cb1375-1" aria-hidden="true" tabindex="-1"></a>gdata <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">st_drop_geometry</span>(dist.graph)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">7</span>)], node, </span>
<span id="cb1375-2"><a href="WE_13.html#cb1375-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">by.x=</span><span class="st">&quot;SiteID&quot;</span>, <span class="at">by.y=</span><span class="st">&quot;SiteID&quot;</span>)</span>
<span id="cb1375-3"><a href="WE_13.html#cb1375-3" aria-hidden="true" tabindex="-1"></a>gdata <span class="ot">&lt;-</span> <span class="fu">merge</span>(gdata, <span class="fu">st_drop_geometry</span>(dist.graph)[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">15</span><span class="sc">:</span><span class="dv">55</span>)], </span>
<span id="cb1375-4"><a href="WE_13.html#cb1375-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by.x=</span><span class="st">&quot;SiteID&quot;</span>, <span class="at">by.y=</span><span class="st">&quot;SiteID&quot;</span>) </span>
<span id="cb1375-5"><a href="WE_13.html#cb1375-5" aria-hidden="true" tabindex="-1"></a><span class="co"># log transform matrix</span></span>
<span id="cb1375-6"><a href="WE_13.html#cb1375-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">5</span><span class="sc">:</span><span class="fu">ncol</span>(gdata)) </span>
<span id="cb1375-7"><a href="WE_13.html#cb1375-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1375-8"><a href="WE_13.html#cb1375-8" aria-hidden="true" tabindex="-1"></a>  gdata[,i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gdata[,i] <span class="sc">&lt;=</span> <span class="dv">0</span>, <span class="fl">0.00001</span>, <span class="fu">log</span>(gdata[,i]))</span>
<span id="cb1375-9"><a href="WE_13.html#cb1375-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="gravity-model" class="section level3 unnumbered hasAnchor">
<h3>7. Gravity model<a href="WE_13.html#gravity-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-develop-hypothesis" class="section level4 unnumbered hasAnchor">
<h4>a. Develop hypothesis<a href="WE_13.html#a.-develop-hypothesis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>What type of gravity model do you wish to run (production or attraction constraint)? Think about what hypotheses that you want to test. Write out model statements that group parameters into hypotheses and run models. Remember to run a NULL that is just distance.</p>
<p><strong>At-site (node) potential parameters.</strong> These are all at-site variables. Remember that we pulled all raster variables. We want to critically think about hypotheses and not use all of these parameters.</p>
<ul>
<li><code>degree</code> - graph degree</li>
<li><code>betweenness</code> - graph betweeness</li>
<li><code>Elev</code> - elevation (see comments below)</li>
<li><code>Length</code> - geographic distance</li>
<li><code>Area</code> - wetland area (field)</li>
<li><code>Perim</code> - wetland perimeter (field)</li>
<li><code>Depth</code> - wetland depth (field)- highly correlated with predatory fish presence/abundance</li>
<li><code>pH</code> - wetland pH (field)</li>
<li><code>Dforest</code> - distance to forest (field)</li>
<li><code>Drock</code> - distance to rock (field)</li>
<li><code>Dshrub</code> - distance to shrub (field)</li>
<li><code>pwetland</code> - proportion of wetland in X buffer (calculated above)</li>
<li><code>cti</code> - compound topographic wetness index - steady-state measure of wetness based on topography (raster data)</li>
<li><code>dd5</code> - degree days &gt;5 C (sum of temp) - (raster data)</li>
<li><code>ffp</code> - frost free period (raster data)</li>
<li><code>gsp</code> - growing season precipitation (raster data)</li>
<li><code>pratio</code> - ratio of growing season precip to annual precip (raster data) - can indicate amount of snow to rain</li>
<li><code>hli</code> - heat load index - topographic measure of exposure, related to productivity (ice-off and primary productivity) in this system (raster data)</li>
<li><code>rough27</code> - unscale topographic variation at a 27 X 27 (cells) window size (raster data)</li>
<li><code>ssr</code> - measure of topographic variation at a 27X27 (cells) windo size - for this system pulling out ridgelines (raster data)</li>
</ul>
<p>NOTE: we are adding elevation here as a covariate. HOWEVER - elevation does not represent ecological processes in and of itself. I strongly encourage using the components (temp, moisture, rainfall, vegetation, accessibility, etc.) directly and not elevation as a surrogate parameter.</p>
<p><strong>Between site (edge) potential parameters include:</strong></p>
<ul>
<li><code>cti</code>, <code>dd5</code>, <code>ffp</code>, <code>gsp</code>, <code>pratio</code>, <code>hli</code>, <code>rough27</code>, <code>ssr</code> (min, mean, max, var, median for each)</li>
<li><code>wet.pct.nlcd</code> - percent of cells that are wetland class</li>
</ul>
<div class="sourceCode" id="cb1376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1376-1"><a href="WE_13.html#cb1376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># null model (under Maximum Likelihood) </span></span>
<span id="cb1376-2"><a href="WE_13.html#cb1376-2" aria-hidden="true" tabindex="-1"></a>( null <span class="ot">&lt;-</span> <span class="fu">gravity</span>(<span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;length&quot;</span>), <span class="at">d =</span> <span class="st">&quot;length&quot;</span>, <span class="at">group =</span> <span class="st">&quot;from_ID&quot;</span>, </span>
<span id="cb1376-3"><a href="WE_13.html#cb1376-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> gdata, <span class="at">fit.method =</span> <span class="st">&quot;ML&quot;</span>) )</span></code></pre></div>
<pre><code>## [1] &quot;Running singly-constrained gravity model&quot;</code></pre>
<pre><code>## Gravity model
## 
## Linear mixed-effects model fit by maximum likelihood
##   Data: gdata 
##        AIC      BIC    logLik
##   20554.37 20585.62 -10273.18
## 
## Random effects:
##  Formula: GDIST ~ 1 | from_ID
##         (Intercept)  Residual
## StdDev:   0.2009152 0.4232432
## 
## Fixed effects:  stats::as.formula(paste(paste(y, &quot;~&quot;, sep = &quot;&quot;), paste(x, collapse = &quot;+&quot;))) 
##                  Value  Std.Error    DF    t-value p-value
## (Intercept) -1.2019984 0.07467247 18224 -16.096941       0
## length       0.1418157 0.03059252 18224   4.635633       0
##  Correlation: 
##        (Intr)
## length -0.854
## 
## Standardized Within-Group Residuals:
##        Min         Q1        Med         Q3        Max 
## -3.2285925 -0.5168847  0.1184083  0.6182159  2.4848654 
## 
## Number of Observations: 18252
## Number of Groups: 27</code></pre>
<div class="sourceCode" id="cb1379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1379-1"><a href="WE_13.html#cb1379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fish hypothesis (under Maximum Likelihood) </span></span>
<span id="cb1379-2"><a href="WE_13.html#cb1379-2" aria-hidden="true" tabindex="-1"></a>( depth <span class="ot">&lt;-</span> <span class="fu">gravity</span>(<span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;length&quot;</span>,<span class="st">&quot;from.Depth&quot;</span>), <span class="at">d =</span> <span class="st">&quot;length&quot;</span>, </span>
<span id="cb1379-3"><a href="WE_13.html#cb1379-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">group =</span> <span class="st">&quot;from_ID&quot;</span>, <span class="at">data =</span> gdata, <span class="at">fit.method =</span> <span class="st">&quot;ML&quot;</span>, <span class="at">ln =</span> <span class="cn">FALSE</span>) )</span></code></pre></div>
<pre><code>## [1] &quot;Running singly-constrained gravity model&quot;</code></pre>
<pre><code>## Gravity model
## 
## Linear mixed-effects model fit by maximum likelihood
##   Data: gdata 
##         AIC       BIC  logLik
##   -13067.22 -13028.16 6538.61
## 
## Random effects:
##  Formula: GDIST ~ 1 | from_ID
##         (Intercept) Residual
## StdDev:  0.08102556 0.168483
## 
## Fixed effects:  stats::as.formula(paste(paste(y, &quot;~&quot;, sep = &quot;&quot;), paste(x, collapse = &quot;+&quot;))) 
##                  Value   Std.Error    DF    t-value p-value
## (Intercept) -0.4101360 0.028357541 18224 -14.463032  0.0000
## length      -0.0002202 0.001624886 18224  -0.135530  0.8922
## from.Depth  -0.0200540 0.014527936    25  -1.380377  0.1797
##  Correlation: 
##            (Intr) length
## length     -0.462       
## from.Depth -0.693 -0.002
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -5.07683320 -0.58959052  0.02162005  0.65913788  3.21875035 
## 
## Number of Observations: 18252
## Number of Groups: 27</code></pre>
<div class="sourceCode" id="cb1382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1382-1"><a href="WE_13.html#cb1382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Productivity hypothesis (under Maximum Likelihood) </span></span>
<span id="cb1382-2"><a href="WE_13.html#cb1382-2" aria-hidden="true" tabindex="-1"></a>( production <span class="ot">&lt;-</span> <span class="fu">gravity</span>(<span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;from.ffp&quot;</span>, <span class="st">&quot;from.hli&quot;</span>), </span>
<span id="cb1382-3"><a href="WE_13.html#cb1382-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">d =</span> <span class="st">&quot;length&quot;</span>,  <span class="at">group =</span> <span class="st">&quot;from_ID&quot;</span>, <span class="at">data =</span> gdata, </span>
<span id="cb1382-4"><a href="WE_13.html#cb1382-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fit.method =</span> <span class="st">&quot;ML&quot;</span>, <span class="at">ln =</span> <span class="cn">FALSE</span>) )</span></code></pre></div>
<pre><code>## [1] &quot;Running singly-constrained gravity model&quot;</code></pre>
<pre><code>## Gravity model
## 
## Linear mixed-effects model fit by maximum likelihood
##   Data: gdata 
##         AIC       BIC   logLik
##   -13069.56 -13022.69 6540.779
## 
## Random effects:
##  Formula: GDIST ~ 1 | from_ID
##         (Intercept) Residual
## StdDev:  0.07472813 0.168483
## 
## Fixed effects:  stats::as.formula(paste(paste(y, &quot;~&quot;, sep = &quot;&quot;), paste(x, collapse = &quot;+&quot;))) 
##                 Value Std.Error    DF    t-value p-value
## (Intercept)  7.844732  3.217229 18224  2.4383506  0.0148
## length      -0.000216  0.001625 18224 -0.1327679  0.8944
## from.ffp    -0.182845  0.092655    24 -1.9734052  0.0601
## from.hli     9.858960  3.806810    24  2.5898215  0.0161
##  Correlation: 
##          (Intr) length frm.ff
## length   -0.001              
## from.ffp -0.873 -0.002       
## from.hli  1.000  0.003 -0.858
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -5.07745485 -0.59059645  0.02038188  0.65656315  3.21927307 
## 
## Number of Observations: 18252
## Number of Groups: 27</code></pre>
<div class="sourceCode" id="cb1385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1385-1"><a href="WE_13.html#cb1385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Climate hypothesis (under Maximum Likelihood) </span></span>
<span id="cb1385-2"><a href="WE_13.html#cb1385-2" aria-hidden="true" tabindex="-1"></a>( climate <span class="ot">&lt;-</span> <span class="fu">gravity</span>(<span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;median.ffp&quot;</span>, <span class="st">&quot;median.pratio&quot;</span>), </span>
<span id="cb1385-3"><a href="WE_13.html#cb1385-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">d =</span> <span class="st">&quot;length&quot;</span>, <span class="at">group =</span> <span class="st">&quot;from_ID&quot;</span>, <span class="at">data =</span> gdata, </span>
<span id="cb1385-4"><a href="WE_13.html#cb1385-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fit.method =</span> <span class="st">&quot;ML&quot;</span>,  <span class="at">ln =</span> <span class="cn">FALSE</span>) )</span></code></pre></div>
<pre><code>## [1] &quot;Running singly-constrained gravity model&quot;</code></pre>
<pre><code>## Gravity model
## 
## Linear mixed-effects model fit by maximum likelihood
##   Data: gdata 
##        AIC       BIC   logLik
##   -13063.4 -13016.53 6537.699
## 
## Random effects:
##  Formula: GDIST ~ 1 | from_ID
##         (Intercept) Residual
## StdDev:  0.08379164 0.168483
## 
## Fixed effects:  stats::as.formula(paste(paste(y, &quot;~&quot;, sep = &quot;&quot;), paste(x, collapse = &quot;+&quot;))) 
##                    Value Std.Error    DF    t-value p-value
## (Intercept)   -0.3764155 0.4324059 18222 -0.8705143  0.3840
## length        -0.0002220 0.0016250 18222 -0.1365944  0.8914
## median.ffp    -0.0015543 0.0123722 18222 -0.1256312  0.9000
## median.pratio  0.0719090 0.5093743 18222  0.1411713  0.8877
##  Correlation: 
##               (Intr) length mdn.ff
## length        -0.030              
## median.ffp    -0.921  0.000       
## median.pratio  0.999  0.000 -0.914
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -5.07813375 -0.58911378  0.02085691  0.65932821  3.22058420 
## 
## Number of Observations: 18252
## Number of Groups: 27</code></pre>
<div class="sourceCode" id="cb1388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1388-1"><a href="WE_13.html#cb1388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wetlands hypothesis (under Maximum Likelihood) </span></span>
<span id="cb1388-2"><a href="WE_13.html#cb1388-2" aria-hidden="true" tabindex="-1"></a>( wetlands <span class="ot">&lt;-</span> <span class="fu">gravity</span>(<span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;from.degree&quot;</span>, <span class="st">&quot;from.betweenness&quot;</span>, <span class="st">&quot;from.pwetland&quot;</span>), </span>
<span id="cb1388-3"><a href="WE_13.html#cb1388-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">d =</span> <span class="st">&quot;length&quot;</span>, <span class="at">group =</span> <span class="st">&quot;from_ID&quot;</span>, <span class="at">data =</span> gdata, <span class="at">fit.method =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb1388-4"><a href="WE_13.html#cb1388-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ln =</span> <span class="cn">FALSE</span>) )</span></code></pre></div>
<pre><code>## [1] &quot;Running singly-constrained gravity model&quot;</code></pre>
<pre><code>## Gravity model
## 
## Linear mixed-effects model fit by maximum likelihood
##   Data: gdata 
##         AIC       BIC   logLik
##   -13061.71 -13007.03 6537.856
## 
## Random effects:
##  Formula: GDIST ~ 1 | from_ID
##         (Intercept) Residual
## StdDev:  0.08333405 0.168483
## 
## Fixed effects:  stats::as.formula(paste(paste(y, &quot;~&quot;, sep = &quot;&quot;), paste(x, collapse = &quot;+&quot;))) 
##                       Value  Std.Error    DF   t-value p-value
## (Intercept)      -0.3992700 0.10461517 18224 -3.816559  0.0001
## length           -0.0002201 0.00162516 18224 -0.135444  0.8923
## from.degree      -0.0016877 0.01219259    23 -0.138422  0.8911
## from.betweenness -0.0211050 0.05709693    23 -0.369635  0.7150
## from.pwetland    -0.0042020 0.00998733    23 -0.420733  0.6779
##  Correlation: 
##                  (Intr) length frm.dg frm.bt
## length           -0.129                     
## from.degree      -0.273  0.013              
## from.betweenness -0.770 -0.006 -0.335       
## from.pwetland     0.015 -0.002  0.348 -0.015
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -5.07678625 -0.58904996  0.02101676  0.65966584  3.21863968 
## 
## Number of Observations: 18252
## Number of Groups: 27</code></pre>
<div class="sourceCode" id="cb1391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1391-1"><a href="WE_13.html#cb1391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Topography hypothesis (under Maximum Likelihood) </span></span>
<span id="cb1391-2"><a href="WE_13.html#cb1391-2" aria-hidden="true" tabindex="-1"></a>( topo <span class="ot">&lt;-</span> <span class="fu">gravity</span>(<span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;median.srr&quot;</span>, <span class="st">&quot;median.rough27&quot;</span>), <span class="at">d =</span> <span class="st">&quot;length&quot;</span>, </span>
<span id="cb1391-3"><a href="WE_13.html#cb1391-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">group =</span> <span class="st">&quot;from_ID&quot;</span>, <span class="at">data =</span> gdata, <span class="at">fit.method =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb1391-4"><a href="WE_13.html#cb1391-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ln =</span> <span class="cn">FALSE</span>) )</span></code></pre></div>
<pre><code>## [1] &quot;Running singly-constrained gravity model&quot;</code></pre>
<pre><code>## Gravity model
## 
## Linear mixed-effects model fit by maximum likelihood
##   Data: gdata 
##         AIC       BIC   logLik
##   -13063.38 -13016.51 6537.691
## 
## Random effects:
##  Formula: GDIST ~ 1 | from_ID
##         (Intercept) Residual
## StdDev:  0.08384168 0.168483
## 
## Fixed effects:  stats::as.formula(paste(paste(y, &quot;~&quot;, sep = &quot;&quot;), paste(x, collapse = &quot;+&quot;))) 
##                     Value   Std.Error    DF    t-value p-value
## (Intercept)    -0.4362752 0.028684761 18222 -15.209304  0.0000
## length         -0.0002219 0.001624950 18222  -0.136584  0.8914
## median.srr      0.0000915 0.012808227 18222   0.007141  0.9943
## median.rough27 -0.0001394 0.002224808 18222  -0.062664  0.9500
##  Correlation: 
##                (Intr) length mdn.sr
## length         -0.458              
## median.srr      0.449  0.000       
## median.rough27 -0.574  0.000 -0.132
## 
## Standardized Within-Group Residuals:
##        Min         Q1        Med         Q3        Max 
## -5.0777083 -0.5892049  0.0209408  0.6596691  3.2190372 
## 
## Number of Observations: 18252
## Number of Groups: 27</code></pre>
<div class="sourceCode" id="cb1394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1394-1"><a href="WE_13.html#cb1394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Habitat hypothesis (under Maximum Likelihood) </span></span>
<span id="cb1394-2"><a href="WE_13.html#cb1394-2" aria-hidden="true" tabindex="-1"></a>( habitat <span class="ot">&lt;-</span> <span class="fu">gravity</span>(<span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;wet.pct.nlcd&quot;</span>, <span class="st">&quot;median.gsp&quot;</span>), </span>
<span id="cb1394-3"><a href="WE_13.html#cb1394-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">d =</span> <span class="st">&quot;length&quot;</span>, <span class="at">group =</span> <span class="st">&quot;from_ID&quot;</span>, <span class="at">data =</span> gdata, <span class="at">fit.method =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb1394-4"><a href="WE_13.html#cb1394-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ln =</span> <span class="cn">FALSE</span>, <span class="at">method=</span><span class="st">&quot;ML&quot;</span>) )</span></code></pre></div>
<pre><code>## [1] &quot;Running singly-constrained gravity model&quot;</code></pre>
<pre><code>## Gravity model
## 
## Linear mixed-effects model fit by maximum likelihood
##   Data: gdata 
##         AIC       BIC   logLik
##   -13063.38 -13016.51 6537.689
## 
## Random effects:
##  Formula: GDIST ~ 1 | from_ID
##         (Intercept) Residual
## StdDev:  0.08385112 0.168483
## 
## Fixed effects:  stats::as.formula(paste(paste(y, &quot;~&quot;, sep = &quot;&quot;), paste(x, collapse = &quot;+&quot;))) 
##                   Value Std.Error    DF    t-value p-value
## (Intercept)  -0.4347231 0.3358747 18222 -1.2943015  0.1956
## length       -0.0002220 0.0016250 18222 -0.1365927  0.8914
## wet.pct.nlcd  0.0000233 0.0008368 18222  0.0278113  0.9778
## median.gsp   -0.0004444 0.0592399 18222 -0.0075024  0.9940
##  Correlation: 
##              (Intr) length wt.pc.
## length       -0.039              
## wet.pct.nlcd -0.131  0.000       
## median.gsp   -0.998  0.000  0.137
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -5.07735336 -0.58922468  0.02089058  0.65952539  3.21896772 
## 
## Number of Observations: 18252
## Number of Groups: 27</code></pre>
<div class="sourceCode" id="cb1397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1397-1"><a href="WE_13.html#cb1397-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Global model (under Maximum Likelihood) </span></span>
<span id="cb1397-2"><a href="WE_13.html#cb1397-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1397-3"><a href="WE_13.html#cb1397-3" aria-hidden="true" tabindex="-1"></a>( global <span class="ot">&lt;-</span> <span class="fu">gravity</span>(<span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;wet.pct.nlcd&quot;</span>, <span class="st">&quot;median.gsp&quot;</span>, </span>
<span id="cb1397-4"><a href="WE_13.html#cb1397-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;from.Depth&quot;</span>, <span class="st">&quot;from.ffp&quot;</span>, <span class="st">&quot;from.hli&quot;</span>, <span class="st">&quot;from.pratio&quot;</span>, <span class="st">&quot;from.degree&quot;</span>, </span>
<span id="cb1397-5"><a href="WE_13.html#cb1397-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;from.betweenness&quot;</span>, <span class="st">&quot;from.pwetland&quot;</span>, <span class="st">&quot;median.srr&quot;</span>, <span class="st">&quot;median.rough27&quot;</span>), </span>
<span id="cb1397-6"><a href="WE_13.html#cb1397-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">d =</span> <span class="st">&quot;length&quot;</span>, <span class="at">group =</span> <span class="st">&quot;from_ID&quot;</span>, <span class="at">data =</span> gdata, <span class="at">fit.method =</span> <span class="st">&quot;ML&quot;</span>,</span>
<span id="cb1397-7"><a href="WE_13.html#cb1397-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ln =</span> <span class="cn">FALSE</span>) )</span></code></pre></div>
<pre><code>## [1] &quot;Running singly-constrained gravity model&quot;</code></pre>
<pre><code>## Gravity model
## 
## Linear mixed-effects model fit by maximum likelihood
##   Data: gdata 
##         AIC       BIC   logLik
##   -13054.63 -12937.45 6542.316
## 
## Random effects:
##  Formula: GDIST ~ 1 | from_ID
##         (Intercept) Residual
## StdDev:  0.07055036 0.168483
## 
## Fixed effects:  stats::as.formula(paste(paste(y, &quot;~&quot;, sep = &quot;&quot;), paste(x, collapse = &quot;+&quot;))) 
##                      Value Std.Error    DF    t-value p-value
## (Intercept)       7.594838  3.142709 18220  2.4166536  0.0157
## length           -0.000222  0.001626 18220 -0.1363422  0.8916
## wet.pct.nlcd      0.000015  0.000848 18220  0.0182482  0.9854
## median.gsp        0.006423  0.074369 18220  0.0863647  0.9312
## from.Depth       -0.028416  0.016951    19 -1.6763414  0.1100
## from.ffp         -0.160716  0.092478    19 -1.7378814  0.0984
## from.hli          9.870505  3.708767    19  2.6613980  0.0154
## from.pratio       0.021924  0.044485    19  0.4928338  0.6278
## from.degree      -0.002106  0.010941    19 -0.1924986  0.8494
## from.betweenness  0.041878  0.059756    19  0.7008170  0.4919
## from.pwetland     0.004308  0.009342    19  0.4611556  0.6499
## median.srr        0.000243  0.012888 18220  0.0188312  0.9850
## median.rough27   -0.000201  0.002850 18220 -0.0705163  0.9438
##  Correlation: 
##                  (Intr) length wt.pc. mdn.gs frm.Dp frm.ff frm.hl frm.pr frm.dg
## length           -0.004                                                        
## wet.pct.nlcd     -0.006  0.000                                                 
## median.gsp       -0.130  0.000  0.018                                          
## from.Depth        0.062 -0.001 -0.002 -0.001                                   
## from.ffp         -0.861  0.001  0.006  0.017 -0.179                            
## from.hli          0.985  0.001 -0.004  0.002  0.035 -0.858                     
## from.pratio       0.015  0.007 -0.009  0.015 -0.076 -0.132  0.120              
## from.degree      -0.114  0.016 -0.005 -0.004 -0.074  0.084 -0.075  0.300       
## from.betweenness  0.054 -0.007  0.003 -0.012 -0.533 -0.009  0.062 -0.159 -0.292
## from.pwetland     0.085  0.000  0.005  0.000 -0.339 -0.070  0.117  0.254  0.379
## median.srr        0.001  0.000 -0.075  0.077  0.005 -0.009  0.007  0.001  0.010
## median.rough27    0.085  0.000  0.150 -0.603 -0.004 -0.010  0.009 -0.015  0.009
##                  frm.bt frm.pw mdn.sr
## length                               
## wet.pct.nlcd                         
## median.gsp                           
## from.Depth                           
## from.ffp                             
## from.hli                             
## from.pratio                          
## from.degree                          
## from.betweenness                     
## from.pwetland     0.137              
## median.srr        0.002 -0.006       
## median.rough27    0.003  0.004 -0.161
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -5.07862043 -0.59088464  0.02199601  0.65522607  3.22091896 
## 
## Number of Observations: 18252
## Number of Groups: 27</code></pre>
</div>
<div id="b.-compare-competing-models" class="section level4 unnumbered hasAnchor">
<h4>b. Compare competing models<a href="WE_13.html#b.-compare-competing-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Should you use ML or REML? Create diagnostic plots.</p>
<p>Can you directly compare ML and REML? Why not?</p>
<div class="sourceCode" id="cb1400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1400-1"><a href="WE_13.html#cb1400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare.models</span>(null, depth, production, climate, wetlands, </span>
<span id="cb1400-2"><a href="WE_13.html#cb1400-2" aria-hidden="true" tabindex="-1"></a>               topo, habitat, global)</span></code></pre></div>
<pre><code>##        model       AIC       BIC log.likelihood   RMSE nparms     deltaAIC
## 1       null  20554.37  20585.62     -10273.185 0.5386      0 33623.927613
## 2      depth -13067.22 -13028.16       6538.610 0.1779      2     2.339018
## 3 production -13069.56 -13022.69       6540.779 0.1765      3     0.000000
## 4    climate -13063.40 -13016.53       6537.699 0.1785      3     6.160553
## 5   wetlands -13061.71 -13007.03       6537.856 0.1784      4     7.846638
## 6       topo -13063.38 -13016.51       6537.691 0.1786      3     6.176597
## 7    habitat -13063.38 -13016.51       6537.689 0.1786      3     6.179621
## 8     global -13054.63 -12937.45       6542.316 0.1757     12    14.926651
##       deltaBIC
## 1 33613.776566
## 2     0.000000
## 3     5.473012
## 4    11.633565
## 5    21.131680
## 6    11.649610
## 7    11.652634
## 8    90.707933</code></pre>
<div class="sourceCode" id="cb1402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1402-1"><a href="WE_13.html#cb1402-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb1402-2"><a href="WE_13.html#cb1402-2" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) { <span class="fu">plot</span>(null, <span class="at">type=</span>i) } </span></code></pre></div>
<p><img src="13-Week13_files/figure-html/null-1.png" width="672" /></p>
</div>
<div id="c.-fit-final-models-and-calculate-effect-size" class="section level4 unnumbered hasAnchor">
<h4>c. Fit final model(s) and calculate effect size<a href="WE_13.html#c.-fit-final-models-and-calculate-effect-size" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To calculate effect size, we refit the models with REML.</p>
<div class="sourceCode" id="cb1403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1403-1"><a href="WE_13.html#cb1403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># productivity fit (under REML)</span></span>
<span id="cb1403-2"><a href="WE_13.html#cb1403-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;from.ffp&quot;</span>, <span class="st">&quot;from.hli&quot;</span>)</span>
<span id="cb1403-3"><a href="WE_13.html#cb1403-3" aria-hidden="true" tabindex="-1"></a>production_fit <span class="ot">&lt;-</span> <span class="fu">gravity</span>(<span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> h, <span class="at">d =</span> <span class="st">&quot;length&quot;</span>, <span class="at">group =</span> <span class="st">&quot;from_ID&quot;</span>,</span>
<span id="cb1403-4"><a href="WE_13.html#cb1403-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> gdata, <span class="at">ln=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Running singly-constrained gravity model&quot;</code></pre>
<div class="sourceCode" id="cb1405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1405-1"><a href="WE_13.html#cb1405-1" aria-hidden="true" tabindex="-1"></a><span class="do">## g.obal fit (under REML)</span></span>
<span id="cb1405-2"><a href="WE_13.html#cb1405-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;wet.pct.nlcd&quot;</span>, <span class="st">&quot;median.gsp&quot;</span>, <span class="st">&quot;from.Depth&quot;</span>, <span class="st">&quot;from.ffp&quot;</span>,</span>
<span id="cb1405-3"><a href="WE_13.html#cb1405-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;from.hli&quot;</span>, <span class="st">&quot;from.pratio&quot;</span>,  <span class="st">&quot;from.degree&quot;</span>, <span class="st">&quot;from.betweenness&quot;</span>,  </span>
<span id="cb1405-4"><a href="WE_13.html#cb1405-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;from.pwetland&quot;</span>, <span class="st">&quot;median.srr&quot;</span>,  <span class="st">&quot;median.rough27&quot;</span>)</span>
<span id="cb1405-5"><a href="WE_13.html#cb1405-5" aria-hidden="true" tabindex="-1"></a>global_fit <span class="ot">&lt;-</span> <span class="fu">gravity</span>(<span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> g, <span class="at">d =</span> <span class="st">&quot;length&quot;</span>, </span>
<span id="cb1405-6"><a href="WE_13.html#cb1405-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group =</span> <span class="st">&quot;from_ID&quot;</span>, <span class="at">data =</span> gdata, <span class="at">ln=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Running singly-constrained gravity model&quot;</code></pre>
<p>Effect size calculation: global model</p>
<div class="sourceCode" id="cb1407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1407-1"><a href="WE_13.html#cb1407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gravity.es</span>(global_fit)</span></code></pre></div>
<pre><code>##                      t.value    df       cohen.d  p.value      low.ci
## length           -0.12995103 18220 -0.0019254646 0.896607 -0.02246144
## wet.pct.nlcd      0.01285573 18220  0.0001904814 0.989743 -0.02034549
## median.gsp        0.06080170 18220  0.0009008895 0.951518 -0.01963508
## from.Depth       -1.40651839    19 -0.6453548981 0.175716 -1.33971267
## from.ffp         -1.45856008    19 -0.6692332641 0.161020 -1.36495273
## from.hli          2.23310806    19  1.0246202508 0.037767  0.30328454
## from.pratio       0.41324402    19  0.1896093623 0.684054 -0.48802350
## from.degree      -0.16130151    19 -0.0740102093 0.873559 -0.75028579
## from.betweenness  0.58817704    19  0.2698741332 0.563340 -0.40939769
## from.pwetland     0.38694297    19  0.1775416115 0.703098 -0.49989408
## median.srr        0.01325052 18220  0.0001963309 0.989428 -0.02033964
## median.rough27   -0.04964361 18220 -0.0007355618 0.960407 -0.02127153
##                       up.ci
## length           0.01861051
## wet.pct.nlcd     0.02072645
## median.gsp       0.02143686
## from.Depth       0.04900287
## from.ffp         0.02648620
## from.hli         1.74595596
## from.pratio      0.86724222
## from.degree      0.60226537
## from.betweenness 0.94914596
## from.pwetland    0.85497730
## median.srr       0.02073230
## median.rough27   0.01980041</code></pre>
<div class="sourceCode" id="cb1409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1409-1"><a href="WE_13.html#cb1409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb1409-2"><a href="WE_13.html#cb1409-2" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) { <span class="fu">plot</span>(global_fit, <span class="at">type=</span>i) } </span></code></pre></div>
<p><img src="13-Week13_files/figure-html/global_fit-1.png" width="672" /></p>
<p>Production model:</p>
<div class="sourceCode" id="cb1410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1410-1"><a href="WE_13.html#cb1410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gravity.es</span>(production_fit)</span></code></pre></div>
<pre><code>##             t.value    df      cohen.d  p.value      low.ci      up.ci
## length   -0.1307727 18224 -0.001937426 0.895957 -0.02247115  0.0185963
## from.ffp -1.8607323    24 -0.759640789 0.075078 -1.37514450 -0.1441371
## from.hli  2.4419572    24  0.996924848 0.022351  0.36605297  1.6277967</code></pre>
<div class="sourceCode" id="cb1412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1412-1"><a href="WE_13.html#cb1412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb1412-2"><a href="WE_13.html#cb1412-2" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) { <span class="fu">plot</span>(production_fit, <span class="at">type=</span>i) } </span></code></pre></div>
<p><img src="13-Week13_files/figure-html/production_fit-1.png" width="672" /></p>
</div>
<div id="d.-back-predict-global_fit-model" class="section level4 unnumbered hasAnchor">
<h4>d. Back predict global_fit model<a href="WE_13.html#d.-back-predict-global_fit-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Feel free to add other top models.</p>
<div class="sourceCode" id="cb1413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1413-1"><a href="WE_13.html#cb1413-1" aria-hidden="true" tabindex="-1"></a>gd <span class="ot">&lt;-</span> <span class="fu">back.transform</span>(gdata<span class="sc">$</span>GDIST)</span>
<span id="cb1413-2"><a href="WE_13.html#cb1413-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1413-3"><a href="WE_13.html#cb1413-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make individual-level (group) predictions (per slope) and show RMSE </span></span>
<span id="cb1413-4"><a href="WE_13.html#cb1413-4" aria-hidden="true" tabindex="-1"></a>global.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(global_fit, <span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> g,  </span>
<span id="cb1413-5"><a href="WE_13.html#cb1413-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">newdata=</span>gdata, <span class="at">groups =</span> gdata<span class="sc">$</span>from_ID,</span>
<span id="cb1413-6"><a href="WE_13.html#cb1413-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">back.transform =</span> <span class="st">&quot;simple&quot;</span>)</span></code></pre></div>
<pre><code>## Making individual-level (per-slope group) 
##        constrained predictions</code></pre>
<pre><code>## Back-transforming exp(y-hat)*0.5*variance(y-hat), 
##        assumes normally distributed errors</code></pre>
<div class="sourceCode" id="cb1416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1416-1"><a href="WE_13.html#cb1416-1" aria-hidden="true" tabindex="-1"></a>production.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(production_fit, <span class="at">y =</span> <span class="st">&quot;GDIST&quot;</span>, <span class="at">x =</span> h,  </span>
<span id="cb1416-2"><a href="WE_13.html#cb1416-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">newdata=</span>gdata, <span class="at">groups =</span> gdata<span class="sc">$</span>from_ID,</span>
<span id="cb1416-3"><a href="WE_13.html#cb1416-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">back.transform =</span> <span class="st">&quot;simple&quot;</span>)</span></code></pre></div>
<pre><code>## Making individual-level (per-slope group) 
##        constrained predictions
## Back-transforming exp(y-hat)*0.5*variance(y-hat), 
##        assumes normally distributed errors</code></pre>
<div class="sourceCode" id="cb1418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1418-1"><a href="WE_13.html#cb1418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;RMSE of global&quot;</span>, <span class="fu">rmse</span>(global.p, gd), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## RMSE of global 0.1104084</code></pre>
<div class="sourceCode" id="cb1420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1420-1"><a href="WE_13.html#cb1420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;RMSE of production&quot;</span>, <span class="fu">rmse</span>(production.p, gd), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## RMSE of production 0.1104098</code></pre>
</div>
<div id="e.-aggregrate-estimates-and-plot" class="section level4 unnumbered hasAnchor">
<h4>e. Aggregrate estimates and plot<a href="WE_13.html#e.-aggregrate-estimates-and-plot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can aggregrate estimates back to the edges and nodes. An interactive map can be created using the <code>tmap</code> package (see Week 2 Bonus vignette).</p>
<p>Aggregate estimates to graph and node.</p>
<div class="sourceCode" id="cb1422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1422-1"><a href="WE_13.html#cb1422-1" aria-hidden="true" tabindex="-1"></a>global.p <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">EID =</span> gdata<span class="sc">$</span>from.to,</span>
<span id="cb1422-2"><a href="WE_13.html#cb1422-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">NID =</span> gdata<span class="sc">$</span>from_ID,  </span>
<span id="cb1422-3"><a href="WE_13.html#cb1422-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">p=</span>global.p)</span>
<span id="cb1422-4"><a href="WE_13.html#cb1422-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1422-5"><a href="WE_13.html#cb1422-5" aria-hidden="true" tabindex="-1"></a>edge.p <span class="ot">&lt;-</span> <span class="fu">tapply</span>(global.p<span class="sc">$</span>p, global.p<span class="sc">$</span>EID, mean)</span>
<span id="cb1422-6"><a href="WE_13.html#cb1422-6" aria-hidden="true" tabindex="-1"></a>  dist.graph<span class="sc">$</span>global.flow <span class="ot">&lt;-</span> edge.p</span>
<span id="cb1422-7"><a href="WE_13.html#cb1422-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1422-8"><a href="WE_13.html#cb1422-8" aria-hidden="true" tabindex="-1"></a>node.p <span class="ot">&lt;-</span> <span class="fu">tapply</span>(global.p<span class="sc">$</span>p, global.p<span class="sc">$</span>NID, mean)</span>
<span id="cb1422-9"><a href="WE_13.html#cb1422-9" aria-hidden="true" tabindex="-1"></a>node.var <span class="ot">&lt;-</span> <span class="fu">tapply</span>(global.p<span class="sc">$</span>p, global.p<span class="sc">$</span>NID, var)</span>
<span id="cb1422-10"><a href="WE_13.html#cb1422-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1422-11"><a href="WE_13.html#cb1422-11" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(sites<span class="sc">$</span>SiteName <span class="sc">%in%</span> <span class="fu">names</span>(node.p))</span>
<span id="cb1422-12"><a href="WE_13.html#cb1422-12" aria-hidden="true" tabindex="-1"></a>sites<span class="sc">$</span>global.flow[idx] <span class="ot">&lt;-</span> node.p</span>
<span id="cb1422-13"><a href="WE_13.html#cb1422-13" aria-hidden="true" tabindex="-1"></a>sites<span class="sc">$</span>global.var[idx] <span class="ot">&lt;-</span> node.var</span></code></pre></div>
<p>Define the map and store it in object <code>Map</code>.</p>
<div class="sourceCode" id="cb1423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1423-1"><a href="WE_13.html#cb1423-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;blue&quot;</span>)), <span class="at">bias=</span><span class="fl">0.15</span>)</span>
<span id="cb1423-2"><a href="WE_13.html#cb1423-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1423-3"><a href="WE_13.html#cb1423-3" aria-hidden="true" tabindex="-1"></a>Map <span class="ot">&lt;-</span> </span>
<span id="cb1423-4"><a href="WE_13.html#cb1423-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(dist.graph) <span class="sc">+</span></span>
<span id="cb1423-5"><a href="WE_13.html#cb1423-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="st">&quot;global.flow&quot;</span>, <span class="at">palette=</span><span class="fu">pal</span>(<span class="dv">10</span>), <span class="at">title.col=</span><span class="st">&quot;Edges: global.flow&quot;</span>) <span class="sc">+</span></span>
<span id="cb1423-6"><a href="WE_13.html#cb1423-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(sites) <span class="sc">+</span></span>
<span id="cb1423-7"><a href="WE_13.html#cb1423-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_symbols</span>(<span class="at">col =</span> <span class="st">&quot;global.flow&quot;</span>, <span class="at">size =</span> <span class="st">&quot;global.var&quot;</span>, </span>
<span id="cb1423-8"><a href="WE_13.html#cb1423-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">20</span>, <span class="at">scale =</span> <span class="fl">0.75</span>, <span class="at">palette=</span><span class="fu">pal</span>(<span class="dv">10</span>), </span>
<span id="cb1423-9"><a href="WE_13.html#cb1423-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">title.col=</span><span class="st">&quot;Nodes: global.flow&quot;</span>, <span class="at">title.size=</span><span class="st">&quot;Nodes: global.var&quot;</span>) </span></code></pre></div>
<p>Plot static map: here we tell R to plot the legend outside of the map.</p>
<div class="sourceCode" id="cb1424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1424-1"><a href="WE_13.html#cb1424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="fu">c</span>(<span class="st">&quot;plot&quot;</span>, <span class="st">&quot;view&quot;</span>)[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## tmap mode set to plotting</code></pre>
<div class="sourceCode" id="cb1426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1426-1"><a href="WE_13.html#cb1426-1" aria-hidden="true" tabindex="-1"></a>Map <span class="sc">+</span> <span class="fu">tm_layout</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>, <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>))</span></code></pre></div>
<pre><code>## Legend labels were too wide. Therefore, legend.text.size has been set to 0.49. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
<p><img src="13-Week13_files/figure-html/static-1.png" width="672" /></p>
<p>Plot interactive map: this may not render e.g. in Bookdown or when you knit your notebook to output formats other than <code>.html</code>.</p>
<div class="sourceCode" id="cb1428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1428-1"><a href="WE_13.html#cb1428-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tmap_mode(c(&quot;plot&quot;, &quot;view&quot;)[2])</span></span>
<span id="cb1428-2"><a href="WE_13.html#cb1428-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Map </span></span></code></pre></div>

</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="Week13.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Week14.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
