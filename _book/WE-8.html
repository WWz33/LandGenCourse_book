<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Worked Example | Landscape Genetic Data Analysis with R</title>
  <meta name="description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Worked Example | Landscape Genetic Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  <meta name="github-repo" content="hhwagner1/LandGenCourse_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Worked Example | Landscape Genetic Data Analysis with R" />
  
  <meta name="twitter:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  

<meta name="author" content="Editor: Helene Wagner (University of Toronto)" />


<meta name="date" content="2021-05-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tutorial-8.html"/>
<link rel="next" href="r-exercise-week-8.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Report About Something</a></li>

<li class="divider"></li>
<li class="part"><span><b>Getting Started</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i>How to use this Book</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#book-structure"><i class="fa fa-check"></i>1. Book Structure</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#a-getting-started"><i class="fa fa-check"></i>a) Getting Started</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#b-basic-topics"><i class="fa fa-check"></i>b) Basic Topics</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#c-advanced-topics"><i class="fa fa-check"></i>c) Advanced Topics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#find-what-is-relevant-for-you"><i class="fa fa-check"></i>2. Find what is relevant for you</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#a-how-to-use-the-labs"><i class="fa fa-check"></i>a) How to use the labs</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#b-check-contents"><i class="fa fa-check"></i>b) Check contents</a></li>
</ul></li>
<li><a href="how-to-use-this-book.html#course-r-package-landgencourse">3. Course R package <code>LandGenCourse</code></a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#a-how-to-install-or-update"><i class="fa fa-check"></i>a) How to install (or update)</a></li>
<li><a href="how-to-use-this-book.html#b-how-to-use-the-r-package-landgencourse">b) How to use the R package <code>LandGenCourse</code></a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#c-video-instructions-for-beginners"><i class="fa fa-check"></i>c) Video instructions for beginners</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="list-of-packages-by-vignette.html"><a href="list-of-packages-by-vignette.html"><i class="fa fa-check"></i>List of Packages by Vignette</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="review-of-r-skills.html"><a href="review-of-r-skills.html"><i class="fa fa-check"></i>Review of R Skills</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html"><i class="fa fa-check"></i>Basic R Programming</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#overview"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#data-types"><i class="fa fa-check"></i>2. Data Types</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#numeric-data-types"><i class="fa fa-check"></i>2.1. Numeric Data Types</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#characters"><i class="fa fa-check"></i>2.2. Characters</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#factors"><i class="fa fa-check"></i>2.3. Factors</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#logical-types"><i class="fa fa-check"></i>2.4. Logical Types</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#data-containers"><i class="fa fa-check"></i>3. Data Containers</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#vectors"><i class="fa fa-check"></i>3.1. Vectors</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#matrices"><i class="fa fa-check"></i>3.2. Matrices</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#lists"><i class="fa fa-check"></i>3.3. Lists</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#data-frames"><i class="fa fa-check"></i>3.4. Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#programming"><i class="fa fa-check"></i>4. Programming</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#function-writing"><i class="fa fa-check"></i>4.1. Function Writing</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#variable-scope"><i class="fa fa-check"></i>4.2. Variable Scope</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#decision-making"><i class="fa fa-check"></i>4.3. Decision Making</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#flow-control"><i class="fa fa-check"></i>4.4. Flow Control</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html"><i class="fa fa-check"></i>R Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#overview-1"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#univariate-plots"><i class="fa fa-check"></i>2. Univariate plots</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#barplots-and-histograms"><i class="fa fa-check"></i>2.1. Barplots and histograms</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#plotting-parameters"><i class="fa fa-check"></i>2.2. Plotting Parameters</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#density-plots"><i class="fa fa-check"></i>2.3. Density Plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#bivariate-plots"><i class="fa fa-check"></i>3. Bivariate plots</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#overlaying-plots-by-grouping"><i class="fa fa-check"></i>3.1. Overlaying Plots by grouping</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#boxplots"><i class="fa fa-check"></i>3.2. Boxplots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#scatter-plots"><i class="fa fa-check"></i>3.3. Scatter Plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#advanced-plotting"><i class="fa fa-check"></i>4. Advanced plotting</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#multiple-plots"><i class="fa fa-check"></i>4.1. Multiple Plots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#color-palettes"><i class="fa fa-check"></i>4.2. Color Palettes</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#rcolorbrewer"><i class="fa fa-check"></i>4.3. RColorBrewer</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#saving-imagery"><i class="fa fa-check"></i>4.4. Saving Imagery</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#interactive-graphics"><i class="fa fa-check"></i>4.5. Interactive Graphics</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="further-r-resources.html"><a href="further-r-resources.html"><i class="fa fa-check"></i>Further R Resources</a></li>
<li class="part"><span><b>Basic Topics</b></span></li>
<li class="chapter" data-level="" data-path="Week1.html"><a href="Week1.html"><i class="fa fa-check"></i>Week 1: Importing Genetic Data</a>
<ul>
<li class="chapter" data-level="" data-path="video-1.html"><a href="video-1.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-1.html"><a href="video-1.html#preview-slides"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html"><i class="fa fa-check"></i>Interactive Tutorial 1</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#list-of-r-commands-used"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#instructions"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#a-how-to-access-tutorials"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#b-how-to-complete-tutorial"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#c-how-to-submit-answers-participating-institutions-only"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#overview-of-worked-example"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-goals"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-data-set"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-required-r-libraries"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#import-data-from-.csv-file"><i class="fa fa-check"></i>2. Import data from .csv file</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-preparation"><i class="fa fa-check"></i>a. Preparation</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-excel-file"><i class="fa fa-check"></i>b. Excel file</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-import-with-function-read.csv"><i class="fa fa-check"></i>c. Import with function ‘read.csv’</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#d.-create-id-variable"><i class="fa fa-check"></i>d. Create ID variable</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#e.-export-with-function-write.csv"><i class="fa fa-check"></i>e. Export with function ‘write.csv’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#create-genind-object"><i class="fa fa-check"></i>3. Create ‘genind’ Object</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-read-the-helpfile"><i class="fa fa-check"></i>a. Read the helpfile</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-set-all-arguments-of-function-df2genind"><i class="fa fa-check"></i>b. Set all arguments of function ‘df2genind’</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-check-imported-data"><i class="fa fa-check"></i>c. Check imported data</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#d.-summarize-genind-object"><i class="fa fa-check"></i>d. Summarize ‘genind’ object</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#view-information-stored-in-genind-object"><i class="fa fa-check"></i>4. View information stored in ‘genind’ object</a>
<ul>
<li><a href="WE-1.html#a.-slot-tab">a. Slot <code>@tab</code></a></li>
<li><a href="WE-1.html#b.-slot-loc.n.all">b. Slot <code>@loc.n.all</code></a></li>
<li><a href="WE-1.html#c.-slot-loc.fac">c. Slot <code>@loc.fac</code></a></li>
<li><a href="WE-1.html#d.-slot-all.names">d. Slot <code>@all.names</code></a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#e.-further-slots"><i class="fa fa-check"></i>e. Further slots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#import-data-with-gstudio-package"><i class="fa fa-check"></i>5. Import data with ‘gstudio’ package</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-function-read_population"><i class="fa fa-check"></i>a. Function ‘read_population’</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-set-arguments"><i class="fa fa-check"></i>b. Set arguments</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-check-imported-data-1"><i class="fa fa-check"></i>c. Check imported data</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#d.-add-frogid"><i class="fa fa-check"></i>d. Add FrogID</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#e.-convert-to-genind-object"><i class="fa fa-check"></i>e. Convert to ‘genind’ object</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-1.html"><a href="r-exercise-week-1.html"><i class="fa fa-check"></i>R exercise Week 1</a></li>
<li class="chapter" data-level="" data-path="bonus-1a.html"><a href="bonus-1a.html"><i class="fa fa-check"></i>Bonus: Importing SNP data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week2.html"><a href="Week2.html"><i class="fa fa-check"></i>Week 2: Spatial Data</a>
<ul>
<li class="chapter" data-level="" data-path="video-2.html"><a href="video-2.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-2.html"><a href="video-2.html#preview-slides-1"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html"><i class="fa fa-check"></i>Interactive Tutorial 2</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#list-of-r-commands-used-1"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#instructions-1"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#a-how-to-access-tutorials-1"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#b-how-to-complete-tutorial-1"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#c-how-to-submit-answers-participating-institutions-only-1"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#overview-of-worked-example-1"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-goals-1"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-data-set-1"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-required-r-libraries-1"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#import-site-data-from-.csv-file"><i class="fa fa-check"></i>2. Import site data from .csv file</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-import-data-into-spatialpointsdataframe"><i class="fa fa-check"></i>a. Import data into SpatialPointsDataFrame</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-add-spatial-reference-data"><i class="fa fa-check"></i>b. Add spatial reference data</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-change-projection"><i class="fa fa-check"></i>c. Change projection</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#d.-access-data-in-spatialpointsdataframe"><i class="fa fa-check"></i>d. Access data in ‘SpatialPointsDataFrame’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#display-raster-data-and-overlay-sampling-locations-extract-data"><i class="fa fa-check"></i>3. Display raster data and overlay sampling locations, extract data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-display-raster-data"><i class="fa fa-check"></i>a. Display raster data</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-change-color-ramp-add-sampling-locations"><i class="fa fa-check"></i>b. Change color ramp, add sampling locations</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-extract-raster-values-at-sampling-locations"><i class="fa fa-check"></i>c. Extract raster values at sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#calculate-landscape-metrics"><i class="fa fa-check"></i>4. Calculate landscape metrics</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-calculate-patch--class--and-landscape-level-landscape-metrics"><i class="fa fa-check"></i>a. Calculate patch-, class- and landscape level landscape metrics</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-calculate-patch-level-landscape-metrics-for-evergreen-forest"><i class="fa fa-check"></i>b. Calculate patch-level landscape metrics for ‘Evergreen Forest’</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-extract-forest-patch-size-at-samplig-locations"><i class="fa fa-check"></i>c. Extract forest patch size at samplig locations</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#d.-plot-a-bubble-map-of-forest-patch-size-at-sampling-locations"><i class="fa fa-check"></i>d. Plot a bubble map of forest patch size at sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#sample-landscape-metrics-within-buffer-around-sampling-locations"><i class="fa fa-check"></i>5. Sample landscape metrics within buffer around sampling locations</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-extract-landscape-metric-of-choice-for-a-single-cover-type-as-vector"><i class="fa fa-check"></i>b. Extract landscape metric of choice for a single cover type (as vector)</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-extract-landscape-metric-of-choice-for-all-cover-types-as-data-frame."><i class="fa fa-check"></i>c. Extract landscape metric of choice for all cover types (as data frame).</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#d.-extract-all-landscape-metrics-for-a-single-cover-type-as-data-frame"><i class="fa fa-check"></i>d. Extract all landscape metrics for a single cover type (as data frame)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-2.html"><a href="r-exercise-week-2.html"><i class="fa fa-check"></i>R Exercise Week 2</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html"><i class="fa fa-check"></i>Bonus: Using package sf</a></li>
<li class="chapter" data-level="" data-path="bonus-2b.html"><a href="bonus-2b.html"><i class="fa fa-check"></i>Bonus: Visualize LULC map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week3.html"><a href="Week3.html"><i class="fa fa-check"></i>Week 3: Genetic Diversity</a>
<ul>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html#video-part-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html#video-part-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html#preview-slides-2"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html"><i class="fa fa-check"></i>Interactive Tutorial 3</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#list-of-r-commands-used-2"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#instructions-2"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#a-how-to-access-tutorials-2"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#b-how-to-complete-tutorial-2"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#c-how-to-submit-answers-participating-institutions-only-2"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#overview-of-worked-example-2"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#a.-goals-2"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#b.-data-set-2"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#c.-required-r-libraries-2"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#basic-checking-of-markers-and-populations"><i class="fa fa-check"></i>2. Basic checking of markers and populations</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#a.-re-create-genind-object"><i class="fa fa-check"></i>a. Re-create genind object</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#b.-check-that-markers-are-polymorphic"><i class="fa fa-check"></i>b. Check that markers are polymorphic</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#c.-check-for-deviations-from-hardy-weinberg-equilibrium-hwe"><i class="fa fa-check"></i>c. Check for deviations from Hardy-Weinberg equilibrium (HWE)</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#d.-check-for-linkage-disequilibrium-ld"><i class="fa fa-check"></i>d. Check for linkage disequilibrium (LD)</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#e.-check-for-null-alleles"><i class="fa fa-check"></i>e. Check for null alleles</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#f.-overall-interpretation"><i class="fa fa-check"></i>f. Overall interpretation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#assess-genetic-diversity"><i class="fa fa-check"></i>3. Assess genetic diversity</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#a.-rarefied-allelic-richness"><i class="fa fa-check"></i>a. Rarefied allelic richness</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#b.-observed-and-expected-heterozygosity"><i class="fa fa-check"></i>b. Observed and expected heterozygosity</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#c.-create-table-with-sitel-level-genetic-diversity-measures"><i class="fa fa-check"></i>c. Create table with sitel-level genetic diversity measures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#aggregate-genetic-data-at-population-level-allele-frequencies"><i class="fa fa-check"></i>4. Aggregate genetic data at population level (allele frequencies)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-3.html"><a href="r-exercise-week-3.html"><i class="fa fa-check"></i>R Exercise Week 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week4.html"><a href="Week4.html"><i class="fa fa-check"></i>Week 4: Metapopulations</a>
<ul>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html#video-part-1-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html#video-part-2-1"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html#preview-slides-3"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html"><i class="fa fa-check"></i>Interactive Tutorial 4</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#list-of-r-commands-used-3"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#instructions-3"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#a-how-to-access-tutorials-3"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#b-how-to-complete-tutorial-3"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#c-how-to-submit-answers-participating-institutions-only-3"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#overview-of-worked-example-3"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-goals-3"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-data-set-3"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#reference"><i class="fa fa-check"></i>Reference:</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#c.-required-r-libraries-3"><i class="fa fa-check"></i>c. Required R libraries</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#d.-import-data"><i class="fa fa-check"></i>d. Import data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#spatial-distribution-of-genetic-structure"><i class="fa fa-check"></i>2. Spatial distribution of genetic structure</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-creating-a-genind-object-with-the-hierarchical-data-set"><i class="fa fa-check"></i>a. Creating a ‘genind’ object with the hierarchical data set</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-hierarchical-amova"><i class="fa fa-check"></i>b. Hierarchical AMOVA</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#what-determines-genetic-differentiation-among-sites"><i class="fa fa-check"></i>3. What determines genetic differentiation among sites?</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-correlation-matrix"><i class="fa fa-check"></i>a. Correlation matrix</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-scatterplots"><i class="fa fa-check"></i>b. Scatterplots</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#c.-regression-model"><i class="fa fa-check"></i>c. Regression model</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#d.-which-populations-dont-fit-the-general-pattern"><i class="fa fa-check"></i>d. Which populations don’t fit the general pattern?</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#e.-regression-model-without-outliers"><i class="fa fa-check"></i>e. Regression model without outliers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#what-determines-genetic-diversity"><i class="fa fa-check"></i>4. What determines genetic diversity?</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-correlation-matrix-1"><i class="fa fa-check"></i>a. Correlation matrix</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-regression-models"><i class="fa fa-check"></i>b. Regression models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#are-genetic-differentiation-and-diversity-related"><i class="fa fa-check"></i>5. Are genetic differentiation and diversity related?</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#effect-of-recent-extinction-events"><i class="fa fa-check"></i>6. Effect of recent extinction events</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-effect-of-patch-extinction-event-temporal-data-set"><i class="fa fa-check"></i>a. Effect of patch extinction event (temporal data set)</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-power-analysis"><i class="fa fa-check"></i>b. Power analysis</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#c.-sample-size-calculation"><i class="fa fa-check"></i>c. Sample size calculation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-4.html"><a href="r-exercise-week-4.html"><i class="fa fa-check"></i>R Exercise Week 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week5.html"><a href="Week5.html"><i class="fa fa-check"></i>Week 5: Spatial Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="video-5.html"><a href="video-5.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-5.html"><a href="video-5.html#preview-slides-4"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html"><i class="fa fa-check"></i>Interactive Tutorial 5</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#list-of-r-commands-used-4"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#instructions-4"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#a-how-to-access-tutorials-4"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#b-how-to-complete-tutorial-4"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#c-how-to-submit-answers-participating-institutions-only-4"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#overview-of-worked-example-4"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-goals-4"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-data-set-4"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-required-r-packages"><i class="fa fa-check"></i>c. Required R packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#data-import-and-manipulation"><i class="fa fa-check"></i>2. Data import and manipulation</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-create-an-ecogen-object"><i class="fa fa-check"></i>a. Create an ecogen object</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-aggregate-to-ecopop"><i class="fa fa-check"></i>b. Aggregate to ecopop</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-add-site-level-data"><i class="fa fa-check"></i>b. Add site-level data</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-export-to-adegenet-and-gstudio"><i class="fa fa-check"></i>c. Export to adegenet and gstudio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#calculate-genetic-distances"><i class="fa fa-check"></i>3. Calculate genetic distances</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-genetic-distances-calculated-from-genind-object"><i class="fa fa-check"></i>a. Genetic distances calculated from genind object</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-more-distance-matrices-with-gstudio"><i class="fa fa-check"></i>b. More distance matrices with ‘gstudio’</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-assemble-distance-matrices"><i class="fa fa-check"></i>c. Assemble distance matrices</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#d.-export-genetic-distance-matrices"><i class="fa fa-check"></i>d. Export genetic distance matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#perform-a-mantel-test-to-test-for-ibd"><i class="fa fa-check"></i>4. Perform a Mantel test to test for IBD</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-visually-check-linearity"><i class="fa fa-check"></i>a. Visually check linearity</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-perform-mantel-test"><i class="fa fa-check"></i>b. Perform Mantel test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#create-mantel-correlogram-for-genetic-data"><i class="fa fa-check"></i>5. Create Mantel correlogram for genetic data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-create-a-first-mantel-correlogram"><i class="fa fa-check"></i>a. Create a first Mantel correlogram</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-vary-distance-class-definition"><i class="fa fa-check"></i>b. Vary distance class definition</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-alternative-measures-of-genetic-distances"><i class="fa fa-check"></i>c. Alternative measures of genetic distances</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#specify-spatial-weights-and-calculate-morans-i"><i class="fa fa-check"></i>6. Specify spatial weights and calculate Moran’s I</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-defining-spatial-neighbors"><i class="fa fa-check"></i>a. Defining spatial neighbors</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-defining-spatial-weights"><i class="fa fa-check"></i>b. Defining spatial weights</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-calculating-and-testing-morans-i"><i class="fa fa-check"></i>c. Calculating and testing Moran’s I</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-5.html"><a href="r-exercise-week-5.html"><i class="fa fa-check"></i>R Exercise Week 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week6.html"><a href="Week6.html"><i class="fa fa-check"></i>Week 6: Quantitative Genetics</a>
<ul>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html#video-part-1-2"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html#video-part-2-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html#preview-slides-5"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html"><i class="fa fa-check"></i>Interactive Tutorial 6</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#list-of-r-commands-used-5"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#instructions-5"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#a-how-to-access-tutorials-5"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#b-how-to-complete-tutorial-5"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#c-how-to-submit-answers-participating-institutions-only-5"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#overview-of-worked-example-5"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-goals-5"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-data-set-5"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#c.-required-r-packages-1"><i class="fa fa-check"></i>c. Required R packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment"><i class="fa fa-check"></i>2. Estimate genetic and non-genetic variance components from a common garden experiment</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-import-phenytypic-data"><i class="fa fa-check"></i>a. Import phenytypic data</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-fit-linear-mixed-effects-models-lmm-to-trait-data-observed-on-families"><i class="fa fa-check"></i>b. Fit linear mixed effects models (LMM) to trait data observed on families</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#c.-compare-model-fit"><i class="fa fa-check"></i>c. Compare model fit</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#d.-check-model-validity"><i class="fa fa-check"></i>d. Check model validity</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#e.-estimate-variance-components"><i class="fa fa-check"></i>e. Estimate variance components</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#f.-significance-testing"><i class="fa fa-check"></i>f. Significance testing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#estimate-trait-heritability"><i class="fa fa-check"></i>3. Estimate trait heritability</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-estimate-heritability"><i class="fa fa-check"></i>a. Estimate heritability</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-estimate-trait-differentiation"><i class="fa fa-check"></i>b. Estimate trait differentiation</a></li>
</ul></li>
<li><a href="WE-6.html#compare-q_st-to-f_st-measured-from-snp-data">4. Compare <span class="math inline">\(Q_{st}\)</span> to <span class="math inline">\(F_{st}\)</span> measured from SNP data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-import-ecogen-object"><i class="fa fa-check"></i>a. Import ‘ecogen’ object</a></li>
<li><a href="WE-6.html#b.-compare-q_st-to-f_st">b. Compare <span class="math inline">\(Q_{ST}\)</span> to <span class="math inline">\(F_{ST}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#assess-correlation-between-trait-and-environment"><i class="fa fa-check"></i>5. Assess correlation between trait and environment</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-describe-and-extract-effects"><i class="fa fa-check"></i>a. Describe and extract effects</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-correlation-of-population-effect-with-environment"><i class="fa fa-check"></i>b. Correlation of population effect with environment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-6.html"><a href="r-exercise-week-6.html"><i class="fa fa-check"></i>R Exercise Week 6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week7.html"><a href="Week7.html"><i class="fa fa-check"></i>Week 7: Spatial Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html#video-part-1-3"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html#video-part-2-3"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html#preview-slides-6"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html"><i class="fa fa-check"></i>Interactive Tutorial 7</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#list-of-r-commands-used-6"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#instructions-6"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#a-how-to-access-tutorials-6"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#b-how-to-complete-tutorial-6"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#c-how-to-submit-answers-participating-institutions-only-6"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#overview-of-worked-example-6"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-goals-6"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-data-set-6"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#c.-required-r-packages-2"><i class="fa fa-check"></i>c. Required R packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment-1"><i class="fa fa-check"></i>2. Estimate genetic and non-genetic variance components from a common garden experiment</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-import-phenytypic-data-1"><i class="fa fa-check"></i>a. Import phenytypic data</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-fit-linear-mixed-effects-models-lmm-to-trait-data-observed-on-families-1"><i class="fa fa-check"></i>b. Fit linear mixed effects models (LMM) to trait data observed on families</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#c.-compare-model-fit-1"><i class="fa fa-check"></i>c. Compare model fit</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#d.-check-model-validity-1"><i class="fa fa-check"></i>d. Check model validity</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#e.-estimate-variance-components-1"><i class="fa fa-check"></i>e. Estimate variance components</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#f.-significance-testing-1"><i class="fa fa-check"></i>f. Significance testing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#estimate-trait-heritability-1"><i class="fa fa-check"></i>3. Estimate trait heritability</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-estimate-heritability-1"><i class="fa fa-check"></i>a. Estimate heritability</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-estimate-trait-differentiation-1"><i class="fa fa-check"></i>b. Estimate trait differentiation</a></li>
</ul></li>
<li><a href="WE-7.html#compare-q_st-to-f_st-measured-from-snp-data-1">4. Compare <span class="math inline">\(Q_{st}\)</span> to <span class="math inline">\(F_{st}\)</span> measured from SNP data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-import-ecogen-object-1"><i class="fa fa-check"></i>a. Import ‘ecogen’ object</a></li>
<li><a href="WE-7.html#b.-compare-q_st-to-f_st-1">b. Compare <span class="math inline">\(Q_{ST}\)</span> to <span class="math inline">\(F_{ST}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#assess-correlation-between-trait-and-environment-1"><i class="fa fa-check"></i>5. Assess correlation between trait and environment</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-describe-and-extract-effects-1"><i class="fa fa-check"></i>a. Describe and extract effects</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-correlation-of-population-effect-with-environment-1"><i class="fa fa-check"></i>b. Correlation of population effect with environment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-6-1.html"><a href="r-exercise-week-6-1.html"><i class="fa fa-check"></i>R Exercise Week 6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week8.html"><a href="Week8.html"><i class="fa fa-check"></i>Week 8: Simulation Experiments</a>
<ul>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html#video-part-1-4"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html#video-part-2-4"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html#preview-slides-7"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html"><i class="fa fa-check"></i>Interactive Tutorial 8</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#list-of-r-commands-used-7"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#instructions-7"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#a-how-to-access-tutorials-7"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#b-how-to-complete-tutorial-7"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#c-how-to-submit-answers-participating-institutions-only-7"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#overview-of-worked-example-7"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-goals-7"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-data-set-7"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-required-r-libraries-4"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#initialize-a-landscape"><i class="fa fa-check"></i>2. Initialize a landscape</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-create-a-random-landscape"><i class="fa fa-check"></i>a. Create a random landscape</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-add-populations-to-the-landscape-using-minimal-distance"><i class="fa fa-check"></i>b. Add populations to the landscape (using minimal distance)</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-initialise-a-metapopulation"><i class="fa fa-check"></i>c. Initialise a metapopulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#define-simulation-parameters"><i class="fa fa-check"></i>3. Define simulation parameters</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-define-your-metapopulation"><i class="fa fa-check"></i>a. Define your metapopulation</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-initialise-your-population-on-the-landscape"><i class="fa fa-check"></i>b. Initialise your population on the landscape</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#run-simulations-and-analyze-results"><i class="fa fa-check"></i>4. Run simulations and analyze results</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-run-your-simulation-over-multiple-time-steps-years"><i class="fa fa-check"></i>a. Run your simulation over multiple time steps (years)</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-analyse-your-simulated-population-with-a-partial-mantel-test"><i class="fa fa-check"></i>b. Analyse your simulated population with a partial Mantel test</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-optional-analyze-your-simulated-populations-using-sunder"><i class="fa fa-check"></i>c. Optional: Analyze your simulated populations using ‘Sunder’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#run-simulator-using-a-previously-defined-parameter-set"><i class="fa fa-check"></i>5. Run simulator using a previously defined parameter set</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-specify-and-record-the-parameter-combinations"><i class="fa fa-check"></i>a. Specify and record the parameter combinations</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-run-the-simulator-over-every-parameter-combination."><i class="fa fa-check"></i>b. Run the simulator over every parameter combination.</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-save-your-complete-simulation-run-input-and-output"><i class="fa fa-check"></i>c. Save your complete simulation run (input and output)</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#d.-analyze-and-synthesize-results"><i class="fa fa-check"></i>d. Analyze and synthesize results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-8.html"><a href="r-exercise-week-8.html"><i class="fa fa-check"></i>R Exercise Week 8</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html"><i class="fa fa-check"></i>Bonus: Efficient R</a></li>
</ul></li>
<li class="part"><span><b>Advanced Topics</b></span></li>
<li class="chapter" data-level="" data-path="Week9.html"><a href="Week9.html"><i class="fa fa-check"></i>Week 9: Population Structure</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#overview-of-worked-example-8"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#a.-goals-8"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#b.-data-sets"><i class="fa fa-check"></i>b. Data sets</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#c.-required-r-libraries-5"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#simulated-data-2-island-model"><i class="fa fa-check"></i>2. Simulated data: 2-island model</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#a.-import-data"><i class="fa fa-check"></i>a. Import data</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#b.-perform-principal-components-analysis-pca"><i class="fa fa-check"></i>b. Perform Principal Components Analysis (PCA)</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#c.-create-synthetic-spatial-coordinates-xy-and-map-them"><i class="fa fa-check"></i>c. Create synthetic spatial coordinates (X,Y) and map them</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#simulated-data-2-island-model-with-admixture"><i class="fa fa-check"></i>3. Simulated data: 2-island model with admixture</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#empirical-data-threespine-sticklebacks"><i class="fa fa-check"></i>4. Empirical data: Threespine sticklebacks</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#a.-import-the-data"><i class="fa fa-check"></i>a. Import the data:</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#b.-examine-population-structure-with-pca"><i class="fa fa-check"></i>b. Examine population structure with PCA</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#c.-clustering-with-snmf-similar-to-structure"><i class="fa fa-check"></i>c. Clustering with SNMF (similar to ‘STRUCTURE’)</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#d.-plot-ancestry-proportions"><i class="fa fa-check"></i>d. Plot ancestry proportions</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#e.-visualize-admixture-proportions-on-a-map"><i class="fa fa-check"></i>e. Visualize admixture proportions on a map</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week10.html"><a href="Week10.html"><i class="fa fa-check"></i>Week 10: Landscape Resistance</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#overview-of-worked-example-9"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-goals-9"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-data-set-8"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-required-r-libraries-6"><i class="fa fa-check"></i>c. Required R libraries</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#d.-import-rasters-gsp-err-cti-and-ffp."><i class="fa fa-check"></i>d. Import rasters (gsp, err, cti, and ffp).</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#e.-import-site-data-with-sampling-locations"><i class="fa fa-check"></i>e. Import site data with sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#explore-the-data-set"><i class="fa fa-check"></i>2. Explore the data set</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-plot-all-rasters"><i class="fa fa-check"></i>a. Plot all rasters</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-plot-spatial-points-over-ffp-raster"><i class="fa fa-check"></i>b. Plot spatial points over ffp raster</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#setting-cost-values-and-calculating-conductance"><i class="fa fa-check"></i>3. Setting cost values and calculating conductance</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-resistance-vs.-conductance-values"><i class="fa fa-check"></i>a. Resistance vs. conductance values</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-as-needed-get-all-rasters-at-the-same-scale"><i class="fa fa-check"></i>b. As needed: Get all rasters at the same scale</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-calculate-conductance-values"><i class="fa fa-check"></i>c. Calculate conductance values</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#d.-create-a-single-landscape-conductance-raster"><i class="fa fa-check"></i>d. Create a single landscape conductance raster</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#convert-conductance-into-effective-distance"><i class="fa fa-check"></i>4. Convert conductance into effective distance</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-create-a-transition-layer"><i class="fa fa-check"></i>a. Create a transition layer</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-visually-inspect-the-raster"><i class="fa fa-check"></i>b. Visually inspect the raster</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-correct-for-geometric-distortion"><i class="fa fa-check"></i>c. Correct for geometric distortion</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#d.-plot-shortest-paths-in-space"><i class="fa fa-check"></i>d. Plot shortest paths in space</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#create-cost-distance-matrices"><i class="fa fa-check"></i>5. Create cost-distance matrices</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-least-cost-distance"><i class="fa fa-check"></i>a. Least cost distance</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-cost-distance-matrix-based-on-random-paths-similar-to-circuitscape"><i class="fa fa-check"></i>b. Cost-distance matrix based on random paths (similar to Circuitscape)</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-compare-cost-distances"><i class="fa fa-check"></i>c. Compare cost distances</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#how-does-changing-resolution-affect-these-metrics"><i class="fa fa-check"></i>6. How does changing resolution affect these metrics?</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-create-loop"><i class="fa fa-check"></i>a. Create loop</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-plot-the-results"><i class="fa fa-check"></i>b. Plot the results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#references"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week11.html"><a href="Week11.html"><i class="fa fa-check"></i>Week 11: Detecting Adaptation</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#overview-of-worked-example-10"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-goals-10"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-data-set-9"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#c.-required-r-libraries-7"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#import-and-prepare-the-data"><i class="fa fa-check"></i>2. Import and prepare the data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-import-the-genetic-data"><i class="fa fa-check"></i>a. Import the genetic data</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-import-the-environmental-data"><i class="fa fa-check"></i>b. Import the environmental data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#latent-factor-mixed-models-lfmm-a-univariate-gea"><i class="fa fa-check"></i>3. Latent Factor Mixed Models (LFMM): a univariate GEA</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-determine-k"><i class="fa fa-check"></i>a. Determine K</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-run-lfmm"><i class="fa fa-check"></i>b. Run LFMM</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#c.-identify-lfmm-candidates-using-false-discovery-rate"><i class="fa fa-check"></i>c. Identify LFMM candidates using False Discovery Rate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#redundancy-analysis-rda-a-multivariate-gea"><i class="fa fa-check"></i>4. Redundancy Analysis (RDA): a multivariate GEA</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-run-rda"><i class="fa fa-check"></i>a. Run RDA</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-identify-rda-candidates"><i class="fa fa-check"></i>b. Identify RDA candidates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#compare-lfmm-and-rda-candidates"><i class="fa fa-check"></i>5. Compare LFMM and RDA candidates</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a-quick-note-on-controlling-for-population-structure-in-rda"><i class="fa fa-check"></i>6. A quick note on controlling for population structure in RDA</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#references-1"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week12.html"><a href="Week12.html"><i class="fa fa-check"></i>Week 12: Model Selection</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#overview-of-worked-example-11"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#a.-goals-and-background"><i class="fa fa-check"></i>a. Goals and Background</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#b.-data-set-10"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#c.-required-packages"><i class="fa fa-check"></i>c. Required packages</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#d.-import-data-1"><i class="fa fa-check"></i>d. Import data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#fitting-candidate-models"><i class="fa fa-check"></i>2. Fitting candidate models</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#a.-alternative-hypotheses"><i class="fa fa-check"></i>a. Alternative hypotheses</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#b.-prepare-for-model-fitting"><i class="fa fa-check"></i>b. Prepare for model fitting</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#c.-fit-all-five-models"><i class="fa fa-check"></i>c. Fit all five models</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#d.-compare-evidence-for-models"><i class="fa fa-check"></i>d. Compare evidence for models</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#e.-calculate-evidence-weights"><i class="fa fa-check"></i>e. Calculate evidence weights</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#f.-confidence-intervals-for-predictors"><i class="fa fa-check"></i>f. Confidence intervals for predictors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#your-turn-to-test-additional-hypotheses"><i class="fa fa-check"></i>3. Your turn to test additional hypotheses!</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#references-2"><i class="fa fa-check"></i>4. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week13.html"><a href="Week13.html"><i class="fa fa-check"></i>Week 13: Gravity Models</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#overview-of-worked-example-12"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-background"><i class="fa fa-check"></i>a. Background</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-data-set-11"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-required-r-libraries-8"><i class="fa fa-check"></i>c. Required R libraries</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#set-working-and-data-directories---needs-to-be-removed"><i class="fa fa-check"></i>Set working and data directories - NEEDS TO BE REMOVED</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#calculating-graph-metrics"><i class="fa fa-check"></i>2. Calculating graph metrics</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-read-in-make-a-spatial-object-and-plot-wetlands-wetlands.csv."><i class="fa fa-check"></i>a. Read in, make a spatial object and plot wetlands (Wetlands.csv).</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-create-a-graph-from-the-wetlands"><i class="fa fa-check"></i>b. Create a graph from the wetlands</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-create-adjacency-matrix"><i class="fa fa-check"></i>c. Create adjacency matrix</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#d.-calculate-graph-metrics"><i class="fa fa-check"></i>d. Calculate graph metrics</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#e.-add-graph-metrics-to-data.frame"><i class="fa fa-check"></i>e. Add graph metrics to data.frame</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#combine-frog-data-with-graph-metrics"><i class="fa fa-check"></i>3. Combine frog data with graph metrics</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-add-graph-node-data-to-frog-site-data"><i class="fa fa-check"></i>a. Add graph node data to frog site data</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-check-data-types"><i class="fa fa-check"></i>b. Check data types</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#merge-graph-with-genetic-distance-data"><i class="fa fa-check"></i>4. Merge graph with genetic distance data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-build-graph-from-occupied-sites"><i class="fa fa-check"></i>a. Build graph from occupied sites</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-merge-graph-with-genetic-distance"><i class="fa fa-check"></i>b. Merge graph with genetic distance</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-write-out-results-ascii-csv-and-lines-shapefile."><i class="fa fa-check"></i>c. Write out results (ASCII csv and lines shapefile).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#preparing-raster-based-covariates"><i class="fa fa-check"></i>5. Preparing raster-based covariates</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-import-raster-data-as-stack"><i class="fa fa-check"></i>a. Import raster data as stack</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-calculate-wetland-area-within-buffer"><i class="fa fa-check"></i>b. Calculate wetland area within buffer</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-create-raster-of-wetland-proportion"><i class="fa fa-check"></i>c. Create raster of wetland proportion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#extract-raster-stats-for-nodes-and-edges"><i class="fa fa-check"></i>6. Extract raster stats for nodes and edges</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-extract-at-site-variables-from-rasters"><i class="fa fa-check"></i>a. Extract at-site variables from rasters</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-add-covariates-to-graph-edges."><i class="fa fa-check"></i>b. Add covariates to graph edges.</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-calculating-stats-along-edges"><i class="fa fa-check"></i>c. Calculating stats along edges</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#d.-calculating-stats-for-categorical-variables"><i class="fa fa-check"></i>d. Calculating stats for categorical variables</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#e.-add-node-data-to-graph"><i class="fa fa-check"></i>e. Add node data to graph</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#gravity-models"><i class="fa fa-check"></i>7. Gravity Models</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-merge-distance-and-site-data"><i class="fa fa-check"></i>a. Merge distance and site data</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-define-a-set-of-models"><i class="fa fa-check"></i>b. Define a set of models</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-check-for-correlations"><i class="fa fa-check"></i>c. Check for correlations</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-write-out-resultss"><i class="fa fa-check"></i>c. Write out resultss</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#e.-compare-models"><i class="fa fa-check"></i>e. Compare models</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#f.-diagnostic-plots"><i class="fa fa-check"></i>f. Diagnostic plots</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#g.-fit-final-models"><i class="fa fa-check"></i>g. Fit final model(s)</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#h.-effect-size"><i class="fa fa-check"></i>h. Effect size</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week14.html"><a href="Week14.html"><i class="fa fa-check"></i>Week 14: Contemporary Gene Flow</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#overview-2"><i class="fa fa-check"></i>1. Overview</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-background-and-goals"><i class="fa fa-check"></i>a. Background and Goals</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-data-set-12"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#c.-required-packages-1"><i class="fa fa-check"></i>c. Required packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#import-genotypes"><i class="fa fa-check"></i>2. Import Genotypes</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-import-genotype-data"><i class="fa fa-check"></i>a. Import genotype data</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-plot-map-of-sampling-locations"><i class="fa fa-check"></i>b. Plot map of sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#pollen-pool-genetic-structure"><i class="fa fa-check"></i>3. Pollen pool genetic structure</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-subtract-maternal-contribution-to-offspring-genotype"><i class="fa fa-check"></i>a. Subtract maternal contribution to offspring genotype</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-twogener-analysis-amova-of-pollen-pool-data"><i class="fa fa-check"></i>b. ‘TwoGener’ analysis (AMOVA of pollen pool data)</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#c.-including-space-isolation-by-distance"><i class="fa fa-check"></i>c. Including space: Isolation by distance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#paternity-analysis"><i class="fa fa-check"></i>4. Paternity analysis</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-exclusion-probabilities"><i class="fa fa-check"></i>a. Exclusion probabilities</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-paternity-analysis"><i class="fa fa-check"></i>b. Paternity analysis</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#c.-visualize-reconstructed-pollen-flow-events-in-space"><i class="fa fa-check"></i>c. Visualize reconstructed pollen flow events in space</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#d.-visualize-dispersal-kernel"><i class="fa fa-check"></i>d. Visualize dispersal kernel</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#linking-paternity-to-ecological-variables"><i class="fa fa-check"></i>5. Linking paternity to ecological variables</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-explain-pollen-flow-within-populations"><i class="fa fa-check"></i>a. Explain pollen flow within populations</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-explain-pollen-flow-at-the-population-level"><i class="fa fa-check"></i>b. Explain pollen flow at the population level</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#references-3"><i class="fa fa-check"></i>6. References</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Landscape Genetic Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="WE_8" class="section level2">
<h2>Worked Example</h2>
<div id="overview-of-worked-example-7" class="section level3">
<h3>1. Overview of Worked Example</h3>
<div id="a.-goals-7" class="section level4">
<h4>a. Goals</h4>
<p>This worked example shows:</p>
<ul>
<li>Simulate a metapopulation on a resistance landscape</li>
<li>Evaluate the power of a partial Mantel test</li>
<li>Compare partial Mantel test to ‘Sunder’</li>
<li>Run many simulations and synthesize results</li>
</ul>
</div>
<div id="b.-data-set-7" class="section level4">
<h4>b. Data set</h4>
<p>We will simulate data using the ‘landgenreport’ function of the package ‘PopGenReport.’ See: www.popgenreport.org</p>
</div>
<div id="c.-required-r-libraries-4" class="section level4">
<h4>c. Required R libraries</h4>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="WE-8.html#cb774-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LandGenCourse)</span>
<span id="cb774-2"><a href="WE-8.html#cb774-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PopGenReport )   <span class="co">#load the package</span></span>
<span id="cb774-3"><a href="WE-8.html#cb774-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(secr)            <span class="co">#to create a random habitat</span></span>
<span id="cb774-4"><a href="WE-8.html#cb774-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(gdistance)</span></span>
<span id="cb774-5"><a href="WE-8.html#cb774-5" aria-hidden="true" tabindex="-1"></a><span class="co">#library(mmod)</span></span>
<span id="cb774-6"><a href="WE-8.html#cb774-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb774-7"><a href="WE-8.html#cb774-7" aria-hidden="true" tabindex="-1"></a><span class="co">#library(tibble)</span></span>
<span id="cb774-8"><a href="WE-8.html#cb774-8" aria-hidden="true" tabindex="-1"></a><span class="co">#library(here)</span></span>
<span id="cb774-9"><a href="WE-8.html#cb774-9" aria-hidden="true" tabindex="-1"></a><span class="co">#library(ggplot2)</span></span>
<span id="cb774-10"><a href="WE-8.html#cb774-10" aria-hidden="true" tabindex="-1"></a><span class="co">#library(Sunder)   # requires mnormt</span></span></code></pre></div>
<p>Package ‘secr’ not automatically installed with ‘LandGenCourse’:</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="WE-8.html#cb775-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(secr)) <span class="fu">install.packages</span>(<span class="st">&quot;secr&quot;</span>, <span class="at">repos=</span><span class="st">&#39;http://cran.us.r-project.org&#39;</span>)</span>
<span id="cb775-2"><a href="WE-8.html#cb775-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(secr)</span></span></code></pre></div>
<p>The following ‘setup chunk’ is used to set the root address of file paths to the root of the project folder.</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="WE-8.html#cb776-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">root.dir =</span> <span class="fu">normalizePath</span>(<span class="st">&quot;..&quot;</span>)) </span></code></pre></div>
</div>
</div>
<div id="initialize-a-landscape" class="section level3">
<h3>2. Initialize a landscape</h3>
<div id="a.-create-a-random-landscape" class="section level4">
<h4>a. Create a random landscape</h4>
<p>We will use the ‘randomHabitat’ function from the ‘secr’ package to create a random habitat map and assign resistance values to habitat and non-habitat. There are many alternative ways to define your map, e.g. simply load a png file or any other file format using the ‘raster’ function from package ‘raster’ (?raster::raster, see the examples in there). If your map is categorical, assign resistance values to the different values in the raster as shown below for the missing values. If your map is already a resistance surface, skip this step.</p>
<p>Here we use the function ‘set.seed’ at the beginning of the simulation to make sure we get the same sequence of random numbers everytime we run this code. This makes the exact results reproducible even though we use a random process.</p>
<p>The function ‘make.grid’ here creates a landscape of nx=50 times xy=50 gridpoints spaced 1 unit (meter) apart. This is returned as a data frame ‘tempgrid’ with two columns that represent ‘x’ and ‘y’ grid coordinates.</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="WE-8.html#cb777-1" aria-hidden="true" tabindex="-1"></a>nx<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb777-2"><a href="WE-8.html#cb777-2" aria-hidden="true" tabindex="-1"></a>ny<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb777-3"><a href="WE-8.html#cb777-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">555</span>) <span class="co">#(to make sure we have the same example running)</span></span>
<span id="cb777-4"><a href="WE-8.html#cb777-4" aria-hidden="true" tabindex="-1"></a><span class="co">#tempmask&lt;-secr::make.mask(nx=nx,ny=ny,spacing=1)</span></span>
<span id="cb777-5"><a href="WE-8.html#cb777-5" aria-hidden="true" tabindex="-1"></a>tempgrid<span class="ot">&lt;-</span>secr<span class="sc">::</span><span class="fu">make.grid</span>(<span class="at">nx=</span>nx,<span class="at">ny=</span>ny,<span class="at">spacing=</span><span class="dv">1</span>)</span></code></pre></div>
<p>In the function ‘randomHabitat,’ the argument ‘A’ specifies the expected proportion of habitat, and ‘p’ controls the level of fragmentation, i.e., degree of spatial aggregation (sorry this is naming may be a bit confusing, but that’s what it says in the help file: ?randomHabitat). The function simulates a map with these parameters and returns a data frame with only those points from ‘tempgrid’ that are habitat. It expects an input object of class ‘mask’ (an object type specific to the ‘secr’ package), hence we pass ‘as.mask(tempgrid).’</p>
<p>The function ‘raster’ of the ‘secr’ package (NOT from the ‘raster’ package) converts the data frame into a raster object. This object has one numeric variable that is 1 for habitat cells and missing for all other cells, we verify this with ‘table.’</p>
<p>Note: there may be a warning about non-missing arguments, you can ignore it.</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="WE-8.html#cb778-1" aria-hidden="true" tabindex="-1"></a><span class="co">#r &lt;- raster(secr::randomHabitat(secr::as.mask(tempgrid), p = 0.5, A = 0.5))</span></span>
<span id="cb778-2"><a href="WE-8.html#cb778-2" aria-hidden="true" tabindex="-1"></a><span class="co">#table(values(r), exclude=&quot;&quot;)</span></span></code></pre></div>
<p>NOTE: April 2021: This does not seem to work anymore. Workaround:</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="WE-8.html#cb779-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> secr<span class="sc">::</span><span class="fu">randomHabitat</span>(secr<span class="sc">::</span><span class="fu">as.mask</span>(tempgrid), <span class="at">p =</span> <span class="fl">0.5</span>, <span class="at">A =</span> <span class="fl">0.5</span>)</span>
<span id="cb779-2"><a href="WE-8.html#cb779-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tempgrid) </span>
<span id="cb779-3"><a href="WE-8.html#cb779-3" aria-hidden="true" tabindex="-1"></a>r<span class="sc">$</span>resistance <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb779-4"><a href="WE-8.html#cb779-4" aria-hidden="true" tabindex="-1"></a>r<span class="sc">$</span>resistance[<span class="fu">as.numeric</span>(<span class="fu">row.names</span>(tmp))] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb779-5"><a href="WE-8.html#cb779-5" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rasterFromXYZ</span>(r)</span></code></pre></div>
<p>Now we set all missing values (i.e., non-habitat) to 10 and verify this again with ‘table.’</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="WE-8.html#cb780-1" aria-hidden="true" tabindex="-1"></a><span class="co">#values(r)[is.na(values(r))==T]&lt;-10</span></span>
<span id="cb780-2"><a href="WE-8.html#cb780-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">values</span>(r), <span class="at">exclude=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
##    1   10 
## 1308 1192</code></pre>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="WE-8.html#cb782-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb782-2"><a href="WE-8.html#cb782-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r)</span></code></pre></div>
<p><img src="08-Week08_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>We have thus created a numeric raster with a resistance surface where habitat cells (grey) have a resistance value of 1 and non-habitat cells (green) have a resistance value of 10.</p>
</div>
<div id="b.-add-populations-to-the-landscape-using-minimal-distance" class="section level4">
<h4>b. Add populations to the landscape (using minimal distance)</h4>
<p>We create a function that allows us to set up ‘n’ subpopulations in the habitat only (grid cells with value = 1). The subpopulations should be at least ‘minDist’ units apart, given any resistance surface ‘landscape.’ We also include an option to plot a raster map with the sampled locations of the populations.</p>
<p>We define a few variables within the function that help keep track. Note that we keep track of the cells by their raster cell number (which goes from 1:ncells). Here’s what the code does:</p>
<ul>
<li>Extract all cells that are habitat and store cell number in <strong>HabitatCells</strong>.</li>
<li>Randomly sample one habitat cell and store its cell number in <strong>Selected</strong>.</li>
<li>Store cell numbers of all remaining habitat cells in <strong>Remaining</strong>.</li>
<li>Create a ‘while’ loop that continues until one of two things happens:
<ul>
<li>Sample size ‘n’ is reached.</li>
<li>There are no cells left in Remaining.</li>
</ul></li>
<li>Inside the loop:
<ul>
<li>Randomly sample one habitat cell and store its number in <strong>Candidate</strong>.</li>
<li>Remove the Candidate from Remaining (we don’t want to consider it twice).</li>
<li>Calculate the <strong>Distance</strong> between Candidate and all populations in Selected. The function ‘xyFromCell’ gets the cell coordinates for each cell number, and the function ‘pointDistance’ calculates the distance between two sets of coordinates, here the coordinates for Candidate and for all cells in Selected. The argument ‘lonlat=FALSE’ tells ‘pointDistance’ that the coordinates are Euclidean.</li>
<li>If the minimum of Distance is larger than ‘minDist,’ add a population. This is done by appending the value in Candidate to the vector Selected.</li>
<li>Repeat.</li>
</ul></li>
<li>If requested, the raster map is plotted, cell coordinates for all populations (Selected) are extracted and added to the map as points with point symbol pch=16 (filled circle).</li>
</ul>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="WE-8.html#cb783-1" aria-hidden="true" tabindex="-1"></a>createpops <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">minDist=</span><span class="dv">5</span>, <span class="at">landscape=</span>r, <span class="at">habitat=</span><span class="dv">1</span>, <span class="at">plot=</span><span class="cn">TRUE</span>)</span>
<span id="cb783-2"><a href="WE-8.html#cb783-2" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb783-3"><a href="WE-8.html#cb783-3" aria-hidden="true" tabindex="-1"></a>  HabitatCells <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(landscape))[<span class="fu">values</span>(landscape)<span class="sc">==</span>habitat]</span>
<span id="cb783-4"><a href="WE-8.html#cb783-4" aria-hidden="true" tabindex="-1"></a>  Selected <span class="ot">&lt;-</span> <span class="fu">sample</span>(HabitatCells, <span class="dv">1</span>)</span>
<span id="cb783-5"><a href="WE-8.html#cb783-5" aria-hidden="true" tabindex="-1"></a>  Remaining <span class="ot">&lt;-</span> HabitatCells[<span class="sc">!</span><span class="fu">is.element</span>(HabitatCells, Selected)]</span>
<span id="cb783-6"><a href="WE-8.html#cb783-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(Selected) <span class="sc">&lt;</span> n <span class="sc">&amp;</span> <span class="fu">length</span>(Remaining) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb783-7"><a href="WE-8.html#cb783-7" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb783-8"><a href="WE-8.html#cb783-8" aria-hidden="true" tabindex="-1"></a>    Candidate <span class="ot">&lt;-</span> <span class="fu">sample</span>(Remaining, <span class="dv">1</span>)</span>
<span id="cb783-9"><a href="WE-8.html#cb783-9" aria-hidden="true" tabindex="-1"></a>    Remaining <span class="ot">&lt;-</span> Remaining[<span class="sc">!</span><span class="fu">is.element</span>(Remaining, Candidate)]</span>
<span id="cb783-10"><a href="WE-8.html#cb783-10" aria-hidden="true" tabindex="-1"></a>    Distances <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">pointDistance</span>(raster<span class="sc">::</span><span class="fu">xyFromCell</span>(landscape, Candidate), </span>
<span id="cb783-11"><a href="WE-8.html#cb783-11" aria-hidden="true" tabindex="-1"></a>                               raster<span class="sc">::</span><span class="fu">xyFromCell</span>(landscape, Selected), </span>
<span id="cb783-12"><a href="WE-8.html#cb783-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">lonlat=</span><span class="cn">FALSE</span>)</span>
<span id="cb783-13"><a href="WE-8.html#cb783-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">min</span>(Distances) <span class="sc">&gt;</span> minDist)</span>
<span id="cb783-14"><a href="WE-8.html#cb783-14" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb783-15"><a href="WE-8.html#cb783-15" aria-hidden="true" tabindex="-1"></a>      Selected <span class="ot">&lt;-</span> <span class="fu">append</span>(Selected, Candidate)</span>
<span id="cb783-16"><a href="WE-8.html#cb783-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb783-17"><a href="WE-8.html#cb783-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb783-18"><a href="WE-8.html#cb783-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(plot<span class="sc">==</span><span class="cn">TRUE</span>) </span>
<span id="cb783-19"><a href="WE-8.html#cb783-19" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb783-20"><a href="WE-8.html#cb783-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(landscape)  </span>
<span id="cb783-21"><a href="WE-8.html#cb783-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(<span class="fu">xyFromCell</span>(landscape, Selected), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb783-22"><a href="WE-8.html#cb783-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb783-23"><a href="WE-8.html#cb783-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Selected)</span>
<span id="cb783-24"><a href="WE-8.html#cb783-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Test the function above:</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="WE-8.html#cb784-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb784-2"><a href="WE-8.html#cb784-2" aria-hidden="true" tabindex="-1"></a><span class="fu">createpops</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">minDist =</span> <span class="dv">3</span>, <span class="at">landscape =</span> r, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="08-Week08_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre><code>## [1] 1329  477  396 2498  441  692  602 1190</code></pre>
</div>
<div id="c.-initialise-a-metapopulation" class="section level4">
<h4>c. Initialise a metapopulation</h4>
<p>We use the function ‘init.popgensim’ from package ‘PopGenReport’ to initialise a metapopulation based on the grid cells that we just selected. To do this we need to initialise a number of parameters (the locations of the subpopulations, the number of individuals per subpopulation, the number of loci and alleles per loci. For a full list check ‘?init.popgensim’).</p>
<p>To store all the parameters we create a list called para where we store all of them</p>
</div>
</div>
<div id="define-simulation-parameters" class="section level3">
<h3>3. Define simulation parameters</h3>
<div id="a.-define-your-metapopulation" class="section level4">
<h4>a. Define your metapopulation</h4>
<p>Define metapopulation:</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="WE-8.html#cb786-1" aria-hidden="true" tabindex="-1"></a>para<span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb786-2"><a href="WE-8.html#cb786-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Define populations (dynamics)</span></span>
<span id="cb786-3"><a href="WE-8.html#cb786-3" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>n.pops<span class="ot">=</span><span class="dv">8</span></span>
<span id="cb786-4"><a href="WE-8.html#cb786-4" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>n.ind<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb786-5"><a href="WE-8.html#cb786-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb786-6"><a href="WE-8.html#cb786-6" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>sex.ratio <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb786-7"><a href="WE-8.html#cb786-7" aria-hidden="true" tabindex="-1"></a><span class="co">#age distribution....</span></span>
<span id="cb786-8"><a href="WE-8.html#cb786-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb786-9"><a href="WE-8.html#cb786-9" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>n.cov <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb786-10"><a href="WE-8.html#cb786-10" aria-hidden="true" tabindex="-1"></a><span class="co">#number of covariates (before the loci in the data.frame, do not change this!!)</span></span></code></pre></div>
<p>Define population dynamics:</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="WE-8.html#cb787-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reproduction</span></span>
<span id="cb787-2"><a href="WE-8.html#cb787-2" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>n.offspring <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb787-3"><a href="WE-8.html#cb787-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb787-4"><a href="WE-8.html#cb787-4" aria-hidden="true" tabindex="-1"></a><span class="co">#migration</span></span>
<span id="cb787-5"><a href="WE-8.html#cb787-5" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>mig.rate <span class="ot">&lt;-</span> <span class="fl">0.1</span> </span>
<span id="cb787-6"><a href="WE-8.html#cb787-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb787-7"><a href="WE-8.html#cb787-7" aria-hidden="true" tabindex="-1"></a><span class="co">#dispersal: exponential dispersal with maximal distance in map units</span></span>
<span id="cb787-8"><a href="WE-8.html#cb787-8" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>disp.max<span class="ot">=</span><span class="dv">50</span>   <span class="co">#average  dispersal of an individual in meters</span></span>
<span id="cb787-9"><a href="WE-8.html#cb787-9" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>disp.rate <span class="ot">=</span> <span class="fl">0.05</span> <span class="co">#proportion of dispersing individuals</span></span>
<span id="cb787-10"><a href="WE-8.html#cb787-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb787-11"><a href="WE-8.html#cb787-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Define genetics</span></span>
<span id="cb787-12"><a href="WE-8.html#cb787-12" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>n.allels <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb787-13"><a href="WE-8.html#cb787-13" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>n.loci <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb787-14"><a href="WE-8.html#cb787-14" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>mut.rate <span class="ot">&lt;-</span> <span class="fl">0.001</span></span></code></pre></div>
<p>Define cost distance method:</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="WE-8.html#cb788-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb788-2"><a href="WE-8.html#cb788-2" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>method <span class="ot">&lt;-</span> <span class="st">&quot;leastcost&quot;</span> <span class="co">#rSPDdistance, commute</span></span>
<span id="cb788-3"><a href="WE-8.html#cb788-3" aria-hidden="true" tabindex="-1"></a>para<span class="sc">$</span>NN <span class="ot">&lt;-</span> <span class="dv">8</span>  <span class="co">#number of neighbours for the cost distance method</span></span>
<span id="cb788-4"><a href="WE-8.html#cb788-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb788-5"><a href="WE-8.html#cb788-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize simulation of populations from scratch</span></span>
<span id="cb788-6"><a href="WE-8.html#cb788-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb788-7"><a href="WE-8.html#cb788-7" aria-hidden="true" tabindex="-1"></a> landscape<span class="ot">&lt;-</span> r  <span class="co">#&lt;-raster(system.file(&quot;external/rlogo.grd&quot;, package=&quot;raster&quot;))</span></span>
<span id="cb788-8"><a href="WE-8.html#cb788-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb788-9"><a href="WE-8.html#cb788-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define x and y locations</span></span>
<span id="cb788-10"><a href="WE-8.html#cb788-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb788-11"><a href="WE-8.html#cb788-11" aria-hidden="true" tabindex="-1"></a> para<span class="sc">$</span>cells <span class="ot">&lt;-</span> <span class="fu">createpops</span>(<span class="at">n=</span>para<span class="sc">$</span>n.pops, <span class="at">minDist =</span> <span class="dv">3</span>, </span>
<span id="cb788-12"><a href="WE-8.html#cb788-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">landscape =</span> landscape, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb788-13"><a href="WE-8.html#cb788-13" aria-hidden="true" tabindex="-1"></a> para<span class="sc">$</span>locs <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">xyFromCell</span>(landscape, para<span class="sc">$</span>cells)</span>
<span id="cb788-14"><a href="WE-8.html#cb788-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb788-15"><a href="WE-8.html#cb788-15" aria-hidden="true" tabindex="-1"></a> <span class="co">#give the population some names </span></span>
<span id="cb788-16"><a href="WE-8.html#cb788-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">rownames</span>(para<span class="sc">$</span>locs) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span>para<span class="sc">$</span>n.pops]</span>
<span id="cb788-17"><a href="WE-8.html#cb788-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb788-18"><a href="WE-8.html#cb788-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb788-19"><a href="WE-8.html#cb788-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a matrix of pairwise cost distances...  </span></span>
<span id="cb788-20"><a href="WE-8.html#cb788-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb788-21"><a href="WE-8.html#cb788-21" aria-hidden="true" tabindex="-1"></a>  cost.mat <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">costdistances</span>(landscape, para<span class="sc">$</span>locs, </span>
<span id="cb788-22"><a href="WE-8.html#cb788-22" aria-hidden="true" tabindex="-1"></a>                                          para<span class="sc">$</span>method, para<span class="sc">$</span>NN)</span>
<span id="cb788-23"><a href="WE-8.html#cb788-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb788-24"><a href="WE-8.html#cb788-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ... and a matrix of pairwise Euclidean distances</span></span>
<span id="cb788-25"><a href="WE-8.html#cb788-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb788-26"><a href="WE-8.html#cb788-26" aria-hidden="true" tabindex="-1"></a>  eucl.mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(para<span class="sc">$</span>locs))  <span class="co">#needed for the analysis later</span></span>
<span id="cb788-27"><a href="WE-8.html#cb788-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb788-28"><a href="WE-8.html#cb788-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot your landscape with the populations....</span></span>
<span id="cb788-29"><a href="WE-8.html#cb788-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(landscape)</span>
<span id="cb788-30"><a href="WE-8.html#cb788-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(para<span class="sc">$</span>locs[,<span class="dv">1</span>], para<span class="sc">$</span>locs[,<span class="dv">2</span>], <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb788-31"><a href="WE-8.html#cb788-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(para<span class="sc">$</span>locs[,<span class="dv">1</span>],para<span class="sc">$</span>locs[,<span class="dv">2</span>], <span class="fu">row.names</span>(para<span class="sc">$</span>locs), <span class="at">cex=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="08-Week08_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="WE-8.html#cb789-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the parameter list</span></span>
<span id="cb789-2"><a href="WE-8.html#cb789-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb789-3"><a href="WE-8.html#cb789-3" aria-hidden="true" tabindex="-1"></a>  para</span></code></pre></div>
<pre><code>## $n.pops
## [1] 8
## 
## $n.ind
## [1] 100
## 
## $sex.ratio
## [1] 0.5
## 
## $n.cov
## [1] 3
## 
## $n.offspring
## [1] 2
## 
## $mig.rate
## [1] 0.1
## 
## $disp.max
## [1] 50
## 
## $disp.rate
## [1] 0.05
## 
## $n.allels
## [1] 10
## 
## $n.loci
## [1] 20
## 
## $mut.rate
## [1] 0.001
## 
## $method
## [1] &quot;leastcost&quot;
## 
## $NN
## [1] 8
## 
## $cells
## [1]  458  894 2359  389 2426  295 1394  680
## 
## $locs
##    x  y
## A  7 40
## B 43 32
## C  8  2
## D 38 42
## E 25  1
## F 44 44
## G 43 22
## H 29 36</code></pre>
</div>
<div id="b.-initialise-your-population-on-the-landscape" class="section level4">
<h4>b. Initialise your population on the landscape</h4>
<p>Now finally we can initialise our population using the init function. We’ll call it ‘simpops.0’ to indicate that this is the initial generation.</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="WE-8.html#cb791-1" aria-hidden="true" tabindex="-1"></a>simpops<span class="fl">.0</span> <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">init.popgensim</span>(para<span class="sc">$</span>n.pops, para<span class="sc">$</span>n.ind, </span>
<span id="cb791-2"><a href="WE-8.html#cb791-2" aria-hidden="true" tabindex="-1"></a>                           para<span class="sc">$</span>sex.ratio, para<span class="sc">$</span>n.loci, </span>
<span id="cb791-3"><a href="WE-8.html#cb791-3" aria-hidden="true" tabindex="-1"></a>                           para<span class="sc">$</span>n.allels, para<span class="sc">$</span>locs, para<span class="sc">$</span>n.cov )  </span></code></pre></div>
<p>You may want to check the simpops object, which is simply a list of our subpopulation and each individual is coded in a single run in one of the subpopulations.</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="WE-8.html#cb792-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(simpops<span class="fl">.0</span>)  <span class="co">#the names of the subpopulations</span></span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot;</code></pre>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="WE-8.html#cb794-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(simpops<span class="fl">.0</span><span class="sc">$</span>A[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]) <span class="do">## a.list of the first 6 individuals and columns of population A</span></span></code></pre></div>
<pre><code>##   pop    sex age locus1A locus1B locus2A
## 1   1 female  NA       6      10       2
## 2   1 female  NA       4       3       6
## 3   1 female  NA       2      10       9
## 4   1 female  NA       7       9       5
## 5   1 female  NA       3       1       9
## 6   1 female  NA       6       7       3</code></pre>
<p>We can also analyse our simpop object. (e.g. calculate the pairwise Fst value between all the populations).</p>
<p>To be able to do that we first need to convert it into a genind object (because many functions need this type of object as input).</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="WE-8.html#cb796-1" aria-hidden="true" tabindex="-1"></a>gsp <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">pops2genind</span>(simpops<span class="fl">.0</span>, <span class="at">locs =</span>para<span class="sc">$</span>locs)</span>
<span id="cb796-2"><a href="WE-8.html#cb796-2" aria-hidden="true" tabindex="-1"></a>gsp <span class="co">#check the genind object</span></span></code></pre></div>
<pre><code>## /// GENIND OBJECT /////////
## 
##  // 800 individuals; 20 loci; 200 alleles; size: 738.5 Kb
## 
##  // Basic content
##    @tab:  800 x 200 matrix of allele counts
##    @loc.n.all: number of alleles per locus (range: 10-10)
##    @loc.fac: locus factor for the 200 columns of @tab
##    @all.names: list of allele names for each locus
##    @ploidy: ploidy of each individual  (range: 2-2)
##    @type:  codom
##    @call: df2genind(X = res, sep = &quot;/&quot;, ind.names = rownames(res), pop = combine$pop)
## 
##  // Optional content
##    @pop: population of each individual (group size range: 100-100)
##    @other: a list containing: xy</code></pre>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="WE-8.html#cb798-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gsp)  <span class="co">#some summary statistics</span></span></code></pre></div>
<pre><code>## 
## // Number of individuals: 800
## // Group sizes: 100 100 100 100 100 100 100 100
## // Number of alleles per locus: 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
## // Number of alleles per group: 200 200 200 200 200 200 200 200
## // Percentage of missing data: 0 %
## // Observed heterozygosity: 0.9 0.89 0.89 0.89 0.9 0.89 0.9 0.92 0.9 0.9 0.91 0.9 0.9 0.88 0.9 0.9 0.91 0.9 0.89 0.88
## // Expected heterozygosity: 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9</code></pre>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="WE-8.html#cb800-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(mmod<span class="sc">::</span><span class="fu">pairwise_Gst_Nei</span>(gsp),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##          A        B        C        D        E        F        G
## B -0.00012                                                      
## C  0.00006  0.00001                                             
## D -0.00019 -0.00060  0.00022                                    
## E  0.00010 -0.00030 -0.00014 -0.00058                           
## F  0.00016 -0.00031  0.00002 -0.00019 -0.00009                  
## G -0.00020 -0.00046  0.00022 -0.00023 -0.00027 -0.00013         
## H -0.00045 -0.00013 -0.00009 -0.00008 -0.00007 -0.00033 -0.00020</code></pre>
<p>Is there an effect of the landscape on the population structure (there should not be after initialisation)?</p>
<p>The function ‘pairwise.fstb’ is around 150 times faster than mmod::pairwise_Gst_Nei, but slightly different.</p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="WE-8.html#cb802-1" aria-hidden="true" tabindex="-1"></a>gen.mat <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">pairwise.fstb</span>(gsp)  </span>
<span id="cb802-2"><a href="WE-8.html#cb802-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(gen.mat ,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##         A       B       C       D       E       F       G       H
## A 0.00000 0.00239 0.00256 0.00231 0.00260 0.00266 0.00231 0.00205
## B 0.00239 0.00000 0.00252 0.00191 0.00220 0.00220 0.00205 0.00238
## C 0.00256 0.00252 0.00000 0.00273 0.00237 0.00253 0.00273 0.00241
## D 0.00231 0.00191 0.00273 0.00000 0.00193 0.00232 0.00228 0.00243
## E 0.00260 0.00220 0.00237 0.00193 0.00000 0.00241 0.00224 0.00244
## F 0.00266 0.00220 0.00253 0.00232 0.00241 0.00000 0.00237 0.00218
## G 0.00231 0.00205 0.00273 0.00228 0.00224 0.00237 0.00000 0.00230
## H 0.00205 0.00238 0.00241 0.00243 0.00244 0.00218 0.00230 0.00000</code></pre>
<p>Now we perform a two partial Mantel tests, one for the effect of the cost distance partialling out the effect of Euclidean distance (Gen ~cost | Euclidean), and one the other way round. The method ‘wassermann’ from the ‘PopGenReport’ package returns a data frame with two rows (one for each test) and three columns (model, r = Mantel r statistic, p = p-value), following this method:</p>
<ul>
<li>Wassermann, T.N., Cushman, S. A., Schwartz, M. K. and Wallin, D. O. (2010). Spatial scaling and multi-model inference in landscape genetics: Martes americana in northern Idaho. Landscape Ecology, 25(10), 1601-1612.</li>
</ul>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="WE-8.html#cb804-1" aria-hidden="true" tabindex="-1"></a>PopGenReport<span class="sc">::</span><span class="fu">wassermann</span>(<span class="at">eucl.mat =</span> eucl.mat, <span class="at">cost.mats =</span> <span class="fu">list</span>(<span class="at">cost=</span>cost.mat), </span>
<span id="cb804-2"><a href="WE-8.html#cb804-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">gen.mat =</span> gen.mat, <span class="at">plot=</span>F)<span class="sc">$</span>mantel.tab</span></code></pre></div>
<pre><code>##                   model      r     p
## 2 Gen ~Euclidean | cost 0.1578 0.248
## 1 Gen ~cost | Euclidean  0.151 0.268</code></pre>
<p>Check the pairwise Fst values, why are they so low? Hints:</p>
<ul>
<li>How were genotypes assigned to the initial generation</li>
<li>How many generations have we simulated thus far?</li>
<li>At this point in the simulation, do you expect to see an effet of IBD, IBR, or neither?</li>
</ul>
</div>
</div>
<div id="run-simulations-and-analyze-results" class="section level3">
<h3>4. Run simulations and analyze results</h3>
<div id="a.-run-your-simulation-over-multiple-time-steps-years" class="section level4">
<h4>a. Run your simulation over multiple time steps (years)</h4>
<p>Now we can run our simulation by simply passing our object ‘simpops’ to the function ‘run.popgensim,’ with some additional parameters that are needed for the simulation. We specify the number of generations the simulation should run with the steps parameter. (Check ?run.popgensim for a description of all parameters).</p>
<p>Important to understand is the idea of the cost.mat (which is the cost matrix that is used for the distance between subpopulation). The n.alleles, n.ind cannot be different from the initialisation.</p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="WE-8.html#cb806-1" aria-hidden="true" tabindex="-1"></a>simpops <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">run.popgensim</span>(simpops<span class="fl">.0</span>, <span class="at">steps=</span><span class="dv">3</span>, cost.mat, </span>
<span id="cb806-2"><a href="WE-8.html#cb806-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">n.offspring=</span>para<span class="sc">$</span>n.offspring, <span class="at">n.ind=</span>para<span class="sc">$</span>n.ind,</span>
<span id="cb806-3"><a href="WE-8.html#cb806-3" aria-hidden="true" tabindex="-1"></a>                         para<span class="sc">$</span>mig.rate, para<span class="sc">$</span>disp.max, para<span class="sc">$</span>disp.rate, </span>
<span id="cb806-4"><a href="WE-8.html#cb806-4" aria-hidden="true" tabindex="-1"></a>                         para<span class="sc">$</span>n.allels, para<span class="sc">$</span>mut.rate,</span>
<span id="cb806-5"><a href="WE-8.html#cb806-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">n.cov=</span>para<span class="sc">$</span>n.cov, <span class="at">rec=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p>In essence we were running a metapopulation with 100 individuals per subpopulation on our resistance landscape for 3 generations. The question is now was that enough time to create an effect on population structure?</p>
</div>
<div id="b.-analyse-your-simulated-population-with-a-partial-mantel-test" class="section level4">
<h4>b. Analyse your simulated population with a partial Mantel test</h4>
<p>Let’s check the pairwise Fst values and then do a landscape genetic analysis using partial Mantel tests.</p>
<p>Convert to genind to calculate pairwise Fst.</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="WE-8.html#cb807-1" aria-hidden="true" tabindex="-1"></a>gsp <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">pops2genind</span>(simpops, para<span class="sc">$</span>locs, para<span class="sc">$</span>n.cov)</span></code></pre></div>
<p>Calculate your genetic distance matrix e.g. fst or D.</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="WE-8.html#cb808-1" aria-hidden="true" tabindex="-1"></a>gen.mat <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">pairwise.fstb</span>(gsp)   </span>
<span id="cb808-2"><a href="WE-8.html#cb808-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(gen.mat ,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##       A     B     C     D     E     F     G     H
## A 0.000 0.008 0.008 0.006 0.008 0.006 0.007 0.008
## B 0.008 0.000 0.008 0.007 0.009 0.007 0.008 0.008
## C 0.008 0.008 0.000 0.008 0.009 0.007 0.008 0.007
## D 0.006 0.007 0.008 0.000 0.008 0.006 0.007 0.007
## E 0.008 0.009 0.009 0.008 0.000 0.009 0.009 0.010
## F 0.006 0.007 0.007 0.006 0.009 0.000 0.007 0.006
## G 0.007 0.008 0.008 0.007 0.009 0.007 0.000 0.007
## H 0.008 0.008 0.007 0.007 0.010 0.006 0.007 0.000</code></pre>
<p>Partial Mantel test:</p>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="WE-8.html#cb810-1" aria-hidden="true" tabindex="-1"></a>PopGenReport<span class="sc">::</span><span class="fu">wassermann</span>(<span class="at">eucl.mat =</span> eucl.mat, <span class="at">cost.mats =</span> <span class="fu">list</span>(<span class="at">cost=</span>cost.mat), </span>
<span id="cb810-2"><a href="WE-8.html#cb810-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">gen.mat =</span> gen.mat, <span class="at">plot=</span>F)<span class="sc">$</span>mantel.tab</span></code></pre></div>
<pre><code>##                   model       r     p
## 1 Gen ~cost | Euclidean  0.5525 0.025
## 2 Gen ~Euclidean | cost -0.3513 0.911</code></pre>
<p>We can extract a specific value from this result, e.g., the p-value of the test “Gen ~cost | Euclidean.” (Note that every time we call the function ‘wassermann,’ a permutation test is performed (default: ‘nperm = 999’), and the p-value may thus vary somewhat).</p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="WE-8.html#cb812-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">wassermann</span>(<span class="at">eucl.mat =</span> eucl.mat, </span>
<span id="cb812-2"><a href="WE-8.html#cb812-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cost.mats =</span> <span class="fu">list</span>(<span class="at">cost=</span>cost.mat), </span>
<span id="cb812-3"><a href="WE-8.html#cb812-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">gen.mat =</span> gen.mat, <span class="at">plot=</span>F)<span class="sc">$</span>mantel.tab</span>
<span id="cb812-4"><a href="WE-8.html#cb812-4" aria-hidden="true" tabindex="-1"></a>res[res<span class="sc">$</span>model <span class="sc">==</span> <span class="st">&quot;Gen ~cost | Euclidean&quot;</span>, <span class="st">&quot;p&quot;</span>]</span></code></pre></div>
<pre><code>## [1] &quot;0.035&quot;</code></pre>
</div>
<div id="c.-optional-analyze-your-simulated-populations-using-sunder" class="section level4">
<h4>c. Optional: Analyze your simulated populations using ‘Sunder’</h4>
<p>See: <a href="http://www.nbi.dk/~botta/Sunder.html#overview" class="uri">http://www.nbi.dk/~botta/Sunder.html#overview</a></p>
<p>Sunder is an alternative (faster) implementation of BEDASSLE, which uses molecular covariance analysis as an alternative to partial Mantel test. All we want from this method for now is the best-model (note that there is no alternative ‘none’):</p>
<ul>
<li><strong>G</strong>: Geographic distance model (IBD)</li>
<li><strong>G</strong>: Ecological distance model (IBR)</li>
<li><strong>G+E</strong>: Both</li>
</ul>
<p>To perform the Sunder analysis, we need to reformat the allele frequencies into a three-dimensional array (site x locus x allele). Here we define a function that takes as argument a ‘genind’ object and reformats it as needed.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="WE-8.html#cb814-1" aria-hidden="true" tabindex="-1"></a>getArray <span class="ot">&lt;-</span> <span class="cf">function</span>(gen)</span>
<span id="cb814-2"><a href="WE-8.html#cb814-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb814-3"><a href="WE-8.html#cb814-3" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(rbind,<span class="fu">lapply</span>(<span class="fu">split</span>(<span class="fu">data.frame</span>(gen<span class="sc">@</span>tab), gen<span class="sc">@</span>pop), </span>
<span id="cb814-4"><a href="WE-8.html#cb814-4" aria-hidden="true" tabindex="-1"></a>                               colSums, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb814-5"><a href="WE-8.html#cb814-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row.names</span>(tmp) <span class="ot">&lt;-</span> <span class="fu">levels</span>(gen<span class="sc">@</span>pop)</span>
<span id="cb814-6"><a href="WE-8.html#cb814-6" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">split</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(tmp)), gen<span class="sc">@</span>loc.fac)</span>
<span id="cb814-7"><a href="WE-8.html#cb814-7" aria-hidden="true" tabindex="-1"></a>  Array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim=</span><span class="fu">c</span>(<span class="fu">ncol</span>(tmp[[<span class="dv">1</span>]]), <span class="fu">length</span>(tmp), <span class="fu">nrow</span>(tmp[[<span class="dv">1</span>]])))</span>
<span id="cb814-8"><a href="WE-8.html#cb814-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(tmp))</span>
<span id="cb814-9"><a href="WE-8.html#cb814-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb814-10"><a href="WE-8.html#cb814-10" aria-hidden="true" tabindex="-1"></a>    Array[,i,] <span class="ot">&lt;-</span> <span class="fu">t</span>(tmp[[i]])</span>
<span id="cb814-11"><a href="WE-8.html#cb814-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb814-12"><a href="WE-8.html#cb814-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Array)</span>
<span id="cb814-13"><a href="WE-8.html#cb814-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Apply the function to the genind object ‘gsp’ with the simulated genotypes:</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="WE-8.html#cb815-1" aria-hidden="true" tabindex="-1"></a>Array <span class="ot">&lt;-</span> <span class="fu">getArray</span>(gsp)</span>
<span id="cb815-2"><a href="WE-8.html#cb815-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Array)</span></code></pre></div>
<pre><code>## [1]  8 20 10</code></pre>
<p>Run the analysis (parameter settings: <a href="http://www.nbi.dk/~botta/Sunder.html#overview" class="uri">http://www.nbi.dk/~botta/Sunder.html#overview</a>)</p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="WE-8.html#cb817-1" aria-hidden="true" tabindex="-1"></a>D.G <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(para<span class="sc">$</span>locs))</span>
<span id="cb817-2"><a href="WE-8.html#cb817-2" aria-hidden="true" tabindex="-1"></a>D.E <span class="ot">&lt;-</span> cost.mat</span>
<span id="cb817-3"><a href="WE-8.html#cb817-3" aria-hidden="true" tabindex="-1"></a>nit <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>   <span class="do">### j.st for the example, should be much larger, e.g. 50000</span></span>
<span id="cb817-4"><a href="WE-8.html#cb817-4" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> Sunder<span class="sc">::</span><span class="fu">MCMCCV</span>(Array,D.G,D.E,</span>
<span id="cb817-5"><a href="WE-8.html#cb817-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nit=</span>nit,<span class="at">thinning=</span><span class="fu">max</span>(nit<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>,<span class="dv">1</span>),</span>
<span id="cb817-6"><a href="WE-8.html#cb817-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">theta.max=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span><span class="sc">*</span><span class="fu">max</span>(D.G),<span class="dv">10</span><span class="sc">*</span><span class="fu">max</span>(D.E),<span class="dv">1</span>,<span class="fl">0.9</span>),</span>
<span id="cb817-7"><a href="WE-8.html#cb817-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">theta.init=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.01</span>),</span>
<span id="cb817-8"><a href="WE-8.html#cb817-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">run=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ud=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb817-9"><a href="WE-8.html#cb817-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n.validation.set=</span><span class="fu">dim</span>(Array)[<span class="dv">1</span>]<span class="sc">*</span><span class="fu">dim</span>(Array)[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb817-10"><a href="WE-8.html#cb817-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">print.pct=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;</code></pre>
<p>Quick answer: the winner (best supporte model) is …</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="WE-8.html#cb819-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">which.max</span>(output<span class="sc">$</span>mod.lik))</span></code></pre></div>
<pre><code>## [1] &quot;G+E&quot;</code></pre>
<p>What did we just do? We extracted the log-likelihood values for the three models ‘G,’ ‘E’ and ‘G+E,’ determined which value was the highest, and extracted the name of the winning model. Let’s verify this by printing the log-likelihood values. The best model has the highest (= least negative) log-likelihood.</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="WE-8.html#cb821-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(output<span class="sc">$</span>mod.lik)</span></code></pre></div>
<pre><code>##       G+E         G         E 
## -8983.219 -8991.129 -9009.385</code></pre>
<p>Let’s combine all of this into our own function to convert the genind object, calculate Sunder and extract the name of the best fitting model</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="WE-8.html#cb823-1" aria-hidden="true" tabindex="-1"></a>getSunder <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">gen=</span>gsp, <span class="at">locs=</span>para<span class="sc">$</span>locs, <span class="at">cost=</span>cost.mat, <span class="at">nit=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb823-2"><a href="WE-8.html#cb823-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb823-3"><a href="WE-8.html#cb823-3" aria-hidden="true" tabindex="-1"></a>  Array <span class="ot">&lt;-</span> <span class="fu">getArray</span>(gen)</span>
<span id="cb823-4"><a href="WE-8.html#cb823-4" aria-hidden="true" tabindex="-1"></a>  D.G <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(locs))</span>
<span id="cb823-5"><a href="WE-8.html#cb823-5" aria-hidden="true" tabindex="-1"></a>  D.E <span class="ot">&lt;-</span> cost</span>
<span id="cb823-6"><a href="WE-8.html#cb823-6" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> Sunder<span class="sc">::</span><span class="fu">MCMCCV</span>(Array,D.G,D.E,</span>
<span id="cb823-7"><a href="WE-8.html#cb823-7" aria-hidden="true" tabindex="-1"></a>                     nit,<span class="at">thinning=</span><span class="fu">max</span>(nit<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>,<span class="dv">1</span>),</span>
<span id="cb823-8"><a href="WE-8.html#cb823-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">theta.max=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span><span class="sc">*</span><span class="fu">max</span>(D.G),<span class="dv">10</span><span class="sc">*</span><span class="fu">max</span>(D.E),<span class="dv">1</span>,<span class="fl">0.9</span>),</span>
<span id="cb823-9"><a href="WE-8.html#cb823-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">theta.init=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.01</span>),</span>
<span id="cb823-10"><a href="WE-8.html#cb823-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">run=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ud=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb823-11"><a href="WE-8.html#cb823-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n.validation.set=</span><span class="fu">dim</span>(Array)[<span class="dv">1</span>]<span class="sc">*</span><span class="fu">dim</span>(Array)[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb823-12"><a href="WE-8.html#cb823-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">print.pct=</span><span class="cn">FALSE</span>)</span>
<span id="cb823-13"><a href="WE-8.html#cb823-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">names</span>(<span class="fu">which.max</span>(output<span class="sc">$</span>mod.lik)))</span>
<span id="cb823-14"><a href="WE-8.html#cb823-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s test it:</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="WE-8.html#cb824-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getSunder</span>()</span></code></pre></div>
<pre><code>## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;</code></pre>
<pre><code>## [1] &quot;G+E&quot;</code></pre>
</div>
</div>
<div id="run-simulator-using-a-previously-defined-parameter-set" class="section level3">
<h3>5. Run simulator using a previously defined parameter set</h3>
<p>Once the simulator works and you are certain that you understand how the simulator needs to be set up for a single run, in almost all studies on simulations you want to be able to re-run the simulator in an automatized way. There are several reasons why you want to do that.</p>
<ol style="list-style-type: decimal">
<li>You want to perform a sensitivity analysis on a single parameter, which means, try to find how much does the output (e.g. pairwise Fst between subpopulations) change when you vary an input parameter (e.g. number of loci).</li>
<li>You want to explore the “complete” parameter space, which means, instead of changing values of a single input parameter you want to change all parameters (within certain levels) and run their combinations.</li>
<li>Another reason is that you want to create a simulated test data set that forms the backbone of your future studies.</li>
</ol>
<p>So we would like to do the following.</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Specify and record all the parameter combinations that you would like to run.<br />
</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Run the simulator with every combination</li>
</ol></li>
<li><ol start="3" style="list-style-type: lower-alpha">
<li>[Optional] save your complete simulation run (recommended, but sometimes prohibitive due to needed resources) or only a calculated summary.</li>
</ol></li>
<li><ol start="4" style="list-style-type: lower-alpha">
<li>Read in your simulations, analyse them and synthesize your results via additional statistics, tests, plots.</li>
</ol></li>
<li><ol start="5" style="list-style-type: lower-alpha">
<li>Publish an enormously important paper….</li>
</ol></li>
</ul>
<p>Admittedly there are several different approaches and as it seems every modeller has a slightly different way to achieve these steps. One approach is to create a parameter file that records all the parameter setting for each run. Another approach is to create so called scripts for every single run. The advantage here is that scripts can be easily distributed across different cores and machines and therefore this approach is easy to parallelise your runs, which sometimes is necessary. Finally the approach I will present here (also because of practical reasons) is to create an R data.frame that stores all the parameter settings and we run all combinations in serial mode instead of in parallel.</p>
<p>Okay before we start we need to think about what kind of parameters we want to explore. I would like to do the following runs:</p>
<ul>
<li>Run our simulations as above (same parameter settings) for varying time steps (say between 5 to 45 years in steps of 20). We’ll keep the number of levels and the maximum number of steps low in this example to limit computation time. Feel free to expand!</li>
<li>As output I would still like to record the Fst value, but also the full genetic data set and the parameters used to run the simulation.</li>
<li>In addition I want to repeat each run 5 times (most often you would do more repetitions) to check how much general variation there is between runs with exactly the same parameter combination.</li>
</ul>
<div id="a.-specify-and-record-the-parameter-combinations" class="section level4">
<h4>a. Specify and record the parameter combinations</h4>
<p>Let’s define the varying numbers of time steps we would like to run the simulations. Here we define a sequence from 5 to 45 in steps of 20, which results in a series c(5, 25, 45). We will interpret these values as numeric, therefore we don’t convert to ‘factor.’</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="WE-8.html#cb827-1" aria-hidden="true" tabindex="-1"></a>timesteps <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">5</span> , <span class="at">to=</span><span class="dv">45</span>, <span class="at">by=</span><span class="dv">20</span>)</span></code></pre></div>
<p>We also specify the number of repeats (replicate simulation runs). We want to do five replicate simulation runs per for each level of ‘time,’ and we will label replicates from 1 through 5. These are essentially labels and we’ll save them as a factor:</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="WE-8.html#cb828-1" aria-hidden="true" tabindex="-1"></a>repeats <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<p>Now we would like to have a data frame that stores all possible combinations for those two parameters. As simple way to do that in R, is to use the ‘expand.grid’ function.</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="WE-8.html#cb829-1" aria-hidden="true" tabindex="-1"></a>para.space <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">rep=</span>repeats, <span class="at">time=</span>timesteps)</span>
<span id="cb829-2"><a href="WE-8.html#cb829-2" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">as_tibble</span>(para.space)</span></code></pre></div>
<pre><code>## # A tibble: 15 x 2
##    rep    time
##    &lt;fct&gt; &lt;dbl&gt;
##  1 1         5
##  2 2         5
##  3 3         5
##  4 4         5
##  5 5         5
##  6 1        25
##  7 2        25
##  8 3        25
##  9 4        25
## 10 5        25
## 11 1        45
## 12 2        45
## 13 3        45
## 14 4        45
## 15 5        45</code></pre>
<p>As you can see this results in 15 combinations (3 time steps x 5 repeats). The beauty of this approach is that it is very flexible and adaptable to runs over other parameter combinations, as you can provide more than two parameter variables to ‘expand.grid.’</p>
</div>
<div id="b.-run-the-simulator-over-every-parameter-combination." class="section level4">
<h4>b. Run the simulator over every parameter combination.</h4>
<p>Remember our parameters are all defined in the ‘para’ object (a list) and we want to keep them constant, except for running the simulation for different number of years. This means that we only need to modify the argument ‘steps.’</p>
<p>Summarizing the code from above, a single run of our simulator runs via:</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="WE-8.html#cb831-1" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize</span></span>
<span id="cb831-2"><a href="WE-8.html#cb831-2" aria-hidden="true" tabindex="-1"></a>simpops<span class="fl">.0</span> <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">init.popgensim</span>(para<span class="sc">$</span>n.pops, para<span class="sc">$</span>n.ind,</span>
<span id="cb831-3"><a href="WE-8.html#cb831-3" aria-hidden="true" tabindex="-1"></a>                           para<span class="sc">$</span>sex.ratio, para<span class="sc">$</span>n.loci, </span>
<span id="cb831-4"><a href="WE-8.html#cb831-4" aria-hidden="true" tabindex="-1"></a>                           para<span class="sc">$</span>n.allels, para<span class="sc">$</span>locs, para<span class="sc">$</span>n.cov )  </span>
<span id="cb831-5"><a href="WE-8.html#cb831-5" aria-hidden="true" tabindex="-1"></a><span class="co">#run for 20 generations</span></span>
<span id="cb831-6"><a href="WE-8.html#cb831-6" aria-hidden="true" tabindex="-1"></a>simpops <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">run.popgensim</span>(simpops<span class="fl">.0</span>, <span class="at">steps=</span><span class="dv">20</span>, cost.mat, </span>
<span id="cb831-7"><a href="WE-8.html#cb831-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">n.offspring=</span>para<span class="sc">$</span>n.offspring, <span class="at">n.ind=</span>para<span class="sc">$</span>n.ind,</span>
<span id="cb831-8"><a href="WE-8.html#cb831-8" aria-hidden="true" tabindex="-1"></a>                         para<span class="sc">$</span>mig.rate, para<span class="sc">$</span>disp.max, para<span class="sc">$</span>disp.rate, </span>
<span id="cb831-9"><a href="WE-8.html#cb831-9" aria-hidden="true" tabindex="-1"></a>                         para<span class="sc">$</span>n.allels, para<span class="sc">$</span>mut.rate,</span>
<span id="cb831-10"><a href="WE-8.html#cb831-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">n.cov=</span>para<span class="sc">$</span>n.cov, <span class="at">rec=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p>We adapt this code as follows:</p>
<ul>
<li>Create a ‘for’ loop that cycles through every row ‘i’ in ‘para.space’</li>
<li>For each value of ‘i’:
<ul>
<li>Initialize population ‘simpops.0.’</li>
<li>Run the simulation with argument ‘steps = para.space$time[i].’</li>
</ul></li>
</ul>
<p>We are not running the code just yet, hence it is commented-out with ‘#.’</p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="WE-8.html#cb832-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:nrow(para.space))</span></span>
<span id="cb832-2"><a href="WE-8.html#cb832-2" aria-hidden="true" tabindex="-1"></a><span class="co">#{</span></span>
<span id="cb832-3"><a href="WE-8.html#cb832-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  #initialize</span></span>
<span id="cb832-4"><a href="WE-8.html#cb832-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  simpops.0 &lt;- PopGenReport::init.popgensim(para$n.pops, para$n.ind, </span></span>
<span id="cb832-5"><a href="WE-8.html#cb832-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                           para$sex.ratio, para$n.loci, para$n.allels, </span></span>
<span id="cb832-6"><a href="WE-8.html#cb832-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                           para$locs, para$n.cov )</span></span>
<span id="cb832-7"><a href="WE-8.html#cb832-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb832-8"><a href="WE-8.html#cb832-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  #run for para.space$time[i] generations</span></span>
<span id="cb832-9"><a href="WE-8.html#cb832-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  simpops &lt;- PopGenReport::run.popgensim(simpops.0, </span></span>
<span id="cb832-10"><a href="WE-8.html#cb832-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                           steps=para.space$time[i], cost.mat,</span></span>
<span id="cb832-11"><a href="WE-8.html#cb832-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                           n.offspring=para$n.offspring, n.ind=para$n.ind,</span></span>
<span id="cb832-12"><a href="WE-8.html#cb832-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                           para$mig.rate, para$disp.max, para$disp.rate, </span></span>
<span id="cb832-13"><a href="WE-8.html#cb832-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                           para$n.allels, para$mut.rate,</span></span>
<span id="cb832-14"><a href="WE-8.html#cb832-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                           n.cov=para$n.cov, rec=&quot;none&quot;)</span></span>
<span id="cb832-15"><a href="WE-8.html#cb832-15" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span></code></pre></div>
<p>Have a close look at the change.</p>
<p>Question: what changes between replicate runs, and what not? Consider the following aspects:</p>
<ul>
<li>Landscape</li>
<li>Population locations</li>
<li>Pairwise distances (cost, Euclidean)</li>
<li>Initial populations with initial genotypes</li>
<li>Migration and gene flow</li>
</ul>
</div>
<div id="c.-save-your-complete-simulation-run-input-and-output" class="section level4">
<h4>c. Save your complete simulation run (input and output)</h4>
<p>Simply running the simulation 15 times (number of rows in ‘para.space’) by itself is not useful yet. We need to store the simulation runs somehow, so we can collect them afterwards to calculate summary statistics and analyse the runs.</p>
<p>How do we store the repeats seperately in a file? One approach would be to have a different file name for every repeat, but in my view, a cleaner approach is to store all simulation outputs and also store the complete parameter and input information in a file, so everything that is need is in one place. A nice way to do that in R is to create a ‘list’ object that stores all in a single object, which can be saved (and is automatically packed) and re-loaded as an R object. This is convenient as long as I only want to analyze the results in R, not export to other software.</p>
<p>Here we do the following:</p>
<ul>
<li>Create a timer with the function ‘proc.time’ so that we know roughly how long the computations take.</li>
<li>For each line ‘i’ in ‘para.space’:
<ul>
<li>Initialize simpops.0.</li>
<li>Run the simulation with ‘steps=para.space$time[i].’</li>
<li>Convert the resulting ‘simpop’ to a genind object ‘gi’ (smaller to store)</li>
<li>Create a list ‘sim’ of all simulation parameters we want to store.</li>
<li>Save the object ‘sim’ as an ‘RData’ file with a unique file name in the folder ‘output/simout’ in the project directory.</li>
<li>Print a message after each run to report progress and computation time.</li>
<li>Flush the output console to make sure it is current (only relevant for console-based versions of R).</li>
</ul></li>
</ul>
<p>The list ‘sim’ will contain the following elements. Note: the name is repeated (e.g., ‘gi = gi’) to create a named list, i.e., to specify the names of the list elements.</p>
<ul>
<li><strong>para.space</strong>: the row ‘para.space[i]’ with settings of the simulation run.</li>
<li><strong>para</strong>: a copy of the list ‘para’ that contains the other parameters that are the same for all simulation runs.</li>
<li><strong>landscape</strong>: the landscape.</li>
<li><strong>cost.mat</strong>: the matrix of pairwise cost distances</li>
<li><strong>gi</strong>: the genind object that contains the genotypes at the end of the simulation.</li>
</ul>
<p>First we make sure the folder <code>simout</code> exists within the <code>output</code> folder in the R project:</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="WE-8.html#cb833-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(),<span class="st">&quot;/output&quot;</span>))) </span>
<span id="cb833-2"><a href="WE-8.html#cb833-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(),<span class="st">&quot;/output&quot;</span>))</span>
<span id="cb833-3"><a href="WE-8.html#cb833-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(),<span class="st">&quot;/output/simout&quot;</span>)))</span>
<span id="cb833-4"><a href="WE-8.html#cb833-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(),<span class="st">&quot;/output/simout&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="WE-8.html#cb834-1" aria-hidden="true" tabindex="-1"></a><span class="do">## c.eate a timer (just to know how long it will take roughly)</span></span>
<span id="cb834-2"><a href="WE-8.html#cb834-2" aria-hidden="true" tabindex="-1"></a>timer0 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">proc.time</span>()[<span class="dv">3</span>],<span class="dv">2</span>)</span>
<span id="cb834-3"><a href="WE-8.html#cb834-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb834-4"><a href="WE-8.html#cb834-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(para.space))</span>
<span id="cb834-5"><a href="WE-8.html#cb834-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb834-6"><a href="WE-8.html#cb834-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## i.itialize</span></span>
<span id="cb834-7"><a href="WE-8.html#cb834-7" aria-hidden="true" tabindex="-1"></a>  simpops<span class="fl">.0</span> <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">init.popgensim</span>(para<span class="sc">$</span>n.pops, para<span class="sc">$</span>n.ind, </span>
<span id="cb834-8"><a href="WE-8.html#cb834-8" aria-hidden="true" tabindex="-1"></a>                           para<span class="sc">$</span>sex.ratio, para<span class="sc">$</span>n.loci, para<span class="sc">$</span>n.allels, </span>
<span id="cb834-9"><a href="WE-8.html#cb834-9" aria-hidden="true" tabindex="-1"></a>                           para<span class="sc">$</span>locs, para<span class="sc">$</span>n.cov )  </span>
<span id="cb834-10"><a href="WE-8.html#cb834-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb834-11"><a href="WE-8.html#cb834-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run for para.space$time[i] generations</span></span>
<span id="cb834-12"><a href="WE-8.html#cb834-12" aria-hidden="true" tabindex="-1"></a>  simpops <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">run.popgensim</span>(simpops<span class="fl">.0</span>, </span>
<span id="cb834-13"><a href="WE-8.html#cb834-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">steps=</span>para.space<span class="sc">$</span>time[i], cost.mat, </span>
<span id="cb834-14"><a href="WE-8.html#cb834-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">n.offspring=</span>para<span class="sc">$</span>n.offspring, <span class="at">n.ind=</span>para<span class="sc">$</span>n.ind,</span>
<span id="cb834-15"><a href="WE-8.html#cb834-15" aria-hidden="true" tabindex="-1"></a>                           para<span class="sc">$</span>mig.rate, para<span class="sc">$</span>disp.max, para<span class="sc">$</span>disp.rate, </span>
<span id="cb834-16"><a href="WE-8.html#cb834-16" aria-hidden="true" tabindex="-1"></a>                           para<span class="sc">$</span>n.allels, para<span class="sc">$</span>mut.rate,</span>
<span id="cb834-17"><a href="WE-8.html#cb834-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">n.cov=</span>para<span class="sc">$</span>n.cov, <span class="at">rec=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb834-18"><a href="WE-8.html#cb834-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb834-19"><a href="WE-8.html#cb834-19" aria-hidden="true" tabindex="-1"></a>  <span class="do">## c.nvert to genind object (smaller)</span></span>
<span id="cb834-20"><a href="WE-8.html#cb834-20" aria-hidden="true" tabindex="-1"></a>  gi <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">pops2genind</span>(simpops)</span>
<span id="cb834-21"><a href="WE-8.html#cb834-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb834-22"><a href="WE-8.html#cb834-22" aria-hidden="true" tabindex="-1"></a>  <span class="do">## c.eate a list of all I want to collect</span></span>
<span id="cb834-23"><a href="WE-8.html#cb834-23" aria-hidden="true" tabindex="-1"></a>  sim <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">para.space=</span>para.space[i,], <span class="at">para=</span>para, </span>
<span id="cb834-24"><a href="WE-8.html#cb834-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">landscape=</span>landscape, <span class="at">cost.mat=</span>cost.mat, <span class="at">gi=</span>gi)</span>
<span id="cb834-25"><a href="WE-8.html#cb834-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb834-26"><a href="WE-8.html#cb834-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># save everything in an output folder (with a consecutive number, with three leading zeros, so the file sorting is nicer)</span></span>
<span id="cb834-27"><a href="WE-8.html#cb834-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb834-28"><a href="WE-8.html#cb834-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(sim, <span class="at">file =</span> <span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(),<span class="st">&quot;/output/simout/sim_time5-45_rep5_&quot;</span>,</span>
<span id="cb834-29"><a href="WE-8.html#cb834-29" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">sprintf</span>(<span class="st">&quot;%03i&quot;</span>,i) ,<span class="st">&quot;.RData&quot;</span>))</span>
<span id="cb834-30"><a href="WE-8.html#cb834-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb834-31"><a href="WE-8.html#cb834-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;Finished run: &quot;</span>, i,<span class="st">&quot; out of &quot;</span>,<span class="fu">nrow</span>(para.space),</span>
<span id="cb834-32"><a href="WE-8.html#cb834-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;. So far, it took: &quot;</span>, <span class="fu">round</span>(<span class="fu">proc.time</span>()[<span class="dv">3</span>]<span class="sc">-</span>timer0,<span class="dv">2</span>),<span class="st">&quot; sec.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb834-33"><a href="WE-8.html#cb834-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flush.console</span>()</span>
<span id="cb834-34"><a href="WE-8.html#cb834-34" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Finished run: 1 out of 15. So far, it took: 0.49 sec.
## Finished run: 2 out of 15. So far, it took: 0.94 sec.
## Finished run: 3 out of 15. So far, it took: 1.46 sec.
## Finished run: 4 out of 15. So far, it took: 1.89 sec.
## Finished run: 5 out of 15. So far, it took: 2.36 sec.
## Finished run: 6 out of 15. So far, it took: 4.42 sec.
## Finished run: 7 out of 15. So far, it took: 6.42 sec.
## Finished run: 8 out of 15. So far, it took: 8.53 sec.
## Finished run: 9 out of 15. So far, it took: 10.5 sec.
## Finished run: 10 out of 15. So far, it took: 12.5 sec.
## Finished run: 11 out of 15. So far, it took: 16.69 sec.
## Finished run: 12 out of 15. So far, it took: 22.13 sec.
## Finished run: 13 out of 15. So far, it took: 29.05 sec.
## Finished run: 14 out of 15. So far, it took: 35.8 sec.
## Finished run: 15 out of 15. So far, it took: 39.02 sec.</code></pre>
</div>
<div id="d.-analyze-and-synthesize-results" class="section level4">
<h4>d. Analyze and synthesize results</h4>
<p>If you check your output folder (simout) you should see 15 files.</p>
<p>Note: File paths can be different when you execute a chunk in an R notebook compared to when you copy-paste the same line into the console! We avoid this problem by using the function ‘here’ from package ‘here.’</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="WE-8.html#cb836-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">dir</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;/output/simout&quot;</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;sim_time5-45_rep5_001.RData&quot; &quot;sim_time5-45_rep5_002.RData&quot;
## [3] &quot;sim_time5-45_rep5_003.RData&quot; &quot;sim_time5-45_rep5_004.RData&quot;
## [5] &quot;sim_time5-45_rep5_005.RData&quot; &quot;sim_time5-45_rep5_006.RData&quot;</code></pre>
<p>Now we are at step D where we need to read in all our files one by one, calculate some summary statistics and plot our results.</p>
<p>Again, this could be easy, but be aware if you have thousands of files it could take quite some time and memory. The most convenient way is to load everyting and store it in a list, so we can access all of our simulations from memory. I will show how to do this in the example below, but be aware in larger simulations (think millions of runs, or large sample sizes) this is not possible and we would load a single simulation, calculate a statistic, store only the result in a table and free the memory for the next simulation run.</p>
<p>Let’s load our simulation runs. There is one caveat: when we load the object ‘sim’ from the ‘.RData file,’ we can’t assign it a new object name. I.e., we can’t use ‘newName &lt;- load(“sim.Rdata”). Instead, we can only type ’load(“sim.Rdata”)’ and it will create or overwrite the object ‘sim.’ Also, R takes the name from the object that was saved, not from the file name. Hence, once we load the object, any existing object of the same name will be overwritten. So if we want to keep, it we need to rename it before using ‘load.’</p>
<p>Here we do the following:</p>
<ul>
<li>Create an empty table with three columns ‘rep,’ ‘time,’ ‘fst’ and other columns to collect summary results for the 15 simulation runs.</li>
<li>Create a vector that contains all filenames. The function ‘list.files’ does just that. We specify with path=“./simout”’ that the files in folder ‘simout’ should be listed, and with ’pattern=“sim” we specify that we want all file names that contain the expression “sim” (we could also have used “time,” for example - any component of the file name that is shared by all the files we are interested in but no other files that might be in the same folder).</li>
<li>Loop through the files. For each filename ‘i’:
<ul>
<li>Load the file, which will create or overwrite the object ‘sim.’ We need to supply not only the file name but the path, hence ‘paste0(“./simout/,”filenames[i])’ (see Week 8 video for more on file paths).</li>
<li>Extract simulation parameters: Copy the ith row from ‘para.space’ (repeat number, timesteps) into the first two columns of the ith row of ‘res.’</li>
<li>Extract the genind object ‘gi’ with the final genotypes.</li>
<li>Calculate the mean of pairwise fst values and store in the third column of the ith row of ‘res.’</li>
<li>Perform partial Mantel tests with function ‘wasserman’ and store the Mantel r statistics and the p-values in the corresponding columns. Note that this is somewhat tricky because the function ‘wasserman’ ranks the models and the better fitting model is listed in the first row, so that the order of the models can vary between runs. Therefore we extract the values based on model name.</li>
<li>Perform ‘Sunder’ covariance analysis and extract which model is best supported (‘G,’ ‘E’ or ‘GE’).</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="WE-8.html#cb838-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">rep=</span><span class="cn">NA</span>, <span class="at">time=</span><span class="cn">NA</span>, <span class="at">fst=</span><span class="cn">NA</span>, <span class="at">r.Eucl=</span><span class="cn">NA</span>, <span class="at">p.Eucl=</span><span class="cn">NA</span>, </span>
<span id="cb838-2"><a href="WE-8.html#cb838-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">r.cost=</span><span class="cn">NA</span>, <span class="at">p.cost=</span><span class="cn">NA</span>, <span class="at">Sunder=</span><span class="cn">NA</span>)</span>
<span id="cb838-3"><a href="WE-8.html#cb838-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb838-4"><a href="WE-8.html#cb838-4" aria-hidden="true" tabindex="-1"></a><span class="co">#load all files in the folder</span></span>
<span id="cb838-5"><a href="WE-8.html#cb838-5" aria-hidden="true" tabindex="-1"></a>filenames <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path=</span> <span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;/output/simout&quot;</span>), <span class="at">pattern=</span><span class="st">&quot;sim&quot;</span>)</span>
<span id="cb838-6"><a href="WE-8.html#cb838-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb838-7"><a href="WE-8.html#cb838-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(filenames))</span>
<span id="cb838-8"><a href="WE-8.html#cb838-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb838-9"><a href="WE-8.html#cb838-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#creates a sim object</span></span>
<span id="cb838-10"><a href="WE-8.html#cb838-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">load</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;/output/simout/&quot;</span>,filenames[i]))</span>
<span id="cb838-11"><a href="WE-8.html#cb838-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb838-12"><a href="WE-8.html#cb838-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now let us take what we need from the simulation</span></span>
<span id="cb838-13"><a href="WE-8.html#cb838-13" aria-hidden="true" tabindex="-1"></a>  res[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> sim<span class="sc">$</span>para.space</span>
<span id="cb838-14"><a href="WE-8.html#cb838-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb838-15"><a href="WE-8.html#cb838-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calculate a summary statistic: mean of pairwise fst values</span></span>
<span id="cb838-16"><a href="WE-8.html#cb838-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## h.re we only take the lower triangle of the matrix to avoid the diagonal values,</span></span>
<span id="cb838-17"><a href="WE-8.html#cb838-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># which are zero by definition (comparing each population to itself)</span></span>
<span id="cb838-18"><a href="WE-8.html#cb838-18" aria-hidden="true" tabindex="-1"></a>  gen.mat <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">pairwise.fstb</span>(sim<span class="sc">$</span>gi)  </span>
<span id="cb838-19"><a href="WE-8.html#cb838-19" aria-hidden="true" tabindex="-1"></a>  res [i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(gen.mat[<span class="fu">lower.tri</span>(gen.mat)])</span>
<span id="cb838-20"><a href="WE-8.html#cb838-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb838-21"><a href="WE-8.html#cb838-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#partial Mantel tests</span></span>
<span id="cb838-22"><a href="WE-8.html#cb838-22" aria-hidden="true" tabindex="-1"></a>  wass <span class="ot">&lt;-</span> PopGenReport<span class="sc">::</span><span class="fu">wassermann</span>(<span class="at">eucl.mat =</span> <span class="fu">dist</span>(sim<span class="sc">$</span>para<span class="sc">$</span>locs), </span>
<span id="cb838-23"><a href="WE-8.html#cb838-23" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cost.mats =</span> <span class="fu">list</span>(<span class="at">cost=</span>sim<span class="sc">$</span>cost.mat), </span>
<span id="cb838-24"><a href="WE-8.html#cb838-24" aria-hidden="true" tabindex="-1"></a>                                <span class="at">gen.mat =</span> gen.mat, <span class="at">plot=</span>F)<span class="sc">$</span>mantel.tab</span>
<span id="cb838-25"><a href="WE-8.html#cb838-25" aria-hidden="true" tabindex="-1"></a>  res[i,<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> wass[wass<span class="sc">$</span>model <span class="sc">==</span> <span class="st">&quot;Gen ~Euclidean | cost&quot;</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb838-26"><a href="WE-8.html#cb838-26" aria-hidden="true" tabindex="-1"></a>  res[i,<span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>] <span class="ot">&lt;-</span> wass[wass<span class="sc">$</span>model <span class="sc">==</span> <span class="st">&quot;Gen ~cost | Euclidean&quot;</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb838-27"><a href="WE-8.html#cb838-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb838-28"><a href="WE-8.html#cb838-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Sunder</span></span>
<span id="cb838-29"><a href="WE-8.html#cb838-29" aria-hidden="true" tabindex="-1"></a>  res[i,<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">getSunder</span>(<span class="at">gen=</span>sim<span class="sc">$</span>gi, <span class="at">locs=</span>sim<span class="sc">$</span>para<span class="sc">$</span>locs, </span>
<span id="cb838-30"><a href="WE-8.html#cb838-30" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cost=</span>sim<span class="sc">$</span>cost.mat, <span class="at">nit=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>) <span class="co">#if you have time, set nit=10^3</span></span>
<span id="cb838-31"><a href="WE-8.html#cb838-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;
## 
## Computations for model &#39;geog+envi&#39;
## Computations for model &#39;geog&#39;
## Computations for model &#39;envi&#39;</code></pre>
<p>Look at the ‘res’ data frame and check the results.</p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="WE-8.html#cb840-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(res)</span></code></pre></div>
<pre><code>##   rep time         fst  r.Eucl p.Eucl  r.cost p.cost Sunder
## 1   1    5 0.009340057  0.0455  0.494  0.1492  0.305    G+E
## 2   2    5 0.009210392 -0.1807  0.723  0.4638  0.045      E
## 3   3    5 0.008996691  0.2389  0.198 -0.0054  0.508      G
## 4   4    5 0.010043283 -0.0772  0.624  0.1089  0.356      E
## 5   5    5 0.009755578 -0.1557  0.739    0.21   0.25      G
## 6   1   25 0.022190031  0.0424  0.425  0.5067  0.059    G+E</code></pre>
<p>The next step would be to visualise the results (e.g. plot runs over times and color by rep). A quick way to do that is to use the function ‘ggplot’ from the ‘ggplot2’ package. Here we add a jitter to keep points from overlapping too much.</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="WE-8.html#cb842-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(res, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>fst)) <span class="sc">+</span> </span>
<span id="cb842-2"><a href="WE-8.html#cb842-2" aria-hidden="true" tabindex="-1"></a>         ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">position =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="08-Week08_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>Now it is again time for you to experiment. For example, why not set up a simulation that varies the number of loci. Or as you may have seen even after 100 generation there was no sign that the mean pairwise Fst value is levelling off. So how long do you have to run a simulation in terms of time to see this (be aware that simulation runs take longer if you increase the number of timesteps)?</p>
<p>Questions:</p>
<ul>
<li>How would you set up a simulation experiment to compare type I error rates between partial Mantel test and Sunder?</li>
<li>How about statistical power?</li>
</ul>
<p>Have fun and please give us feed back what you think about this Worked Example. <a href="mailto:bernd.gruber@canberra.edu.au">Bernd Gruber</a>, <a href="erin.landguth@gmail.com">Erin Landguth</a>, <a href="mailto:helene.wagner@utoronto.ca">Helene Wagner</a>.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tutorial-8.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-exercise-week-8.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
