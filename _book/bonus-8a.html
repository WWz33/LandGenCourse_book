<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Bonus Vignette | Landscape Genetic Data Analysis with R</title>
  <meta name="description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Bonus Vignette | Landscape Genetic Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  <meta name="github-repo" content="hhwagner1/LandGenCourse_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bonus Vignette | Landscape Genetic Data Analysis with R" />
  
  <meta name="twitter:description" content="This is a web-interface to the teaching materials for the lab course ‘Landscape Genetic Data Analysis with R’ associated with the distributed graduate course ‘DGS Landscape Genetics.’ The output format is bookdown::gitbook." />
  

<meta name="author" content="Editor: Helene Wagner (University of Toronto)" />


<meta name="date" content="2021-05-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-exercise-week-8.html"/>
<link rel="next" href="Week9.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.7/profvis.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Landscape Genetic Data Analysis with R</a></li>

<li class="divider"></li>
<li class="part"><span><b>Getting Started</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i>How to use this Book</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#book-structure"><i class="fa fa-check"></i>1. Book Structure</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#a-getting-started"><i class="fa fa-check"></i>a) Getting Started</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#b-basic-topics"><i class="fa fa-check"></i>b) Basic Topics</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#c-advanced-topics"><i class="fa fa-check"></i>c) Advanced Topics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#find-what-is-relevant-for-you"><i class="fa fa-check"></i>2. Find what is relevant for you</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#a-how-to-use-the-labs"><i class="fa fa-check"></i>a) How to use the labs</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#b-check-contents"><i class="fa fa-check"></i>b) Check contents</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#b-check-contents-1"><i class="fa fa-check"></i>b) Check contents</a></li>
</ul></li>
<li><a href="how-to-use-this-book.html#course-r-package-landgencourse">3. Course R package <code>LandGenCourse</code></a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#a-how-to-install-or-update"><i class="fa fa-check"></i>a) How to install (or update)</a></li>
<li><a href="how-to-use-this-book.html#b-how-to-use-the-r-package-landgencourse">b) How to use the R package <code>LandGenCourse</code></a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#c-video-instructions-for-beginners"><i class="fa fa-check"></i>c) Video instructions for beginners</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="list-of-packages-by-vignette.html"><a href="list-of-packages-by-vignette.html"><i class="fa fa-check"></i>List of Packages by Vignette</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="review-of-r-skills.html"><a href="review-of-r-skills.html"><i class="fa fa-check"></i>Review of R Skills</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html"><i class="fa fa-check"></i>Basic R Programming</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#overview"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#data-types"><i class="fa fa-check"></i>2. Data Types</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#numeric-data-types"><i class="fa fa-check"></i>2.1. Numeric Data Types</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#characters"><i class="fa fa-check"></i>2.2. Characters</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#factors"><i class="fa fa-check"></i>2.3. Factors</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#logical-types"><i class="fa fa-check"></i>2.4. Logical Types</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#data-containers"><i class="fa fa-check"></i>3. Data Containers</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#vectors"><i class="fa fa-check"></i>3.1. Vectors</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#matrices"><i class="fa fa-check"></i>3.2. Matrices</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#lists"><i class="fa fa-check"></i>3.3. Lists</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#data-frames"><i class="fa fa-check"></i>3.4. Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#programming"><i class="fa fa-check"></i>4. Programming</a>
<ul>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#function-writing"><i class="fa fa-check"></i>4.1. Function Writing</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#variable-scope"><i class="fa fa-check"></i>4.2. Variable Scope</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#decision-making"><i class="fa fa-check"></i>4.3. Decision Making</a></li>
<li class="chapter" data-level="" data-path="basic-r-programming.html"><a href="basic-r-programming.html#flow-control"><i class="fa fa-check"></i>4.4. Flow Control</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html"><i class="fa fa-check"></i>R Graphics</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#overview-1"><i class="fa fa-check"></i>1. Overview</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#univariate-plots"><i class="fa fa-check"></i>2. Univariate plots</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#barplots-and-histograms"><i class="fa fa-check"></i>2.1. Barplots and histograms</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#plotting-parameters"><i class="fa fa-check"></i>2.2. Plotting Parameters</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#density-plots"><i class="fa fa-check"></i>2.3. Density Plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#bivariate-plots"><i class="fa fa-check"></i>3. Bivariate plots</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#overlaying-plots-by-grouping"><i class="fa fa-check"></i>3.1. Overlaying Plots by grouping</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#boxplots"><i class="fa fa-check"></i>3.2. Boxplots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#scatter-plots"><i class="fa fa-check"></i>3.3. Scatter Plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#advanced-plotting"><i class="fa fa-check"></i>4. Advanced plotting</a>
<ul>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#multiple-plots"><i class="fa fa-check"></i>4.1. Multiple Plots</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#color-palettes"><i class="fa fa-check"></i>4.2. Color Palettes</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#rcolorbrewer"><i class="fa fa-check"></i>4.3. RColorBrewer</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#saving-imagery"><i class="fa fa-check"></i>4.4. Saving Imagery</a></li>
<li class="chapter" data-level="" data-path="r-graphics.html"><a href="r-graphics.html#interactive-graphics"><i class="fa fa-check"></i>4.5. Interactive Graphics</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="further-r-resources.html"><a href="further-r-resources.html"><i class="fa fa-check"></i>Further R Resources</a></li>
<li class="part"><span><b>Basic Topics</b></span></li>
<li class="chapter" data-level="" data-path="Week1.html"><a href="Week1.html"><i class="fa fa-check"></i>Week 1: Importing Genetic Data</a>
<ul>
<li class="chapter" data-level="" data-path="video-1.html"><a href="video-1.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-1.html"><a href="video-1.html#preview-slides"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html"><i class="fa fa-check"></i>Interactive Tutorial 1</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#list-of-r-commands-used"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#instructions"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#a-how-to-access-tutorials"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#b-how-to-complete-tutorial"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-1.html"><a href="tutorial-1.html#c-how-to-submit-answers-participating-institutions-only"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#overview-of-worked-example"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-goals"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-data-set"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-required-r-libraries"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#import-data-from-.csv-file"><i class="fa fa-check"></i>2. Import data from .csv file</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-preparation"><i class="fa fa-check"></i>a. Preparation</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-excel-file"><i class="fa fa-check"></i>b. Excel file</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-import-with-function-read.csv"><i class="fa fa-check"></i>c. Import with function ‘read.csv’</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#d.-create-id-variable"><i class="fa fa-check"></i>d. Create ID variable</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#e.-export-with-function-write.csv"><i class="fa fa-check"></i>e. Export with function ‘write.csv’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#create-genind-object"><i class="fa fa-check"></i>3. Create ‘genind’ Object</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-read-the-helpfile"><i class="fa fa-check"></i>a. Read the helpfile</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-set-all-arguments-of-function-df2genind"><i class="fa fa-check"></i>b. Set all arguments of function ‘df2genind’</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-check-imported-data"><i class="fa fa-check"></i>c. Check imported data</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#d.-summarize-genind-object"><i class="fa fa-check"></i>d. Summarize ‘genind’ object</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#view-information-stored-in-genind-object"><i class="fa fa-check"></i>4. View information stored in ‘genind’ object</a>
<ul>
<li><a href="WE-1.html#a.-slot-tab">a. Slot <code>@tab</code></a></li>
<li><a href="WE-1.html#b.-slot-loc.n.all">b. Slot <code>@loc.n.all</code></a></li>
<li><a href="WE-1.html#c.-slot-loc.fac">c. Slot <code>@loc.fac</code></a></li>
<li><a href="WE-1.html#d.-slot-all.names">d. Slot <code>@all.names</code></a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#e.-further-slots"><i class="fa fa-check"></i>e. Further slots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#import-data-with-gstudio-package"><i class="fa fa-check"></i>5. Import data with ‘gstudio’ package</a>
<ul>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#a.-function-read_population"><i class="fa fa-check"></i>a. Function ‘read_population’</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#b.-set-arguments"><i class="fa fa-check"></i>b. Set arguments</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#c.-check-imported-data-1"><i class="fa fa-check"></i>c. Check imported data</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#d.-add-frogid"><i class="fa fa-check"></i>d. Add FrogID</a></li>
<li class="chapter" data-level="" data-path="WE-1.html"><a href="WE-1.html#e.-convert-to-genind-object"><i class="fa fa-check"></i>e. Convert to ‘genind’ object</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-1.html"><a href="r-exercise-week-1.html"><i class="fa fa-check"></i>R exercise Week 1</a></li>
<<<<<<< HEAD
=======
<li class="chapter" data-level="" data-path="bonus-1a.html"><a href="bonus-1a.html"><i class="fa fa-check"></i>Bonus: Importing SNP data</a></li>
>>>>>>> main
</ul></li>
<li class="chapter" data-level="" data-path="Week2.html"><a href="Week2.html"><i class="fa fa-check"></i>Week 2: Spatial Data</a>
<ul>
<li class="chapter" data-level="" data-path="video-2.html"><a href="video-2.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-2.html"><a href="video-2.html#preview-slides-1"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html"><i class="fa fa-check"></i>Interactive Tutorial 2</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#list-of-r-commands-used-1"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#instructions-1"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#a-how-to-access-tutorials-1"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#b-how-to-complete-tutorial-1"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-2.html"><a href="tutorial-2.html#c-how-to-submit-answers-participating-institutions-only-1"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#overview-of-worked-example-1"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-goals-1"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-data-set-1"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-required-r-libraries-1"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#import-site-data-from-.csv-file"><i class="fa fa-check"></i>2. Import site data from .csv file</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-import-data-into-spatialpointsdataframe"><i class="fa fa-check"></i>a. Import data into SpatialPointsDataFrame</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-add-spatial-reference-data"><i class="fa fa-check"></i>b. Add spatial reference data</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-change-projection"><i class="fa fa-check"></i>c. Change projection</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#d.-access-data-in-spatialpointsdataframe"><i class="fa fa-check"></i>d. Access data in ‘SpatialPointsDataFrame’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#display-raster-data-and-overlay-sampling-locations-extract-data"><i class="fa fa-check"></i>3. Display raster data and overlay sampling locations, extract data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-display-raster-data"><i class="fa fa-check"></i>a. Display raster data</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-change-color-ramp-add-sampling-locations"><i class="fa fa-check"></i>b. Change color ramp, add sampling locations</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-extract-raster-values-at-sampling-locations"><i class="fa fa-check"></i>c. Extract raster values at sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#calculate-landscape-metrics"><i class="fa fa-check"></i>4. Calculate landscape metrics</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#a.-calculate-patch--class--and-landscape-level-landscape-metrics"><i class="fa fa-check"></i>a. Calculate patch-, class- and landscape level landscape metrics</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-calculate-patch-level-landscape-metrics-for-evergreen-forest"><i class="fa fa-check"></i>b. Calculate patch-level landscape metrics for ‘Evergreen Forest’</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-extract-forest-patch-size-at-samplig-locations"><i class="fa fa-check"></i>c. Extract forest patch size at samplig locations</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#d.-plot-a-bubble-map-of-forest-patch-size-at-sampling-locations"><i class="fa fa-check"></i>d. Plot a bubble map of forest patch size at sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#sample-landscape-metrics-within-buffer-around-sampling-locations"><i class="fa fa-check"></i>5. Sample landscape metrics within buffer around sampling locations</a>
<ul>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#b.-extract-landscape-metric-of-choice-for-a-single-cover-type-as-vector"><i class="fa fa-check"></i>b. Extract landscape metric of choice for a single cover type (as vector)</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#c.-extract-landscape-metric-of-choice-for-all-cover-types-as-data-frame."><i class="fa fa-check"></i>c. Extract landscape metric of choice for all cover types (as data frame).</a></li>
<li class="chapter" data-level="" data-path="WE-2.html"><a href="WE-2.html#d.-extract-all-landscape-metrics-for-a-single-cover-type-as-data-frame"><i class="fa fa-check"></i>d. Extract all landscape metrics for a single cover type (as data frame)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-2.html"><a href="r-exercise-week-2.html"><i class="fa fa-check"></i>R Exercise Week 2</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html"><i class="fa fa-check"></i>Bonus Vignette</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#overview-2"><i class="fa fa-check"></i>1. Overview</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#a.-goals-2"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#b.-required-r-libraries"><i class="fa fa-check"></i>b. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#convert-spatialpointsdataframe-to-sf-object"><i class="fa fa-check"></i>2. Convert ‘SpatialPointsDataFrame’ to ‘sf’ object</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#plot-variables-first-10-in-data-set"><i class="fa fa-check"></i>3. Plot variables (first 10 in data set)</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#export-site-data-as-esri-shapefile"><i class="fa fa-check"></i>4. Export site data as ESRI shapefile</a></li>
<li class="chapter" data-level="" data-path="bonus-2a.html"><a href="bonus-2a.html#display-categorical-map-with-a-predefined-color-table"><i class="fa fa-check"></i>5. Display categorical map with a predefined color table</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week3.html"><a href="Week3.html"><i class="fa fa-check"></i>Week 3: Genetic Diversity</a>
<ul>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html#video-part-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html#video-part-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-3.html"><a href="video-3.html#preview-slides-2"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html"><i class="fa fa-check"></i>Interactive Tutorial 3</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#list-of-r-commands-used-2"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#instructions-2"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#a-how-to-access-tutorials-2"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#b-how-to-complete-tutorial-2"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-3.html"><a href="tutorial-3.html#c-how-to-submit-answers-participating-institutions-only-2"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#overview-of-worked-example-2"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#a.-goals-3"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#b.-data-set-2"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#c.-required-r-libraries-2"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#basic-checking-of-markers-and-populations"><i class="fa fa-check"></i>2. Basic checking of markers and populations</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#a.-re-create-genind-object"><i class="fa fa-check"></i>a. Re-create genind object</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#b.-check-that-markers-are-polymorphic"><i class="fa fa-check"></i>b. Check that markers are polymorphic</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#c.-check-for-deviations-from-hardy-weinberg-equilibrium-hwe"><i class="fa fa-check"></i>c. Check for deviations from Hardy-Weinberg equilibrium (HWE)</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#d.-check-for-linkage-disequilibrium-ld"><i class="fa fa-check"></i>d. Check for linkage disequilibrium (LD)</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#e.-check-for-null-alleles"><i class="fa fa-check"></i>e. Check for null alleles</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#f.-overall-interpretation"><i class="fa fa-check"></i>f. Overall interpretation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#assess-genetic-diversity"><i class="fa fa-check"></i>3. Assess genetic diversity</a>
<ul>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#a.-rarefied-allelic-richness"><i class="fa fa-check"></i>a. Rarefied allelic richness</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#b.-observed-and-expected-heterozygosity"><i class="fa fa-check"></i>b. Observed and expected heterozygosity</a></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#c.-create-table-with-sitel-level-genetic-diversity-measures"><i class="fa fa-check"></i>c. Create table with sitel-level genetic diversity measures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-3.html"><a href="WE-3.html#aggregate-genetic-data-at-population-level-allele-frequencies"><i class="fa fa-check"></i>4. Aggregate genetic data at population level (allele frequencies)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-3.html"><a href="r-exercise-week-3.html"><i class="fa fa-check"></i>R Exercise Week 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week4.html"><a href="Week4.html"><i class="fa fa-check"></i>Week 4: Metapopulations</a>
<ul>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html#video-part-1-1"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html#video-part-2-1"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-4.html"><a href="video-4.html#preview-slides-3"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html"><i class="fa fa-check"></i>Interactive Tutorial 4</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#list-of-r-commands-used-3"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#instructions-3"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#a-how-to-access-tutorials-3"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#b-how-to-complete-tutorial-3"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-4.html"><a href="tutorial-4.html#c-how-to-submit-answers-participating-institutions-only-3"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#overview-of-worked-example-3"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-goals-4"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-data-set-3"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#reference"><i class="fa fa-check"></i>Reference:</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#c.-required-r-libraries-3"><i class="fa fa-check"></i>c. Required R libraries</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#d.-import-data"><i class="fa fa-check"></i>d. Import data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#spatial-distribution-of-genetic-structure"><i class="fa fa-check"></i>2. Spatial distribution of genetic structure</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-creating-a-genind-object-with-the-hierarchical-data-set"><i class="fa fa-check"></i>a. Creating a ‘genind’ object with the hierarchical data set</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-hierarchical-amova"><i class="fa fa-check"></i>b. Hierarchical AMOVA</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#what-determines-genetic-differentiation-among-sites"><i class="fa fa-check"></i>3. What determines genetic differentiation among sites?</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-correlation-matrix"><i class="fa fa-check"></i>a. Correlation matrix</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-scatterplots"><i class="fa fa-check"></i>b. Scatterplots</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#c.-regression-model"><i class="fa fa-check"></i>c. Regression model</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#d.-which-populations-dont-fit-the-general-pattern"><i class="fa fa-check"></i>d. Which populations don’t fit the general pattern?</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#e.-regression-model-without-outliers"><i class="fa fa-check"></i>e. Regression model without outliers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#what-determines-genetic-diversity"><i class="fa fa-check"></i>4. What determines genetic diversity?</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-correlation-matrix-1"><i class="fa fa-check"></i>a. Correlation matrix</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-regression-models"><i class="fa fa-check"></i>b. Regression models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#are-genetic-differentiation-and-diversity-related"><i class="fa fa-check"></i>5. Are genetic differentiation and diversity related?</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#effect-of-recent-extinction-events"><i class="fa fa-check"></i>6. Effect of recent extinction events</a>
<ul>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#a.-effect-of-patch-extinction-event-temporal-data-set"><i class="fa fa-check"></i>a. Effect of patch extinction event (temporal data set)</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#b.-power-analysis"><i class="fa fa-check"></i>b. Power analysis</a></li>
<li class="chapter" data-level="" data-path="WE-4.html"><a href="WE-4.html#c.-sample-size-calculation"><i class="fa fa-check"></i>c. Sample size calculation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-4.html"><a href="r-exercise-week-4.html"><i class="fa fa-check"></i>R Exercise Week 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week5.html"><a href="Week5.html"><i class="fa fa-check"></i>Week 5: Spatial Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="video-5.html"><a href="video-5.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-5.html"><a href="video-5.html#preview-slides-4"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html"><i class="fa fa-check"></i>Interactive Tutorial 5</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#list-of-r-commands-used-4"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#instructions-4"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#a-how-to-access-tutorials-4"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#b-how-to-complete-tutorial-4"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-5.html"><a href="tutorial-5.html#c-how-to-submit-answers-participating-institutions-only-4"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#overview-of-worked-example-4"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-goals-5"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-data-set-4"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-required-r-packages"><i class="fa fa-check"></i>c. Required R packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#data-import-and-manipulation"><i class="fa fa-check"></i>2. Data import and manipulation</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-create-an-ecogen-object"><i class="fa fa-check"></i>a. Create an ecogen object</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-aggregate-to-ecopop"><i class="fa fa-check"></i>b. Aggregate to ecopop</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-add-site-level-data"><i class="fa fa-check"></i>b. Add site-level data</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-export-to-adegenet-and-gstudio"><i class="fa fa-check"></i>c. Export to adegenet and gstudio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#calculate-genetic-distances"><i class="fa fa-check"></i>3. Calculate genetic distances</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-genetic-distances-calculated-from-genind-object"><i class="fa fa-check"></i>a. Genetic distances calculated from genind object</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-more-distance-matrices-with-gstudio"><i class="fa fa-check"></i>b. More distance matrices with ‘gstudio’</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-assemble-distance-matrices"><i class="fa fa-check"></i>c. Assemble distance matrices</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#d.-export-genetic-distance-matrices"><i class="fa fa-check"></i>d. Export genetic distance matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#perform-a-mantel-test-to-test-for-ibd"><i class="fa fa-check"></i>4. Perform a Mantel test to test for IBD</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-visually-check-linearity"><i class="fa fa-check"></i>a. Visually check linearity</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-perform-mantel-test"><i class="fa fa-check"></i>b. Perform Mantel test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#create-mantel-correlogram-for-genetic-data"><i class="fa fa-check"></i>5. Create Mantel correlogram for genetic data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-create-a-first-mantel-correlogram"><i class="fa fa-check"></i>a. Create a first Mantel correlogram</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-vary-distance-class-definition"><i class="fa fa-check"></i>b. Vary distance class definition</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-alternative-measures-of-genetic-distances"><i class="fa fa-check"></i>c. Alternative measures of genetic distances</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#specify-spatial-weights-and-calculate-morans-i"><i class="fa fa-check"></i>6. Specify spatial weights and calculate Moran’s I</a>
<ul>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#a.-defining-spatial-neighbors"><i class="fa fa-check"></i>a. Defining spatial neighbors</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#b.-defining-spatial-weights"><i class="fa fa-check"></i>b. Defining spatial weights</a></li>
<li class="chapter" data-level="" data-path="WE-5.html"><a href="WE-5.html#c.-calculating-and-testing-morans-i"><i class="fa fa-check"></i>c. Calculating and testing Moran’s I</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-5.html"><a href="r-exercise-week-5.html"><i class="fa fa-check"></i>R Exercise Week 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week6.html"><a href="Week6.html"><i class="fa fa-check"></i>Week 6: Quantitative Genetics</a>
<ul>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html#video-part-1-2"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html#video-part-2-2"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-6.html"><a href="video-6.html#preview-slides-5"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html"><i class="fa fa-check"></i>Interactive Tutorial 6</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#list-of-r-commands-used-5"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#instructions-5"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#a-how-to-access-tutorials-5"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#b-how-to-complete-tutorial-5"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-6.html"><a href="tutorial-6.html#c-how-to-submit-answers-participating-institutions-only-5"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#overview-of-worked-example-5"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-goals-6"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-data-set-5"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#c.-required-r-packages-1"><i class="fa fa-check"></i>c. Required R packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment"><i class="fa fa-check"></i>2. Estimate genetic and non-genetic variance components from a common garden experiment</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-import-phenytypic-data"><i class="fa fa-check"></i>a. Import phenytypic data</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-fit-linear-mixed-effects-models-lmm-to-trait-data-observed-on-families"><i class="fa fa-check"></i>b. Fit linear mixed effects models (LMM) to trait data observed on families</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#c.-compare-model-fit"><i class="fa fa-check"></i>c. Compare model fit</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#d.-check-model-validity"><i class="fa fa-check"></i>d. Check model validity</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#e.-estimate-variance-components"><i class="fa fa-check"></i>e. Estimate variance components</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#f.-significance-testing"><i class="fa fa-check"></i>f. Significance testing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#estimate-trait-heritability"><i class="fa fa-check"></i>3. Estimate trait heritability</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-estimate-heritability"><i class="fa fa-check"></i>a. Estimate heritability</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-estimate-trait-differentiation"><i class="fa fa-check"></i>b. Estimate trait differentiation</a></li>
</ul></li>
<li><a href="WE-6.html#compare-q_st-to-f_st-measured-from-snp-data">4. Compare <span class="math inline">\(Q_{st}\)</span> to <span class="math inline">\(F_{st}\)</span> measured from SNP data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-import-ecogen-object"><i class="fa fa-check"></i>a. Import ‘ecogen’ object</a></li>
<li><a href="WE-6.html#b.-compare-q_st-to-f_st">b. Compare <span class="math inline">\(Q_{ST}\)</span> to <span class="math inline">\(F_{ST}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#assess-correlation-between-trait-and-environment"><i class="fa fa-check"></i>5. Assess correlation between trait and environment</a>
<ul>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#a.-describe-and-extract-effects"><i class="fa fa-check"></i>a. Describe and extract effects</a></li>
<li class="chapter" data-level="" data-path="WE-6.html"><a href="WE-6.html#b.-correlation-of-population-effect-with-environment"><i class="fa fa-check"></i>b. Correlation of population effect with environment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-6.html"><a href="r-exercise-week-6.html"><i class="fa fa-check"></i>R Exercise Week 6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week7.html"><a href="Week7.html"><i class="fa fa-check"></i>Week 7: Spatial Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html#video-part-1-3"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html#video-part-2-3"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-7.html"><a href="video-7.html#preview-slides-6"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html"><i class="fa fa-check"></i>Interactive Tutorial 7</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#list-of-r-commands-used-6"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#instructions-6"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#a-how-to-access-tutorials-6"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#b-how-to-complete-tutorial-6"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-7.html"><a href="tutorial-7.html#c-how-to-submit-answers-participating-institutions-only-6"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#overview-of-worked-example-6"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-goals-7"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-data-set-6"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#c.-required-r-packages-2"><i class="fa fa-check"></i>c. Required R packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#estimate-genetic-and-non-genetic-variance-components-from-a-common-garden-experiment-1"><i class="fa fa-check"></i>2. Estimate genetic and non-genetic variance components from a common garden experiment</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-import-phenytypic-data-1"><i class="fa fa-check"></i>a. Import phenytypic data</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-fit-linear-mixed-effects-models-lmm-to-trait-data-observed-on-families-1"><i class="fa fa-check"></i>b. Fit linear mixed effects models (LMM) to trait data observed on families</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#c.-compare-model-fit-1"><i class="fa fa-check"></i>c. Compare model fit</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#d.-check-model-validity-1"><i class="fa fa-check"></i>d. Check model validity</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#e.-estimate-variance-components-1"><i class="fa fa-check"></i>e. Estimate variance components</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#f.-significance-testing-1"><i class="fa fa-check"></i>f. Significance testing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#estimate-trait-heritability-1"><i class="fa fa-check"></i>3. Estimate trait heritability</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-estimate-heritability-1"><i class="fa fa-check"></i>a. Estimate heritability</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-estimate-trait-differentiation-1"><i class="fa fa-check"></i>b. Estimate trait differentiation</a></li>
</ul></li>
<li><a href="WE-7.html#compare-q_st-to-f_st-measured-from-snp-data-1">4. Compare <span class="math inline">\(Q_{st}\)</span> to <span class="math inline">\(F_{st}\)</span> measured from SNP data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-import-ecogen-object-1"><i class="fa fa-check"></i>a. Import ‘ecogen’ object</a></li>
<li><a href="WE-7.html#b.-compare-q_st-to-f_st-1">b. Compare <span class="math inline">\(Q_{ST}\)</span> to <span class="math inline">\(F_{ST}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#assess-correlation-between-trait-and-environment-1"><i class="fa fa-check"></i>5. Assess correlation between trait and environment</a>
<ul>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#a.-describe-and-extract-effects-1"><i class="fa fa-check"></i>a. Describe and extract effects</a></li>
<li class="chapter" data-level="" data-path="WE-7.html"><a href="WE-7.html#b.-correlation-of-population-effect-with-environment-1"><i class="fa fa-check"></i>b. Correlation of population effect with environment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-6-1.html"><a href="r-exercise-week-6-1.html"><i class="fa fa-check"></i>R Exercise Week 6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week8.html"><a href="Week8.html"><i class="fa fa-check"></i>Week 8: Simulation Experiments</a>
<ul>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html"><i class="fa fa-check"></i>View Course Video</a>
<ul>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html#video-part-1-4"><i class="fa fa-check"></i>Video, Part 1</a></li>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html#video-part-2-4"><i class="fa fa-check"></i>Video, Part 2</a></li>
<li class="chapter" data-level="" data-path="video-8.html"><a href="video-8.html#preview-slides-7"><i class="fa fa-check"></i>Preview Slides</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html"><i class="fa fa-check"></i>Interactive Tutorial 8</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#list-of-r-commands-used-7"><i class="fa fa-check"></i>List of R commands used</a></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#instructions-7"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#a-how-to-access-tutorials-7"><i class="fa fa-check"></i>a) How to access tutorials:</a></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#b-how-to-complete-tutorial-7"><i class="fa fa-check"></i>b) How to complete tutorial:</a></li>
<li class="chapter" data-level="" data-path="tutorial-8.html"><a href="tutorial-8.html#c-how-to-submit-answers-participating-institutions-only-7"><i class="fa fa-check"></i>c) How to submit answers (participating institutions only):</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#overview-of-worked-example-7"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-goals-8"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-data-set-7"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-required-r-libraries-4"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#initialize-a-landscape"><i class="fa fa-check"></i>2. Initialize a landscape</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-create-a-random-landscape"><i class="fa fa-check"></i>a. Create a random landscape</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-add-populations-to-the-landscape-using-minimal-distance"><i class="fa fa-check"></i>b. Add populations to the landscape (using minimal distance)</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-initialise-a-metapopulation"><i class="fa fa-check"></i>c. Initialise a metapopulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#define-simulation-parameters"><i class="fa fa-check"></i>3. Define simulation parameters</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-define-your-metapopulation"><i class="fa fa-check"></i>a. Define your metapopulation</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-initialise-your-population-on-the-landscape"><i class="fa fa-check"></i>b. Initialise your population on the landscape</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#run-simulations-and-analyze-results"><i class="fa fa-check"></i>4. Run simulations and analyze results</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-run-your-simulation-over-multiple-time-steps-years"><i class="fa fa-check"></i>a. Run your simulation over multiple time steps (years)</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-analyse-your-simulated-population-with-a-partial-mantel-test"><i class="fa fa-check"></i>b. Analyse your simulated population with a partial Mantel test</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-optional-analyze-your-simulated-populations-using-sunder"><i class="fa fa-check"></i>c. Optional: Analyze your simulated populations using ‘Sunder’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#run-simulator-using-a-previously-defined-parameter-set"><i class="fa fa-check"></i>5. Run simulator using a previously defined parameter set</a>
<ul>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#a.-specify-and-record-the-parameter-combinations"><i class="fa fa-check"></i>a. Specify and record the parameter combinations</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#b.-run-the-simulator-over-every-parameter-combination."><i class="fa fa-check"></i>b. Run the simulator over every parameter combination.</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#c.-save-your-complete-simulation-run-input-and-output"><i class="fa fa-check"></i>c. Save your complete simulation run (input and output)</a></li>
<li class="chapter" data-level="" data-path="WE-8.html"><a href="WE-8.html#d.-analyze-and-synthesize-results"><i class="fa fa-check"></i>d. Analyze and synthesize results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-exercise-week-8.html"><a href="r-exercise-week-8.html"><i class="fa fa-check"></i>R Exercise Week 8</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html"><i class="fa fa-check"></i>Bonus Vignette</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#overview-of-bonus-material"><i class="fa fa-check"></i>1. Overview of Bonus Material</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-goals-9"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-data-set-8"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#c.-required-r-libraries-5"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#navigating-the-file-system"><i class="fa fa-check"></i>2. Navigating the file system</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-where-am-i"><i class="fa fa-check"></i>a. Where am I?</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-accessing-a-system-file"><i class="fa fa-check"></i>b. Accessing a system file</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#c.-file-manipulation"><i class="fa fa-check"></i>c. File manipulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#benchmarking-file-import-and-export-options"><i class="fa fa-check"></i>3. Benchmarking file import and export options</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-benchmark-methods-for-importing-csv-files"><i class="fa fa-check"></i>a. Benchmark methods for importing csv files</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-check-handling-of-character-data"><i class="fa fa-check"></i>b. Check handling of character data</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#c.-binary-files"><i class="fa fa-check"></i>c. Binary files</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#d.-should-you-save-your-r-workspace"><i class="fa fa-check"></i>d. Should you save your R workspace?</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#e.-compile-your-functions"><i class="fa fa-check"></i>e. Compile your functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#profiling-your-code"><i class="fa fa-check"></i>4. Profiling your code</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-named-chunks"><i class="fa fa-check"></i>a. Named chunks</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-profiling-some-lines-of-code-with-profvis"><i class="fa fa-check"></i>b. Profiling some lines of code with ‘profvis’</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#c.-profiling-an-r-script-with-profvis"><i class="fa fa-check"></i>c. Profiling an R script with ‘profvis’</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#d.-converting-an-r-notebook-to-an-r-script"><i class="fa fa-check"></i>d. Converting an R Notebook to an R script</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#creating-and-executing-a-bash-r-script"><i class="fa fa-check"></i>5. Creating and executing a Bash R script</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-run-r-script-directly-in-the-terminal"><i class="fa fa-check"></i>a. Run R script directly in the Terminal</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-create-a-bash-r-script"><i class="fa fa-check"></i>b. Create a Bash R script</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#c.-executing-a-bash-r-script"><i class="fa fa-check"></i>c. Executing a Bash R script</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#d.-moving-to-a-node-or-cluster"><i class="fa fa-check"></i>d. Moving to a node or cluster?</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#e.-store-your-session-info-and-package-versions"><i class="fa fa-check"></i>e. Store your session info and package versions</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#f.-potential-windows-issues"><i class="fa fa-check"></i>f. Potential Windows issues</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#parallelizing-code"><i class="fa fa-check"></i>6. Parallelizing code</a>
<ul>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#a.-replace-lapply-by-mclapply-with-package-parallel"><i class="fa fa-check"></i>a. Replace ‘lapply’ by ‘mclapply’ with package ‘parallel’</a></li>
<li class="chapter" data-level="" data-path="bonus-8a.html"><a href="bonus-8a.html#b.-replace-for-by-foreach-with-package-doparallel"><i class="fa fa-check"></i>b. Replace ‘for’ by ‘foreach’ with package ‘doParallel’</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Advanced Topics</b></span></li>
<li class="chapter" data-level="" data-path="Week9.html"><a href="Week9.html"><i class="fa fa-check"></i>Week 9: Population Structure</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#overview-of-worked-example-8"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#a.-goals-10"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#b.-data-sets"><i class="fa fa-check"></i>b. Data sets</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#c.-required-r-libraries-6"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#simulated-data-2-island-model"><i class="fa fa-check"></i>2. Simulated data: 2-island model</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#a.-import-data"><i class="fa fa-check"></i>a. Import data</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#b.-perform-principal-components-analysis-pca"><i class="fa fa-check"></i>b. Perform Principal Components Analysis (PCA)</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#c.-create-synthetic-spatial-coordinates-xy-and-map-them"><i class="fa fa-check"></i>c. Create synthetic spatial coordinates (X,Y) and map them</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#simulated-data-2-island-model-with-admixture"><i class="fa fa-check"></i>3. Simulated data: 2-island model with admixture</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#empirical-data-threespine-sticklebacks"><i class="fa fa-check"></i>4. Empirical data: Threespine sticklebacks</a>
<ul>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#a.-import-the-data"><i class="fa fa-check"></i>a. Import the data:</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#b.-examine-population-structure-with-pca"><i class="fa fa-check"></i>b. Examine population structure with PCA</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#c.-clustering-with-snmf-similar-to-structure"><i class="fa fa-check"></i>c. Clustering with SNMF (similar to ‘STRUCTURE’)</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#d.-plot-ancestry-proportions"><i class="fa fa-check"></i>d. Plot ancestry proportions</a></li>
<li class="chapter" data-level="" data-path="WE-9.html"><a href="WE-9.html#e.-visualize-admixture-proportions-on-a-map"><i class="fa fa-check"></i>e. Visualize admixture proportions on a map</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week10.html"><a href="Week10.html"><i class="fa fa-check"></i>Week 10: Landscape Resistance</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#overview-of-worked-example-9"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-goals-11"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-data-set-9"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-required-r-libraries-7"><i class="fa fa-check"></i>c. Required R libraries</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#d.-import-rasters-gsp-err-cti-and-ffp."><i class="fa fa-check"></i>d. Import rasters (gsp, err, cti, and ffp).</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#e.-import-site-data-with-sampling-locations"><i class="fa fa-check"></i>e. Import site data with sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#explore-the-data-set"><i class="fa fa-check"></i>2. Explore the data set</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-plot-all-rasters"><i class="fa fa-check"></i>a. Plot all rasters</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-plot-spatial-points-over-ffp-raster"><i class="fa fa-check"></i>b. Plot spatial points over ffp raster</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#setting-cost-values-and-calculating-conductance"><i class="fa fa-check"></i>3. Setting cost values and calculating conductance</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-resistance-vs.-conductance-values"><i class="fa fa-check"></i>a. Resistance vs. conductance values</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-as-needed-get-all-rasters-at-the-same-scale"><i class="fa fa-check"></i>b. As needed: Get all rasters at the same scale</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-calculate-conductance-values"><i class="fa fa-check"></i>c. Calculate conductance values</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#d.-create-a-single-landscape-conductance-raster"><i class="fa fa-check"></i>d. Create a single landscape conductance raster</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#convert-conductance-into-effective-distance"><i class="fa fa-check"></i>4. Convert conductance into effective distance</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-create-a-transition-layer"><i class="fa fa-check"></i>a. Create a transition layer</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-visually-inspect-the-raster"><i class="fa fa-check"></i>b. Visually inspect the raster</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-correct-for-geometric-distortion"><i class="fa fa-check"></i>c. Correct for geometric distortion</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#d.-plot-shortest-paths-in-space"><i class="fa fa-check"></i>d. Plot shortest paths in space</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#create-cost-distance-matrices"><i class="fa fa-check"></i>5. Create cost-distance matrices</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-least-cost-distance"><i class="fa fa-check"></i>a. Least cost distance</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-cost-distance-matrix-based-on-random-paths-similar-to-circuitscape"><i class="fa fa-check"></i>b. Cost-distance matrix based on random paths (similar to Circuitscape)</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#c.-compare-cost-distances"><i class="fa fa-check"></i>c. Compare cost distances</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#how-does-changing-resolution-affect-these-metrics"><i class="fa fa-check"></i>6. How does changing resolution affect these metrics?</a>
<ul>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#a.-create-loop"><i class="fa fa-check"></i>a. Create loop</a></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#b.-plot-the-results"><i class="fa fa-check"></i>b. Plot the results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-10.html"><a href="WE-10.html#references"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week11.html"><a href="Week11.html"><i class="fa fa-check"></i>Week 11: Detecting Adaptation</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#overview-of-worked-example-10"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-goals-12"><i class="fa fa-check"></i>a. Goals</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-data-set-10"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#c.-required-r-libraries-8"><i class="fa fa-check"></i>c. Required R libraries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#import-and-prepare-the-data"><i class="fa fa-check"></i>2. Import and prepare the data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-import-the-genetic-data"><i class="fa fa-check"></i>a. Import the genetic data</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-import-the-environmental-data"><i class="fa fa-check"></i>b. Import the environmental data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#latent-factor-mixed-models-lfmm-a-univariate-gea"><i class="fa fa-check"></i>3. Latent Factor Mixed Models (LFMM): a univariate GEA</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-determine-k"><i class="fa fa-check"></i>a. Determine K</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-run-lfmm"><i class="fa fa-check"></i>b. Run LFMM</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#c.-identify-lfmm-candidates-using-false-discovery-rate"><i class="fa fa-check"></i>c. Identify LFMM candidates using False Discovery Rate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#redundancy-analysis-rda-a-multivariate-gea"><i class="fa fa-check"></i>4. Redundancy Analysis (RDA): a multivariate GEA</a>
<ul>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a.-run-rda"><i class="fa fa-check"></i>a. Run RDA</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#b.-identify-rda-candidates"><i class="fa fa-check"></i>b. Identify RDA candidates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#compare-lfmm-and-rda-candidates"><i class="fa fa-check"></i>5. Compare LFMM and RDA candidates</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#a-quick-note-on-controlling-for-population-structure-in-rda"><i class="fa fa-check"></i>6. A quick note on controlling for population structure in RDA</a></li>
<li class="chapter" data-level="" data-path="WE-11.html"><a href="WE-11.html#references-1"><i class="fa fa-check"></i>7. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week12.html"><a href="Week12.html"><i class="fa fa-check"></i>Week 12: Model Selection</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#overview-of-worked-example-11"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#a.-goals-and-background"><i class="fa fa-check"></i>a. Goals and Background</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#b.-data-set-11"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#c.-required-packages"><i class="fa fa-check"></i>c. Required packages</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#d.-import-data-1"><i class="fa fa-check"></i>d. Import data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#fitting-candidate-models"><i class="fa fa-check"></i>2. Fitting candidate models</a>
<ul>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#a.-alternative-hypotheses"><i class="fa fa-check"></i>a. Alternative hypotheses</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#b.-prepare-for-model-fitting"><i class="fa fa-check"></i>b. Prepare for model fitting</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#c.-fit-all-five-models"><i class="fa fa-check"></i>c. Fit all five models</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#d.-compare-evidence-for-models"><i class="fa fa-check"></i>d. Compare evidence for models</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#e.-calculate-evidence-weights"><i class="fa fa-check"></i>e. Calculate evidence weights</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#f.-confidence-intervals-for-predictors"><i class="fa fa-check"></i>f. Confidence intervals for predictors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#your-turn-to-test-additional-hypotheses"><i class="fa fa-check"></i>3. Your turn to test additional hypotheses!</a></li>
<li class="chapter" data-level="" data-path="WE-12.html"><a href="WE-12.html#references-2"><i class="fa fa-check"></i>4. References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week13.html"><a href="Week13.html"><i class="fa fa-check"></i>Week 13: Gravity Models</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#overview-of-worked-example-12"><i class="fa fa-check"></i>1. Overview of Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-background"><i class="fa fa-check"></i>a. Background</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-data-set-12"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-required-r-libraries-9"><i class="fa fa-check"></i>c. Required R libraries</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#set-working-and-data-directories---needs-to-be-removed"><i class="fa fa-check"></i>Set working and data directories - NEEDS TO BE REMOVED</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#calculating-graph-metrics"><i class="fa fa-check"></i>2. Calculating graph metrics</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-read-in-make-a-spatial-object-and-plot-wetlands-wetlands.csv."><i class="fa fa-check"></i>a. Read in, make a spatial object and plot wetlands (Wetlands.csv).</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-create-a-graph-from-the-wetlands"><i class="fa fa-check"></i>b. Create a graph from the wetlands</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-create-adjacency-matrix"><i class="fa fa-check"></i>c. Create adjacency matrix</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#d.-calculate-graph-metrics"><i class="fa fa-check"></i>d. Calculate graph metrics</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#e.-add-graph-metrics-to-data.frame"><i class="fa fa-check"></i>e. Add graph metrics to data.frame</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#combine-frog-data-with-graph-metrics"><i class="fa fa-check"></i>3. Combine frog data with graph metrics</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-add-graph-node-data-to-frog-site-data"><i class="fa fa-check"></i>a. Add graph node data to frog site data</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-check-data-types"><i class="fa fa-check"></i>b. Check data types</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#merge-graph-with-genetic-distance-data"><i class="fa fa-check"></i>4. Merge graph with genetic distance data</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-build-graph-from-occupied-sites"><i class="fa fa-check"></i>a. Build graph from occupied sites</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-merge-graph-with-genetic-distance"><i class="fa fa-check"></i>b. Merge graph with genetic distance</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-write-out-results-ascii-csv-and-lines-shapefile."><i class="fa fa-check"></i>c. Write out results (ASCII csv and lines shapefile).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#preparing-raster-based-covariates"><i class="fa fa-check"></i>5. Preparing raster-based covariates</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-import-raster-data-as-stack"><i class="fa fa-check"></i>a. Import raster data as stack</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-calculate-wetland-area-within-buffer"><i class="fa fa-check"></i>b. Calculate wetland area within buffer</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-create-raster-of-wetland-proportion"><i class="fa fa-check"></i>c. Create raster of wetland proportion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#extract-raster-stats-for-nodes-and-edges"><i class="fa fa-check"></i>6. Extract raster stats for nodes and edges</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-extract-at-site-variables-from-rasters"><i class="fa fa-check"></i>a. Extract at-site variables from rasters</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-add-covariates-to-graph-edges."><i class="fa fa-check"></i>b. Add covariates to graph edges.</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-calculating-stats-along-edges"><i class="fa fa-check"></i>c. Calculating stats along edges</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#d.-calculating-stats-for-categorical-variables"><i class="fa fa-check"></i>d. Calculating stats for categorical variables</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#e.-add-node-data-to-graph"><i class="fa fa-check"></i>e. Add node data to graph</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#gravity-models"><i class="fa fa-check"></i>7. Gravity Models</a>
<ul>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#a.-merge-distance-and-site-data"><i class="fa fa-check"></i>a. Merge distance and site data</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#b.-define-a-set-of-models"><i class="fa fa-check"></i>b. Define a set of models</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-check-for-correlations"><i class="fa fa-check"></i>c. Check for correlations</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#c.-write-out-resultss"><i class="fa fa-check"></i>c. Write out resultss</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#e.-compare-models"><i class="fa fa-check"></i>e. Compare models</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#f.-diagnostic-plots"><i class="fa fa-check"></i>f. Diagnostic plots</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#g.-fit-final-models"><i class="fa fa-check"></i>g. Fit final model(s)</a></li>
<li class="chapter" data-level="" data-path="WE-13.html"><a href="WE-13.html#h.-effect-size"><i class="fa fa-check"></i>h. Effect size</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Week14.html"><a href="Week14.html"><i class="fa fa-check"></i>Week 14: Contemporary Gene Flow</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html"><i class="fa fa-check"></i>Worked Example</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#overview-3"><i class="fa fa-check"></i>1. Overview</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-background-and-goals"><i class="fa fa-check"></i>a. Background and Goals</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-data-set-13"><i class="fa fa-check"></i>b. Data set</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#c.-required-packages-1"><i class="fa fa-check"></i>c. Required packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#import-genotypes"><i class="fa fa-check"></i>2. Import Genotypes</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-import-genotype-data"><i class="fa fa-check"></i>a. Import genotype data</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-plot-map-of-sampling-locations"><i class="fa fa-check"></i>b. Plot map of sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#pollen-pool-genetic-structure"><i class="fa fa-check"></i>3. Pollen pool genetic structure</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-subtract-maternal-contribution-to-offspring-genotype"><i class="fa fa-check"></i>a. Subtract maternal contribution to offspring genotype</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-twogener-analysis-amova-of-pollen-pool-data"><i class="fa fa-check"></i>b. ‘TwoGener’ analysis (AMOVA of pollen pool data)</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#c.-including-space-isolation-by-distance"><i class="fa fa-check"></i>c. Including space: Isolation by distance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#paternity-analysis"><i class="fa fa-check"></i>4. Paternity analysis</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-exclusion-probabilities"><i class="fa fa-check"></i>a. Exclusion probabilities</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-paternity-analysis"><i class="fa fa-check"></i>b. Paternity analysis</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#c.-visualize-reconstructed-pollen-flow-events-in-space"><i class="fa fa-check"></i>c. Visualize reconstructed pollen flow events in space</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#d.-visualize-dispersal-kernel"><i class="fa fa-check"></i>d. Visualize dispersal kernel</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#linking-paternity-to-ecological-variables"><i class="fa fa-check"></i>5. Linking paternity to ecological variables</a>
<ul>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#a.-explain-pollen-flow-within-populations"><i class="fa fa-check"></i>a. Explain pollen flow within populations</a></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#b.-explain-pollen-flow-at-the-population-level"><i class="fa fa-check"></i>b. Explain pollen flow at the population level</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="WE-14.html"><a href="WE-14.html#references-3"><i class="fa fa-check"></i>6. References</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Landscape Genetic Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bonus_8a" class="section level2">
<h2>Bonus Vignette</h2>
<div id="overview-of-bonus-material" class="section level3">
<h3>1. Overview of Bonus Material</h3>
<div id="a.-goals-9" class="section level4">
<h4>a. Goals</h4>
<p>This Bonus Material provides some introductory worked examples for:</p>
<ul>
<li>Navigating the file system</li>
<li>Benchmarking file import and export functions</li>
<li>Profiling an R script</li>
<li>Creating and executing a Bash R script</li>
<li>Parallelizing code</li>
</ul>
</div>
<div id="b.-data-set-8" class="section level4">
<h4>b. Data set</h4>
<p>We will use the wolf SNP data (Schweizer et al., 2016) from the Week 11 worked example. The genetic data are individual-based, and are input as allele counts (i.e. 0/1/2) for each locus. We are using a randomly sampled subset of 10,000 single nucleotide polymorphism (SNP) markers from the full data set (which contains 42,587 SNPs).</p>
</div>
<div id="c.-required-r-libraries-5" class="section level4">
<h4>c. Required R libraries</h4>
<<<<<<< HEAD
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="bonus-8a.html#cb863-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LandGenCourse)</span>
<span id="cb863-2"><a href="bonus-8a.html#cb863-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(microbenchmark)</span></span>
<span id="cb863-3"><a href="bonus-8a.html#cb863-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(profvis)</span></span>
<span id="cb863-4"><a href="bonus-8a.html#cb863-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(here)</span></span>
<span id="cb863-5"><a href="bonus-8a.html#cb863-5" aria-hidden="true" tabindex="-1"></a><span class="co">#library(readr)</span></span>
<span id="cb863-6"><a href="bonus-8a.html#cb863-6" aria-hidden="true" tabindex="-1"></a><span class="co">#library(data.table)</span></span>
<span id="cb863-7"><a href="bonus-8a.html#cb863-7" aria-hidden="true" tabindex="-1"></a><span class="co">#library(feather)</span></span>
<span id="cb863-8"><a href="bonus-8a.html#cb863-8" aria-hidden="true" tabindex="-1"></a><span class="co">#library(rio)</span></span>
<span id="cb863-9"><a href="bonus-8a.html#cb863-9" aria-hidden="true" tabindex="-1"></a><span class="co">#library(devtools)</span></span>
<span id="cb863-10"><a href="bonus-8a.html#cb863-10" aria-hidden="true" tabindex="-1"></a><span class="co">#library(parallel)</span></span>
<span id="cb863-11"><a href="bonus-8a.html#cb863-11" aria-hidden="true" tabindex="-1"></a><span class="co">#library(doParallel)</span></span>
<span id="cb863-12"><a href="bonus-8a.html#cb863-12" aria-hidden="true" tabindex="-1"></a><span class="co">#library(knitr)</span></span>
<span id="cb863-13"><a href="bonus-8a.html#cb863-13" aria-hidden="true" tabindex="-1"></a><span class="co">#library(compiler)</span></span></code></pre></div>
=======
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="bonus-8a.html#cb870-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LandGenCourse)</span>
<span id="cb870-2"><a href="bonus-8a.html#cb870-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(microbenchmark)</span></span>
<span id="cb870-3"><a href="bonus-8a.html#cb870-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(profvis)</span></span>
<span id="cb870-4"><a href="bonus-8a.html#cb870-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(here)</span></span>
<span id="cb870-5"><a href="bonus-8a.html#cb870-5" aria-hidden="true" tabindex="-1"></a><span class="co">#library(readr)</span></span>
<span id="cb870-6"><a href="bonus-8a.html#cb870-6" aria-hidden="true" tabindex="-1"></a><span class="co">#library(data.table)</span></span>
<span id="cb870-7"><a href="bonus-8a.html#cb870-7" aria-hidden="true" tabindex="-1"></a><span class="co">#library(feather)</span></span>
<span id="cb870-8"><a href="bonus-8a.html#cb870-8" aria-hidden="true" tabindex="-1"></a><span class="co">#library(rio)</span></span>
<span id="cb870-9"><a href="bonus-8a.html#cb870-9" aria-hidden="true" tabindex="-1"></a><span class="co">#library(devtools)</span></span>
<span id="cb870-10"><a href="bonus-8a.html#cb870-10" aria-hidden="true" tabindex="-1"></a><span class="co">#library(parallel)</span></span>
<span id="cb870-11"><a href="bonus-8a.html#cb870-11" aria-hidden="true" tabindex="-1"></a><span class="co">#library(doParallel)</span></span>
<span id="cb870-12"><a href="bonus-8a.html#cb870-12" aria-hidden="true" tabindex="-1"></a><span class="co">#library(knitr)</span></span>
<span id="cb870-13"><a href="bonus-8a.html#cb870-13" aria-hidden="true" tabindex="-1"></a><span class="co">#library(compiler)</span></span></code></pre></div>
>>>>>>> main
</div>
</div>
<div id="navigating-the-file-system" class="section level3">
<h3>2. Navigating the file system</h3>
<p>This Bonus material assumes that you are running R in RStudio within a ‘R project.’ Therefore, the default workspace when you enter commands in the console should be your R project folder. A discussed in the video, Part 2, the default location when executing code from an R Notebook is the folder where the notebook is stored. If you downloaded this Bonus material from ‘LandGenCourse,’ it should be stored in a folder ‘downloads’ in your project folder.</p>
<p>More about R projects: <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects" class="uri">https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects</a>.</p>
<div id="a.-where-am-i" class="section level4">
<h4>a. Where am I?</h4>
<p>Let’s see where we are.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="bonus-8a.html#cb864-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/Desktop/LandGenCourse_book/vignettes&quot;</code></pre>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="bonus-8a.html#cb866-1" aria-hidden="true" tabindex="-1"></a>here<span class="sc">::</span><span class="fu">here</span>()</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/Desktop/LandGenCourse_book&quot;</code></pre>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="bonus-8a.html#cb868-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;HOME&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;C:\\Users\\wagnerh1\\Documents&quot;</code></pre>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="bonus-8a.html#cb870-1" aria-hidden="true" tabindex="-1"></a><span class="fu">R.home</span>()</span></code></pre></div>
=======
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="bonus-8a.html#cb871-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/Desktop/LandGenCourse_book/vignettes&quot;</code></pre>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="bonus-8a.html#cb873-1" aria-hidden="true" tabindex="-1"></a>here<span class="sc">::</span><span class="fu">here</span>()</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/Desktop/LandGenCourse_book&quot;</code></pre>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="bonus-8a.html#cb875-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;HOME&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;C:\\Users\\wagnerh1\\Documents&quot;</code></pre>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="bonus-8a.html#cb877-1" aria-hidden="true" tabindex="-1"></a><span class="fu">R.home</span>()</span></code></pre></div>
>>>>>>> main
<pre><code>## [1] &quot;C:/Users/wagnerh1/DOCUME~1/R/R-40~1.5&quot;</code></pre>
<p><strong>Question:</strong> Copy-paste the commands in the chunk above directly into the Console and run them there. Do you get the same paths?</p>
<ul>
<li><code>getwd()</code>: If you execute the chunk, or knit the notebook, this will return the locatio of the R Notebook. If you copy-paste it into the console, it will return the project folder.</li>
<li><code>here::here</code>: This should return the project folder in both cases.</li>
<li><code>Sys.getenv("HOME")</code>: This should return your home directory on the local machine. Note: “HOME” must be in all capitals.</li>
<li><code>R.home</code>: This shows the location where R is installed on your computer.</li>
</ul>
</div>
<div id="b.-accessing-a-system-file" class="section level4">
<h4>b. Accessing a system file</h4>
<p>The example data set is available in the ‘extdata’ folder of the ‘LandGenCoures’ package. This is how we import the data in the Week 11 Worked Example:</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="bonus-8a.html#cb872-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;wolf_geno_samp_10000.csv&quot;</span>, </span>
<span id="cb872-2"><a href="bonus-8a.html#cb872-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>), <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb872-3"><a href="bonus-8a.html#cb872-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(gen)</span></code></pre></div>
<pre><code>## [1]    94 10000</code></pre>
<p>Let’s unpack this code. What does the function <code>system.file</code> do? Let’s compare it to <code>R.home</code>.</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="bonus-8a.html#cb874-1" aria-hidden="true" tabindex="-1"></a><span class="fu">R.home</span>()</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/DOCUME~1/R/R-40~1.5&quot;</code></pre>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="bonus-8a.html#cb876-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>()</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/DOCUME~1/R/R-40~1.5/library/base&quot;</code></pre>
<p>So, <code>system.file</code> goes to the R home and, without additional arguments, locates the folder ‘library’ with the subfolder ‘base.’</p>
<p>What happens when we add the arguments?</p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="bonus-8a.html#cb878-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>(<span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/Documents/R/R-4.0.5/library/LandGenCourse&quot;</code></pre>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="bonus-8a.html#cb880-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;wolf_geno_samp_10000.csv&quot;</span>, </span>
<span id="cb880-2"><a href="bonus-8a.html#cb880-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>)</span></code></pre></div>
=======
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="bonus-8a.html#cb879-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;wolf_geno_samp_10000.csv&quot;</span>, </span>
<span id="cb879-2"><a href="bonus-8a.html#cb879-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>), <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb879-3"><a href="bonus-8a.html#cb879-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(gen)</span></code></pre></div>
<pre><code>## [1]    94 10000</code></pre>
<p>Let’s unpack this code. What does the function <code>system.file</code> do? Let’s compare it to <code>R.home</code>.</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="bonus-8a.html#cb881-1" aria-hidden="true" tabindex="-1"></a><span class="fu">R.home</span>()</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/DOCUME~1/R/R-40~1.5&quot;</code></pre>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="bonus-8a.html#cb883-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>()</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/DOCUME~1/R/R-40~1.5/library/base&quot;</code></pre>
<p>So, <code>system.file</code> goes to the R home and, without additional arguments, locates the folder ‘library’ with the subfolder ‘base.’</p>
<p>What happens when we add the arguments?</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="bonus-8a.html#cb885-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>(<span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/Documents/R/R-4.0.5/library/LandGenCourse&quot;</code></pre>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="bonus-8a.html#cb887-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;wolf_geno_samp_10000.csv&quot;</span>, </span>
<span id="cb887-2"><a href="bonus-8a.html#cb887-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>)</span></code></pre></div>
>>>>>>> main
<pre><code>## [1] &quot;C:/Users/wagnerh1/Documents/R/R-4.0.5/library/LandGenCourse/extdata/wolf_geno_samp_10000.csv&quot;</code></pre>
<p>Compare the paths to those from the previous chunk!</p>
<ul>
<li>When we specify the package argument, <code>system.file</code> modifies the path to the location where the package is stored.</li>
<li>The remaining, unnamed arguments are interpreted as a path and added at the end: within package ‘LandGenCourse,’ go to folder ‘extdata’ and locate file “wolf_geno_samp_10000.csv.”</li>
</ul>
<p>This is pretty cool! To be honest, I have no clue where such files are stored, and the absolute path would be different anyways on my Mac and on my Windows machine.</p>
</div>
<div id="c.-file-manipulation" class="section level4">
<h4>c. File manipulation</h4>
<p>We can use R’s file manipulation functions to do things with the file before even importing the data. Let’s check the file size:</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="bonus-8a.html#cb882-1" aria-hidden="true" tabindex="-1"></a>myFile <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;wolf_geno_samp_10000.csv&quot;</span>, </span>
<span id="cb882-2"><a href="bonus-8a.html#cb882-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>)</span>
<span id="cb882-3"><a href="bonus-8a.html#cb882-3" aria-hidden="true" tabindex="-1"></a><span class="fu">file.size</span>(myFile)</span></code></pre></div>
<pre><code>## [1] 2078748</code></pre>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="bonus-8a.html#cb884-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;File size: &quot;</span>, <span class="fu">file.size</span>(myFile) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="st">&quot; MB&quot;</span>)</span></code></pre></div>
=======
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="bonus-8a.html#cb889-1" aria-hidden="true" tabindex="-1"></a>myFile <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;wolf_geno_samp_10000.csv&quot;</span>, </span>
<span id="cb889-2"><a href="bonus-8a.html#cb889-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>)</span>
<span id="cb889-3"><a href="bonus-8a.html#cb889-3" aria-hidden="true" tabindex="-1"></a><span class="fu">file.size</span>(myFile)</span></code></pre></div>
<pre><code>## [1] 2078748</code></pre>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="bonus-8a.html#cb891-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;File size: &quot;</span>, <span class="fu">file.size</span>(myFile) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="st">&quot; MB&quot;</span>)</span></code></pre></div>
>>>>>>> main
<pre><code>## File size:  2.078748  MB</code></pre>
<p>The number returned is in byte, hence we divide by 1 million (10^6) to get megabyte (MB).</p>
<p>Other useful functions include (see help file: ‘?files’):</p>
<ul>
<li><code>file.create</code>: creates file, truncates name if name already exists</li>
<li><code>file.exist</code>: checks whether a file with this name exists at location</li>
<li><code>file.remove</code>: attempts to delete file</li>
<li><code>file.rename</code>: attempts to rename file</li>
<li><code>file.append</code>: attempts to append one file to another</li>
<li><code>file.copy</code>: copies file ‘from’ ‘to’ (set ‘overwrite=TRUE’ to allow overwriting an existing file)</li>
<li><code>download.file</code>: download a file from the internet</li>
<li><code>unzip</code>: unzip a zip archive (there is also a function <code>zip</code>, also <code>untar</code> and <code>tar</code> for tar archives)</li>
<li><code>dir</code>: list content of folder (=directory)</li>
<li><code>dir.exist</code>: check whether a folder with this name exists at location</li>
<li><code>dir.create</code>: creates a folder (does not work when knitting R Notebook!)</li>
</ul>
<p>What other files are available? The function <code>dir</code> lists all files and subfolders in a specific folder. The question then is which folder to specify?</p>
<p><strong>Question:</strong> What do you think the following commands will return?</p>
<ul>
<li>dir()</li>
<li>dir(here::here())</li>
<li>dir(system.file(package = “LandGenCourse”))</li>
<li>dir(system.file(“extdata,” package = “LandGenCourse”))</li>
<li>dir(myFile)</li>
</ul>
<p>Give it a try:</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="bonus-8a.html#cb886-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>()</span></code></pre></div>
=======
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="bonus-8a.html#cb893-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>()</span></code></pre></div>
>>>>>>> main
<pre><code>##  [1] &quot;WE12_Fig1.PNG&quot;            &quot;WE13_Fig1.png&quot;           
##  [3] &quot;WE9_Fig1.png&quot;             &quot;WE9_Fig2.png&quot;            
##  [5] &quot;Week0_BasicR.Rmd&quot;         &quot;Week0_Graphics.Rmd&quot;      
##  [7] &quot;Week1_vignette.Rmd&quot;       &quot;Week10_vignette.Rmd&quot;     
##  [9] &quot;Week11_vignette.Rmd&quot;      &quot;Week12_vignette.Rmd&quot;     
## [11] &quot;Week13_vignette.Rmd&quot;      &quot;Week14_vignette.Rmd&quot;     
## [13] &quot;Week2_bonus_vignette.Rmd&quot; &quot;Week2_vignette.Rmd&quot;      
## [15] &quot;Week3_vignette.Rmd&quot;       &quot;Week4_vignette.Rmd&quot;      
## [17] &quot;Week5_vignette.Rmd&quot;       &quot;Week6_vignette.Rmd&quot;      
## [19] &quot;Week7_vignette.Rmd&quot;       &quot;Week8_bonus_vignette.Rmd&quot;
## [21] &quot;Week8_vignette.Rmd&quot;       &quot;Week9_vignette.Rmd&quot;</code></pre>
<<<<<<< HEAD
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="bonus-8a.html#cb888-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(here<span class="sc">::</span><span class="fu">here</span>())</span></code></pre></div>
=======
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="bonus-8a.html#cb895-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(here<span class="sc">::</span><span class="fu">here</span>())</span></code></pre></div>
>>>>>>> main
<pre><code>##  [1] &quot;_book&quot;                    &quot;_bookdown.yml&quot;           
##  [3] &quot;_bookdown_files&quot;          &quot;_output.yml&quot;             
##  [5] &quot;00-ReviewR.md&quot;            &quot;00-ReviewR.Rmd&quot;          
##  [7] &quot;00-ReviewR.utf8.md&quot;       &quot;00-ReviewR_files&quot;        
##  [9] &quot;01-Week01.md&quot;             &quot;01-Week01.Rmd&quot;           
## [11] &quot;01-Week01.utf8.md&quot;        &quot;01-Week01_files&quot;         
## [13] &quot;02-Week02.md&quot;             &quot;02-Week02.Rmd&quot;           
## [15] &quot;02-Week02.utf8.md&quot;        &quot;02-Week02_files&quot;         
## [17] &quot;03-Week03.md&quot;             &quot;03-Week03.Rmd&quot;           
## [19] &quot;03-Week03.utf8.md&quot;        &quot;03-Week03_files&quot;         
## [21] &quot;04-Week04.md&quot;             &quot;04-Week04.Rmd&quot;           
## [23] &quot;04-Week04.utf8.md&quot;        &quot;04-Week04_files&quot;         
## [25] &quot;05-Week05.md&quot;             &quot;05-Week05.Rmd&quot;           
## [27] &quot;05-Week05.utf8.md&quot;        &quot;05-Week05_files&quot;         
## [29] &quot;06-Week06.md&quot;             &quot;06-Week06.Rmd&quot;           
## [31] &quot;06-Week06.utf8.md&quot;        &quot;06-Week06_files&quot;         
## [33] &quot;07-Week07.md&quot;             &quot;07-Week07.Rmd&quot;           
## [35] &quot;07-Week07.utf8.md&quot;        &quot;07-Week07_files&quot;         
<<<<<<< HEAD
## [37] &quot;08-Week08.Rmd&quot;            &quot;08-Week08_files&quot;         
## [39] &quot;09-Week09.Rmd&quot;            &quot;09-Week09_files&quot;         
## [41] &quot;10-Week10.Rmd&quot;            &quot;10-Week10_files&quot;         
## [43] &quot;11-Week11.Rmd&quot;            &quot;11-Week11_files&quot;         
## [45] &quot;12-Week12.Rmd&quot;            &quot;12-Week12_files&quot;         
## [47] &quot;13-Week13.Rmd&quot;            &quot;13-Week13_files&quot;         
## [49] &quot;14-Week14.Rmd&quot;            &quot;14-Week14_files&quot;         
## [51] &quot;book.bib&quot;                 &quot;ChapterDepot.R&quot;          
## [53] &quot;downloads&quot;                &quot;header.html&quot;             
## [55] &quot;index.md&quot;                 &quot;index.Rmd&quot;               
## [57] &quot;index.utf8.md&quot;            &quot;js&quot;                      
## [59] &quot;LandGenCourse_book.rds&quot;   &quot;LandGenCourse_book.Rproj&quot;
## [61] &quot;LICENSE&quot;                  &quot;ListOfPackages.nb.html&quot;  
## [63] &quot;ListOfPackages.Rmd&quot;       &quot;my_plot.png&quot;             
## [65] &quot;output&quot;                   &quot;README.md&quot;               
## [67] &quot;render1e541582584a.rds&quot;   &quot;render2fbc1ad7f46.rds&quot;   
## [69] &quot;render33ed6170c2e4.rds&quot;   &quot;render363c1997640c.rds&quot;  
## [71] &quot;render3894c561f3.rds&quot;     &quot;render3b305196d38.rds&quot;   
## [73] &quot;render66c9275c5e.rds&quot;     &quot;rendera1ac36509ec1.rds&quot;  
## [75] &quot;renderf9011b67ac.rds&quot;     &quot;rsconnect&quot;               
## [77] &quot;style.css&quot;                &quot;toc.css&quot;                 
## [79] &quot;tutorials&quot;                &quot;vignettes&quot;               
## [81] &quot;Workflow.nb.html&quot;         &quot;Workflow.Rmd&quot;</code></pre>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="bonus-8a.html#cb890-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(<span class="fu">system.file</span>(<span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>))</span></code></pre></div>
<pre><code>##  [1] &quot;data&quot;        &quot;DESCRIPTION&quot; &quot;extdata&quot;     &quot;help&quot;        &quot;html&quot;       
##  [6] &quot;INDEX&quot;       &quot;Meta&quot;        &quot;NAMESPACE&quot;   &quot;R&quot;           &quot;rstudio&quot;</code></pre>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="bonus-8a.html#cb892-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>))</span></code></pre></div>
=======
## [37] &quot;08-Week08.Rmd&quot;            &quot;08-Week08.utf8.md&quot;       
## [39] &quot;08-Week08_files&quot;          &quot;09-Week09.Rmd&quot;           
## [41] &quot;09-Week09_files&quot;          &quot;10-Week10.Rmd&quot;           
## [43] &quot;11-Week11.Rmd&quot;            &quot;12-Week12.Rmd&quot;           
## [45] &quot;13-Week13.Rmd&quot;            &quot;13-Week13_files&quot;         
## [47] &quot;14-Week14.Rmd&quot;            &quot;book.bib&quot;                
## [49] &quot;ChapterDepot.R&quot;           &quot;downloads&quot;               
## [51] &quot;header.html&quot;              &quot;index.md&quot;                
## [53] &quot;index.Rmd&quot;                &quot;index.utf8.md&quot;           
## [55] &quot;js&quot;                       &quot;LandGenCourse_book.rds&quot;  
## [57] &quot;LandGenCourse_book.Rproj&quot; &quot;LICENSE&quot;                 
## [59] &quot;ListOfPackages.nb.html&quot;   &quot;ListOfPackages.Rmd&quot;      
## [61] &quot;my_plot.png&quot;              &quot;output&quot;                  
## [63] &quot;README.md&quot;                &quot;render173c39542062.rds&quot;  
## [65] &quot;render1e541582584a.rds&quot;   &quot;render2fbc1ad7f46.rds&quot;   
## [67] &quot;render33ed6170c2e4.rds&quot;   &quot;render363c1997640c.rds&quot;  
## [69] &quot;render3894c561f3.rds&quot;     &quot;render3b305196d38.rds&quot;   
## [71] &quot;rendera1ac36509ec1.rds&quot;   &quot;renderf9011b67ac.rds&quot;    
## [73] &quot;rsconnect&quot;                &quot;style.css&quot;               
## [75] &quot;toc.css&quot;                  &quot;tutorials&quot;               
## [77] &quot;vignettes&quot;                &quot;Workflow.nb.html&quot;        
## [79] &quot;Workflow.Rmd&quot;</code></pre>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="bonus-8a.html#cb897-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(<span class="fu">system.file</span>(<span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>))</span></code></pre></div>
<pre><code>##  [1] &quot;data&quot;        &quot;DESCRIPTION&quot; &quot;extdata&quot;     &quot;help&quot;        &quot;html&quot;       
##  [6] &quot;INDEX&quot;       &quot;Meta&quot;        &quot;NAMESPACE&quot;   &quot;R&quot;           &quot;rstudio&quot;</code></pre>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="bonus-8a.html#cb899-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>))</span></code></pre></div>
>>>>>>> main
<pre><code>##  [1] &quot;BashExample.sh&quot;                   &quot;Colortable_LULC.csv&quot;             
##  [3] &quot;CSF_network.csv&quot;                  &quot;dataNm1.str&quot;                     
##  [5] &quot;dataNm10.txt&quot;                     &quot;dataNm2.txt&quot;                     
##  [7] &quot;EnvironmentalData_8pred.csv&quot;      &quot;ExcelTable.png&quot;                  
##  [9] &quot;Frogs_diversity_allpops.csv&quot;      &quot;Index_of_functions_formatted.pdf&quot;
## [11] &quot;myNotebook.Rmd&quot;                   &quot;panel.cor.r&quot;                     
## [13] &quot;pulsatilla_genotypes.csv&quot;         &quot;pulsatilla_momVariables.csv&quot;     
## [15] &quot;pulsatilla_population.csv&quot;        &quot;ralu.loci.csv&quot;                   
## [17] &quot;ralu.rasters.rds&quot;                 &quot;ralu_coords_allpops.csv&quot;         
## [19] &quot;RALU_Dps.csv&quot;                     &quot;ralu_loci_allpops.csv&quot;           
## [21] &quot;RALU_Site.csv&quot;                    &quot;RCommands.doc&quot;                   
## [23] &quot;RCommands.docx&quot;                   &quot;supplemental_R_functions.R&quot;      
## [25] &quot;WE12_Fig1.PNG&quot;                    &quot;WE13_Fig1.png&quot;                   
## [27] &quot;WE9_Fig1.png&quot;                     &quot;WE9_Fig2.png&quot;                    
## [29] &quot;Wetlands.csv&quot;                     &quot;wolf_geno_samp_10000.csv&quot;        
## [31] &quot;WWP_environmental_data.txt&quot;       &quot;WWP_phenotype_data.txt&quot;          
## [33] &quot;WWP_SNP_genotypes.txt&quot;</code></pre>
<<<<<<< HEAD
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="bonus-8a.html#cb894-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(myFile)</span></code></pre></div>
=======
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="bonus-8a.html#cb901-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir</span>(myFile)</span></code></pre></div>
>>>>>>> main
<pre><code>## character(0)</code></pre>
<ul>
<li><code>dir()</code>: the content of the last folder to which you navigated.</li>
<li><code>dir(here::here())</code>: the content of your project folder.</li>
<li><code>dir(system.file(package = "LandGenCourse"))</code>: the content of the package.</li>
<li><code>dir(system.file("extdata", package = "LandGenCourse"))</code>: the content of the folder ‘extdata’ in the package.</li>
<li><code>dir(myFile)</code>: nothing (this is a file, not a folder).</li>
</ul>
</div>
</div>
<div id="benchmarking-file-import-and-export-options" class="section level3">
<h3>3. Benchmarking file import and export options</h3>
<p>See also Chapter 5 in “Efficient R Programming”: <a href="https://csgillespie.github.io/efficientR/input-output.html" class="uri">https://csgillespie.github.io/efficientR/input-output.html</a></p>
<div id="a.-benchmark-methods-for-importing-csv-files" class="section level4">
<h4>a. Benchmark methods for importing csv files</h4>
<p>The file ‘myFile’ has 2MB and thus a reasonable size to compare the speed of different import and export functions.</p>
<p>Let’s benchmark the function <code>read.csv</code> used in Week 11. We use the function <code>microbenchmark</code> from the package <code>microbenchmark</code> to compare the speed of four different functions that can import a ‘csv’ file.</p>
<p>Note: Here we execute each function only once to save time, typically you would set <code>times = 10</code> or so. Also, <code>read_csv</code> will print a warning about a missing column name. This is because the first column here contains the row names and does not have a column name. We’ll ignore this here, as we can use the first column as an example to compare how character data are being imported.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="bonus-8a.html#cb896-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> myFile</span>
<span id="cb896-2"><a href="bonus-8a.html#cb896-2" aria-hidden="true" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(<span class="at">times =</span> <span class="dv">1</span>, <span class="at">unit =</span> <span class="st">&quot;ms&quot;</span>, </span>
<span id="cb896-3"><a href="bonus-8a.html#cb896-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">read.csv</span>(x), readr<span class="sc">::</span><span class="fu">read_csv</span>(x), data.table<span class="sc">::</span><span class="fu">fread</span>(x),</span>
<span id="cb896-4"><a href="bonus-8a.html#cb896-4" aria-hidden="true" tabindex="-1"></a>          rio<span class="sc">::</span><span class="fu">import</span>(x))</span></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Unit: milliseconds
##                  expr       min        lq      mean    median        uq
##           read.csv(x) 3831.9176 3831.9176 3831.9176 3831.9176 3831.9176
##    readr::read_csv(x) 5932.1155 5932.1155 5932.1155 5932.1155 5932.1155
##  data.table::fread(x)   87.9424   87.9424   87.9424   87.9424   87.9424
##        rio::import(x)  154.3189  154.3189  154.3189  154.3189  154.3189
##        max neval
##  3831.9176     1
##  5932.1155     1
##    87.9424     1
##   154.3189     1</code></pre>
<p>Would it be faster if we first loaded the packages so that we could call the functions directly?</p>
<p>Note: you can list several independent commands on the same line by separating the with a semi-colon ‘;’ Also, the chunk setting <code>message=FALSE</code> here suppresses the warning message from <code>read_csv</code>.</p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="bonus-8a.html#cb899-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr); <span class="fu">library</span>(data.table); <span class="fu">library</span>(rio); <span class="fu">library</span>(microbenchmark)</span>
<span id="cb899-2"><a href="bonus-8a.html#cb899-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb899-3"><a href="bonus-8a.html#cb899-3" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="at">times =</span> <span class="dv">1</span>, <span class="at">unit =</span> <span class="st">&quot;ms&quot;</span>, </span>
<span id="cb899-4"><a href="bonus-8a.html#cb899-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">read.csv</span>(x), <span class="fu">read_csv</span>(x), <span class="fu">fread</span>(x), <span class="fu">import</span>(x))</span></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Unit: milliseconds
##         expr       min        lq      mean    median        uq       max neval
##  read.csv(x) 3940.9549 3940.9549 3940.9549 3940.9549 3940.9549 3940.9549     1
##  read_csv(x) 5865.0204 5865.0204 5865.0204 5865.0204 5865.0204 5865.0204     1
##     fread(x)  150.8235  150.8235  150.8235  150.8235  150.8235  150.8235     1
##    import(x)   85.1180   85.1180   85.1180   85.1180   85.1180   85.1180     1</code></pre>
=======
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="bonus-8a.html#cb903-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> myFile</span>
<span id="cb903-2"><a href="bonus-8a.html#cb903-2" aria-hidden="true" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(<span class="at">times =</span> <span class="dv">1</span>, <span class="at">unit =</span> <span class="st">&quot;ms&quot;</span>, </span>
<span id="cb903-3"><a href="bonus-8a.html#cb903-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">read.csv</span>(x), readr<span class="sc">::</span><span class="fu">read_csv</span>(x), data.table<span class="sc">::</span><span class="fu">fread</span>(x),</span>
<span id="cb903-4"><a href="bonus-8a.html#cb903-4" aria-hidden="true" tabindex="-1"></a>          rio<span class="sc">::</span><span class="fu">import</span>(x))</span></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Unit: milliseconds
##                  expr       min        lq      mean    median        uq
##           read.csv(x) 3860.6293 3860.6293 3860.6293 3860.6293 3860.6293
##    readr::read_csv(x) 6018.6958 6018.6958 6018.6958 6018.6958 6018.6958
##  data.table::fread(x)   83.2845   83.2845   83.2845   83.2845   83.2845
##        rio::import(x)  149.4532  149.4532  149.4532  149.4532  149.4532
##        max neval
##  3860.6293     1
##  6018.6958     1
##    83.2845     1
##   149.4532     1</code></pre>
<p>Would it be faster if we first loaded the packages so that we could call the functions directly?</p>
<p>Note: you can list several independent commands on the same line by separating the with a semi-colon ‘;’ Also, the chunk setting <code>message=FALSE</code> here suppresses the warning message from <code>read_csv</code>.</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="bonus-8a.html#cb906-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr); <span class="fu">library</span>(data.table); <span class="fu">library</span>(rio); <span class="fu">library</span>(microbenchmark)</span>
<span id="cb906-2"><a href="bonus-8a.html#cb906-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb906-3"><a href="bonus-8a.html#cb906-3" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="at">times =</span> <span class="dv">1</span>, <span class="at">unit =</span> <span class="st">&quot;ms&quot;</span>, </span>
<span id="cb906-4"><a href="bonus-8a.html#cb906-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">read.csv</span>(x), <span class="fu">read_csv</span>(x), <span class="fu">fread</span>(x), <span class="fu">import</span>(x))</span></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Unit: milliseconds
##         expr       min        lq      mean    median        uq       max neval
##  read.csv(x) 6265.3486 6265.3486 6265.3486 6265.3486 6265.3486 6265.3486     1
##  read_csv(x) 3520.9875 3520.9875 3520.9875 3520.9875 3520.9875 3520.9875     1
##     fread(x)   66.7760   66.7760   66.7760   66.7760   66.7760   66.7760     1
##    import(x)   88.9253   88.9253   88.9253   88.9253   88.9253   88.9253     1</code></pre>
>>>>>>> main
<p>Yes, the import was faster when the packages were already loaded.</p>
<p>Overall <code>fread</code> and <code>import</code> were in the order of 50 times faster than <code>read.csv</code> and <code>read_csv</code>! The two had practically the same speed, which is little surprising: for ‘csv’ files, <code>import</code> uses the function <code>fread</code>.</p>
<p>The beauty of <code>import</code> is that it can handle a wide range of file types (and the list keeps growing): csv, xls, xlsx, html, xml, json, feather, R, RData, rda, rds, psv, tsv, sas7bdat, xpt, sav, dta, xpt, por, rec, mtp, syd, dbf, arff, dif, fwf, csv.gz, CSVY, fst, mat, ods, yml, as well as Fortan files and clipboard imports (Mac and Windows). It recognizes the file type from the extension and uses an appropriate import function.</p>
<p>Note: there is also a fuction <code>Import</code> in the <code>car</code> package that similarly aims to provide an easy way to import various file formats. However, <code>car::Import</code> can be very slow (slower than ‘read.csv’), whereas <code>rio::import</code> is fast.</p>
</div>
<div id="b.-check-handling-of-character-data" class="section level4">
<h4>b. Check handling of character data</h4>
<p>The functions differ not only in their speed but also in how they handle text data (character or factor?), missing values etc.</p>
<p>The first column in ‘myFile’ is an ID variable that should be used as row names. Let’s compare what the four methods did with this. The following code determines, for each import method, the class of the first column (IDs), and the class (or classes) of the resulting object.</p>
<p>Note: here we use double square brackets to subset the first column. Strictly speaking, we interpret ‘gen’ as a list of vectors. With a data.frame, we could also access the first column by gen[,1]. However, this would not return what we want for ‘tbl’ of ‘data.table’ objects. Always double check.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb902-1"><a href="bonus-8a.html#cb902-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(x); <span class="fu">c</span>(<span class="fu">class</span>(gen[[<span class="dv">1</span>]]), <span class="fu">class</span>(gen))</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;  &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb904-1"><a href="bonus-8a.html#cb904-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(x); <span class="fu">c</span>(<span class="fu">class</span>(gen[[<span class="dv">1</span>]]), <span class="fu">class</span>(gen))</span></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## [1] &quot;character&quot;   &quot;spec_tbl_df&quot; &quot;tbl_df&quot;      &quot;tbl&quot;         &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="bonus-8a.html#cb907-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">fread</span>(x); <span class="fu">c</span>(<span class="fu">class</span>(gen[[<span class="dv">1</span>]]), <span class="fu">class</span>(gen))</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;  &quot;data.table&quot; &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="bonus-8a.html#cb909-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">import</span>(x); <span class="fu">c</span>(<span class="fu">class</span>(gen[[<span class="dv">1</span>]]), <span class="fu">class</span>(gen))</span></code></pre></div>
=======
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="bonus-8a.html#cb909-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(x); <span class="fu">c</span>(<span class="fu">class</span>(gen[[<span class="dv">1</span>]]), <span class="fu">class</span>(gen))</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;  &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="bonus-8a.html#cb911-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(x); <span class="fu">c</span>(<span class="fu">class</span>(gen[[<span class="dv">1</span>]]), <span class="fu">class</span>(gen))</span></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## [1] &quot;character&quot;   &quot;spec_tbl_df&quot; &quot;tbl_df&quot;      &quot;tbl&quot;         &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="bonus-8a.html#cb914-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">fread</span>(x); <span class="fu">c</span>(<span class="fu">class</span>(gen[[<span class="dv">1</span>]]), <span class="fu">class</span>(gen))</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;  &quot;data.table&quot; &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="bonus-8a.html#cb916-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">import</span>(x); <span class="fu">c</span>(<span class="fu">class</span>(gen[[<span class="dv">1</span>]]), <span class="fu">class</span>(gen))</span></code></pre></div>
>>>>>>> main
<pre><code>## [1] &quot;character&quot;  &quot;data.frame&quot;</code></pre>
<ul>
<li>The function <code>read.csv</code> interprets any text as ‘factor,’ the other functions use ‘character’ as default. Always double check!<br />
</li>
<li>All of these functions have optional arguments for specifying how each column how it should be interpreted (see help files).</li>
<li>With the functions <code>fread</code> and <code>import</code>, you can set the argument ‘stringsAsFactors = TRUE’ to import all text data as factors.</li>
</ul>
</div>
<div id="c.-binary-files" class="section level4">
<h4>c. Binary files</h4>
<p>Binary files are not readable by users (or other software) but provide an efficient way of storing data. Let’s compare file size and input/output speed between text files (csv) and different types of binary files (RData, rds, feather). We’ll also export the ‘csv’ file so that we have it in the same location.</p>
<p>First we make sure an <code>output</code> folder exists in the R project:</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="bonus-8a.html#cb911-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(),<span class="st">&quot;/output&quot;</span>))) <span class="fu">dir.create</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(),<span class="st">&quot;/output&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="bonus-8a.html#cb912-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">import</span>(myFile)</span>
<span id="cb912-2"><a href="bonus-8a.html#cb912-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb912-3"><a href="bonus-8a.html#cb912-3" aria-hidden="true" tabindex="-1"></a><span class="fu">export</span>(gen, <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.csv&quot;</span>))</span>
<span id="cb912-4"><a href="bonus-8a.html#cb912-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(gen, <span class="at">file=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.RData&quot;</span>))</span>
<span id="cb912-5"><a href="bonus-8a.html#cb912-5" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(gen, <span class="at">file=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.rds&quot;</span>))</span>
<span id="cb912-6"><a href="bonus-8a.html#cb912-6" aria-hidden="true" tabindex="-1"></a><span class="fu">export</span>(gen, <span class="at">file=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.feather&quot;</span>))</span></code></pre></div>
<pre><code>## Loading required namespace: feather</code></pre>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="bonus-8a.html#cb914-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">csv=</span><span class="fu">file.size</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.csv&quot;</span>)),</span>
<span id="cb914-2"><a href="bonus-8a.html#cb914-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">RData=</span><span class="fu">file.size</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.RData&quot;</span>)),</span>
<span id="cb914-3"><a href="bonus-8a.html#cb914-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rds=</span><span class="fu">file.size</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.rds&quot;</span>)),</span>
<span id="cb914-4"><a href="bonus-8a.html#cb914-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">feather=</span><span class="fu">file.size</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.feather&quot;</span>)))<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span></code></pre></div>
=======
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="bonus-8a.html#cb918-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(),<span class="st">&quot;/output&quot;</span>))) <span class="fu">dir.create</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(),<span class="st">&quot;/output&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="bonus-8a.html#cb919-1" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">import</span>(myFile)</span>
<span id="cb919-2"><a href="bonus-8a.html#cb919-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb919-3"><a href="bonus-8a.html#cb919-3" aria-hidden="true" tabindex="-1"></a><span class="fu">export</span>(gen, <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.csv&quot;</span>))</span>
<span id="cb919-4"><a href="bonus-8a.html#cb919-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(gen, <span class="at">file=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.RData&quot;</span>))</span>
<span id="cb919-5"><a href="bonus-8a.html#cb919-5" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(gen, <span class="at">file=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.rds&quot;</span>))</span>
<span id="cb919-6"><a href="bonus-8a.html#cb919-6" aria-hidden="true" tabindex="-1"></a><span class="fu">export</span>(gen, <span class="at">file=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.feather&quot;</span>))</span></code></pre></div>
<pre><code>## Loading required namespace: feather</code></pre>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="bonus-8a.html#cb921-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">csv=</span><span class="fu">file.size</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.csv&quot;</span>)),</span>
<span id="cb921-2"><a href="bonus-8a.html#cb921-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">RData=</span><span class="fu">file.size</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.RData&quot;</span>)),</span>
<span id="cb921-3"><a href="bonus-8a.html#cb921-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rds=</span><span class="fu">file.size</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.rds&quot;</span>)),</span>
<span id="cb921-4"><a href="bonus-8a.html#cb921-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">feather=</span><span class="fu">file.size</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.feather&quot;</span>)))<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span></code></pre></div>
>>>>>>> main
<pre><code>##      csv    RData      rds  feather 
## 2.002586 0.351647 0.351620 4.759960</code></pre>
<ul>
<li>The ‘csv’ file is 2 MB (first row).</li>
<li>The R binary files ‘RData’ and ‘rds’ are much smaller!</li>
<li>In contrast, the ‘feather’ file (last row) is twice as large here than the ‘csv’ file, and more than 10 times larger than ‘rds!’</li>
</ul>
<p>Let’s benchmark the import again. We can use the function <code>import</code> for all of them. This is so fast that we can actually do it 10 times.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="bonus-8a.html#cb916-1" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="at">times =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">&quot;ms&quot;</span>, </span>
<span id="cb916-2"><a href="bonus-8a.html#cb916-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">csv=</span> <span class="fu">import</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.csv&quot;</span>)),</span>
<span id="cb916-3"><a href="bonus-8a.html#cb916-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">RData=</span><span class="fu">import</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.RData&quot;</span>)),</span>
<span id="cb916-4"><a href="bonus-8a.html#cb916-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">rds=</span><span class="fu">import</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.rds&quot;</span>)),</span>
<span id="cb916-5"><a href="bonus-8a.html#cb916-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">feather=</span><span class="fu">import</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.feather&quot;</span>)))</span></code></pre></div>
<pre><code>## Unit: milliseconds
##     expr     min      lq     mean   median      uq     max neval cld
##      csv 63.5149 64.6514 66.30174 65.07345 67.8021 72.6304    10  b 
##    RData 14.9272 15.6169 16.16177 15.91850 16.2611 19.4511    10 a  
##      rds 14.9037 15.5138 15.80388 15.85240 16.1839 16.5527    10 a  
##  feather 64.0513 67.1752 73.17925 70.75710 78.5029 92.9404    10   c</code></pre>
=======
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="bonus-8a.html#cb923-1" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="at">times =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">&quot;ms&quot;</span>, </span>
<span id="cb923-2"><a href="bonus-8a.html#cb923-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">csv=</span> <span class="fu">import</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.csv&quot;</span>)),</span>
<span id="cb923-3"><a href="bonus-8a.html#cb923-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">RData=</span><span class="fu">import</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.RData&quot;</span>)),</span>
<span id="cb923-4"><a href="bonus-8a.html#cb923-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">rds=</span><span class="fu">import</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.rds&quot;</span>)),</span>
<span id="cb923-5"><a href="bonus-8a.html#cb923-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">feather=</span><span class="fu">import</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.feather&quot;</span>)))</span></code></pre></div>
<pre><code>## Unit: milliseconds
##     expr     min      lq     mean   median      uq     max neval cld
##      csv 63.6636 64.0392 65.27626 64.31715 66.0944 70.7024    10  b 
##    RData 15.0345 15.1168 15.86305 15.56375 16.1838 18.2565    10 a  
##      rds 14.8866 15.0950 15.82153 15.41105 16.0085 19.2394    10 a  
##  feather 63.7461 66.7099 72.25826 70.70965 79.2637 81.2181    10   c</code></pre>
>>>>>>> main
<p>Look at the column ‘mean.’ Importing any of the binary files was at least twice as fast as importing the ‘csv’ file with the underlying function <code>fread</code> (which was already 50 times faster than <code>read.csv</code>).</p>
<p>Here’s my recommendation for saving R objects/data efficiently:</p>
<ul>
<li>If object is not in tabular form: rds (can store any R object)</li>
<li>If storage space is most important: rds</li>
<li>If portability with Python is important: feather</li>
<li>If being able to read text file is important: csv</li>
</ul>
<p>Note: the developer of <code>feather</code> does not recommend using it for long-term data storage since its stability with future updates to R or Python can’t be guaranteed: <a href="https://github.com/wesm/feather/issues/183" class="uri">https://github.com/wesm/feather/issues/183</a></p>
<p>Why ‘rds’ and not ‘RData?’ In practice, the main advantage of ‘rds’ is convenience when importing data.</p>
<ul>
<li>with ‘readRDS,’ you can directly assign the imported data to an object, and thus choose the object name.</li>
<li>with ‘load,’ you have to do this in two steps. When using ‘load,’ the loaded object will inherit the name from the object that was stored.</li>
</ul>
<<<<<<< HEAD
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="bonus-8a.html#cb918-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s delete any copy of &#39;gen&#39; from the workspace:</span></span>
<span id="cb918-2"><a href="bonus-8a.html#cb918-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gen)</span>
<span id="cb918-3"><a href="bonus-8a.html#cb918-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb918-4"><a href="bonus-8a.html#cb918-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create object &#39;myData&#39; in a single step from &#39;rds&#39; file:</span></span>
<span id="cb918-5"><a href="bonus-8a.html#cb918-5" aria-hidden="true" tabindex="-1"></a>myData <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.rds&quot;</span>))</span>
<span id="cb918-6"><a href="bonus-8a.html#cb918-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb918-7"><a href="bonus-8a.html#cb918-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Two steps when importing &#39;RData&#39;: first, load the stored object:</span></span>
<span id="cb918-8"><a href="bonus-8a.html#cb918-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.RData&quot;</span>)) </span>
<span id="cb918-9"><a href="bonus-8a.html#cb918-9" aria-hidden="true" tabindex="-1"></a><span class="co"># then assign to the new object &#39;myData&#39;:</span></span>
<span id="cb918-10"><a href="bonus-8a.html#cb918-10" aria-hidden="true" tabindex="-1"></a>myData <span class="ot">&lt;-</span> gen</span></code></pre></div>
<p>Note that when you use <code>load</code>, the object name is NOT taken from the file name! This means that you may not know what object you are loading, if the object and file names are different.</p>
<p>Let’s test this. Here we save the object ‘gen’ in file ‘gen2.RData,’ then load it.</p>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="bonus-8a.html#cb919-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export &#39;gen&#39; to a file with a different name &#39;gen2.RData&#39;:</span></span>
<span id="cb919-2"><a href="bonus-8a.html#cb919-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(gen, <span class="at">file=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen2.RData&quot;</span>))</span>
<span id="cb919-3"><a href="bonus-8a.html#cb919-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gen)</span>
<span id="cb919-4"><a href="bonus-8a.html#cb919-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb919-5"><a href="bonus-8a.html#cb919-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load:</span></span>
<span id="cb919-6"><a href="bonus-8a.html#cb919-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen2.RData&quot;</span>)) </span>
<span id="cb919-7"><a href="bonus-8a.html#cb919-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb919-8"><a href="bonus-8a.html#cb919-8" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the name of the loaded object?</span></span>
<span id="cb919-9"><a href="bonus-8a.html#cb919-9" aria-hidden="true" tabindex="-1"></a><span class="fu">exists</span>(<span class="st">&quot;gen&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="bonus-8a.html#cb921-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exists</span>(<span class="st">&quot;gen2&quot;</span>)</span></code></pre></div>
=======
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="bonus-8a.html#cb925-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s delete any copy of &#39;gen&#39; from the workspace:</span></span>
<span id="cb925-2"><a href="bonus-8a.html#cb925-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gen)</span>
<span id="cb925-3"><a href="bonus-8a.html#cb925-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb925-4"><a href="bonus-8a.html#cb925-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create object &#39;myData&#39; in a single step from &#39;rds&#39; file:</span></span>
<span id="cb925-5"><a href="bonus-8a.html#cb925-5" aria-hidden="true" tabindex="-1"></a>myData <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.rds&quot;</span>))</span>
<span id="cb925-6"><a href="bonus-8a.html#cb925-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb925-7"><a href="bonus-8a.html#cb925-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Two steps when importing &#39;RData&#39;: first, load the stored object:</span></span>
<span id="cb925-8"><a href="bonus-8a.html#cb925-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen.RData&quot;</span>)) </span>
<span id="cb925-9"><a href="bonus-8a.html#cb925-9" aria-hidden="true" tabindex="-1"></a><span class="co"># then assign to the new object &#39;myData&#39;:</span></span>
<span id="cb925-10"><a href="bonus-8a.html#cb925-10" aria-hidden="true" tabindex="-1"></a>myData <span class="ot">&lt;-</span> gen</span></code></pre></div>
<p>Note that when you use <code>load</code>, the object name is NOT taken from the file name! This means that you may not know what object you are loading, if the object and file names are different.</p>
<p>Let’s test this. Here we save the object ‘gen’ in file ‘gen2.RData,’ then load it.</p>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="bonus-8a.html#cb926-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export &#39;gen&#39; to a file with a different name &#39;gen2.RData&#39;:</span></span>
<span id="cb926-2"><a href="bonus-8a.html#cb926-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(gen, <span class="at">file=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen2.RData&quot;</span>))</span>
<span id="cb926-3"><a href="bonus-8a.html#cb926-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gen)</span>
<span id="cb926-4"><a href="bonus-8a.html#cb926-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb926-5"><a href="bonus-8a.html#cb926-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load:</span></span>
<span id="cb926-6"><a href="bonus-8a.html#cb926-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output&quot;</span>, <span class="st">&quot;gen2.RData&quot;</span>)) </span>
<span id="cb926-7"><a href="bonus-8a.html#cb926-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb926-8"><a href="bonus-8a.html#cb926-8" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the name of the loaded object?</span></span>
<span id="cb926-9"><a href="bonus-8a.html#cb926-9" aria-hidden="true" tabindex="-1"></a><span class="fu">exists</span>(<span class="st">&quot;gen&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="bonus-8a.html#cb928-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exists</span>(<span class="st">&quot;gen2&quot;</span>)</span></code></pre></div>
>>>>>>> main
<pre><code>## [1] FALSE</code></pre>
<p>We see that an object ‘gen’ exists (TRUE), but an object ‘gen2’ does not exist (FALSE). The name of the loaded object is thus ‘gen.’</p>
</div>
<div id="d.-should-you-save-your-r-workspace" class="section level4">
<h4>d. Should you save your R workspace?</h4>
<p>When you close RStudio, you may be asked whether you want to save your workspace. What happens when you do this, and should you do so?</p>
<ul>
<li>When you save your workspace, all objects from the workspace are saved in one binary file ‘.RData’ (unless you provide a name, like ‘myWorkspace.Rdata’).</li>
<li>This may result in a large file!</li>
<li>There are other downsides: you may accidentally overwrite an object. And your code will not be portable because it depends on a copy of the workspace.</li>
<li>The general recommendation is to NOT save your workspace, but save your dataset and your R scripts (or Notebooks). This means that you can always recreate all the objects needed.</li>
</ul>
<p>Also, in the vein of reproducible research, do not save multiple copies of your data set. Instead:</p>
<ul>
<li>Save the raw data (with the original file name and extension, e.g. if you downloaded it from the internet - this will help identify the source)</li>
<li>Save all the data manipulation steps (such as checking for errors, excluding rows, recoding variables, etc.) in an R Notebook and document them (what you are doing, why and when).</li>
<li>Save the ‘clean’ dataset (result from data manipulation), preferably as a binary file (especially if it is large). Keep only one copy (you can always recreate it).</li>
<li>Save your data analysis in another R Notebook (or multiple) that starts with importing the ‘clean’ dataset. If your code runs quickly, this is sufficient to recreate your results.</li>
<li>If your code takes a lot of computation time, you may want to export the results (see above).</li>
<li>Backup your data and scripts (R Notebooks)!</li>
<li>Use version control for your script (R Notebooks)! See Chapter 0 video ‘Version Control 101.’ The simplest is to include version numbers in the file name: ‘myNotebook_v7.Rmd.’ A better way is to use e.g. GitHub.</li>
</ul>
</div>
<div id="e.-compile-your-functions" class="section level4">
<h4>e. Compile your functions</h4>
<p>A recommended way of keeping your code tidy is to write functions for anything you will do more than once.</p>
<ul>
<li>Collect your functions in a separate file (R script), e.g. <code>myFunctions.R</code>.</li>
<li>At the beginning of your R Notebook, source the R script with the functions with <code>source("myFunctions.R")</code>.</li>
<li>This will make your code much shorter and thus easier to read.</li>
<li>If you need to change some code inside your function, you only have to change it in one place, hence there is less risk of mistakes.</li>
<li>Use some kind of version control for your functions file so that you can go back to an older version, and you always know which is the current version.</li>
</ul>
<p>To further speed up your code, you can compile your function with ‘cmpfun’:</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="bonus-8a.html#cb923-1" aria-hidden="true" tabindex="-1"></a>myFunction <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb923-2"><a href="bonus-8a.html#cb923-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>))<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb923-3"><a href="bonus-8a.html#cb923-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb923-4"><a href="bonus-8a.html#cb923-4" aria-hidden="true" tabindex="-1"></a>myFunction.cmp <span class="ot">&lt;-</span> compiler<span class="sc">::</span><span class="fu">cmpfun</span>(myFunction)</span>
<span id="cb923-5"><a href="bonus-8a.html#cb923-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb923-6"><a href="bonus-8a.html#cb923-6" aria-hidden="true" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(<span class="fu">myFunction</span>(), <span class="fu">myFunction.cmp</span>())</span></code></pre></div>
<pre><code>## Unit: microseconds
##              expr  min    lq   mean median    uq    max neval cld
##      myFunction() 58.4 59.35 76.885   60.1 60.90 1551.9   100   a
##  myFunction.cmp() 58.4 59.20 61.263   60.0 61.15   90.5   100   a</code></pre>
=======
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="bonus-8a.html#cb930-1" aria-hidden="true" tabindex="-1"></a>myFunction <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb930-2"><a href="bonus-8a.html#cb930-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>))<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb930-3"><a href="bonus-8a.html#cb930-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb930-4"><a href="bonus-8a.html#cb930-4" aria-hidden="true" tabindex="-1"></a>myFunction.cmp <span class="ot">&lt;-</span> compiler<span class="sc">::</span><span class="fu">cmpfun</span>(myFunction)</span>
<span id="cb930-5"><a href="bonus-8a.html#cb930-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb930-6"><a href="bonus-8a.html#cb930-6" aria-hidden="true" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(<span class="fu">myFunction</span>(), <span class="fu">myFunction.cmp</span>())</span></code></pre></div>
<pre><code>## Unit: microseconds
##              expr  min    lq   mean median    uq    max neval cld
##      myFunction() 53.2 54.75 75.878   58.1 61.60 1716.9   100   a
##  myFunction.cmp() 53.2 54.30 58.098   56.8 60.85   78.2   100   a</code></pre>
>>>>>>> main
<p><strong>Question</strong>: Which of the following times are most different between the uncompiled and the compiled versions of this simple function?</p>
<ul>
<li><strong>min</strong>: minimum time across ‘neval’ replicates</li>
<li><strong>Quartiles</strong>: ‘lq’ = lower quartile (25%), ‘median,’ ‘uq’ = upper quartile (75%)</li>
<li><strong>mean</strong>: mean time across ‘neval’ replicates</li>
<li><strong>max</strong>: maximum time across ‘neval’ replicates</li>
</ul>
<p>In this case, compiling mainly reduced the duration of the longest 25% runs (with longer times than the 75% quartile), which brought down the mean processing time.</p>
</div>
</div>
<div id="profiling-your-code" class="section level3">
<h3>4. Profiling your code</h3>
<div id="a.-named-chunks" class="section level4">
<h4>a. Named chunks</h4>
<p>An simple way to identify parts of your code that may be slow is to:</p>
<ul>
<li>Name each chunk in your R Notebook</li>
<li>Knit the notebook</li>
<li>Monitor the R markdown pane while the notebook is knitted: which chunks seem to take a lot of time?</li>
</ul>
<p>To name a chunk, click on the wheel symbol at the top right of the grey chunk area and enter a one-word name.</p>
<p>Here’s an example of a named chunk: the name ‘myChunkName’ has been added in the curly brackets <code>{r, myChunkName}</code>. You can add a name manually in the same way.</p>
<p>More generally, this is where chunk options are added in the R Notebook. Here’s a long list of chunk options: <a href="https://yihui.name/knitr/options/" class="uri">https://yihui.name/knitr/options/</a></p>
</div>
<div id="b.-profiling-some-lines-of-code-with-profvis" class="section level4">
<h4>b. Profiling some lines of code with ‘profvis’</h4>
<p>With the <code>profvis</code> package (from CRAN), we can provide code as an argument to the <code>profvis</code> function. Within the round brackets <code>profvis()</code>, use curly brackets to allow for multiple lines of code: <code>profvis({ })</code></p>
<p>Note: here we use the chunk option ‘include=FALSE’ to suppress the output (figures created by the code), we only want to get the profile for the code.</p>
<p>The results will be opened in a ‘Profile’ tab. The upper part has again two tabs (the lower part is less intuitive to interpret, we’ll ignore it here):</p>
<ul>
<li><strong>Flame Graph</strong>: this plots horizontal bars indicating the amount of memory and time used by each line of code, in the original order of the code.</li>
<li><strong>Data</strong>: code is sorted by resource use, with the most ‘costly’ line <code>qqnorm</code> at the top of the list. You can click on the triangle before each line to see more detail.</li>
</ul>
<p>The results may depend on the speed of your computer. With my machine, I get a value of 20 for <code>hist</code> and another 30 for <code>qqnorm</code>, but nothing for the other lines. Check the sample interval at the bottom of the ‘Profile’ tab: time was estimated by observing every 10 milliseconds what the computer was doing. The other lines must have been too fast to be recorded.</p>
<p>RStudio has a built-in menu for profiling that does the same thing. Check it out:</p>
<ul>
<li>Select the four lines of code above, from <code>x &lt;- rnorm(100)</code> until <code>qqnorm(x)</code></li>
<li>In RStudio’s menu, click on ‘Profile’ &gt; ‘Profile Selected Line(s).’</li>
</ul>
</div>
<div id="c.-profiling-an-r-script-with-profvis" class="section level4">
<h4>c. Profiling an R script with ‘profvis’</h4>
<p>The function <code>profvis</code> can also profile an entire R script. To try this, let’s first create a small R script with the four lines of code that we profiled above.</p>
<p>Note: Obviously, what we do here is not a recommended way of creating and saving an R script. Normally, you would write the code directly into a script file in the ‘Source’ tab in RStudio and save it with menu commands.</p>
<ul>
<li>We open a file connection, and as the file does not exist yet, it will be created.</li>
<li>We use a relative path to save the file in the ‘output’ folder in the workspace.</li>
<li>With <code>writeLines</code>, we write each line into the file, but we need to wrap each line in quotes.</li>
<li>Then we close the file connection.</li>
<li>Finally, we use <code>file.show</code> to show the file in a tab.</li>
</ul>
<p>Note: An ‘output’ folder should have been created already when you accessed this worked example with the Addin. We are not creating the folder with ‘dir.create’ because this would not work when knitting the R Notebook.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="bonus-8a.html#cb925-1" aria-hidden="true" tabindex="-1"></a>myPath <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output/myScript.R&quot;</span>)</span>
<span id="cb925-2"><a href="bonus-8a.html#cb925-2" aria-hidden="true" tabindex="-1"></a>fileConn <span class="ot">&lt;-</span> <span class="fu">file</span>(myPath)</span>
<span id="cb925-3"><a href="bonus-8a.html#cb925-3" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">c</span>(<span class="st">&quot;x &lt;- rnorm(100)&quot;</span>,</span>
<span id="cb925-4"><a href="bonus-8a.html#cb925-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;mean(x)&quot;</span>,</span>
<span id="cb925-5"><a href="bonus-8a.html#cb925-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;hist(x)&quot;</span>,</span>
<span id="cb925-6"><a href="bonus-8a.html#cb925-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;qqnorm(x)&quot;</span>), fileConn)</span>
<span id="cb925-7"><a href="bonus-8a.html#cb925-7" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(fileConn)</span>
<span id="cb925-8"><a href="bonus-8a.html#cb925-8" aria-hidden="true" tabindex="-1"></a><span class="fu">file.show</span>(myPath)</span></code></pre></div>
<p>Check the tab ‘R Information,’ which should now display the content of the file ‘myScript.R.’ Are the quotes still there?</p>
<p>Now we can pass the file to <code>profvis</code>:</p>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="bonus-8a.html#cb926-1" aria-hidden="true" tabindex="-1"></a>profvis<span class="sc">::</span><span class="fu">profvis</span>(<span class="fu">source</span>(myPath))</span></code></pre></div>
<p><img src="08-Week08_files/figure-html/profvis2-1.png" width="672" /><img src="08-Week08_files/figure-html/profvis2-2.png" width="672" /></p>
<div id="htmlwidget-33de65d5df039931a737" style="width:100%;height:600px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-33de65d5df039931a737">{"x":{"message":{"prof":{"time":[1,1,2,2,3,3],"depth":[2,1,2,1,2,1],"label":[".External2","local",".External2","local",".External2","local"],"filenum":[null,null,null,null,null,null],"linenum":[null,null,null,null,null,null],"memalloc":[140.066177368164,140.066177368164,140.066177368164,140.066177368164,140.066177368164,140.066177368164],"meminc":[0,0,0,0,0,0],"filename":[null,null,null,null,null,null]},"interval":10,"files":[],"prof_output":"C:\\Users\\wagnerh1\\AppData\\Local\\Temp\\1\\RtmpgzAEI0\\file262c70fd2ef0.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
=======
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="bonus-8a.html#cb932-1" aria-hidden="true" tabindex="-1"></a>myPath <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output/myScript.R&quot;</span>)</span>
<span id="cb932-2"><a href="bonus-8a.html#cb932-2" aria-hidden="true" tabindex="-1"></a>fileConn <span class="ot">&lt;-</span> <span class="fu">file</span>(myPath)</span>
<span id="cb932-3"><a href="bonus-8a.html#cb932-3" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">c</span>(<span class="st">&quot;x &lt;- rnorm(100)&quot;</span>,</span>
<span id="cb932-4"><a href="bonus-8a.html#cb932-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;mean(x)&quot;</span>,</span>
<span id="cb932-5"><a href="bonus-8a.html#cb932-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;hist(x)&quot;</span>,</span>
<span id="cb932-6"><a href="bonus-8a.html#cb932-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;qqnorm(x)&quot;</span>), fileConn)</span>
<span id="cb932-7"><a href="bonus-8a.html#cb932-7" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(fileConn)</span>
<span id="cb932-8"><a href="bonus-8a.html#cb932-8" aria-hidden="true" tabindex="-1"></a><span class="fu">file.show</span>(myPath)</span></code></pre></div>
<p>Check the tab ‘R Information,’ which should now display the content of the file ‘myScript.R.’ Are the quotes still there?</p>
<p>Now we can pass the file to <code>profvis</code>:</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="bonus-8a.html#cb933-1" aria-hidden="true" tabindex="-1"></a>profvis<span class="sc">::</span><span class="fu">profvis</span>(<span class="fu">source</span>(myPath))</span></code></pre></div>
<p><img src="08-Week08_files/figure-html/profvis2-1.png" width="672" /><img src="08-Week08_files/figure-html/profvis2-2.png" width="672" /></p>
<div id="htmlwidget-33de65d5df039931a737" style="width:100%;height:600px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-33de65d5df039931a737">{"x":{"message":{"prof":{"time":[1,1,1,1,1,1,2,2,3,3],"depth":[6,5,4,3,2,1,2,1,2,1],"label":["tryCatch","profvis::profvis","eval","eval","eval.parent","local",".External2","local",".External2","local"],"filenum":[null,null,null,null,null,null,null,null,null,null],"linenum":[null,null,null,null,null,null,null,null,null,null],"memalloc":[139.725494384766,139.725494384766,139.725494384766,139.725494384766,139.725494384766,139.725494384766,140.066093444824,140.066093444824,140.066093444824,140.066093444824],"meminc":[0,0,0,0,0,0,0.340599060058594,0,0,0],"filename":[null,null,null,null,null,null,null,null,null,null]},"interval":10,"files":[],"prof_output":"C:\\Users\\wagnerh1\\AppData\\Local\\Temp\\1\\RtmpyWiLrl\\file5a0538b46.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
>>>>>>> main
<ul>
<li>The ‘Flame Graph’ should look the same as before.</li>
<li>The content of the ‘Data’ tab is different. Click on the triangle before ‘source’ to navigate to: ‘source’ &gt; ‘withVisible’ &gt; ‘eval’ &gt; ‘eval.’</li>
<li>That’s where the actual lines of code are profiled.</li>
</ul>
</div>
<div id="d.-converting-an-r-notebook-to-an-r-script" class="section level4">
<h4>d. Converting an R Notebook to an R script</h4>
<p>Unfortunately, we can’t profile an entire R Notebook (as far as I know). However, we can extract the R code as a script file, then profile the script file.</p>
<p>The file ‘myNotebook.Rmd’ contains the same R code as our file ‘myScript.R,’ but in the format of an R Notebook, with R markdown text (e.g. titles) and several chunks of code.</p>
<p>Note: With ‘file.show,’ the Notebook is opened with a simple text editor (without the coloring etc.). Alternatively, you could run ‘file.edit’ to open it with the familiar RStudio editor.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="bonus-8a.html#cb927-1" aria-hidden="true" tabindex="-1"></a>inFile <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;myNotebook.Rmd&quot;</span>, <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>)</span>
<span id="cb927-2"><a href="bonus-8a.html#cb927-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file.show</span>(inFile)</span>
<span id="cb927-3"><a href="bonus-8a.html#cb927-3" aria-hidden="true" tabindex="-1"></a><span class="co">#file.edit(inFile)</span></span></code></pre></div>
<p>We can use the function ‘purl’ from the ‘knitr’ package to extract the R code from the R Notebook file ‘myNotebook.Rmd’:</p>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="bonus-8a.html#cb928-1" aria-hidden="true" tabindex="-1"></a>outFile <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output/myNotebook.R&quot;</span>)</span>
<span id="cb928-2"><a href="bonus-8a.html#cb928-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">purl</span>(inFile, <span class="at">output=</span>outFile, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/Desktop/LandGenCourse_book/output/myNotebook.R&quot;</code></pre>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="bonus-8a.html#cb930-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.show</span>(outFile)</span></code></pre></div>
=======
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="bonus-8a.html#cb934-1" aria-hidden="true" tabindex="-1"></a>inFile <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;myNotebook.Rmd&quot;</span>, <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>)</span>
<span id="cb934-2"><a href="bonus-8a.html#cb934-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file.show</span>(inFile)</span>
<span id="cb934-3"><a href="bonus-8a.html#cb934-3" aria-hidden="true" tabindex="-1"></a><span class="co">#file.edit(inFile)</span></span></code></pre></div>
<p>We can use the function ‘purl’ from the ‘knitr’ package to extract the R code from the R Notebook file ‘myNotebook.Rmd’:</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="bonus-8a.html#cb935-1" aria-hidden="true" tabindex="-1"></a>outFile <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output/myNotebook.R&quot;</span>)</span>
<span id="cb935-2"><a href="bonus-8a.html#cb935-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">purl</span>(inFile, <span class="at">output=</span>outFile, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/wagnerh1/Desktop/LandGenCourse_book/output/myNotebook.R&quot;</code></pre>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="bonus-8a.html#cb937-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.show</span>(outFile)</span></code></pre></div>
>>>>>>> main
<p><strong>Question</strong>: Compare the two files (they should be open, check the tabs of the source pane).</p>
<ul>
<li>How are the chunks from the Notebook file divided in the new script file?</li>
<li>What happened to the titles and text?</li>
<li>What about the header information?</li>
</ul>
<p>Now we can pass the file to `profvis’:</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="bonus-8a.html#cb931-1" aria-hidden="true" tabindex="-1"></a>profvis<span class="sc">::</span><span class="fu">profvis</span>(<span class="fu">source</span>(outFile), <span class="at">prof_output=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output/output.prof&quot;</span>))</span></code></pre></div>
=======
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="bonus-8a.html#cb938-1" aria-hidden="true" tabindex="-1"></a>profvis<span class="sc">::</span><span class="fu">profvis</span>(<span class="fu">source</span>(outFile), <span class="at">prof_output=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;/output/output.prof&quot;</span>))</span></code></pre></div>
>>>>>>> main
<pre><code>## profvis: code exited with error:
## C:/Users/wagnerh1/Desktop/LandGenCourse_book/output/myNotebook.R:8:6: unexpected symbol
## 7: 
## 8: This file
##         ^</code></pre>
<div id="htmlwidget-7ece7cccec775b3a474d" style="width:100%;height:600px;" class="profvis html-widget"></div>
<<<<<<< HEAD
<script type="application/json" data-for="htmlwidget-7ece7cccec775b3a474d">{"x":{"message":{"prof":{"time":[1,1,1,1,1],"depth":[5,4,3,2,1],"label":["profvis::profvis","eval","eval","eval.parent","local"],"filenum":[null,null,null,null,null],"linenum":[null,null,null,null,null],"memalloc":[139.793006896973,139.793006896973,139.793006896973,139.793006896973,139.793006896973],"meminc":[0,0,0,0,0],"filename":[null,null,null,null,null]},"interval":10,"files":[],"prof_output":"C:/Users/wagnerh1/Desktop/LandGenCourse_book/output/output.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
=======
<script type="application/json" data-for="htmlwidget-7ece7cccec775b3a474d">{"x":{"message":{"prof":{"time":[1,1,1,1,1],"depth":[5,4,3,2,1],"label":["profvis::profvis","eval","eval","eval.parent","local"],"filenum":[null,null,null,null,null],"linenum":[null,null,null,null,null],"memalloc":[139.793182373047,139.793182373047,139.793182373047,139.793182373047,139.793182373047],"meminc":[0,0,0,0,0],"filename":[null,null,null,null,null]},"interval":10,"files":[],"prof_output":"C:/Users/wagnerh1/Desktop/LandGenCourse_book//output/output.prof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
>>>>>>> main
<p><strong>Question</strong>: Which lines of code took the longest to run in this example?</p>
</div>
</div>
<div id="creating-and-executing-a-bash-r-script" class="section level3">
<h3>5. Creating and executing a Bash R script</h3>
<div id="a.-run-r-script-directly-in-the-terminal" class="section level4">
<h4>a. Run R script directly in the Terminal</h4>
<p>Now that we have a stand-alone R script ‘myScript.R,’ we can run it from the command line in the terminal (shell). After navigating to the correct folder, type:</p>
<p><code>Rscript myScript.R</code></p>
<p>This will source the file and execute the R code.</p>
<ul>
<li>Numerical output will be printed in the termminal. Here, a random number should be returned.</li>
<li>Best include code in your R script to export any R objects, data tables or figures that you want to retain. These will be saved in the same folder as the R script (unless you specify file paths).</li>
</ul>
</div>
<div id="b.-create-a-bash-r-script" class="section level4">
<h4>b. Create a Bash R script</h4>
<p>If you want to run your code on a node or cluster, you may need to take this one step further and include the R code in a bash Rscript. In a bash script, you can add bash commands that govern resource use to submit a job to a node or cluster. Bash scripts are the way of giving instructions to the scheduler of the cluster (e.g. SLURM) for how to manage input and output files.</p>
<p>To execute our R script ‘myScript.R’ as a Bash script, we need to add a few lines.</p>
<ul>
<li>The ‘shebang’ line <code>#!/bin/bash</code> that tells the computer that this is a Bash script, and where to find Bash. Note that here the hashtag symbol does NOT mean that the line is commented out (this line is Unix code, not R code).</li>
<li>The line <code>R --slave &lt;&lt; EOF</code> that declares the rest of the file (until <code>EOF</code>) as R code.</li>
<li>The end of file <code>EOF</code> marker.</li>
</ul>
<p>Let’s modify the previous code and write it into a Bash file. As an additional challenge, our code contains two figures, which won’t be written anywhere unless we change the code to write them into a file:</p>
<ul>
<li>We create a graphics file ‘my_plot.png’ that is 800 pixels wide and 400 pixels high.</li>
<li>With <code>par(mfrow=c(1,2))</code>, we specify that the two plots should be plotted side-by-side. Then we create the plots.</li>
<li>We close the graphics device (png file) with <code>dev.off</code>.</li>
</ul>
<p>Note: We use single quotes for the file name here, ‘my_plot.png,’ as they are nested within a set of double quotes. R pretty much considers single and double quotes as synonyms, which allows us to nest them either way: ‘"“’ or”’’".</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="bonus-8a.html#cb933-1" aria-hidden="true" tabindex="-1"></a>myPath <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output/myBashScript.sh&quot;</span>)</span>
<span id="cb933-2"><a href="bonus-8a.html#cb933-2" aria-hidden="true" tabindex="-1"></a>fileConn <span class="ot">&lt;-</span> <span class="fu">file</span>(myPath)</span>
<span id="cb933-3"><a href="bonus-8a.html#cb933-3" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">c</span>(<span class="st">&quot;#!/bin/bash&quot;</span>,</span>
<span id="cb933-4"><a href="bonus-8a.html#cb933-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;R --slave &lt;&lt; EOF&quot;</span>,</span>
<span id="cb933-5"><a href="bonus-8a.html#cb933-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;x &lt;- rnorm(100)&quot;</span>,</span>
<span id="cb933-6"><a href="bonus-8a.html#cb933-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;mean(x)&quot;</span>,</span>
<span id="cb933-7"><a href="bonus-8a.html#cb933-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;png(&#39;my_plot.png&#39;, height = 400, width = 800)&quot;</span>,</span>
<span id="cb933-8"><a href="bonus-8a.html#cb933-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;par(mfrow=c(1,2))&quot;</span>, </span>
<span id="cb933-9"><a href="bonus-8a.html#cb933-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;hist(x)&quot;</span>, </span>
<span id="cb933-10"><a href="bonus-8a.html#cb933-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;qqnorm(x)&quot;</span>,</span>
<span id="cb933-11"><a href="bonus-8a.html#cb933-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;dev.off()&quot;</span>,</span>
<span id="cb933-12"><a href="bonus-8a.html#cb933-12" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;EOF&quot;</span>), fileConn)</span>
<span id="cb933-13"><a href="bonus-8a.html#cb933-13" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(fileConn)</span>
<span id="cb933-14"><a href="bonus-8a.html#cb933-14" aria-hidden="true" tabindex="-1"></a><span class="fu">file.show</span>(myPath)</span></code></pre></div>
=======
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="bonus-8a.html#cb940-1" aria-hidden="true" tabindex="-1"></a>myPath <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output/myBashScript.sh&quot;</span>)</span>
<span id="cb940-2"><a href="bonus-8a.html#cb940-2" aria-hidden="true" tabindex="-1"></a>fileConn <span class="ot">&lt;-</span> <span class="fu">file</span>(myPath)</span>
<span id="cb940-3"><a href="bonus-8a.html#cb940-3" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">c</span>(<span class="st">&quot;#!/bin/bash&quot;</span>,</span>
<span id="cb940-4"><a href="bonus-8a.html#cb940-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;R --slave &lt;&lt; EOF&quot;</span>,</span>
<span id="cb940-5"><a href="bonus-8a.html#cb940-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;x &lt;- rnorm(100)&quot;</span>,</span>
<span id="cb940-6"><a href="bonus-8a.html#cb940-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;mean(x)&quot;</span>,</span>
<span id="cb940-7"><a href="bonus-8a.html#cb940-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;png(&#39;my_plot.png&#39;, height = 400, width = 800)&quot;</span>,</span>
<span id="cb940-8"><a href="bonus-8a.html#cb940-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;par(mfrow=c(1,2))&quot;</span>, </span>
<span id="cb940-9"><a href="bonus-8a.html#cb940-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;hist(x)&quot;</span>, </span>
<span id="cb940-10"><a href="bonus-8a.html#cb940-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;qqnorm(x)&quot;</span>,</span>
<span id="cb940-11"><a href="bonus-8a.html#cb940-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;dev.off()&quot;</span>,</span>
<span id="cb940-12"><a href="bonus-8a.html#cb940-12" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;EOF&quot;</span>), fileConn)</span>
<span id="cb940-13"><a href="bonus-8a.html#cb940-13" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(fileConn)</span>
<span id="cb940-14"><a href="bonus-8a.html#cb940-14" aria-hidden="true" tabindex="-1"></a><span class="fu">file.show</span>(myPath)</span></code></pre></div>
>>>>>>> main
</div>
<div id="c.-executing-a-bash-r-script" class="section level4">
<h4>c. Executing a Bash R script</h4>
<p>On Mac / Unix / Linux, this is straight-forward:</p>
<ol style="list-style-type: decimal">
<li><strong>Open terminal</strong>:
<ul>
<li>From the RStudio menu, select ‘Tools’ &gt; ‘Terminal’ &gt; ‘New Terminal.’ This will open an Terminal tab in RStudio. Alternatively, you could select ‘Tools’ &gt; ‘Shell’ to open a Shell in a new window outside RStudio.</li>
<li>Check the prompt: it should start with the name of your computer, then a colon, then the name of your project folder, then your use name followed ‘$.’</li>
</ul></li>
<li><strong>Navigate to Bash file</strong>:
<ul>
<li>Enter <code>ls</code> to list the content of the project folder.</li>
<li>Enter <code>cd output</code> to change directory to the subfolder ‘output.’</li>
<li>Repeat <code>ls</code> to list the content of the ‘output’ folder. The Bash script ‘myBashScript.sh’ should be listed there.</li>
</ul></li>
<li><strong>Execute Bash file</strong>:
<ul>
<li>Enter <code>chmod +x myBashScript.sh</code> to change file permission for the script.</li>
<li>Enter <code>./myBashScript.sh</code> to execute the script.</li>
</ul></li>
<li><strong>Find output</strong>:
<ul>
<li>The output from <code>mean(x)</code> is printed in the terminal, it should look like this: <code>[1] -0.07731751</code>.</li>
<li>This is followed ‘null device’ and the number 1, which tells us that a graphics device has been closed.</li>
<li>Enter <code>ls</code> to list the content of the project folder. The graphics file ‘my_plot.png’ should now be listed.</li>
</ul></li>
</ol>
<p>Use R again to open the graphics file (the code here first checks whether the file exists):</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="bonus-8a.html#cb934-1" aria-hidden="true" tabindex="-1"></a>myPNG <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output/my_plot.png&quot;</span>)</span>
<span id="cb934-2"><a href="bonus-8a.html#cb934-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">file.exists</span>(myPNG))</span>
<span id="cb934-3"><a href="bonus-8a.html#cb934-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb934-4"><a href="bonus-8a.html#cb934-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.show</span>(myPNG)</span>
<span id="cb934-5"><a href="bonus-8a.html#cb934-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
=======
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="bonus-8a.html#cb941-1" aria-hidden="true" tabindex="-1"></a>myPNG <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;output/my_plot.png&quot;</span>)</span>
<span id="cb941-2"><a href="bonus-8a.html#cb941-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">file.exists</span>(myPNG))</span>
<span id="cb941-3"><a href="bonus-8a.html#cb941-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb941-4"><a href="bonus-8a.html#cb941-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.show</span>(myPNG)</span>
<span id="cb941-5"><a href="bonus-8a.html#cb941-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
>>>>>>> main
</div>
<div id="d.-moving-to-a-node-or-cluster" class="section level4">
<h4>d. Moving to a node or cluster?</h4>
<p>The example bash file and advice in this section have been provided by Hossam Abdel Moniem, thanks!</p>
<p>Here’s an annotated example of a bash file that contains instructions for submitting a job to a single node (a single machine with multiple/many cores).</p>
<p>Note: A copy of the file ‘BashExample.sh’ should also have been copied into the downloads folder inside your project folder.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="bonus-8a.html#cb935-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">readLines</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;BashExample.sh&quot;</span>, <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>)))</span></code></pre></div>
=======
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="bonus-8a.html#cb942-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">readLines</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;BashExample.sh&quot;</span>, <span class="at">package =</span> <span class="st">&quot;LandGenCourse&quot;</span>)))</span></code></pre></div>
>>>>>>> main
<pre><code>## #!/bin/bash 
## 
## #SBATCH --nodes=1                                 # Number of Nodes 
## #SBATCH --mail-type=ALL                           # Mail events (NONE, BEGIN, END, FAIL, ALL)
## #SBATCH --mail-user=myEmail@gmail.com             # Where to send mail
## #SBATCH --ntasks=1                                # Run a single task
## #SBATCH --cpus-per-task=24                        # Number of CPU cores per task
## #SBATCH --mem-per-cpu=8000             # allocated memory for the task
## #SBATCH -p nodename                # name of cluster node
## #SBATCH --requeue                                 # Allow the job to be requeued
## #SBATCH -e myJob.err                   # File to which STDERR will be written 
## #SBATCH -o myJob.out                   # File to which STDOUT will be written 
## #SBATCH -J myJob                   # Job name 
## 
## module load R/MS3.4.1                  # call a preinstalled module(program) on the cluster
## 
## Rscript connect_calc_25.R              # Run the R script in bash 
## </code></pre>
<p>Instead of including the R code directly in the bash file, the last line here executes an R script with the <code>Rscript</code> command.</p>
<p>Notice the second-last line. Obviously, on the node, R and any relevant packages need to be pre-installed. Different users may need different configurations (different packages or versions) installed, hence each installation has a name, which needs to be specified in the bash script.</p>
<p>Note: Make sure that all packages that you need (and their dependencies), as well as the package <code>unixtools</code>, have been installed on the node or cluster (i.e., they are part of the installation you will be using). Install <code>unixtools</code> with: <code>install.packages("unixtools",,"http://rforge.net/")</code></p>
<p>Further reading:</p>
<ul>
<li>Bash script tutorial: <a href="https://ryanstutorials.net/bash-scripting-tutorial/" class="uri">https://ryanstutorials.net/bash-scripting-tutorial/</a></li>
<li>Scheduling a job with SLURM commands: <a href="https://www.rc.fas.harvard.edu/resources/documentation/convenient-slurm-commands/" class="uri">https://www.rc.fas.harvard.edu/resources/documentation/convenient-slurm-commands/</a></li>
</ul>
</div>
<div id="e.-store-your-session-info-and-package-versions" class="section level4">
<h4>e. Store your session info and package versions</h4>
<p>If you use any R packages, load them at the beginning of your script file with <code>library</code>. Make sure the packages are installed on the system where you will be running the Bash R script.</p>
<p>A big issue with R is that package updates may make your code break. At least at the end of any project (such as the analyses for a manuscript), save your session information.</p>
<p>Here we use the function <code>session_info</code> from the <code>devtools</code> package (preferred over the R base function <code>sessionInfo</code>). We store the information as an object, ‘Session,’ of class ‘session_info’ that has two list elements:</p>
<ul>
<li><strong>platform</strong>: Information about R version, your computer’s operating system, etc.</li>
<li><strong>packages</strong>: List of all packages, including their version, installation date and repository (CRAN, Github etc.). All packages that are currently loaded will be marked with an asterisk.</li>
</ul>
<p>Platform:</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="bonus-8a.html#cb937-1" aria-hidden="true" tabindex="-1"></a>Session <span class="ot">&lt;-</span> devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb937-2"><a href="bonus-8a.html#cb937-2" aria-hidden="true" tabindex="-1"></a>Session<span class="sc">$</span>platform</span></code></pre></div>
=======
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="bonus-8a.html#cb944-1" aria-hidden="true" tabindex="-1"></a>Session <span class="ot">&lt;-</span> devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb944-2"><a href="bonus-8a.html#cb944-2" aria-hidden="true" tabindex="-1"></a>Session<span class="sc">$</span>platform</span></code></pre></div>
>>>>>>> main
<pre><code>##  setting  value                       
##  version  R version 4.0.5 (2021-03-31)
##  os       Windows 10 x64              
##  system   x86_64, mingw32             
##  ui       RTerm                       
##  language (EN)                        
##  collate  English_United States.1252  
##  ctype    English_United States.1252  
##  tz       America/New_York            
##  date     2021-05-06</code></pre>
<p>Packages: here we display only the first six lines, as the list may be long.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="bonus-8a.html#cb939-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Session<span class="sc">$</span>packages)</span></code></pre></div>
=======
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="bonus-8a.html#cb946-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Session<span class="sc">$</span>packages)</span></code></pre></div>
>>>>>>> main
<pre><code>##  package  * version date       lib source        
##  abind      1.4-5   2016-07-21 [1] CRAN (R 4.0.3)
##  ade4       1.7-16  2020-10-28 [1] CRAN (R 4.0.5)
##  adegenet   2.1.3   2020-05-10 [1] CRAN (R 4.0.5)
##  ape        5.5     2021-04-25 [1] CRAN (R 4.0.5)
##  bitops     1.0-7   2021-04-24 [1] CRAN (R 4.0.5)
##  bookdown   0.22    2021-04-22 [1] CRAN (R 4.0.5)
## 
## [1] C:/Users/wagnerh1/Documents/R/R-4.0.5/library</code></pre>
<p>Exporting the session information is a bit tricky because ‘Session’ is not in tabular format, and what we want to export is the formatted output, not the object itself.</p>
<p>Also, we will add a time stamp to the file name. This achieves two goals: avoid overwriting earlier files, and keep a record of the date of the session information.</p>
<ul>
<li><code>capture.output</code>: captures the output of a function (here: <code>devtools::session_info()</code>)</li>
<li><code>writeLines</code>: writes the captured output into a file, here a text file.</li>
<li><code>Sys.Date</code>: returns the current date. Here we specify the format as “%Y-%m-%d,” i.e., ‘Year-month-day.’</li>
</ul>
<p>More advanced ways for handling the problem of package versions to make sure you can run your code in the future without compatibility issues include:</p>
<ul>
<li>Package ‘packrat’: bundle all your current package version. This can become quite large.</li>
<li>Package ‘checkpoint’: access daily snapshots of CRAN for any given date. Note that checkpoint only covers packages from CRAN, not other repositories like GitHub.</li>
</ul>
<p>More on the topic: <a href="https://timogrossenbacher.ch/2017/07/a-truly-reproducible-r-workflow/" class="uri">https://timogrossenbacher.ch/2017/07/a-truly-reproducible-r-workflow/</a></p>
</div>
<div id="f.-potential-windows-issues" class="section level4">
<h4>f. Potential Windows issues</h4>
<p>Check that Bash is installed and ready to use with RStudio:</p>
<ul>
<li>In the RStudio menu, select ‘Tools’ &gt; ‘Global options’ &gt; ‘Terminal.’</li>
<li>Make sure some form of Bash (e.g., Git Bash) is listed under ‘Shell: New terminals open with:’</li>
</ul>
<p>If this does not work, try installing ‘Git for Windows,’ which will also install Bash: <a href="http://neondataskills.org/setup/setup-git-bash-R" class="uri">http://neondataskills.org/setup/setup-git-bash-R</a></p>
<p>Here’s a detailed multi-part tutorial on running R from the command line, with R scripts and Bash R scripts, with some additional information on Windows:</p>
<ul>
<li><strong>Introduction</strong>: <a href="https://github.com/gastonstat/tutorial-R-noninteractive/blob/master/01-introduction.Rmd" class="uri">https://github.com/gastonstat/tutorial-R-noninteractive/blob/master/01-introduction.Rmd</a></li>
<li><strong>Batch mode</strong>: <a href="https://github.com/gastonstat/tutorial-R-noninteractive/blob/master/02-batch-mode.Rmd" class="uri">https://github.com/gastonstat/tutorial-R-noninteractive/blob/master/02-batch-mode.Rmd</a></li>
<li><strong>Executing R scripts</strong>: <a href="https://github.com/gastonstat/tutorial-R-noninteractive/blob/master/03-rscript.Rmd" class="uri">https://github.com/gastonstat/tutorial-R-noninteractive/blob/master/03-rscript.Rmd</a></li>
<li><strong>Bash R scripts</strong>: <a href="https://github.com/gastonstat/tutorial-R-noninteractive/blob/master/04-shell-script.Rmd" class="uri">https://github.com/gastonstat/tutorial-R-noninteractive/blob/master/04-shell-script.Rmd</a></li>
<li><strong>Redirection</strong>: <a href="https://github.com/gastonstat/tutorial-R-noninteractive/blob/master/05-redirection.Rmd" class="uri">https://github.com/gastonstat/tutorial-R-noninteractive/blob/master/05-redirection.Rmd</a></li>
</ul>
</div>
</div>
<div id="parallelizing-code" class="section level3">
<h3>6. Parallelizing code</h3>
<p>Note that the following issues may create problems when developing Bash R scripts on Windows that you want to run e.g. on a Linux cluster or another Unix-type system;</p>
<ul>
<li>File paths are different, and system files are stored in a different place.</li>
<li>End-of-line symbols are different</li>
</ul>
<div id="a.-replace-lapply-by-mclapply-with-package-parallel" class="section level4">
<h4>a. Replace ‘lapply’ by ‘mclapply’ with package ‘parallel’</h4>
<p>Note: while this will run on a Windows without causing an error, it will only be faster on Mac / Unix.</p>
<p>With the package ‘parallel,’ it is really easy to use all cores of your local machine (as long as you are on a Mac / Unix / Linux system). Let’s check the number of cores available:</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="bonus-8a.html#cb941-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb941-2"><a href="bonus-8a.html#cb941-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detectCores</span>()</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<p><strong>Question</strong>: How many cores does your machine have?</p>
<p>Note: Here we check whether the operating system is ‘Windows,’ in which case we set <code>nCores = 1</code>. This means that we will use all cores on Mac or Linux, but only one core on Windows. This is to avoid problems on Windows machines.</p>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="bonus-8a.html#cb943-1" aria-hidden="true" tabindex="-1"></a>nCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>()</span>
<span id="cb943-2"><a href="bonus-8a.html#cb943-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">Sys.info</span>()[[<span class="st">&#39;sysname&#39;</span>]]<span class="sc">==</span><span class="st">&quot;Windows&quot;</span>) nCores <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb943-3"><a href="bonus-8a.html#cb943-3" aria-hidden="true" tabindex="-1"></a>nCores</span></code></pre></div>
=======
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="bonus-8a.html#cb948-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb948-2"><a href="bonus-8a.html#cb948-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detectCores</span>()</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<p><strong>Question</strong>: How many cores does your machine have?</p>
<p>Note: Here we check whether the operating system is ‘Windows,’ in which case we set <code>nCores = 1</code>. This means that we will use all cores on Mac or Linux, but only one core on Windows. This is to avoid problems on Windows machines.</p>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="bonus-8a.html#cb950-1" aria-hidden="true" tabindex="-1"></a>nCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>()</span>
<span id="cb950-2"><a href="bonus-8a.html#cb950-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">Sys.info</span>()[[<span class="st">&#39;sysname&#39;</span>]]<span class="sc">==</span><span class="st">&quot;Windows&quot;</span>) nCores <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb950-3"><a href="bonus-8a.html#cb950-3" aria-hidden="true" tabindex="-1"></a>nCores</span></code></pre></div>
>>>>>>> main
<pre><code>## [1] 1</code></pre>
<ul>
<li>Code your analysis with <code>lapply</code> (and related functions).</li>
<li>Replace <code>lapply</code> by <code>mclapply</code> (and related functions). Use the argument <code>mc.cores=detectCores()</code> to automatically detect the number of cores in your machine.</li>
</ul>
<p>NOTE: April 2021: package build does not work with multiple cores, changing nCores to 1.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="bonus-8a.html#cb945-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> gen[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb945-2"><a href="bonus-8a.html#cb945-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(x, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb945-3"><a href="bonus-8a.html#cb945-3" aria-hidden="true" tabindex="-1"></a><span class="co">#m2 &lt;- mclapply(x, mean, na.rm=TRUE, mc.cores=nCores)  # Use this line when running the code yourself</span></span>
<span id="cb945-4"><a href="bonus-8a.html#cb945-4" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">mclapply</span>(x, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">mc.cores=</span><span class="dv">1</span>)        <span class="co"># Replace this line with the previous line</span></span></code></pre></div>
=======
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="bonus-8a.html#cb952-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> gen[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb952-2"><a href="bonus-8a.html#cb952-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(x, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb952-3"><a href="bonus-8a.html#cb952-3" aria-hidden="true" tabindex="-1"></a><span class="co">#m2 &lt;- mclapply(x, mean, na.rm=TRUE, mc.cores=nCores)  # Use this line when running the code yourself</span></span>
<span id="cb952-4"><a href="bonus-8a.html#cb952-4" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">mclapply</span>(x, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">mc.cores=</span><span class="dv">1</span>)        <span class="co"># Replace this line with the previous line</span></span></code></pre></div>
>>>>>>> main
<p>Let’s benchmark four ways of calculating the mean of each column in our example data set ‘gen’ with 94 rows and 10,000 columns (SNPs):</p>
<ul>
<li><strong>Method 1</strong>: The dedicated function <code>colMeans</code> from base R.</li>
<li><strong>Method 2</strong>: A <code>for</code> loop.</li>
<li><strong>Method 3</strong>: Vectorization with <code>lapply</code></li>
<li><strong>Method 4</strong>: Multi-core with <code>mclapply</code>.</li>
</ul>
<<<<<<< HEAD
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="bonus-8a.html#cb946-1" aria-hidden="true" tabindex="-1"></a>method1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">colMeans</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>)}</span>
<span id="cb946-2"><a href="bonus-8a.html#cb946-2" aria-hidden="true" tabindex="-1"></a>method2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)) <span class="fu">mean</span>(x[,i], <span class="at">na.rm=</span><span class="cn">TRUE</span>)}</span>
<span id="cb946-3"><a href="bonus-8a.html#cb946-3" aria-hidden="true" tabindex="-1"></a>method3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">lapply</span>(x, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>)}</span>
<span id="cb946-4"><a href="bonus-8a.html#cb946-4" aria-hidden="true" tabindex="-1"></a><span class="co">#method4 &lt;- function(x) {mclapply(x, mean, na.rm=TRUE, mc.cores=nCores)} # Use this line when running the code yourself</span></span>
<span id="cb946-5"><a href="bonus-8a.html#cb946-5" aria-hidden="true" tabindex="-1"></a>method4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">mclapply</span>(x, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">mc.cores=</span><span class="dv">1</span>)}  <span class="co"># Replace this line with the previous line</span></span>
<span id="cb946-6"><a href="bonus-8a.html#cb946-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb946-7"><a href="bonus-8a.html#cb946-7" aria-hidden="true" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(<span class="at">times =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">&quot;ms&quot;</span>,</span>
<span id="cb946-8"><a href="bonus-8a.html#cb946-8" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">method1</span>(x), <span class="fu">method2</span>(x), <span class="fu">method3</span>(x), <span class="fu">method4</span>(x))</span></code></pre></div>
<pre><code>## Unit: milliseconds
##        expr      min       lq      mean   median       uq      max neval cld
##  method1(x)  34.1365  34.2769  40.91901  36.3829  42.5025  63.3001    10  a 
##  method2(x) 144.0516 149.2856 162.87317 158.2103 174.9715 200.6437    10   b
##  method3(x)  31.3999  32.7412  39.26943  36.6563  40.1584  56.9164    10  a 
##  method4(x)  32.6947  33.0409  35.69796  34.2545  37.4404  41.3809    10  a</code></pre>
=======
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="bonus-8a.html#cb953-1" aria-hidden="true" tabindex="-1"></a>method1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">colMeans</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>)}</span>
<span id="cb953-2"><a href="bonus-8a.html#cb953-2" aria-hidden="true" tabindex="-1"></a>method2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)) <span class="fu">mean</span>(x[,i], <span class="at">na.rm=</span><span class="cn">TRUE</span>)}</span>
<span id="cb953-3"><a href="bonus-8a.html#cb953-3" aria-hidden="true" tabindex="-1"></a>method3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">lapply</span>(x, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>)}</span>
<span id="cb953-4"><a href="bonus-8a.html#cb953-4" aria-hidden="true" tabindex="-1"></a><span class="co">#method4 &lt;- function(x) {mclapply(x, mean, na.rm=TRUE, mc.cores=nCores)} # Use this line when running the code yourself</span></span>
<span id="cb953-5"><a href="bonus-8a.html#cb953-5" aria-hidden="true" tabindex="-1"></a>method4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">mclapply</span>(x, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">mc.cores=</span><span class="dv">1</span>)}  <span class="co"># Replace this line with the previous line</span></span>
<span id="cb953-6"><a href="bonus-8a.html#cb953-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb953-7"><a href="bonus-8a.html#cb953-7" aria-hidden="true" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(<span class="at">times =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">&quot;ms&quot;</span>,</span>
<span id="cb953-8"><a href="bonus-8a.html#cb953-8" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">method1</span>(x), <span class="fu">method2</span>(x), <span class="fu">method3</span>(x), <span class="fu">method4</span>(x))</span></code></pre></div>
<pre><code>## Unit: milliseconds
##        expr      min       lq      mean    median       uq      max neval cld
##  method1(x)  35.0782  35.1557  39.78689  37.43575  41.0023  58.7343    10  a 
##  method2(x) 149.8661 160.0045 169.54971 171.92180 178.5980 188.1043    10   b
##  method3(x)  33.3108  33.7978  39.42758  34.93725  37.9695  60.3094    10  a 
##  method4(x)  32.8447  33.4907  35.58582  34.91595  37.2769  40.8918    10  a</code></pre>
>>>>>>> main
<p><strong>Question</strong>: Compare the mean</p>
<ul>
<li>Which method was the fastest? Can you explain this?</li>
<li>Which method was slowest?</li>
<li>Was <code>mclapply</code> faster than <code>lapply</code> in this example?</li>
</ul>
<p>Note: Obviously you might only expect to see a gain in speed if nCores &gt; 1.</p>
</div>
<div id="b.-replace-for-by-foreach-with-package-doparallel" class="section level4">
<h4>b. Replace ‘for’ by ‘foreach’ with package ‘doParallel’</h4>
<p>On Windows, it is easier to use the package ‘doParallel’ with the function ‘foreach.’ Here’s a detailed introduction: <a href="http://127.0.0.1:26758/help/library/doParallel/doc/gettingstartedParallel.pdf" class="uri">http://127.0.0.1:26758/help/library/doParallel/doc/gettingstartedParallel.pdf</a>.</p>
<ul>
<li>Use <code>makeCluster</code> to specify the number of cores to be used. The default is half the number of cores.</li>
<li>Check number of clusters by printing <code>cl</code>.</li>
<li>Register the cluster with <code>registerDoParallel</code>. If you omit this step, the code will not use parallel computing.</li>
</ul>
<p>The following code is commented out to avoid problems when knitting the Notebook. You may uncomment and run it.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="bonus-8a.html#cb948-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span></code></pre></div>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## Loading required package: iterators</code></pre>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="bonus-8a.html#cb951-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cl &lt;- makeCluster(2)</span></span>
<span id="cb951-2"><a href="bonus-8a.html#cb951-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cl</span></span>
<span id="cb951-3"><a href="bonus-8a.html#cb951-3" aria-hidden="true" tabindex="-1"></a><span class="co">#registerDoParallel(cl)</span></span></code></pre></div>
=======
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="bonus-8a.html#cb955-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span></code></pre></div>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## Loading required package: iterators</code></pre>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="bonus-8a.html#cb958-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cl &lt;- makeCluster(2)</span></span>
<span id="cb958-2"><a href="bonus-8a.html#cb958-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cl</span></span>
<span id="cb958-3"><a href="bonus-8a.html#cb958-3" aria-hidden="true" tabindex="-1"></a><span class="co">#registerDoParallel(cl)</span></span></code></pre></div>
>>>>>>> main
<p>Now we adapt the code in two steps:</p>
<ul>
<li>The code is a little different with <code>foreach</code> than with <code>for</code>, as we use a pipe-like syntax with <code>%do%</code>, which means, for each value of <em>i</em>, do the following.</li>
<li>Thus, <code>%do%</code> is only a pipe operator, it does not result in parallelisation yet.</li>
<li>To make this parallel, replace <code>%do%</code> by <code>%dopar%</code>.</li>
</ul>
<<<<<<< HEAD
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="bonus-8a.html#cb952-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)) <span class="fu">mean</span>(x[,i], <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb952-2"><a href="bonus-8a.html#cb952-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)) <span class="sc">%do%</span> (<span class="fu">mean</span>(x[,i], <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb952-3"><a href="bonus-8a.html#cb952-3" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 &lt;- foreach(i = 1:ncol(x)) %dopar% (mean(x[,i], na.rm=TRUE))</span></span></code></pre></div>
<p>Let’s benchmark this again. We’ll only do 3 replicates this time (uncomment before running this code).</p>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="bonus-8a.html#cb953-1" aria-hidden="true" tabindex="-1"></a><span class="co">#method1 &lt;- function(x) {colMeans(x, na.rm=TRUE)}</span></span>
<span id="cb953-2"><a href="bonus-8a.html#cb953-2" aria-hidden="true" tabindex="-1"></a><span class="co">#method2 &lt;- function(x) {for(i in 1:ncol(x)) mean(x[,i], na.rm=TRUE)}</span></span>
<span id="cb953-3"><a href="bonus-8a.html#cb953-3" aria-hidden="true" tabindex="-1"></a><span class="co">#method3 &lt;- function(x) {lapply(x, mean, na.rm=TRUE)}</span></span>
<span id="cb953-4"><a href="bonus-8a.html#cb953-4" aria-hidden="true" tabindex="-1"></a><span class="co">#method4 &lt;- function(x) {mclapply(x, mean, na.rm=TRUE, mc.cores=nCores)}</span></span>
<span id="cb953-5"><a href="bonus-8a.html#cb953-5" aria-hidden="true" tabindex="-1"></a><span class="co">#method5 &lt;- function(x) {foreach(i = 1:ncol(x)) %do% (mean(x[,i], na.rm=TRUE))}</span></span>
<span id="cb953-6"><a href="bonus-8a.html#cb953-6" aria-hidden="true" tabindex="-1"></a><span class="co">#method6 &lt;- function(x) {foreach(i = 1:ncol(x)) %dopar% (mean(x[,i], na.rm=TRUE))}</span></span>
<span id="cb953-7"><a href="bonus-8a.html#cb953-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb953-8"><a href="bonus-8a.html#cb953-8" aria-hidden="true" tabindex="-1"></a><span class="co">#microbenchmark::microbenchmark(times = 3, unit = &quot;ms&quot;,method1(x), method2(x), method3(x), method4(x), method5(x), method6(x))</span></span></code></pre></div>
=======
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="bonus-8a.html#cb959-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)) <span class="fu">mean</span>(x[,i], <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb959-2"><a href="bonus-8a.html#cb959-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)) <span class="sc">%do%</span> (<span class="fu">mean</span>(x[,i], <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb959-3"><a href="bonus-8a.html#cb959-3" aria-hidden="true" tabindex="-1"></a><span class="co">#m3 &lt;- foreach(i = 1:ncol(x)) %dopar% (mean(x[,i], na.rm=TRUE))</span></span></code></pre></div>
<p>Let’s benchmark this again. We’ll only do 3 replicates this time (uncomment before running this code).</p>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="bonus-8a.html#cb960-1" aria-hidden="true" tabindex="-1"></a><span class="co">#method1 &lt;- function(x) {colMeans(x, na.rm=TRUE)}</span></span>
<span id="cb960-2"><a href="bonus-8a.html#cb960-2" aria-hidden="true" tabindex="-1"></a><span class="co">#method2 &lt;- function(x) {for(i in 1:ncol(x)) mean(x[,i], na.rm=TRUE)}</span></span>
<span id="cb960-3"><a href="bonus-8a.html#cb960-3" aria-hidden="true" tabindex="-1"></a><span class="co">#method3 &lt;- function(x) {lapply(x, mean, na.rm=TRUE)}</span></span>
<span id="cb960-4"><a href="bonus-8a.html#cb960-4" aria-hidden="true" tabindex="-1"></a><span class="co">#method4 &lt;- function(x) {mclapply(x, mean, na.rm=TRUE, mc.cores=nCores)}</span></span>
<span id="cb960-5"><a href="bonus-8a.html#cb960-5" aria-hidden="true" tabindex="-1"></a><span class="co">#method5 &lt;- function(x) {foreach(i = 1:ncol(x)) %do% (mean(x[,i], na.rm=TRUE))}</span></span>
<span id="cb960-6"><a href="bonus-8a.html#cb960-6" aria-hidden="true" tabindex="-1"></a><span class="co">#method6 &lt;- function(x) {foreach(i = 1:ncol(x)) %dopar% (mean(x[,i], na.rm=TRUE))}</span></span>
<span id="cb960-7"><a href="bonus-8a.html#cb960-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb960-8"><a href="bonus-8a.html#cb960-8" aria-hidden="true" tabindex="-1"></a><span class="co">#microbenchmark::microbenchmark(times = 3, unit = &quot;ms&quot;,method1(x), method2(x), method3(x), method4(x), method5(x), method6(x))</span></span></code></pre></div>
>>>>>>> main
<p>Whether parallelisation is faster depends on the type of task and on your system. In this case, both versions that used parallelisation were actually slower than the sequential code (at least on my system).</p>
<p>Of course, this will not always be the case, it may depend on:</p>
<ul>
<li>What type and size of computational task you are running.</li>
<li>How many nodes you can use in parallel. The initial ‘cost’ of coordinating the task among cores may not be worth it if you only have two cores to use anyways, but with 20 cores, the gain will be higher.</li>
<li>Whether all cores are in the same node, or whether you distribute the work among multiple nodes (this will increase the cost of coordination, but potentially also give you access to many more cores).</li>
</ul>

</div>
</div>
</div>
<!-- </div> -->



            </section>

          </div>
        </div>
      </div>
<a href="r-exercise-week-8.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Week9.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
